---
title: 数据库介绍（MySQL安装 体系结构、基本管理）
author: 惨绿少年
type: post
date: 2017-12-14T01:47:00+00:00
url: /clsn/lx446.html
Baidusubmit:
  - 1
views:
  - 348
specs_zan:
  - 1
categories:
  - Linux运维
  - MySQL
  - 数据库

---
<span style="font-size: 2em;">第1章 数据库介绍及mysql安装</span>

<p align="center">
  &nbsp;<img src="https://clsn.io/wp-content/uploads/2018/03/1190037-20171214171323029-677919266.png" alt="数据库介绍（MySQL安装 体系结构、基本管理）" alt="" /><img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171214171326279-1595156611.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="数据库介绍（MySQL安装 体系结构、基本管理）" alt="" />
</p>

## <span id="11">1.1 数据库简介</span>

　　数据库，简而言之可视为电子化的文件柜&mdash;&mdash;存储电子文件的处所，用户可以对文件中的数据运行新增、截取、更新、删除等操作。

　　所谓&ldquo;数据库&rdquo;系以一定方式储存在一起、能予多个用户共享、具有尽可能小的冗余度、与应用程序彼此独立的数据集合。

### <span id="111">1.1.1 什么是数据</span>

　　数据是指对客观事件进行记录并可以鉴别的符号，是对客观 事物的性质、状态以及相互关系等进行记载的物理符号或这些物 理符号的组合。它是可识别的、抽象的符号。

### <span id="112">1.1.2 数据库管理系统</span>

<p align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171214171353623-1825862157.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="数据库介绍（MySQL安装 体系结构、基本管理）" alt="" />
</p>

<p align="center">
  <strong>非关系型数据库</strong>
</p>

　　NoSQL：非关系型数据库（Not only SQL）

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #000000;">不是否定关系型数据库，做关系型数据库的的补充。
想做老大，先学会做老二。</span></pre>
  </div>
</div>

<p align="center">
  &nbsp;<img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171214171412138-1184919459.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="数据库介绍（MySQL安装 体系结构、基本管理）" alt="" />
</p>

<p align="center">
  <strong>关系型数据库</strong>
</p>

　　关系型数据库的特点

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #000000;">二维表
典型产品 Oracle传统企业，MySQL是互联网企业
数据存取是通过SQL(结构化查询语句)
最大特点，数据安全性方面强（ACID） </span></pre>
  </div>
</div>

### <span id="113_NoSQL">1.1.3 NoSQL特性总览</span>

　　l&nbsp; 不是否定关系型数据库，而是作为补充，现在也有部分替代的趋势。

　　l&nbsp; 关注高性能，高并发，灵活性，忽略和上述无关的功能。

　　l&nbsp; 现在也在提升安全性和使用功能。

　　l&nbsp; 典型产品：Redis（持久化缓存，两个半天）、MongoDB（最接近关系型数据 的NoSQL）、Memcached。

　　l&nbsp; 管理不适用SQL管理，而是用一些特殊的 API 或 数据接口。

### <span id="114_NoSQL">1.1.4 NoSQL的分类、特点、典型产品</span>

　　键值（KV）存储：Memcached、Redis

　　列存储（column-oriented）：HBASE(新浪，360)、Cassandra（200台服务器集群 ）

　　文档数据库（document-oriented）：MongoDB（最接近关系型数据库的NoSQL）

　　图形存储（Graph）：Neo4j

<p style="text-align: center;">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171214171453748-187774726.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="数据库介绍（MySQL安装 体系结构、基本管理）" alt="" />
</p>

　　　　数据来源： https://db-engines.com/en/ranking

## <span id="12">1.2 数据库相关产品</span>

### <span id="121_Oracle">1.2.1 Oracle公司产品介绍</span>

**　　Oracle****数据库版本介绍**

<div>
  <p class="a4">
    　　　　7--8i--9i--10g&mdash;11g--12c--18c(?)
  </p>
</div>

**　　Oracle****的市场应用**

　　　　a)&nbsp; 市场份额第一，趋势递减

　　　　b)&nbsp; 市场空间，传统企业

　　　　c)&nbsp; 传统企业也在互联网化

**　　<span style="background-color: #99cc00;">MySQL</span>**<span style="background-color: #99cc00;"><strong>数据库版本介绍</strong></span>

<div>
  <p class="a4">
    　　　　5.0--5.1--5.5--5.6--5.7--8.0
  </p>
</div>

**　　MySQL****的市场应用**

　　　　a)&nbsp; 中、大型互联网公司

　　　　b)&nbsp; 市场空间：互联网领域第一

　　　　c)&nbsp; 趋势明显

　　　　d)&nbsp; 同源产品：MariaDB、perconaDB

### <span id="122">1.2.2 其他公司产品</span>

**　　微软：SQL Server**

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #000000;">微软和sysbase合作开发的产品，后来自己开发,windows平台
</span><span style="color: #800080;">3</span>,4线小公司，传统行业在用</pre>
  </div>
</div>

**　　IBM** **：DB2****数据库**

<div>
  <p class="a4">
    &nbsp;&nbsp;&nbsp;　　&nbsp;市场占有量小
  </p>
  
  <p class="a4">
    　　&nbsp; &nbsp; 目前只有：国有银行（人行、中国银行、工商银行等）、中国移动应用。
  </p>
</div>

**下面三者广泛应用在大型互联网公司**

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #000000;">　　PostgreSQL
　　MongoDB
　　Redis</span></pre>
  </div>
</div>

## <span id="13_Mysql">1.3 Mysql简介</span>

### <span id="131_mysql">1.3.1 mysql数据库发展史</span>

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #008080;">1</span> <span style="color: #000000;">1979年，报表工具Unireg出现。
</span><span style="color: #008080;">2</span> <span style="color: #800080;">1985</span><span style="color: #000000;"> 年，以瑞典David Axmark 为首，成立了一家公司（AB前身），IASM引擎出现。
</span><span style="color: #008080;">3</span> <span style="color: #000000;">1990年，提供SQL支持。
</span><span style="color: #008080;">4</span> <span style="color: #800080;">1999</span>-<span style="color: #000000;">2000年，MySQL AB公司成立，并公布源码，开源化。
</span><span style="color: #008080;">5</span> <span style="color: #000000;">2000年4月BDB引擎出现，支持事务。
</span><span style="color: #008080;">6</span> <span style="color: #000000;">2008年1月16日，Sun（太阳微系统）正式收购MySQL。
</span><span style="color: #008080;">7</span> <span style="color: #000000;">2009年4月20日，甲骨文公司宣布以每股9.50美元，74亿美元的总额收购Sun电脑公司，MySQL 转入Oracle 门下。
</span><span style="color: #008080;">8</span> 2013年6月18日，甲骨文公司修改MySQL授权协议，移除了GPL。但随后有消息称这是一个bug。</pre>
  </div>
</div>

### <span id="132_MySQL">1.3.2 MySQL的特点简介</span>

　　开源、社区版免费、简单，使用方便，可靠、稳定、安全、社区活跃

### <span id="133_mysql">1.3.3 mysql产品线的介绍</span>

**mysql****产品线（主线）**

**_　　3.26--5.2_****_版本_**

　　　　&ndash; 正宗后代

　　　　&ndash; Centos5、6中默认有5.1版本

　　　　&ndash; Centos7中默认是MariaDB

**　　5.4--5.7** **，8.0****版本**

　　　　&ndash; 借鉴社区好的贡献，进一步开发的版本

　　　　&ndash; 主流版本：5.5 5.6 5.7

**_　　MySQL Cluster 6.0_** **_版本&_****_更高_**

　　　　&ndash; 类似于Oracle RAC，硬件要求高。

　　　　&ndash; 一般各大网站没有人用

**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mysql****产品线(****派生产品)**

**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** 派生版本有Drizzle、MariaDB、Percona Server及OurDelta等。

### <span id="134_MySQL">1.3.4 企业生产场景选择MySQL数据库建议：</span>

<div class="cnblogs_code">
  <pre><span style="color: #800080;">1</span><span style="color: #000000;">） 稳定版：选择开源的社区版的稳定版GA版本 
</span><span style="color: #800080;">2</span>） 产品线：可以选择5.1或5.<span style="color: #800080;">5</span> 互联网公司主流5.<span style="color: #800080;">5</span>，其次是5.1和5.<span style="color: #800080;">6</span> 
<span style="color: #800080;">3</span><span style="color: #000000;">） 选择MySQL数据库GA版发布后6个月以上的GA版本。 
</span><span style="color: #800080;">4</span><span style="color: #000000;">）要选择前后几个月没有大的BUG修复的版本，而不是大量修复BUG的集中版本 
</span><span style="color: #800080;">5</span><span style="color: #000000;">）最好向后较长时间没有更新发布的版本 
</span><span style="color: #800080;">6</span><span style="color: #000000;">）要考虑开发人员开发程序使用的版本是否兼容你选的版本 
</span><span style="color: #800080;">7</span>）作为内部开发人员开发测试数据库环境，跑大概3-<span style="color: #000000;">6个月的事件 
</span><span style="color: #800080;">8</span><span style="color: #000000;">）优先企业非核心业务采用新版本的数据库GA版本软件 
</span><span style="color: #800080;">9</span><span style="color: #000000;">）向DBA高手请教，或者在及技术氛围好的群里和大家一起交流，使用真正的高手们用过的好用的GA版本产品
</span><span style="color: #800080;">10</span>）若是没有重要的功能BUG或性能瓶颈，则可以开始考虑作为任何任务数据服务的后端数据库软件</pre>
</div>

## <span id="14_mysql">1.4 mysql数据库的安装</span>

### <span id="141">1.4.1 系统环境说明</span>

<div>
  <div class="cnblogs_code">
    <pre>[root@db02 ~]# <span style="color: #0000ff;">cat</span> /etc/redhat-<span style="color: #000000;">release 
CentOS release </span><span style="color: #800080;">6.9</span><span style="color: #000000;"> (Final)
[root@db02 </span>~]# <span style="color: #0000ff;">uname</span> -<span style="color: #000000;">r
</span><span style="color: #800080;">2.6</span>.<span style="color: #800080;">32</span>-<span style="color: #800080;">696</span><span style="color: #000000;">.el6.x86_64
[root@db02 </span>~]# /etc/init.d/<span style="color: #000000;">iptables status
iptables: Firewall is not running.
[root@db02 </span>~<span style="color: #000000;">]# getenforce 
Disabled
[root@db02 </span>~]# <span style="color: #0000ff;">hostname</span>  -<span style="color: #000000;">I 
</span><span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.52</span> <span style="color: #800080;">172.16</span>.<span style="color: #800080;">1.52</span></pre>
  </div>
</div>

### <span id="142_mysql">1.4.2 mysql编译安装</span>

　　安装依赖包

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #0000ff;">yum</span>  <span style="color: #0000ff;">install</span>  -y  ncurses-devel libaio-devel</pre>
  </div>
  
  <p>
    　　安装cmake编译工具
  </p>
</div>

**　　<span style="background-color: #00ff00;">cmake</span>**

　　定制功能：存储引擎、字符集、压缩等

　　定制安装位置、数据存储位置、文件位置（socket）

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #0000ff;">yum</span> <span style="color: #0000ff;">install</span> cmake -y</pre>
  </div>
  
  <p>
    　　创建mysql管理用户
  </p>
</div>

<div>
  <div class="cnblogs_code">
    <pre>useradd -s /sbin/nologin -M mysql -<span style="color: #000000;">u1000
</span><span style="color: #0000ff;">id</span> mysql</pre>
  </div>
  
  <p>
    　　下载mysql软件包，解压
  </p>
</div>

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #0000ff;">mkdir</span>  -p /server/<span style="color: #000000;">tools 
cd </span>/server/<span style="color: #000000;">tools
</span><span style="color: #0000ff;">wget</span> -q http:<span style="color: #008000;">//</span><span style="color: #008000;">mirrors.sohu.com/mysql/MySQL-5.6/mysql-5.6.36.tar.gz</span>
<span style="color: #0000ff;">tar</span> xf mysql-<span style="color: #800080;">5.6</span>.<span style="color: #800080;">36</span>.<span style="color: #0000ff;">tar</span>.gz</pre>
  </div>
</div>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 注：这里使用的是sohu的镜像源进行下载（软件版本5.6.36）

<div>
  <div class="cnblogs_code">
    <pre>　　　　官方下载方式参考：http:<span style="color: #008000;">//</span><span style="color: #008000;">www.cnblogs.com/clsn/p/8025324.html#_label4</span></pre>
  </div>
</div>

进入查询目录，使用cmake进行编译，安装，创建软连接，过程时间较长。

<div class="cnblogs_code">
  <pre>cd mysql-<span style="color: #800080;">5.6</span>.<span style="color: #800080;">36</span><span style="color: #000000;">
cmake . </span>-DCMAKE_INSTALL_PREFIX=/application/mysql-<span style="color: #800080;">5.6</span>.<span style="color: #800080;">36</span><span style="color: #000000;"> \
</span>-DMYSQL_DATADIR=/application/mysql-<span style="color: #800080;">5.6</span>.<span style="color: #800080;">36</span>/<span style="color: #000000;">data \
</span>-DMYSQL_UNIX_ADDR=/application/mysql-<span style="color: #800080;">5.6</span>.<span style="color: #800080;">36</span>/tmp/<span style="color: #000000;">mysql.sock \
</span>-DDEFAULT_CHARSET=<span style="color: #000000;">utf8 \
</span>-DDEFAULT_COLLATION=<span style="color: #000000;">utf8_general_ci \
</span>-DWITH_EXTRA_CHARSETS=<span style="color: #000000;">all \
</span>-DWITH_INNOBASE_STORAGE_ENGINE=<span style="color: #800080;">1</span><span style="color: #000000;"> \
</span>-DWITH_FEDERATED_STORAGE_ENGINE=<span style="color: #800080;">1</span><span style="color: #000000;"> \
</span>-DWITH_BLACKHOLE_STORAGE_ENGINE=<span style="color: #800080;">1</span><span style="color: #000000;"> \
</span>-DWITHOUT_EXAMPLE_STORAGE_ENGINE=<span style="color: #800080;">1</span><span style="color: #000000;"> \
</span>-DWITH_ZLIB=<span style="color: #000000;">bundled \
</span>-DWITH_SSL=<span style="color: #000000;">bundled \
</span>-DENABLED_LOCAL_INFILE=<span style="color: #800080;">1</span><span style="color: #000000;"> \
</span>-DWITH_EMBEDDED_SERVER=<span style="color: #800080;">1</span><span style="color: #000000;"> \
</span>-DENABLE_DOWNLOADS=<span style="color: #800080;">1</span><span style="color: #000000;"> \
</span>-DWITH_DEBUG=<span style="color: #800080;"></span>
<span style="color: #0000ff;">make</span> && <span style="color: #0000ff;">make</span> <span style="color: #0000ff;">install</span>
<span style="color: #0000ff;">ln</span> -s /application/mysql-<span style="color: #800080;">5.6</span>.<span style="color: #800080;">36</span>/ /application/mysql</pre>
</div>

### <span id="143">1.4.3 数据库安装后的操作</span>

**　　复制配置文件**

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #0000ff;">\cp</span>  /application/mysql/support-files/my-default.cnf /etc/my.cnf</pre>
  </div>
</div>

　　编译的MySQL可以暂时不需要设置配置文件。

　　注意：如果以前操作系统中安装过rpm格式的mysql，系统中可能会遗留/etc/my.cnf文件，我们需要将它删除掉

**初始化数据库**

<div>
  <div class="cnblogs_code">
    <pre>/application/mysql/scripts/mysql_install_db --basedir=/application/mysql/ --datadir=/application/mysql/data --user=mysql</pre>
  </div>
  
  <p>
    　　<strong>防止报错：</strong>数据库启动会提示，找不到xx/tmp/mysql.sock,原因是5.6.36版本不会自动创建tmp目录，需要我们手工创建。
  </p>
</div>

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #0000ff;">mkdir</span> /application/mysql/tmp</pre>
  </div>
  
  <p>
    　　修改程序目录的属主，属组
  </p>
</div>

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #0000ff;">chown</span> -R mysql.mysql /application/mysql/</pre>
  </div>
  
  <p>
    　　复制启动脚本，并修改权限
  </p>
</div>

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #0000ff;">cp</span> support-files/mysql.server /etc/init.d/<span style="color: #000000;">mysqld
</span><span style="color: #0000ff;">chmod</span> <span style="color: #800080;">700</span> /etc/init.d/mysqld</pre>
  </div>
</div>

**　　添加环境变量，使用mysql****命令**

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #0000ff;">echo</span> <span style="color: #800000;">'</span><span style="color: #800000;">PATH=/application/mysql/bin/:$PATH</span><span style="color: #800000;">'</span> >>/etc/<span style="color: #000000;">profile
</span><span style="color: #0000ff;">tail</span> -<span style="color: #800080;">1</span> /etc/<span style="color: #000000;">profile
source </span>/etc/<span style="color: #000000;">profile
</span><span style="color: #0000ff;">echo</span><span style="color: #000000;"> $PATH
mysql</span></pre>
  </div>
</div>

### <span id="144">1.4.4 数据库安全设置</span>

　　设置root用户密码

<div>
  <div class="cnblogs_code">
    <pre>mysqladmin -u root password <span style="color: #800000;">'</span><span style="color: #800000;">123456</span><span style="color: #800000;">'</span><span style="color: #000000;">
mysql </span>-uroot -p123456</pre>
  </div>
</div>

　　优化数据库（清理用户及无用数据库）

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #0000ff;">select</span><span style="color: #000000;"> user,host from mysql.user;
drop user </span><span style="color: #800000;">''</span>@<span style="color: #800000;">'</span><span style="color: #800000;">db02</span><span style="color: #800000;">'</span><span style="color: #000000;">;
drop user </span><span style="color: #800000;">''</span>@<span style="color: #800000;">'</span><span style="color: #800000;">localhost</span><span style="color: #800000;">'</span><span style="color: #000000;">;
drop user </span><span style="color: #800000;">'</span><span style="color: #800000;">root</span><span style="color: #800000;">'</span>@<span style="color: #800000;">'</span><span style="color: #800000;">db02</span><span style="color: #800000;">'</span><span style="color: #000000;">;
drop user </span><span style="color: #800000;">'</span><span style="color: #800000;">root</span><span style="color: #800000;">'</span>@<span style="color: #800000;">'</span><span style="color: #800000;">::1</span><span style="color: #800000;">'</span><span style="color: #000000;">;
</span><span style="color: #0000ff;">select</span><span style="color: #000000;"> user,host from mysql.user;
drop database test;
show databases;</span></pre>
  </div>
</div>

## <span id="15_mysql_57">1.5 mysql 5.7版本安装说明</span>

　　主机系统环境说明

<div>
  <div class="cnblogs_code">
    <pre>[root@db13 ~]# <span style="color: #0000ff;">cat</span> /etc/redhat-<span style="color: #000000;">release
CentOS release </span><span style="color: #800080;">6.9</span><span style="color: #000000;"> (Final)
[root@db13 </span>~]# <span style="color: #0000ff;">uname</span> -<span style="color: #000000;">r
</span><span style="color: #800080;">2.6</span>.<span style="color: #800080;">32</span>-<span style="color: #800080;">696</span><span style="color: #000000;">.el6.x86_64
[root@db13 </span>~<span style="color: #000000;">]# getenforce
Disabled
[root@db13 </span>~]# /etc/init.d/<span style="color: #000000;">iptables status
iptables: Firewall is not running.
[root@db13 </span>~]# <span style="color: #0000ff;">hostname</span> -<span style="color: #000000;">I
</span><span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.153</span> <span style="color: #800080;">172.16</span>.<span style="color: #800080;">1.153</span></pre>
  </div>
  
  <p>
    　　获取软件（采用二进制包方式进行安装）
  </p>
</div>

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #0000ff;">mkdir</span> -p /server/<span style="color: #000000;">tools
cd </span>/server/<span style="color: #000000;">tools
</span><span style="color: #0000ff;">wget</span> http:<span style="color: #008000;">//</span><span style="color: #008000;">mirrors.sohu.com/mysql/MySQL-5.7/mysql-5.7.17-linux-glibc2.5-x86_64.tar.gz</span></pre>
  </div>
  
  <p>
    　　解压
  </p>
</div>

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #0000ff;">tar</span> xf mysql-<span style="color: #800080;">5.7</span>.<span style="color: #800080;">17</span>-linux-glibc2.<span style="color: #800080;">5</span>-x86_64.<span style="color: #0000ff;">tar</span>.gz</pre>
  </div>
  
  <p>
    　　将软件移动到程序目录，创建软连接
  </p>
</div>

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #0000ff;">mkdir</span> -p /application/
<span style="color: #0000ff;">mv</span> mysql-<span style="color: #800080;">5.7</span>.<span style="color: #800080;">17</span>-linux-glibc2.<span style="color: #800080;">5</span>-x86_64 /application/mysql-<span style="color: #800080;">5.7</span>.<span style="color: #800080;">17</span>
<span style="color: #0000ff;">ln</span> -s /application/mysql-<span style="color: #800080;">5.7</span>.<span style="color: #800080;">17</span> /application/mysql</pre>
  </div>
  
  <p>
    　　添加mysql用户，并进行授权
  </p>
</div>

<div>
  <div class="cnblogs_code">
    <pre>useradd -M -s /sbin/nologin  -u <span style="color: #800080;">1000</span><span style="color: #000000;"> mysql
</span><span style="color: #0000ff;">chown</span> -R mysql.mysql /application/mysql-<span style="color: #800080;">5.7</span>.<span style="color: #800080;">17</span></pre>
  </div>
  
  <p>
    　　初始化数据库
  </p>
</div>

<div>
  <div class="cnblogs_code">
    <pre>/application/mysql-<span style="color: #800080;">5.7</span>.<span style="color: #800080;">17</span>/bin/mysqld --initialize --user=mysql --basedir=/application/mysql-<span style="color: #800080;">5.7</span>.<span style="color: #800080;">17</span> --datadir=/application/mysql-<span style="color: #800080;">5.7</span>.<span style="color: #800080;">17</span>/data</pre>
  </div>
</div>

**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** **初始化时注意最后一行输出root****密码**

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #800080;">2017</span>-<span style="color: #800080;">12</span>-13T08:<span style="color: #800080;">40</span>:<span style="color: #800080;">31</span>.760309Z <span style="color: #800080;">1</span> [Note] A temporary password is generated <span style="color: #0000ff;">for</span> root@localhost: )<span style="background-color: #ff0000;">*1E7=fYd&>i</span></pre>
  </div>
</div>

　　拷贝配置文件和启动文件

<div>
  <div class="cnblogs_code">
    <pre>\<span style="color: #0000ff;">cp</span> /application/mysql-<span style="color: #800080;">5.7</span>.<span style="color: #800080;">17</span>/support-files/my-default.cnf /etc/<span style="color: #000000;">my.cn
\</span><span style="color: #0000ff;">cp</span> \application/mysql-<span style="color: #800080;">5.7</span>.<span style="color: #800080;">17</span>/support-files/mysql.server /etc/init.d/mysqld</pre>
  </div>
</div>

\# 修改启动文件内容（配置目录）

<div>
  <p class="a4">
    　　将程序安装到 /usr/local/ 下 可以省略这步操作
  </p>
</div>

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #0000ff;">sed</span> <span style="color: #800000;">'</span><span style="color: #800000;">s#/usr/local#/application#g</span><span style="color: #800000;">'</span> /application/mysql-<span style="color: #800080;">5.7</span>.<span style="color: #800080;">17</span>/bin/mysqld_safe /etc/init.d/mysqld -i</pre>
  </div>
</div>

　　启动mysql

<div>
  <div class="cnblogs_code">
    <pre>[root@db13 tools]# /etc/init.d/<span style="color: #000000;">mysqld start 
Starting MySQL.Logging to </span><span style="color: #800000;">'</span><span style="color: #800000;">/application/mysql/data/db13.err</span><span style="color: #800000;">'</span><span style="color: #000000;">.
 SUCCESS</span>!<span style="color: #000000;"> 
[root@db13 tools]# </span>/etc/init.d/<span style="color: #000000;">mysqld status
 SUCCESS</span>! MySQL running (<span style="color: #800080;">1509</span>)</pre>
  </div>
</div>

　　添加环境变量

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #0000ff;">echo</span> <span style="color: #800000;">'</span><span style="color: #800000;">PATH=/application/mysql/bin/:$PATH</span><span style="color: #800000;">'</span> >>/etc/<span style="color: #000000;">profile
</span><span style="color: #0000ff;">tail</span> -<span style="color: #800080;">1</span> /etc/<span style="color: #000000;">profile
source </span>/etc/<span style="color: #000000;">profile
</span><span style="color: #0000ff;">echo</span> $PATH</pre>
  </div>
</div>

修改mysql密码

<div>
  <div class="cnblogs_code">
    <pre>[root@db13 tools]# mysqladmin -uroot -p password <span style="color: #800080;">123456</span><span style="color: #000000;">
Enter password: 【输入初始化时生成的密码】
mysqladmin: [Warning] Using a password on the command line interface can be insecure.
Warning: Since password will be sent to server </span><span style="color: #0000ff;">in</span> plain text, use ssl connection to ensure password safety.</pre>
  </div>
</div>

# <span id="2_Mysql">第2章 Mysql体系结构与基本管理</span>

## <span id="21">2.1 客户端与服务器端模型</span>

### <span id="211_mysql">2.1.1 mysql服务结构</span>

mysql是一个典型的c/s模式，服务端与客户端两部分组成

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #000000;">        服务端程序 mysqld
        客户端程序 mysql自带客户端（mysql、mysqladmin、mysqldump等）
                  第三方客户端  API接口（php</span>-mysql）</pre>
  </div>
</div>

<p align="center">
  &nbsp;<img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171214172430638-833605238.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="数据库介绍（MySQL安装 体系结构、基本管理）" alt="" />
</p>

### <span id="212_mysql">2.1.2 mysql连接方式</span>

**TCP/IP** **连接**&nbsp;&nbsp; 网络连接串(通过用户名 密码 IP 端口进行连接)

<div>
  <div class="cnblogs_code">
    <pre>mysql -uroot -p123 -h <span style="color: #800080;">127.0</span>.<span style="color: #800080;">0.1</span> -P <span style="color: #800080;">3306</span></pre>
  </div>
</div>

<p align="center">
  &nbsp;<img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171214172459060-1741763262.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="数据库介绍（MySQL安装 体系结构、基本管理）" alt="" />
</p>

**socket** **连接** &nbsp;&nbsp;网络套接字(用户名 密码&nbsp; socket文件)

<div>
  <div class="cnblogs_code">
    <pre>mysql -uroot -p123 -S /application/mysql/tmp/mysql.sock </pre>
  </div>
</div>

<p align="center">
  &nbsp;<img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171214172510873-948862641.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="数据库介绍（MySQL安装 体系结构、基本管理）" alt="" />
</p>

在linux中使用mysql命令不加其他的参数连接方式即

<div>
  <div class="cnblogs_code">
    <pre>mysql -uroot -poldboy123使用的是套接字文件方式登录的</pre>
  </div>
</div>

### <span id="213_MySQL">2.1.3 MySQL在启动过程</span>

　　启动后台守护进程，并生成工作线程

　　预分配内存结构供MySQL处理数据使用

**　　<span style="background-color: #ffff00;">实例就是MySQL</span>**<span style="background-color: #ffff00;"><strong>的后台进程+</strong><strong>线程+</strong><strong>预分配的内存结构</strong></span>

## <span id="22_Mysqld">2.2 Mysqld服务的构成</span>

<p align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171214172541076-542631194.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="数据库介绍（MySQL安装 体系结构、基本管理）" alt="" />&nbsp;
</p>

### <span id="221">2.2.1 连接层</span>

<p align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171214172551685-1082871403.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="数据库介绍（MySQL安装 体系结构、基本管理）" alt="" />&nbsp;
</p>

　　通讯协议为：tcp/ip 或 socket

　　连接线程 为连接的数量

　　用户验证 为通过用户名 密码验证进行通讯协议

### <span id="222_SQL">2.2.2 SQL层</span>

<p align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171214172601263-2057573575.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="数据库介绍（MySQL安装 体系结构、基本管理）" alt="" />&nbsp;
</p>

　　sql即结构化的查询语句（数据库内部逻辑语言）sql92 sql99

<div>
  <p class="a4">
    &nbsp;&nbsp;&nbsp; 　　DDL 数据库定义语言
  </p>
  
  <p class="a4">
    &nbsp;&nbsp;&nbsp; 　　DCL 数据库控制语言
  </p>
  
  <p class="a4">
    &nbsp;&nbsp;&nbsp; 　　DML 数据库操作语言
  </p>
  
  <p class="a4">
    &nbsp;&nbsp;&nbsp; 　　DQL 数据查询语言
  </p>
</div>

SQL层的功能： select * from wordpress.user;

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #800080;">1</span><span style="color: #000000;">、判断语法、语句、语义
    判断语句类型 
</span><span style="color: #800080;">2</span><span style="color: #000000;">、数据库不能直接响应sql语句
    必须明确的知道数据在哪个磁盘  
</span><span style="color: #800080;">3</span><span style="color: #000000;">、数据库对象授权情况判断
    授权失败不继续
</span><span style="color: #800080;">4</span><span style="color: #000000;">、解析(解析器)
    将sql语句解析成执行计划，运行执行计划，生成找数据的方式
</span><span style="color: #800080;">5</span><span style="color: #000000;">、优化 (优化器)
    运行执行计划
   </span><span style="color: #800080;">5</span>.6之后 基于代价的算法，从执行计划中选择代价最小的交给<span style="color: #800000;">"</span><span style="color: #800000;">执行器</span><span style="color: #800000;">"</span>
<span style="color: #800080;">6</span>、<span style="color: #800000;">"</span><span style="color: #800000;">执行器</span><span style="color: #800000;">"</span><span style="color: #000000;">
    运行执行计划 
    最终生产如何去磁盘找数据方式
</span><span style="color: #800080;">7</span><span style="color: #000000;">、将取数据的方式，交由下层(存储引擎层)进行处理

</span><span style="color: #800080;">8</span><span style="color: #000000;">、最终将取出的数据抽象成管理员或用户能看懂的方式(表)，展现在用户面前

</span><span style="color: #800080;">9</span><span style="color: #000000;">、查询缓存： 缓存之前查询的数据。
    假如我们查询的表是一个经常有变动的表，查询缓存不要设置太大　　</span></pre>
  </div>
</div>

**　　SQL****层处理流程**

<p align="center">
  &nbsp;<img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171214172632123-1843023678.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="数据库介绍（MySQL安装 体系结构、基本管理）" alt="" />
</p>

### <span id="223">2.2.3 存储引擎层</span>

　　由上层决定存储方式

　　　　存储引擎是充当不同表类型的处理程序的服务器组件。

<p align="center">
  &nbsp;<img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171214172641795-1437750178.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="数据库介绍（MySQL安装 体系结构、基本管理）" alt="" />
</p>

**　　存储引擎层功能：**

　　　　存数据、取数据

　　　　数据的不同存储方式

**_&nbsp; &nbsp; &nbsp;不同的管理方式：_**

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;　　&nbsp;&nbsp;&nbsp;&nbsp; 事务（增、删、改）

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;　　&nbsp;&nbsp;&nbsp; 备份恢复&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;　　&nbsp;&nbsp;&nbsp; 高级功能（高可用的架构、读写分离架构）

### <span id="224">2.2.4 依赖于存储引擎的功能</span>

存储引擎是充当不同表类型的处理程序的服务器组件。

**存储引擎用于：**

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #000000;">存储数据、检索数据、通过索引查找数据
        存储介质、  事务功能、  锁定、备份和恢复、优化</span></pre>
  </div>
</div>

　　特殊功能：

<div>
  <div class="cnblogs_code">
    <pre>全文搜索、引用完整性、空间数据处理    </pre>
  </div>
</div>

　　双层处理

<div>
  <div class="cnblogs_code">
    <pre>上层包括SQL解析器和优化器、下层包含一组存储引擎</pre>
  </div>
</div>

　　SQL 层不依赖于存储引擎：

<div>
  <div class="cnblogs_code">
    <pre>引擎不影响SQL处理</pre>
  </div>
</div>

### <span id="225_mysql">2.2.5 mysql 的逻辑构成(数据库内部结构)</span>

　　逻辑构成是为了用户能够读懂数据出现的，让你更好的理解数据。

　　管理数据的一种方式。

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #000000;">对象：
            库中包含表，在linux中以目录表示
            表中有列结构与行记录，在linux中以多个文件表示
                行记录
                列结构</span></pre>
  </div>
</div>

　　切换库

<div>
  <div class="cnblogs_code">
    <pre>mysql> use mysql;</pre>
  </div>
</div>

　　查看表

<div>
  <div class="cnblogs_code">
    <pre>mysql> show tables;</pre>
  </div>
</div>

　　查看列的信息（记录）

<div>
  <div class="cnblogs_code">
    <pre>mysql> desc user;</pre>
  </div>
</div>

### <span id="226_mysql">2.2.6 mysql的存储方式</span>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 程序文件随数据目录一起存储在服务器安装目录下。执行各种客户机程序、管理程序和实用程序时将创建程序可执行文件和日志文件。首要使用磁盘空间的是数据目录。

服务器日志文件和状态文件：

　　包含有关服务器处理的语句的信息。日志可用于进行故障排除、监视、复制和恢复。

**　　<span style="background-color: #00ff00;">InnoDB </span>****<span style="background-color: #00ff00;">日志文件</span>：** （适用于所有数据库）驻留在数据目录级别。

**　　<span style="background-color: #00ff00;">InnoDB </span>**<span style="background-color: #00ff00;"><strong>系统表空间： &nbsp;</strong></span>包含数据字典、撤消日志和缓冲区。

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 每个数据库在数据目录下均具有单一目录（无论在数据库中创建何种类型的表）。数据库目录存储以下内容：

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #000000;">数据文件：
     特定于存储引擎的数据文件。这些文件也可能包含元数据或索引信息，具体取决于所使用的存储引擎。
格式文件 (.frm)：
　　　包含每个表和</span>/<span style="color: #000000;">或视图结构的说明，位于相应的数据库目录中。
触发器：
     与某个表关联并在该表发生特定事件时激活的命名数据库对象。</span></pre>
  </div>
</div>

　　数据目录的位置取决于配置、操作系统、安装包和分发。典型位置是 /var/lib/mysql。

　　MySQL 在磁盘上存储系统数据库 (mysql)。

　　mysql 包含诸如用户、特权、插件、帮助列表、事件、时区实现和存储例程之类的信息。

### <span id="227_MySQL">2.2.7 MySQL体系结构小结</span>

<span style="background-color: #00ff00;"><strong>sql </strong><strong>优化相关的理念</strong></span>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 解析器 ： 执行计划&nbsp; 数据库执行sql的一种方式&nbsp;

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 优化器 ： 知道基本规则，直接影响将来选择哪个执行计划

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 查询缓存 ： 生产环境中，一般会用redis memcached 来代替

<span style="background-color: #00ff00;"><strong>逻辑结构</strong></span>

&nbsp;_&nbsp;__库&nbsp;&nbsp;_ &nbsp;就是一个目录，为了存放多张表

&nbsp;_&nbsp;__表&nbsp;&nbsp;_ &nbsp;在相应的库中，用多个文件来表示

_&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_ &nbsp; myisam表 3个文件：（.myd数据文件&nbsp; .myi索引文件 frm表 结构定义文件）

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; innodb：&nbsp; 2个或者一个，共享表空间（ibdata1 基表 元数据）、独立表空间(5.6以后默认的表存储方式)

<span style="background-color: #00ff00;"><strong>如何使用磁盘</strong></span>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1、多个库多个目录，目录下存放了多个表的存储文件

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2、&nbsp; auto.cnf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; db02.err&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; db02.pid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ibdata1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ib\_logfile0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ib\_logfile1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 等

## <span id="23_MySQL">2.3 MySQL管理</span>

### <span id="231_mysql">2.3.1 连接管理：mysql</span>

<div>
  <div class="cnblogs_code">
    <pre>[root@db02 ~]# mysql --<span style="color: #000000;">help
</span>-u &lt;user_name> 或 --host=&lt;user_name>
-p&lt;password>
-h &lt;host_name> 或 --host=&lt;host_name>
--protocol=&lt;protocol_name> 
-P &lt;port_number> 或 --port=&lt;port_number> 
-S &lt;socket_name> 或 --socket=&lt;socket_name></pre>
  </div>
</div>

**常用的连接方式：**

<div>
  <div class="cnblogs_code">
    <pre>套接字：  mysql -uroot -p123  -S /application/mysql/tmp/<span style="color: #000000;">mysql.sock
Tcp</span>/Ip： mysql -uroot -p123 -h <span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.52</span> -P <span style="color: #800080;">3306</span></pre>
  </div>
</div>

### <span id="232">2.3.2 数据库的启动流程</span>

<p align="center">
  &nbsp;<img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171214173016498-1014362978.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="数据库介绍（MySQL安装 体系结构、基本管理）" alt="" />
</p>

　　mysqld 文件属性

<div>
  <div class="cnblogs_code">
    <pre>[root@db02 ~]# cd /application/mysql/bin/<span style="color: #000000;">
[root@db02 bin]# </span><span style="color: #0000ff;">file</span><span style="color: #000000;"> mysqld
mysqld: ELF </span><span style="color: #800080;">64</span>-bit LSB executable, x86-<span style="color: #800080;">64</span>, version <span style="color: #800080;">1</span> (SYSV), dynamically linked (uses shared libs), <span style="color: #0000ff;">for</span> GNU/Linux <span style="color: #800080;">2.6</span>.<span style="color: #800080;">18</span>, not stripped</pre>
  </div>
</div>

mysql.server文件属性

<div>
  <div class="cnblogs_code">
    <pre>[root@db02 bin]# <span style="color: #0000ff;">file</span> ../support-files/<span style="color: #000000;">mysql.server 
..</span>/support-files/mysql.server: POSIX shell script text executable</pre>
  </div>
</div>

mysqld_safe文件属性

<div>
  <div class="cnblogs_code">
    <pre>[root@db02 data]# <span style="color: #0000ff;">file</span> /application/mysql/bin/<span style="color: #000000;">mysqld_safe 
</span>/application/mysql/bin/mysqld_safe: POSIX shell script text executable</pre>
  </div>
  
  <p>
    <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171214173108201-1164662592.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="数据库介绍（MySQL安装 体系结构、基本管理）" alt="" />
  </p>
</div>

<p align="center">
  可以看出mysql.server文件与mysqld_safe文件都是脚本文件，最后都调用mysqld二进制文件进行启动。
</p>

### <span id="233_mysql">2.3.3 mysql的关闭方法</span>

　　推荐使用的方法:

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #800080;">1</span>、mysqladmin -uroot -<span style="color: #000000;">p123 shutdown
</span><span style="color: #800080;">2</span>、servive mysqld stop</pre>
  </div>
  
  <p>
    　　尽量避免使用kill命令
  </p>
</div>

　　　　mysqladmin命令关闭mysql

<div>
  <div class="cnblogs_code">
    <pre>[root@db02 bin]# mysqladmin shutdown -uroot -<span style="color: #000000;">p123
Warning: Using a password on the command line interface can be insecure.</span></pre>
  </div>
  
  <p>
    　　<strong>perror</strong><strong>命令</strong>
  </p>
</div>

<div>
  <div class="cnblogs_code">
    <pre>[root@db02 bin]# perror <span style="color: #800080;">13</span><span style="color: #000000;">
OS error code  </span><span style="color: #800080;">13</span>:  Permission denied</pre>
  </div>
</div>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; perror命令是mysql自带命令，能够查询mysql错误代码的含义。

### <span id="234_mycnf">2.3.4 my.cnf 配置文件说明</span>

<span style="background-color: #00ff00;"><strong>功能 </strong><strong>：</strong></span>

　　　　1、影响到服务器进程的启动

　　　　2、影响到客户端程序

<span style="background-color: #00ff00;"><strong>配置my.cnf</strong></span>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 使用不同的"标签"去明确指定影响哪部分功能

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 服务器端

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #000000;">[server]
    [mysqld] </span>-----><span style="color: #000000;"> 一般设置此项
    [mysqld_safe]
[client]     </span>----><span style="color: #000000;"> 为了方便设置此项
    [mysql] 
    [mysqladmin]
    [mysqldump]</span></pre>
  </div>
  
  <p>
    　　my.cnf文件配置实例
  </p>
</div>

<div>
  <div class="cnblogs_code">
    <pre>[root@db02 data]# <span style="color: #0000ff;">cat</span> /etc/<span style="color: #000000;">my.cnf
[mysqld]
basedir</span>=/application/<span style="color: #000000;">mysql
datadir</span>=/application/mysql/<span style="color: #000000;">data
socket</span>=/tmp/<span style="color: #000000;">mysql.sock
log</span>-error=/var/log/<span style="color: #000000;">mysql.log
port</span>=<span style="color: #800080;">3307</span><span style="color: #000000;">
[mysql]
socket</span>=/tmp/<span style="color: #000000;">mysql.sock
user</span>=<span style="color: #000000;">root
password</span>=<span style="color: #800080;">123</span></pre>
  </div>
</div>

检查进程信息，可以看到与my.cnf配置的相同

<div>
  <div class="cnblogs_code">
    <pre>[root@db02 data]# <span style="color: #0000ff;">ps</span> -ef |<span style="color: #0000ff;">grep</span><span style="color: #000000;"> [my]sql 
root       </span><span style="color: #800080;">3411</span>   <span style="color: #800080;">1918</span>  <span style="color: #800080;"></span> <span style="color: #800080;">15</span>:<span style="color: #800080;">52</span> pts/<span style="color: #800080;">1</span>    <span style="color: #800080;">00</span>:<span style="color: #800080;">00</span>:<span style="color: #800080;">00</span> /bin/<span style="color: #0000ff;">sh</span> /application/mysql/bin/<span style="color: #000000;">mysqld_safe
mysql      </span><span style="color: #800080;">3548</span>   <span style="color: #800080;">3411</span>  <span style="color: #800080;"></span> <span style="color: #800080;">15</span>:<span style="color: #800080;">52</span> pts/<span style="color: #800080;">1</span>    <span style="color: #800080;">00</span>:<span style="color: #800080;">00</span>:<span style="color: #800080;">00</span> /application/mysql/bin/mysqld --basedir=/application/mysql --datadir=/application/mysql/data --plugin-<span style="color: #0000ff;">dir</span>=/application/mysql/lib/plugin --user=mysql --log-error=/var/log/mysql.log --pid-<span style="color: #0000ff;">file</span>=/application/mysql/data/db02.pid --socket=/tmp/mysql.sock --port=<span style="color: #800080;">3307</span></pre>
  </div>
</div>

my.cnf文件的配置

<p align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171214173301842-1876875375.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="数据库介绍（MySQL安装 体系结构、基本管理）" alt="" />&nbsp;
</p>

### <span id="235">2.3.5 配置文件的读取过程</span>

<div>
  <div class="cnblogs_code">
    <pre>/etc/my.cnf --> /etc/mysql/my.cnf --> $MYSQL_HOME/my.cnf --> defaults-extra-<span style="color: #0000ff;">file</span>=/tmp/clsn.txt --> ~/.my.cnf</pre>
  </div>
  
  <p>
    　　注：假设4个配置文件都存在，同时使用<span style="background-color: #00ff00;">--defaults-extra-file</span>指定了参数文件，如果这时有一个 "参数变量"在5个配置文件中都出现了，那么后面的配置文件中的参数变量值会覆盖前面配置文件中的参数变量值，就是说会使用 ~/.my.cnf 中设置的值
  </p>
</div>

　　如果使用./bin/mysqld_safe 守护进程启动mysql数据库时，使用了 --defaults-file=<配置文件的绝对路径>参数，这时只会使用这个参数指定的配置文件。

## <span id="24_mysql">2.4 mysql多实例配置</span>

### <span id="241_MySQL">2.4.1 什么是MySQL多实例？</span>

<p align="center">
  &nbsp;<img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171214173336592-815842154.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="数据库介绍（MySQL安装 体系结构、基本管理）" alt="" />
</p>

　　简单地说，MySQL多实例就是在一台服务器上同时开启多个不同的服务端口（如：3306/3307）同时运行多个MySQL服务进程，这些服务进程通过不同的socket监听不同的服务端口来提供服务。

　　这些MySQL多实例共用一套MySQL安装程序，使用不同的my.cnf（也可以相同）配置文件、启动程序（也可以相同）和数据文件。在提供服务时，多实例MySQL在逻辑上看来是各自独立的，他们根据配置文件对应设定值，获得服务器响应数量的资源。

### <span id="242_MySQL">2.4.2 MySQL多实例的作用与问题</span>

<span style="background-color: #00ff00;"><strong>有效利用服务器资源 </strong></span>

　　当单个服务器资源有剩余时，可以充分利用剩余的资源提供更多的服务，且可以实现资源的逻辑隔离

<span style="background-color: #00ff00;"><strong>节约服务器资源 </strong></span>

　　当公司资金紧张，但是数据库又需要各自尽量独立地提供服务，而且，需要主从复制等技术时，多实例就再好不过了

　　MySQL多实例有它的好处，但也有弊端，比如，会存在资源互相抢占的问题。当某个数据库实例并发很高或者有SQL慢查询时，整个实例会消耗大量的系统CPU、磁盘I/O等资源，导致服务器上的其他数据库实例提供服务的质量一起下降。

### <span id="243">2.4.3 多实例配置思路</span>

<div class="cnblogs_code">
  <pre><span style="color: #008080;">1</span> <span style="color: #000000;">    多套配置文件
</span><span style="color: #008080;">2</span> <span style="color: #000000;">    多套 数据
</span><span style="color: #008080;">3</span> <span style="color: #000000;">    多个socket
</span><span style="color: #008080;">4</span> <span style="color: #000000;">    多个端口
</span><span style="color: #008080;">5</span> <span style="color: #000000;">    多个日志文件
</span><span style="color: #008080;">6</span>     多个启动程序</pre>
</div>

### <span id="244">2.4.4 多实例配置过程</span>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 前期mysql的安装与1.4MySQL的安装一致，在这里就不再重复（配置完成不要启动）

<span style="background-color: #00ff00;"><strong>第一个里程碑：多实例配置文件准备</strong></span>

<div>
  <div class="cnblogs_code">
    <pre>[root@db02 /]# tree /data/
/data/<span style="color: #000000;">
├── </span><span style="color: #800080;">3306</span><span style="color: #000000;">
│   ├── my.cnf
│   └── mysql
└── </span><span style="color: #800080;">3307</span><span style="color: #000000;">
    ├── my.cnf
    └── mysql</span></pre>
  </div>
</div>

3306端口my.cnf配置文件

<div>
  <div class="cnblogs_code">
    <pre>[root@db02 /]# <span style="color: #0000ff;">cat</span> data/<span style="color: #800080;">3306</span>/<span style="color: #000000;">my.cnf 
[client]
port            </span>= <span style="color: #800080;">3306</span><span style="color: #000000;">
socket          </span>= /data/<span style="color: #800080;">3306</span>/<span style="color: #000000;">mysql.sock

[mysqld]
user    </span>=<span style="color: #000000;"> mysql
port    </span>= <span style="color: #800080;">3306</span><span style="color: #000000;">
socket  </span>= /data/<span style="color: #800080;">3306</span>/<span style="color: #000000;">mysql.sock
basedir </span>= /application/<span style="color: #000000;">mysql
datadir </span>= /data/<span style="color: #800080;">3306</span>/<span style="color: #000000;">data
log</span>-bin = /data/<span style="color: #800080;">3306</span>/mysql-<span style="color: #000000;">bin
server</span>-<span style="color: #0000ff;">id</span> = <span style="color: #800080;">6</span><span style="color: #000000;">

[mysqld_safe]
log</span>-error=/data/<span style="color: #800080;">3306</span>/<span style="color: #000000;">mysql_3306.err
pid</span>-<span style="color: #0000ff;">file</span>=/data/<span style="color: #800080;">3306</span>/mysqld.pid</pre>
  </div>
</div>

3307端口my.cnf配置文件

<div>
  <div class="cnblogs_code">
    <pre>[root@db02 /]# <span style="color: #0000ff;">cat</span>  /data/<span style="color: #800080;">3307</span>/<span style="color: #000000;">my.cnf 
[client]
port            </span>= <span style="color: #800080;">3307</span><span style="color: #000000;">
socket          </span>= /data/<span style="color: #800080;">3307</span>/<span style="color: #000000;">mysql.sock

[mysqld]
user    </span>=<span style="color: #000000;"> mysql
port    </span>= <span style="color: #800080;">3307</span><span style="color: #000000;">
socket  </span>= /data/<span style="color: #800080;">3307</span>/<span style="color: #000000;">mysql.sock
basedir </span>= /application/<span style="color: #000000;">mysql
datadir </span>= /data/<span style="color: #800080;">3307</span>/<span style="color: #000000;">data
log</span>-bin = /data/<span style="color: #800080;">3307</span>/mysql-<span style="color: #000000;">bin
server</span>-<span style="color: #0000ff;">id</span> = <span style="color: #800080;">7</span><span style="color: #000000;">

[mysqld_safe]
log</span>-error=/data/<span style="color: #800080;">3307</span>/<span style="color: #000000;">mysql_3307.err
pid</span>-<span style="color: #0000ff;">file</span>=/data/<span style="color: #800080;">3307</span>/mysqld.pid</pre>
  </div>
</div>

编写管理脚本3306

<div>
  <div class="cnblogs_code" onclick="cnblogs_code_show('40256223-4c27-4ef9-adab-eda304eb594f')">
    <img id="code_img_closed_40256223-4c27-4ef9-adab-eda304eb594f" class="code_img_closed" src="https://clsn.io/wp-content/uploads/2018/03/ContractedBlock-8.gif" alt="数据库介绍（MySQL安装 体系结构、基本管理）" alt="" /><img id="code_img_opened_40256223-4c27-4ef9-adab-eda304eb594f" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('40256223-4c27-4ef9-adab-eda304eb594f',event)" data-original="https://clsn.io/wp-content/uploads/2018/03/ExpandedBlockStart-8.gif" src="/wp-content/themes/clsn-003/img/blank.gif" alt="数据库介绍（MySQL安装 体系结构、基本管理）" alt="" /></p> 
    
    <div id="cnblogs_code_open_40256223-4c27-4ef9-adab-eda304eb594f" class="cnblogs_code_hide">
      <pre><span style="color: #008080;"> 1</span> [root@db02 /]# <span style="color: #0000ff;">cat</span> data/<span style="color: #800080;">3306</span>/<span style="color: #000000;">mysql 
</span><span style="color: #008080;"> 2</span> #!/bin/<span style="color: #0000ff;">sh</span>
<span style="color: #008080;"> 3</span> #<span style="color: #800080;">3306</span><span style="color: #000000;"> start scripts
</span><span style="color: #008080;"> 4</span> <span style="color: #000000;">#init
</span><span style="color: #008080;"> 5</span> port=<span style="color: #800080;">3306</span>
<span style="color: #008080;"> 6</span> mysql_user=<span style="color: #800000;">"</span><span style="color: #800000;">root</span><span style="color: #800000;">"</span>
<span style="color: #008080;"> 7</span> CmdPath=<span style="color: #800000;">"</span><span style="color: #800000;">/application/mysql/bin</span><span style="color: #800000;">"</span>
<span style="color: #008080;"> 8</span> mysql_sock=<span style="color: #800000;">"</span><span style="color: #800000;">/data/${port}/mysql.sock</span><span style="color: #800000;">"</span>
<span style="color: #008080;"> 9</span> mysqld_pid_file_path=/data/<span style="color: #800080;">3306</span>/<span style="color: #800080;">3306</span><span style="color: #000000;">.pid
</span><span style="color: #008080;">10</span> <span style="color: #000000;">start(){
</span><span style="color: #008080;">11</span>     <span style="color: #0000ff;">if</span> [ ! -e <span style="color: #800000;">"</span><span style="color: #800000;">$mysql_sock</span><span style="color: #800000;">"</span> ];<span style="color: #0000ff;">then</span>
<span style="color: #008080;">12</span>          printf <span style="color: #800000;">"</span><span style="color: #800000;">Starting MySQL...\n</span><span style="color: #800000;">"</span>
<span style="color: #008080;">13</span>         /bin/<span style="color: #0000ff;">sh</span> ${CmdPath}/mysqld_safe --defaults-<span style="color: #0000ff;">file</span>=/data/${port}/my.cnf --pid-<span style="color: #0000ff;">file</span>=$mysqld_pid_file_path <span style="color: #800080;">2</span>>&<span style="color: #800080;">1</span> > /dev/<span style="color: #0000ff;">null</span> &
<span style="color: #008080;">14</span>         <span style="color: #0000ff;">sleep</span> <span style="color: #800080;">3</span>
<span style="color: #008080;">15</span>     <span style="color: #0000ff;">else</span>
<span style="color: #008080;">16</span>         printf <span style="color: #800000;">"</span><span style="color: #800000;">MySQL is running...\n</span><span style="color: #800000;">"</span>
<span style="color: #008080;">17</span>         exit <span style="color: #800080;">1</span>
<span style="color: #008080;">18</span>     <span style="color: #0000ff;">fi</span>
<span style="color: #008080;">19</span> <span style="color: #000000;">}
</span><span style="color: #008080;">20</span> <span style="color: #000000;">stop(){
</span><span style="color: #008080;">21</span>     <span style="color: #0000ff;">if</span> [ ! -e <span style="color: #800000;">"</span><span style="color: #800000;">$mysql_sock</span><span style="color: #800000;">"</span> ];<span style="color: #0000ff;">then</span>
<span style="color: #008080;">22</span>         printf <span style="color: #800000;">"</span><span style="color: #800000;">MySQL is stopped...\n</span><span style="color: #800000;">"</span>
<span style="color: #008080;">23</span>         exit <span style="color: #800080;">1</span>
<span style="color: #008080;">24</span>     <span style="color: #0000ff;">else</span>
<span style="color: #008080;">25</span>         printf <span style="color: #800000;">"</span><span style="color: #800000;">Stoping MySQL...\n</span><span style="color: #800000;">"</span>
<span style="color: #008080;">26</span>         mysqld_pid=`<span style="color: #0000ff;">cat</span> <span style="color: #800000;">"</span><span style="color: #800000;">$mysqld_pid_file_path</span><span style="color: #800000;">"</span><span style="color: #000000;">`
</span><span style="color: #008080;">27</span>          <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">kill</span> -<span style="color: #800080;"></span> $mysqld_pid <span style="color: #800080;">2</span>>/dev/<span style="color: #0000ff;">null</span><span style="color: #000000;">)
</span><span style="color: #008080;">28</span>            <span style="color: #0000ff;">then</span>
<span style="color: #008080;">29</span>              <span style="color: #0000ff;">kill</span><span style="color: #000000;"> $mysqld_pid
</span><span style="color: #008080;">30</span>              <span style="color: #0000ff;">sleep</span> <span style="color: #800080;">2</span>
<span style="color: #008080;">31</span>          <span style="color: #0000ff;">fi</span>
<span style="color: #008080;">32</span>     <span style="color: #0000ff;">fi</span>
<span style="color: #008080;">33</span> <span style="color: #000000;">}
</span><span style="color: #008080;">34</span> 
<span style="color: #008080;">35</span> <span style="color: #000000;">restart(){
</span><span style="color: #008080;">36</span>     printf <span style="color: #800000;">"</span><span style="color: #800000;">Restarting MySQL...\n</span><span style="color: #800000;">"</span>
<span style="color: #008080;">37</span> <span style="color: #000000;">    stop
</span><span style="color: #008080;">38</span>     <span style="color: #0000ff;">sleep</span> <span style="color: #800080;">2</span>
<span style="color: #008080;">39</span> <span style="color: #000000;">    start
</span><span style="color: #008080;">40</span> <span style="color: #000000;">}
</span><span style="color: #008080;">41</span> 
<span style="color: #008080;">42</span> <span style="color: #0000ff;">case</span> <span style="color: #800000;">"</span><span style="color: #800000;">$1</span><span style="color: #800000;">"</span> <span style="color: #0000ff;">in</span>
<span style="color: #008080;">43</span> <span style="color: #000000;">    start)
</span><span style="color: #008080;">44</span> <span style="color: #000000;">        start
</span><span style="color: #008080;">45</span> <span style="color: #000000;">    ;;
</span><span style="color: #008080;">46</span> <span style="color: #000000;">    stop)
</span><span style="color: #008080;">47</span> <span style="color: #000000;">        stop
</span><span style="color: #008080;">48</span> <span style="color: #000000;">    ;;
</span><span style="color: #008080;">49</span> <span style="color: #000000;">    restart)
</span><span style="color: #008080;">50</span> <span style="color: #000000;">        restart
</span><span style="color: #008080;">51</span> <span style="color: #000000;">    ;;
</span><span style="color: #008080;">52</span>     *<span style="color: #000000;">)
</span><span style="color: #008080;">53</span>         printf <span style="color: #800000;">"</span><span style="color: #800000;">Usage: /data/${port}/mysql {start|stop|restart}\n</span><span style="color: #800000;">"</span>
<span style="color: #008080;">54</span> <span style="color: #0000ff;">esac</span></pre>
    </div>
    
    <p>
      <span class="cnblogs_code_collapse">View Code mysql 多实例 启动脚本</span></div> </div> 
      
      <p>
        编写管理脚本3307
      </p>
      
      <div>
        <div class="cnblogs_code" onclick="cnblogs_code_show('3bf8e017-7e17-482e-9a18-8ed441f03791')">
          <img id="code_img_closed_3bf8e017-7e17-482e-9a18-8ed441f03791" class="code_img_closed" src="https://clsn.io/wp-content/uploads/2018/03/ContractedBlock-8.gif" alt="数据库介绍（MySQL安装 体系结构、基本管理）" alt="" /><img id="code_img_opened_3bf8e017-7e17-482e-9a18-8ed441f03791" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('3bf8e017-7e17-482e-9a18-8ed441f03791',event)" data-original="https://clsn.io/wp-content/uploads/2018/03/ExpandedBlockStart-8.gif" src="/wp-content/themes/clsn-003/img/blank.gif" alt="数据库介绍（MySQL安装 体系结构、基本管理）" alt="" /></p> 
          
          <div id="cnblogs_code_open_3bf8e017-7e17-482e-9a18-8ed441f03791" class="cnblogs_code_hide">
            <pre><span style="color: #008080;"> 1</span> [root@db02 /]# <span style="color: #0000ff;">cat</span> data/<span style="color: #800080;">3307</span>/<span style="color: #000000;">mysql 
</span><span style="color: #008080;"> 2</span> #!/bin/<span style="color: #0000ff;">sh</span>
<span style="color: #008080;"> 3</span> #<span style="color: #800080;">3307</span><span style="color: #000000;"> start scripts
</span><span style="color: #008080;"> 4</span> <span style="color: #000000;">#init
</span><span style="color: #008080;"> 5</span> port=<span style="color: #800080;">3307</span>
<span style="color: #008080;"> 6</span> mysql_user=<span style="color: #800000;">"</span><span style="color: #800000;">root</span><span style="color: #800000;">"</span>
<span style="color: #008080;"> 7</span> CmdPath=<span style="color: #800000;">"</span><span style="color: #800000;">/application/mysql/bin</span><span style="color: #800000;">"</span>
<span style="color: #008080;"> 8</span> mysql_sock=<span style="color: #800000;">"</span><span style="color: #800000;">/data/${port}/mysql.sock</span><span style="color: #800000;">"</span>
<span style="color: #008080;"> 9</span> mysqld_pid_file_path=/data/<span style="color: #800080;">3307</span>/<span style="color: #800080;">3307</span><span style="color: #000000;">.pid
</span><span style="color: #008080;">10</span> <span style="color: #000000;">start(){
</span><span style="color: #008080;">11</span>     <span style="color: #0000ff;">if</span> [ ! -e <span style="color: #800000;">"</span><span style="color: #800000;">$mysql_sock</span><span style="color: #800000;">"</span> ];<span style="color: #0000ff;">then</span>
<span style="color: #008080;">12</span>          printf <span style="color: #800000;">"</span><span style="color: #800000;">Starting MySQL...\n</span><span style="color: #800000;">"</span>
<span style="color: #008080;">13</span>         /bin/<span style="color: #0000ff;">sh</span> ${CmdPath}/mysqld_safe --defaults-<span style="color: #0000ff;">file</span>=/data/${port}/my.cnf --pid-<span style="color: #0000ff;">file</span>=$mysqld_pid_file_path <span style="color: #800080;">2</span>>&<span style="color: #800080;">1</span> > /dev/<span style="color: #0000ff;">null</span> &
<span style="color: #008080;">14</span>         <span style="color: #0000ff;">sleep</span> <span style="color: #800080;">3</span>
<span style="color: #008080;">15</span>     <span style="color: #0000ff;">else</span>
<span style="color: #008080;">16</span>         printf <span style="color: #800000;">"</span><span style="color: #800000;">MySQL is running...\n</span><span style="color: #800000;">"</span>
<span style="color: #008080;">17</span>         exit <span style="color: #800080;">1</span>
<span style="color: #008080;">18</span>     <span style="color: #0000ff;">fi</span>
<span style="color: #008080;">19</span> <span style="color: #000000;">}
</span><span style="color: #008080;">20</span> <span style="color: #000000;">stop(){
</span><span style="color: #008080;">21</span>     <span style="color: #0000ff;">if</span> [ ! -e <span style="color: #800000;">"</span><span style="color: #800000;">$mysql_sock</span><span style="color: #800000;">"</span> ];<span style="color: #0000ff;">then</span>
<span style="color: #008080;">22</span>         printf <span style="color: #800000;">"</span><span style="color: #800000;">MySQL is stopped...\n</span><span style="color: #800000;">"</span>
<span style="color: #008080;">23</span>         exit <span style="color: #800080;">1</span>
<span style="color: #008080;">24</span>     <span style="color: #0000ff;">else</span>
<span style="color: #008080;">25</span>         printf <span style="color: #800000;">"</span><span style="color: #800000;">Stoping MySQL...\n</span><span style="color: #800000;">"</span>
<span style="color: #008080;">26</span>         mysqld_pid=`<span style="color: #0000ff;">cat</span> <span style="color: #800000;">"</span><span style="color: #800000;">$mysqld_pid_file_path</span><span style="color: #800000;">"</span><span style="color: #000000;">`
</span><span style="color: #008080;">27</span>          <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">kill</span> -<span style="color: #800080;"></span> $mysqld_pid <span style="color: #800080;">2</span>>/dev/<span style="color: #0000ff;">null</span><span style="color: #000000;">)
</span><span style="color: #008080;">28</span>            <span style="color: #0000ff;">then</span>
<span style="color: #008080;">29</span>              <span style="color: #0000ff;">kill</span><span style="color: #000000;"> $mysqld_pid
</span><span style="color: #008080;">30</span>              <span style="color: #0000ff;">sleep</span> <span style="color: #800080;">2</span>
<span style="color: #008080;">31</span>          <span style="color: #0000ff;">fi</span>
<span style="color: #008080;">32</span>     <span style="color: #0000ff;">fi</span>
<span style="color: #008080;">33</span> <span style="color: #000000;">}
</span><span style="color: #008080;">34</span> 
<span style="color: #008080;">35</span> <span style="color: #000000;">restart(){
</span><span style="color: #008080;">36</span>     printf <span style="color: #800000;">"</span><span style="color: #800000;">Restarting MySQL...\n</span><span style="color: #800000;">"</span>
<span style="color: #008080;">37</span> <span style="color: #000000;">    stop
</span><span style="color: #008080;">38</span>     <span style="color: #0000ff;">sleep</span> <span style="color: #800080;">2</span>
<span style="color: #008080;">39</span> <span style="color: #000000;">    start
</span><span style="color: #008080;">40</span> <span style="color: #000000;">}
</span><span style="color: #008080;">41</span> 
<span style="color: #008080;">42</span> <span style="color: #0000ff;">case</span> <span style="color: #800000;">"</span><span style="color: #800000;">$1</span><span style="color: #800000;">"</span> <span style="color: #0000ff;">in</span>
<span style="color: #008080;">43</span> <span style="color: #000000;">    start)
</span><span style="color: #008080;">44</span> <span style="color: #000000;">        start
</span><span style="color: #008080;">45</span> <span style="color: #000000;">    ;;
</span><span style="color: #008080;">46</span> <span style="color: #000000;">    stop)
</span><span style="color: #008080;">47</span> <span style="color: #000000;">        stop
</span><span style="color: #008080;">48</span> <span style="color: #000000;">    ;;
</span><span style="color: #008080;">49</span> <span style="color: #000000;">    restart)
</span><span style="color: #008080;">50</span> <span style="color: #000000;">        restart
</span><span style="color: #008080;">51</span> <span style="color: #000000;">    ;;
</span><span style="color: #008080;">52</span>     *<span style="color: #000000;">)
</span><span style="color: #008080;">53</span>         printf <span style="color: #800000;">"</span><span style="color: #800000;">Usage: /data/${port}/mysql {start|stop|restart}\n</span><span style="color: #800000;">"</span>
<span style="color: #008080;">54</span> <span style="color: #0000ff;">esac</span></pre>
          </div>
          
          <p>
            <span class="cnblogs_code_collapse">View Code mysql 多实例 启动脚本</span></div> 
            
            <p class="ad">
              　　<span style="color: #ff0000;">注意脚本要给继续权限才能够正常使用</span>
            </p></div> 
            
            <p>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 第二个里程碑：创建数据目录并授权
            </p>
            
            <div>
              <div class="cnblogs_code">
                <pre>[root@db02 /]# <span style="color: #0000ff;">mkdir</span> /data/{<span style="color: #800080;">3306</span>,<span style="color: #800080;">3307</span>}/data -<span style="color: #000000;">p
[root@db02 </span>/]# <span style="color: #0000ff;">chown</span> -R mysql.mysql /data/</pre>
              </div>
            </div>
            
            <p>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 第三个里程碑：初始化数据
            </p>
            
            <div>
              <div class="cnblogs_code">
                <pre>cd /application/mysql/scripts  &&<span style="color: #000000;"> \
.</span>/mysql_install_db  --defaults-<span style="color: #0000ff;">file</span>=/data/<span style="color: #800080;">3306</span>/my.cnf --basedir=/application/mysql --datadir=/data/<span style="color: #800080;">3306</span>/data --user=<span style="color: #000000;">mysql
.</span>/mysql_install_db  --defaults-<span style="color: #0000ff;">file</span>=/data/<span style="color: #800080;">3307</span>/my.cnf --basedir=/application/mysql --datadir=/data/<span style="color: #800080;">3307</span>/data --user=mysql</pre>
              </div>
            </div>
            
            <p>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 第四个里程碑：创建日志文件
            </p>
            
            <div>
              <p class="ad">
                　　　　#5.6.36特殊性：需要创建错误日志文件
              </p>
              
              <div class="cnblogs_code">
                <pre><span style="color: #0000ff;">touch</span> /data/<span style="color: #800080;">3306</span>/<span style="color: #000000;">mysql_3306.err
</span><span style="color: #0000ff;">touch</span> /data/<span style="color: #800080;">3307</span>/mysql_3307.err</pre>
              </div>
            </div>
            
            <p>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 第五个里程碑：启动多实例
            </p>
            
            <div>
              <div class="cnblogs_code">
                <pre>[root@db02 scripts]# /data/<span style="color: #800080;">3306</span>/<span style="color: #000000;">mysql start
Starting MySQL...
[root@db02 scripts]# </span>/data/<span style="color: #800080;">3307</span>/<span style="color: #000000;">mysql start
Starting MySQL...</span></pre>
              </div>
            </div>
            
            <p>
              检查mysql状态
            </p>
            
            <div>
              <div class="cnblogs_code">
                <pre>[root@db02 scripts]# <span style="color: #0000ff;">ps</span> -ef |<span style="color: #0000ff;">grep</span><span style="color: #000000;"> [my]sql 
root       </span><span style="color: #800080;">4341</span>      <span style="color: #800080;">1</span>  <span style="color: #800080;"></span> <span style="color: #800080;">16</span>:<span style="color: #800080;">46</span> pts/<span style="color: #800080;">1</span>    <span style="color: #800080;">00</span>:<span style="color: #800080;">00</span>:<span style="color: #800080;">00</span> /bin/<span style="color: #0000ff;">sh</span> /application/mysql/bin/mysqld_safe --defaults-<span style="color: #0000ff;">file</span>=/data/<span style="color: #800080;">3306</span>/my.cnf --pid-<span style="color: #0000ff;">file</span>=/data/<span style="color: #800080;">3306</span>/<span style="color: #800080;">3306</span><span style="color: #000000;">.pid
mysql      </span><span style="color: #800080;">4526</span>   <span style="color: #800080;">4341</span> <span style="color: #800080;">13</span> <span style="color: #800080;">16</span>:<span style="color: #800080;">46</span> pts/<span style="color: #800080;">1</span>    <span style="color: #800080;">00</span>:<span style="color: #800080;">00</span>:<span style="color: #800080;">03</span> /application/mysql/bin/mysqld --defaults-<span style="color: #0000ff;">file</span>=/data/<span style="color: #800080;">3306</span>/my.cnf --basedir=/application/mysql --datadir=/data/<span style="color: #800080;">3306</span>/data --plugin-<span style="color: #0000ff;">dir</span>=/application/mysql/lib/plugin --user=mysql --log-error=/data/<span style="color: #800080;">3306</span>/mysql_3306.err --pid-<span style="color: #0000ff;">file</span>=/data/<span style="color: #800080;">3306</span>/<span style="color: #800080;">3306</span>.pid --socket=/data/<span style="color: #800080;">3306</span>/mysql.sock --port=<span style="color: #800080;">3306</span><span style="color: #000000;">
root       </span><span style="color: #800080;">4549</span>      <span style="color: #800080;">1</span>  <span style="color: #800080;"></span> <span style="color: #800080;">16</span>:<span style="color: #800080;">46</span> pts/<span style="color: #800080;">1</span>    <span style="color: #800080;">00</span>:<span style="color: #800080;">00</span>:<span style="color: #800080;">00</span> /bin/<span style="color: #0000ff;">sh</span> /application/mysql/bin/mysqld_safe --defaults-<span style="color: #0000ff;">file</span>=/data/<span style="color: #800080;">3307</span>/my.cnf --pid-<span style="color: #0000ff;">file</span>=/data/<span style="color: #800080;">3307</span>/<span style="color: #800080;">3307</span><span style="color: #000000;">.pid
mysql      </span><span style="color: #800080;">4734</span>   <span style="color: #800080;">4549</span> <span style="color: #800080;">51</span> <span style="color: #800080;">16</span>:<span style="color: #800080;">46</span> pts/<span style="color: #800080;">1</span>    <span style="color: #800080;">00</span>:<span style="color: #800080;">00</span>:<span style="color: #800080;">08</span> /application/mysql/bin/mysqld --defaults-<span style="color: #0000ff;">file</span>=/data/<span style="color: #800080;">3307</span>/my.cnf --basedir=/application/mysql --datadir=/data/<span style="color: #800080;">3307</span>/data --plugin-<span style="color: #0000ff;">dir</span>=/application/mysql/lib/plugin --user=mysql --log-error=/data/<span style="color: #800080;">3307</span>/mysql_3307.err --pid-<span style="color: #0000ff;">file</span>=/data/<span style="color: #800080;">3307</span>/<span style="color: #800080;">3307</span>.pid --socket=/data/<span style="color: #800080;">3307</span>/mysql.sock --port=<span style="color: #800080;">3307</span></pre>
              </div>
            </div>
            
            <p>
              检查端口信息
            </p>
            
            <div>
              <div class="cnblogs_code">
                <pre>[root@db02 scripts]# netstat  -lntup |<span style="color: #0000ff;">grep</span><span style="color: #000000;"> mysql 
tcp        </span><span style="color: #800080;"></span>      <span style="color: #800080;"></span> :::<span style="color: #800080;">3306</span>                     :::*                        LISTEN      <span style="color: #800080;">4526</span>/<span style="color: #000000;">mysqld         
tcp        </span><span style="color: #800080;"></span>      <span style="color: #800080;"></span> :::<span style="color: #800080;">3307</span>                     :::*                        LISTEN      <span style="color: #800080;">4734</span>/mysqld</pre>
              </div>
              
              <p>
                <span style="background-color: #00ff00;">　　至此mysql的多实例就配置完成&nbsp; &nbsp;&nbsp;</span>
              </p>
            </div>
            
            <h3>
              <span id="245_mysql">2.4.5 多实例mysql的使用</span>
            </h3>
            
            <p>
              本地连接方式
            </p>
            
            <div>
              <div class="cnblogs_code">
                <pre>mysql -S /data/<span style="color: #800080;">3306</span>/<span style="color: #000000;">mysql.sock
mysql </span>-S /data/<span style="color: #800080;">3307</span>/mysql.sock</pre>
              </div>
            </div>
            
            <h3>
              <span id="246_mysql">2.4.6 关于mysql多实例的选择</span>
            </h3>
            
            <div class="cnblogs_code">
              <pre><span style="color: #800080;">1</span><span style="color: #000000;">、资金紧张性公司的选择 
　　资金紧张，公司业务访问量又不大，但又希望不同的业务的数据库服务各自尽量独立 
</span><span style="color: #800080;">2</span><span style="color: #000000;">、并发访问不是特别大的业务 
　　当公司业务访问量不太大的时候，服务器的资源基本都是浪费的，这就适合多实例的使用 
</span><span style="color: #800080;">3</span><span style="color: #000000;">、门户网站应用MySQL多实例场景 
　　配置硬件好的服务器，可以节省IDC机柜空间，跑多实例也不会减少硬件资源不慢的浪费 
　　一般是从库多实例，例如：某部门使用IBM服务器为48核CPU，内存96GB、一台服务器跑3</span>~4个实例：此外，sina网也是用的多实例，内存48GB左右。企业环境中一般将多实例应用在测试环境。</pre>
            </div>
            
            <h2>
              <span id="25_mysql">2.5 mysql忘记密码怎么办？</span>
            </h2>
            
            <p>
              　　第一步：将服务停掉
            </p>
            
            <div>
              <div class="cnblogs_code">
                <pre>/etc/init.d/mysqld stop</pre>
              </div>
              
              <p>
                　　第二步：加参数启动服务
              </p>
            </div>
            
            <div>
              <div class="cnblogs_code">
                <pre>cd /application/mysql/bin/<span style="color: #000000;"> 
mysqld_safe </span>--skip-grant-table --user=mysql --skip-networking &</pre>
              </div>
            </div>
            
            <p>
              　　<span style="background-color: #ffff00;">这种模式下</span><br /> 　　　　无密码登陆<br /> 　　　　网络用户无法登陆<br /> 　　　　只能本地登陆<br /> 　　　　和授权有关的命令都无法执行
            </p>
            
            <p>
              　　第三步：修改密码
            </p>
            
            <div>
              <div class="cnblogs_code">
                <pre>[root@db02 <span style="color: #800080;">3306</span><span style="color: #000000;">]# mysql
mysql</span>> update mysql.user set password=password(<span style="color: #800000;">'</span><span style="color: #800000;">123</span><span style="color: #800000;">'</span>) where user=<span style="color: #800000;">'</span><span style="color: #800000;">root</span><span style="color: #800000;">'</span> and host=<span style="color: #800000;">'</span><span style="color: #800000;">localhost</span><span style="color: #800000;">'</span><span style="color: #000000;">;
mysql</span>> flush privileges;</pre>
              </div>
            </div>
            
            <p>
              　　　<span style="background-color: #ccffff;">　MYSQL5.7 修改密码修改字段&nbsp; authentication_string</span>
            </p>
            
            <p>
              　　第四步：退出重启服务
            </p>
            
            <div>
              <div class="cnblogs_code">
                <pre>/etc/init.d/mysqld restart</pre>
              </div>
            </div>
            
            <p>
              　　第五步：登录验证
            </p>
            
            <div>
              <div class="cnblogs_code">
                <pre>mysql -uroot -p123</pre>
              </div>
            </div>
            
            <p>
              　　至此密码修改成功
            </p>
            
            <h2>
              <span id="26">2.6 参考文献</span>
            </h2>
            
            <div>
              <div class="cnblogs_code">
                <pre>https:<span style="color: #008000;">//</span><span style="color: #008000;">zh.wikipedia.org/wiki/MySQL#%E6%AD%B7%E5%8F%B2  mysql历史</span>
http:<span style="color: #008000;">//</span><span style="color: #008000;">blog.51cto.com/oldboy/1728380   MySQL常见错误代码(error code)及代码说明</span>
https:<span style="color: #008000;">//</span><span style="color: #008000;">www.abcdocker.com/abcdocker/28   MySQL入门介绍</span>
https:<span style="color: #008000;">//</span><span style="color: #008000;">www.abcdocker.com/abcdocker/90   MySQL多实例</span>
http:<span style="color: #008000;">//</span><span style="color: #008000;">oldboy.blog.51cto.com    脚本来源</span></pre>
              </div>
              
              <p>
                &nbsp;
              </p>
            </div>
            
            <p>
              &nbsp;
            </p>
            
            <div id="toc_container" class="toc_white have_bullets">
              <ul class="toc_list">
                <ul>
                  <li>
                    <a href="#11">1.1 数据库简介</a><ul>
                      <li>
                        <a href="#111">1.1.1 什么是数据</a>
                      </li>
                      <li>
                        <a href="#112">1.1.2 数据库管理系统</a>
                      </li>
                      <li>
                        <a href="#113_NoSQL">1.1.3 NoSQL特性总览</a>
                      </li>
                      <li>
                        <a href="#114_NoSQL">1.1.4 NoSQL的分类、特点、典型产品</a>
                      </li>
                    </ul>
                  </li>
                  
                  <li>
                    <a href="#12">1.2 数据库相关产品</a><ul>
                      <li>
                        <a href="#121_Oracle">1.2.1 Oracle公司产品介绍</a>
                      </li>
                      <li>
                        <a href="#122">1.2.2 其他公司产品</a>
                      </li>
                    </ul>
                  </li>
                  
                  <li>
                    <a href="#13_Mysql">1.3 Mysql简介</a><ul>
                      <li>
                        <a href="#131_mysql">1.3.1 mysql数据库发展史</a>
                      </li>
                      <li>
                        <a href="#132_MySQL">1.3.2 MySQL的特点简介</a>
                      </li>
                      <li>
                        <a href="#133_mysql">1.3.3 mysql产品线的介绍</a>
                      </li>
                      <li>
                        <a href="#134_MySQL">1.3.4 企业生产场景选择MySQL数据库建议：</a>
                      </li>
                    </ul>
                  </li>
                  
                  <li>
                    <a href="#14_mysql">1.4 mysql数据库的安装</a><ul>
                      <li>
                        <a href="#141">1.4.1 系统环境说明</a>
                      </li>
                      <li>
                        <a href="#142_mysql">1.4.2 mysql编译安装</a>
                      </li>
                      <li>
                        <a href="#143">1.4.3 数据库安装后的操作</a>
                      </li>
                      <li>
                        <a href="#144">1.4.4 数据库安全设置</a>
                      </li>
                    </ul>
                  </li>
                  
                  <li>
                    <a href="#15_mysql_57">1.5 mysql 5.7版本安装说明</a>
                  </li>
                </ul></li>
                
                <li>
                  <a href="#2_Mysql">第2章 Mysql体系结构与基本管理</a><ul>
                    <li>
                      <a href="#21">2.1 客户端与服务器端模型</a><ul>
                        <li>
                          <a href="#211_mysql">2.1.1 mysql服务结构</a>
                        </li>
                        <li>
                          <a href="#212_mysql">2.1.2 mysql连接方式</a>
                        </li>
                        <li>
                          <a href="#213_MySQL">2.1.3 MySQL在启动过程</a>
                        </li>
                      </ul>
                    </li>
                    
                    <li>
                      <a href="#22_Mysqld">2.2 Mysqld服务的构成</a><ul>
                        <li>
                          <a href="#221">2.2.1 连接层</a>
                        </li>
                        <li>
                          <a href="#222_SQL">2.2.2 SQL层</a>
                        </li>
                        <li>
                          <a href="#223">2.2.3 存储引擎层</a>
                        </li>
                        <li>
                          <a href="#224">2.2.4 依赖于存储引擎的功能</a>
                        </li>
                        <li>
                          <a href="#225_mysql">2.2.5 mysql 的逻辑构成(数据库内部结构)</a>
                        </li>
                        <li>
                          <a href="#226_mysql">2.2.6 mysql的存储方式</a>
                        </li>
                        <li>
                          <a href="#227_MySQL">2.2.7 MySQL体系结构小结</a>
                        </li>
                      </ul>
                    </li>
                    
                    <li>
                      <a href="#23_MySQL">2.3 MySQL管理</a><ul>
                        <li>
                          <a href="#231_mysql">2.3.1 连接管理：mysql</a>
                        </li>
                        <li>
                          <a href="#232">2.3.2 数据库的启动流程</a>
                        </li>
                        <li>
                          <a href="#233_mysql">2.3.3 mysql的关闭方法</a>
                        </li>
                        <li>
                          <a href="#234_mycnf">2.3.4 my.cnf 配置文件说明</a>
                        </li>
                        <li>
                          <a href="#235">2.3.5 配置文件的读取过程</a>
                        </li>
                      </ul>
                    </li>
                    
                    <li>
                      <a href="#24_mysql">2.4 mysql多实例配置</a><ul>
                        <li>
                          <a href="#241_MySQL">2.4.1 什么是MySQL多实例？</a>
                        </li>
                        <li>
                          <a href="#242_MySQL">2.4.2 MySQL多实例的作用与问题</a>
                        </li>
                        <li>
                          <a href="#243">2.4.3 多实例配置思路</a>
                        </li>
                        <li>
                          <a href="#244">2.4.4 多实例配置过程</a>
                        </li>
                        <li>
                          <a href="#245_mysql">2.4.5 多实例mysql的使用</a>
                        </li>
                        <li>
                          <a href="#246_mysql">2.4.6 关于mysql多实例的选择</a>
                        </li>
                      </ul>
                    </li>
                    
                    <li>
                      <a href="#25_mysql">2.5 mysql忘记密码怎么办？</a>
                    </li>
                    <li>
                      <a href="#26">2.6 参考文献</a>
                    </li>
                  </ul>
                </li>
              </ul>
            </div>