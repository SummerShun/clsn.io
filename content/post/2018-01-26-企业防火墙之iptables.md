---
title: 企业防火墙之iptables
author: 惨绿少年
type: post
date: 2018-01-25T21:24:00+00:00
url: /clsn/lx230.html
Baidusubmit:
  - 1
views:
  - 210
zm_like:
  - 2
categories:
  - Linux运维
  - 安全
  - 运维基本功

---
## <span id="11">1.1 <span style="font-family: '微软雅黑',sans-serif;">企业中安全优化配置原则</span></span>

<p style="text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif;">尽可能不给服务器配置外网</span>ip ,<span style="font-family: '微软雅黑',sans-serif;">可以通过代理转发或者通过防火墙映射</span>.<span style="font-family: '微软雅黑',sans-serif;">并发不是特别大情况有外网</span>ip,<span style="font-family: '微软雅黑',sans-serif;">可以开启防火墙服务</span>.
</p>

<p style="text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif;">大并发的情况，不能开</span>iptables,<span style="font-family: '微软雅黑',sans-serif;">影响性能，利用硬件防火墙提升架构安全</span>
</p>

### <span id="111_iptables">1.1.1 <span style="font-family: '微软雅黑',sans-serif;">生产中</span>iptables<span style="font-family: '微软雅黑',sans-serif;">的实际应用</span></span>

<span style="font-family: '微软雅黑',sans-serif; courier new"4courier new";background: yellow;">主要应用方向</span>

<p style="margin-left: 24.0pt;">
  1<span style="font-family: '微软雅黑',sans-serif;">、主机防火墙（</span>filter<span style="font-family: '微软雅黑',sans-serif;">表的</span>INPUT<span style="font-family: '微软雅黑',sans-serif;">链）。</span>
</p>

<p style="margin-left: 24.0pt;">
  2<span style="font-family: '微软雅黑',sans-serif;">、局域网共享上网</span>(nat<span style="font-family: '微软雅黑',sans-serif;">表的</span>POSTROUTING<span style="font-family: '微软雅黑',sans-serif;">链</span>)<span style="font-family: '微软雅黑',sans-serif;">。半个路由器，</span>NAT<span style="font-family: '微软雅黑',sans-serif;">功能。</span>
</p>

<p style="margin-left: 24.0pt;">
  3<span style="font-family: '微软雅黑',sans-serif;">、端口及</span>IP<span style="font-family: '微软雅黑',sans-serif;">映射</span>(nat<span style="font-family: '微软雅黑',sans-serif;">表的</span>PREROUTING<span style="font-family: '微软雅黑',sans-serif;">链</span>)<span style="font-family: '微软雅黑',sans-serif;">，硬防的</span>NAT<span style="font-family: '微软雅黑',sans-serif;">功能。</span>
</p>

<p style="margin-left: 24.0pt;">
  4<span style="font-family: '微软雅黑',sans-serif;">、</span>IP<span style="font-family: '微软雅黑',sans-serif;">一对一映射。</span>
</p>

**_<span style="font-family: '微软雅黑',sans-serif; courier new"4courier new";background: yellow;">其他说明：</span>_**

> &nbsp;①iptables是基于内核的防火墙，功能非常强大，基于数据包的过滤！特别是可以在一台非常低的硬件配置下跑的非常好。
> 
> **_　　注：_**iptables主要工作在OSI七层的2.3.4层。七层的控制可以使用squid代理+iptables。
> 
> ②iptabes：生产中根据具体情况，一般，内网关闭，外网打开。大并发的情况不能开iptables，影响性能，iptables是要消耗CPU的，所以大并发的情况下，我们使用硬件防火墙的各方面做的很仔细。selinux：生产中也是关闭的。可以做ids的入侵检测。
> 
> ③实际生产中尽可能不给服务器配置外网IP。可以通过代理转发。比如，nagios就不需要外网。
> 
> ④并发不是很大的情况下，再外网的IP环境，开防火墙。
> 
> ⑤第一次直接默认规则生成配置文件，以后就在配置文件中进行修改（编辑添加删除）。
> 
> ⑥封掉IP：根据IP地址和网络连接数进行封杀。（定时任务，定时封掉，判断，存在就不再进行二次封杀）

### <span id="112">1.1.2 <span style="font-family: '微软雅黑',sans-serif;">企业常用案例功能小结：</span></span>

<p style="margin-left: 24.0pt;">
  1<span style="font-family: '微软雅黑',sans-serif;">）</span>linux<span style="font-family: '微软雅黑',sans-serif;">主机防火墙，单机作为防火墙（表</span>filter<span style="font-family: '微软雅黑',sans-serif;">）。</span>
</p>

<p style="margin-left: 24.0pt;">
  2<span style="font-family: '微软雅黑',sans-serif;">）局域网共享上网（表</span>nat postrouting<span style="font-family: '微软雅黑',sans-serif;">）。</span>
</p>

<p style="margin-left: 24.0pt;">
  3<span style="font-family: '微软雅黑',sans-serif;">）外部地址映射为内部地址和端口（表</span>nat prerouting<span style="font-family: '微软雅黑',sans-serif;">）</span>
</p>

## <span id="12_iptables">1.2 iptables<span style="font-family: '微软雅黑',sans-serif;">防火墙简介</span></span>

<p style="text-indent: 21.0pt;">
  Netfilter/Iptables(<span style="font-family: '微软雅黑',sans-serif;">以下简称</span>Iptables)<span style="font-family: '微软雅黑',sans-serif;">是</span>unix/linux<span style="font-family: '微软雅黑',sans-serif;">自带的<span style="text-decoration: underline;">一款优秀且开放源代码的完全自由的基于包过滤的防火墙工具</span>，它的功能十分强大，使用非常灵活，可以对流入和流出服务器的数据包进行很精细的控制</span>.<span style="font-family: '微软雅黑',sans-serif;">特别是它可以在一台非常低的硬件配置服务器上跑的非常好（赛扬</span>500HZ cpu 64M <span style="font-family: '微软雅黑',sans-serif;">内存的惲况下部署网关防火墙），提供近</span>400<span style="font-family: '微软雅黑',sans-serif;">人的上网服务丝毫不逊色企业级专业路由器防火墙。</span> iptables + zebra + squid (<span style="font-family: '微软雅黑',sans-serif;">企业常用网络开源产品）。</span>
</p>

&nbsp;&nbsp; iptables<span style="font-family: '微软雅黑',sans-serif;">是</span>linux2.4<span style="font-family: '微软雅黑',sans-serif;">及</span>2.6<span style="font-family: '微软雅黑',sans-serif;">内核中集成的服务，其功能与安全性比其老一蜚</span>ipfwadm<span style="font-family: '微软雅黑',sans-serif;">，</span>ipchains <span style="font-family: '微软雅黑',sans-serif;">强大的多，</span>iptables<span style="font-family: '微软雅黑',sans-serif;">主要工作在</span>0SI<span style="font-family: '微软雅黑',sans-serif;">七层的二、三、四层，如果重新编译内核，</span>iptables<span style="font-family: '微软雅黑',sans-serif;">也可以支持</span> 7 <span style="font-family: '微软雅黑',sans-serif;">层控制（</span>squid<span style="font-family: '微软雅黑',sans-serif;">代理</span>+iptables<span style="font-family: '微软雅黑',sans-serif;">）。</span>

### <span id="121_iptables">1.2.1 iptables<span style="font-family: '微软雅黑',sans-serif;">名词和术语</span></span>

<p style="text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif;">不少刚接触到</span>iptables<span style="font-family: '微软雅黑',sans-serif;">的朋友可能会对</span>iptables<span style="font-family: '微软雅黑',sans-serif;">防火墙的相关名词搞的很晕，不知道其所云的具体意思，而是就最基本的能让大家容易快速理解和掌握的思路来描述：</span>
</p>

<p style="text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif;">容器：包含或者说属于的关系</span>
</p>

### <span id="122">1.2.2 <span style="font-family: '微软雅黑',sans-serif;">什么是容器</span></span>

<p style="text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif;">谁不知道啊，容器就是装东西的，如（箱、包、坛）。没错，恭喜你答对了</span>.<span style="font-family: '微软雅黑',sans-serif;">词典里解释说，容器就是用来包装或装载物品的贮存器（如箱、罐、坛）或者成形或柔软不成形的包覆材料</span>.
</p>

<p style="text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif;">在</span>iptables<span style="font-family: '微软雅黑',sans-serif;">里的呢，就是用来描述这种包含或者说属于的关系。</span>
</p>

### <span id="123_Netfilteriptables">1.2.3 <span style="font-family: '微软雅黑',sans-serif;">什么是</span> Netfilter/iptables ?</span>

<p style="text-indent: 21.0pt;">
  Netfilter<span style="font-family: '微软雅黑',sans-serif;">是表（</span>tables<span style="font-family: '微软雅黑',sans-serif;">）的容器，这样解释大家肯定还是晕。举个例子，如果把</span>Netfilter<span style="font-family: '微软雅黑',sans-serif;">看成是某个小区的一栋楼。那么表（</span>tables)<span style="font-family: '微软雅黑',sans-serif;">就是楼里的其中的一套房子。这套房子</span>"<span style="font-family: '微软雅黑',sans-serif;">表（</span>tables)"<span style="font-family: '微软雅黑',sans-serif;">属于这栋&ldquo;</span>Netfilter<span style="font-family: '微软雅黑',sans-serif;">&rdquo;。</span>
</p>

### <span id="124_tables">1.2.4 <span style="font-family: '微软雅黑',sans-serif;">什么是表（</span>tables<span style="font-family: '微软雅黑',sans-serif;">）？</span></span>

<p style="text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif;">表（</span>tables<span style="font-family: '微软雅黑',sans-serif;">）是链的容器，即所有的链（</span>chains<span style="font-family: '微软雅黑',sans-serif;">）都属于其对应的表（</span>tables<span style="font-family: '微软雅黑',sans-serif;">）</span>.<span style="font-family: '微软雅黑',sans-serif;">如上，如果把</span>Netfilter<span style="font-family: '微软雅黑',sans-serif;">看成是某个小区的一栋楼</span>.<span style="font-family: '微软雅黑',sans-serif;">那么表（</span>tables<span style="font-family: '微软雅黑',sans-serif;">）就是楼里的其中的一套房子。</span>
</p>

### <span id="125_chains">1.2.5 <span style="font-family: '微软雅黑',sans-serif;">什么是链（</span>chains<span style="font-family: '微软雅黑',sans-serif;">）？</span></span>

<p style="text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif;">链（</span>chains<span style="font-family: '微软雅黑',sans-serif;">）是规则（</span>Policys<span style="font-family: '微软雅黑',sans-serif;">）的容器。接上，如果把表（</span>tables<span style="font-family: '微软雅黑',sans-serif;">）当作有一套房子，那么链（</span>chains<span style="font-family: '微软雅黑',sans-serif;">）就可以说是房子里的家具（柜子等）。</span>
</p>

### <span id="126_Policy">1.2.6 <span style="font-family: '微软雅黑',sans-serif;">什么是规则（</span>Policy<span style="font-family: '微软雅黑',sans-serif;">）？</span></span>

<p style="text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif;">规则（</span>Policy<span style="font-family: '微软雅黑',sans-serif;">）就比较容易理解了，就是</span>iptables<span style="font-family: '微软雅黑',sans-serif;">系列过滤信息的规范和具体方法条款了</span>.<span style="font-family: '微软雅黑',sans-serif;">可以理解为柜子如何增加并摆放柜子东西等。</span>
</p>

<p style="text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif;">基本术语如下表格所示：</span>
</p>

<table style="width: 100%; border-collapse: collapse; border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
  <tr>
    <td style="width: 19.58%; border-width: 1pt 1pt 1.5pt; border-style: solid; border-color: #666666; padding: 0cm 5.4pt;" valign="top" width="19%">
      <p style="text-align: center;" align="center">
        <strong>Netfilter</strong>
      </p>
    </td>
    
    <td style="width: 23.3%; border-top: solid #666666 1.0pt; border-left: none; border-bottom: solid #666666 1.5pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="23%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: 微软雅黑, sans-serif;">表（</span>tables</strong><strong><span style="font-family: 微软雅黑, sans-serif;">）</span></strong>
      </p>
    </td>
    
    <td style="width: 23.3%; border-top: solid #666666 1.0pt; border-left: none; border-bottom: solid #666666 1.5pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="23%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: 微软雅黑, sans-serif;">链（</span>chains</strong><strong><span style="font-family: 微软雅黑, sans-serif;">）</span></strong>
      </p>
    </td>
    
    <td style="width: 33.84%; border-top: solid #666666 1.0pt; border-left: none; border-bottom: solid #666666 1.5pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="33%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: 微软雅黑, sans-serif;">规则（</span>Policy</strong><strong><span style="font-family: 微软雅黑, sans-serif;">）</span></strong>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 19.58%; border-right: 1pt solid #666666; border-bottom: 1pt solid #666666; border-left: 1pt solid #666666; border-top: none; background: #cccccc; padding: 0cm 5.4pt;" valign="top" width="19%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: 微软雅黑, sans-serif;">一栋楼</span></strong>
      </p>
    </td>
    
    <td style="width: 23.3%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="23%">
      <p style="text-align: center;" align="center">
        <span style="font-family: 微软雅黑, sans-serif;">按里的房子</span>
      </p>
    </td>
    
    <td style="width: 23.3%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="23%">
      <p style="text-align: center;" align="center">
        <span style="font-family: 微软雅黑, sans-serif;">房子里的柜子</span>
      </p>
    </td>
    
    <td style="width: 33.84%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="33%">
      <p style="text-align: center;" align="center">
        <span style="font-family: 微软雅黑, sans-serif;">柜子里衣服，摆放规则</span>
      </p>
    </td>
  </tr>
</table>

## <span id="13_iptables">1.3 iptables <span style="font-family: '微软雅黑',sans-serif;">表和链</span></span>

<p style="text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif;">描述完</span>iptables<span style="font-family: '微软雅黑',sans-serif;">术语后，相信大家对</span>iptables<span style="font-family: '微软雅黑',sans-serif;">的表和链有了初步的了解了，默认情况下，</span>iptables<span style="font-family: '微软雅黑',sans-serif;">根据功能和表的定义划分包含三个表，</span>filter,nat,mangle,<span style="font-family: '微软雅黑',sans-serif;">其每个表又包含不同的操作链（</span>chains )<span style="font-family: '微软雅黑',sans-serif;">。</span> <span style="font-family: '微软雅黑',sans-serif;">实际</span>iptables<span style="font-family: '微软雅黑',sans-serif;">包含</span>4<span style="font-family: '微软雅黑',sans-serif;">张表和五个链</span>,<span style="font-family: '微软雅黑',sans-serif;">巧主要记住两张表即可</span>filter<span style="font-family: '微软雅黑',sans-serif;">和</span>nat<span style="font-family: '微软雅黑',sans-serif;">表即可。</span>
</p>

<p style="text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif;">下面表格展示了表和链的对应关系。</span>
</p>

**<span style="font-family: '微软雅黑',sans-serif; courier new"4courier new";background: yellow;">四个表：</span>**

<div align="center">
  <table style="width: 100%; border-collapse: collapse; border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
    <tr>
      <td style="width: 18.94%; border-width: 1pt; border-style: solid; border-color: windowtext; background: #bfbfbf; padding: 0cm 5.4pt;" width="18%">
        <p style="text-align: center;" align="center">
          <strong><span style="font-family: '微软雅黑',sans-serif;">表（</span>tables</strong><strong><span style="font-family: '微软雅黑',sans-serif;">）</span></strong>
        </p>
      </td>
      
      <td style="width: 81.06%; border-top: 1pt solid windowtext; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: none; background: #bfbfbf; padding: 0cm 5.4pt;" colspan="2" width="81%">
        <p style="text-align: center;" align="center">
          <strong><span style="font-family: '微软雅黑',sans-serif;">链（</span>chains</strong><strong><span style="font-family: '微软雅黑',sans-serif;">）</span></strong>
        </p>
      </td>
    </tr>
    
    <tr>
      <td style="width: 18.94%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; background: #d99594; padding: 0cm 5.4pt;" rowspan="4" width="18%">
        <p style="text-align: center;" align="center">
          <strong>Filter</strong>
        </p>
      </td>
      
      <td style="width: 81.06%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; background: #B8CCE4; padding: 0cm 5.4pt 0cm 5.4pt;" colspan="2" width="81%">
        <p style="text-align: justify; text-justify: inter-ideograph;">
          <span style="font-family: '微软雅黑',sans-serif;">这是默认表，实现防火墙数据过滤功能。</span>
        </p>
      </td>
    </tr>
    
    <tr style="height: 16.0pt;">
      <td style="width: 18.98%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; height: 16.0pt;" width="18%">
        <p style="text-align: center;" align="center">
          <strong>INPUT</strong>
        </p>
      </td>
      
      <td style="width: 62.08%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; height: 16.0pt;" width="62%">
        <p style="text-align: justify; text-justify: inter-ideograph;">
          <span style="font-family: '微软雅黑',sans-serif;">对于指定到本地套接字的包，即到达本地防火墙服务器的数据包。</span>
        </p>
      </td>
    </tr>
    
    <tr style="height: 16.0pt;">
      <td style="width: 18.98%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; height: 16.0pt;" width="18%">
        <p style="text-align: center;" align="center">
          <strong>FORWARD</strong>
        </p>
      </td>
      
      <td style="width: 62.08%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; height: 16.0pt;" width="62%">
        <p style="text-align: justify; text-justify: inter-ideograph;">
          <span style="font-family: '微软雅黑',sans-serif;">路由穿过的数据包，即经过本地防火墙服务器的数据包。</span>
        </p>
      </td>
    </tr>
    
    <tr style="height: 16.0pt;">
      <td style="width: 18.98%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; height: 16.0pt;" width="18%">
        <p style="text-align: center;" align="center">
          <strong>OUTPUT</strong>
        </p>
      </td>
      
      <td style="width: 62.08%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; height: 16.0pt;" width="62%">
        <p style="text-align: justify; text-justify: inter-ideograph;">
          <span style="font-family: '微软雅黑',sans-serif;">本地创建的数据包</span>
        </p>
      </td>
    </tr>
    
    <tr>
      <td style="width: 18.94%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; background: #fabf8f; padding: 0cm 5.4pt;" rowspan="4" width="18%">
        <p style="text-align: center;" align="center">
          <strong>NAT</strong>
        </p>
      </td>
      
      <td style="width: 81.06%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; background: #B8CCE4; padding: 0cm 5.4pt 0cm 5.4pt;" colspan="2" width="81%">
        <p style="text-align: justify; text-justify: inter-ideograph;">
          <span style="font-family: '微软雅黑',sans-serif;">当遇到新创建的数据包连接时将参考这个表</span>
        </p>
      </td>
    </tr>
    
    <tr>
      <td style="width: 18.98%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="18%">
        <p style="text-align: center;" align="center">
          <strong>FREROUTING</strong>
        </p>
      </td>
      
      <td style="width: 62.08%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="62%">
        <p style="text-align: justify; text-justify: inter-ideograph;">
          <span style="font-family: '微软雅黑',sans-serif;">一进来就对数据包进行改变</span>
        </p>
      </td>
    </tr>
    
    <tr>
      <td style="width: 18.98%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="18%">
        <p style="text-align: center;" align="center">
          <strong>OUTPUT</strong>
        </p>
      </td>
      
      <td style="width: 62.08%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="62%">
        <p style="text-align: justify; text-justify: inter-ideograph;">
          <span style="font-family: '微软雅黑',sans-serif;">本地创建的数据包在路由前进行改变</span>
        </p>
      </td>
    </tr>
    
    <tr>
      <td style="width: 18.98%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="18%">
        <p style="text-align: center;" align="center">
          <strong>POSTROUTING</strong>
        </p>
      </td>
      
      <td style="width: 62.08%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="62%">
        <p style="text-align: justify; text-justify: inter-ideograph;">
          <span style="font-family: '微软雅黑',sans-serif;">在数据包即将出去时改变数据包信息</span>
        </p>
      </td>
    </tr>
    
    <tr>
      <td style="width: 18.94%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; background: #c2d69b; padding: 0cm 5.4pt;" rowspan="6" width="18%">
        <p style="text-align: center;" align="center">
          <strong>Mangle</strong>
        </p>
      </td>
      
      <td style="width: 81.06%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; background: #B8CCE4; padding: 0cm 5.4pt 0cm 5.4pt;" colspan="2" width="81%">
        <p style="text-align: justify; text-justify: inter-ideograph;">
          <span style="font-family: '微软雅黑',sans-serif;">这个表专门用于改变数据包</span>
        </p>
      </td>
    </tr>
    
    <tr>
      <td style="width: 18.98%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="18%">
        <p style="text-align: center;" align="center">
          <strong>INPUT</strong>
        </p>
      </td>
      
      <td style="width: 62.08%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="62%">
        <p style="text-align: justify; text-justify: inter-ideograph;">
          <span style="font-family: '微软雅黑',sans-serif;">进入到设备本身的包</span>
        </p>
      </td>
    </tr>
    
    <tr>
      <td style="width: 18.98%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="18%">
        <p style="text-align: center;" align="center">
          <strong>FORWARD</strong>
        </p>
      </td>
      
      <td style="width: 62.08%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="62%">
        <p style="text-align: justify; text-justify: inter-ideograph;">
          <span style="font-family: '微软雅黑',sans-serif;">对路由后的数据包信息进行修改</span>
        </p>
      </td>
    </tr>
    
    <tr>
      <td style="width: 18.98%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="18%">
        <p style="text-align: center;" align="center">
          <strong>FREROUTING</strong>
        </p>
      </td>
      
      <td style="width: 62.08%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="62%">
        <p style="text-align: justify; text-justify: inter-ideograph;">
          <span style="font-family: '微软雅黑',sans-serif;">在路由之前更改传入的包</span>
        </p>
      </td>
    </tr>
    
    <tr>
      <td style="width: 18.98%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="18%">
        <p style="text-align: center;" align="center">
          <strong>OUTPUT</strong>
        </p>
      </td>
      
      <td style="width: 62.08%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="62%">
        <p style="text-align: justify; text-justify: inter-ideograph;">
          <span style="font-family: '微软雅黑',sans-serif;">本地创建的数据包在路由之前改变</span>
        </p>
      </td>
    </tr>
    
    <tr>
      <td style="width: 18.98%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="18%">
        <p style="text-align: center;" align="center">
          <strong>POSTROUTING</strong>
        </p>
      </td>
      
      <td style="width: 62.08%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="62%">
        <p style="text-align: justify; text-justify: inter-ideograph;">
          <span style="font-family: '微软雅黑',sans-serif;">在数据包即将离开时更改数据包信息</span>
        </p>
      </td>
    </tr>
    
    <tr style="height: 7.25pt;">
      <td style="width: 18.94%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; background: #b6dde8; padding: 0cm 5.4pt; height: 7.25pt;" rowspan="3" width="18%">
        <p style="text-align: center;" align="center">
          <strong>raw</strong>
        </p>
      </td>
      
      <td style="width: 81.06%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; height: 7.25pt;" colspan="2" width="81%">
        <p style="text-align: justify; text-justify: inter-ideograph;">
          <strong><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif; courier new"4courier new";color: #E36C0A;">此表用处较少，可以忽略不计。</span></strong>
        </p>
        
        <p style="text-align: justify; text-justify: inter-ideograph;">
          <span style="font-size: 9.0pt;">This&nbsp; table is used mainly for configuring exemptions from connection tracking in combination with the&nbsp; NOTRACK&nbsp; target.</span>
        </p>
      </td>
    </tr>
    
    <tr style="height: 7.25pt;">
      <td style="width: 18.98%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; height: 7.25pt;" width="18%">
        <p style="text-align: center;" align="center">
          <strong>PREROUTING</strong>
        </p>
      </td>
      
      <td style="width: 62.08%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; height: 7.25pt;" width="62%">
        <p style="text-align: justify; text-justify: inter-ideograph;">
          <span style="font-family: 'Microsoft YaHei UI',sans-serif;">for packets arriving via any network interface</span>
        </p>
      </td>
    </tr>
    
    <tr style="height: 7.25pt;">
      <td style="width: 18.98%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; height: 7.25pt;" width="18%">
        <p style="text-align: center;" align="center">
          <strong>OUTPUT</strong>
        </p>
      </td>
      
      <td style="width: 62.08%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; height: 7.25pt;" width="62%">
        <p style="text-align: justify; text-justify: inter-ideograph;">
          <span style="font-family: 'Microsoft YaHei UI',sans-serif;">for packets&nbsp; generated by local processes</span>
        </p>
      </td>
    </tr>
  </table>
</div>

**<span style="font-family: '微软雅黑',sans-serif; courier new"4courier new";background: yellow;">五个链</span>**

<table style="width: 100%; border-collapse: collapse; border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
  <tr>
    <td style="width: 18.76%; border-width: 1pt; border-style: solid; border-color: windowtext; background: #95b3d7; padding: 0cm 5.4pt;" rowspan="2" width="18%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: '微软雅黑',sans-serif;">表（</span>tables</strong><strong><span style="font-family: '微软雅黑',sans-serif;">）</span></strong>
      </p>
    </td>
    
    <td style="width: 81.24%; border-top: 1pt solid windowtext; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: none; background: #b2a1c7; padding: 0cm 5.4pt;" colspan="5" width="81%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: '微软雅黑',sans-serif;">链（</span>chains</strong><strong><span style="font-family: '微软雅黑',sans-serif;">）</span></strong>
      </p>
    </td>
  </tr>
  
  <tr style="height: 22.05pt;">
    <td style="width: 15.88%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; background: #FBD4B4; padding: 0cm 5.4pt 0cm 5.4pt; height: 22.05pt;" width="15%">
      <p style="text-align: center;" align="center">
        INPUT
      </p>
    </td>
    
    <td style="width: 16.0%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; background: #FBD4B4; padding: 0cm 5.4pt 0cm 5.4pt; height: 22.05pt;" width="16%">
      <p style="text-align: center;" align="center">
        FORWARD
      </p>
    </td>
    
    <td style="width: 15.94%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; background: #FBD4B4; padding: 0cm 5.4pt 0cm 5.4pt; height: 22.05pt;" width="15%">
      <p style="text-align: center;" align="center">
        OUTPUT
      </p>
    </td>
    
    <td style="width: 16.2%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; background: #FBD4B4; padding: 0cm 5.4pt 0cm 5.4pt; height: 22.05pt;" width="16%">
      <p style="text-align: center;" align="center">
        PREROUTING
      </p>
    </td>
    
    <td style="width: 17.22%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; background: #FBD4B4; padding: 0cm 5.4pt 0cm 5.4pt; height: 22.05pt;" width="17%">
      <p style="text-align: center;" align="center">
        POSTROUTING
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 18.76%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; background: #d99594; padding: 0cm 5.4pt;" width="18%">
      <p style="text-align: center;" align="center">
        <strong>Filter</strong>
      </p>
    </td>
    
    <td style="width: 15.88%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="15%">
      <p style="text-align: center;" align="center">
        <span style="font-family: '微软雅黑',sans-serif;">&radic;</span>
      </p>
    </td>
    
    <td style="width: 16.0%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="16%">
      <p style="text-align: center;" align="center">
        <span style="font-family: '微软雅黑',sans-serif;">&radic;</span>
      </p>
    </td>
    
    <td style="width: 15.94%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="15%">
      <p style="text-align: center;" align="center">
        <span style="font-family: '微软雅黑',sans-serif;">&radic;</span>
      </p>
    </td>
    
    <td style="width: 16.2%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="16%">
      <p style="text-align: center;" align="center">
        <span style="font-family: '微软雅黑',sans-serif;">&times;</span>
      </p>
    </td>
    
    <td style="width: 17.22%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="17%">
      <p style="text-align: center;" align="center">
        <span style="font-family: '微软雅黑',sans-serif;">&times;</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 18.76%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; background: #fabf8f; padding: 0cm 5.4pt;" width="18%">
      <p style="text-align: center;" align="center">
        <strong>NAT</strong>
      </p>
    </td>
    
    <td style="width: 15.88%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="15%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: '微软雅黑',sans-serif;">&times;</span></strong>
      </p>
    </td>
    
    <td style="width: 16.0%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="16%">
      <p style="text-align: center;" align="center">
        <span style="font-family: '微软雅黑',sans-serif;">&times;</span>
      </p>
    </td>
    
    <td style="width: 15.94%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="15%">
      <p style="text-align: center;" align="center">
        <span style="font-family: '微软雅黑',sans-serif;">&radic;</span>
      </p>
    </td>
    
    <td style="width: 16.2%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="16%">
      <p style="text-align: center;" align="center">
        <span style="font-family: '微软雅黑',sans-serif;">&radic;</span>
      </p>
    </td>
    
    <td style="width: 17.22%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="17%">
      <p style="text-align: center;" align="center">
        <span style="font-family: '微软雅黑',sans-serif;">&radic;</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 18.76%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; background: #c2d69b; padding: 0cm 5.4pt;" width="18%">
      <p style="text-align: center;" align="center">
        <strong>Managle</strong>
      </p>
    </td>
    
    <td style="width: 15.88%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="15%">
      <p style="text-align: center;" align="center">
        <span style="font-family: '微软雅黑',sans-serif;">&radic;</span>
      </p>
    </td>
    
    <td style="width: 16.0%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="16%">
      <p style="text-align: center;" align="center">
        <span style="font-family: '微软雅黑',sans-serif;">&radic;</span>
      </p>
    </td>
    
    <td style="width: 15.94%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="15%">
      <p style="text-align: center;" align="center">
        <span style="font-family: '微软雅黑',sans-serif;">&radic;</span>
      </p>
    </td>
    
    <td style="width: 16.2%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="16%">
      <p style="text-align: center;" align="center">
        <span style="font-family: '微软雅黑',sans-serif;">&radic;</span>
      </p>
    </td>
    
    <td style="width: 17.22%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="17%">
      <p style="text-align: center;" align="center">
        <span style="font-family: '微软雅黑',sans-serif;">&radic;</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 18.76%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; background: #b6dde8; padding: 0cm 5.4pt;" width="18%">
      <p style="text-align: center;" align="center">
        <strong>raw</strong>
      </p>
    </td>
    
    <td style="width: 15.88%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="15%">
      <p style="text-align: center;" align="center">
        <span style="font-family: '微软雅黑',sans-serif;">&times;</span>
      </p>
    </td>
    
    <td style="width: 16.0%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="16%">
      <p style="text-align: center;" align="center">
        <span style="font-family: '微软雅黑',sans-serif;">&times;</span>
      </p>
    </td>
    
    <td style="width: 15.94%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="15%">
      <p style="text-align: center;" align="center">
        <span style="font-family: '微软雅黑',sans-serif;">&radic;</span>
      </p>
    </td>
    
    <td style="width: 16.2%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="16%">
      <p style="text-align: center;" align="center">
        <span style="font-family: '微软雅黑',sans-serif;">&radic;</span>
      </p>
    </td>
    
    <td style="width: 17.22%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="17%">
      <p style="text-align: center;" align="center">
        <span style="font-family: '微软雅黑',sans-serif;">&times;</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 100%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; background: #c2d69b; padding: 0cm 5.4pt;" colspan="6" width="100%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">说明：&radic;</span> <span style="font-family: '微软雅黑',sans-serif;">表示有，&times;</span> <span style="font-family: '微软雅黑',sans-serif;">表示无。</span>
      </p>
    </td>
  </tr>
</table>

<p style="text-align: center;" align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20180118095127803-1524170528.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="企业防火墙之iptables" alt="" />
</p>

<p style="text-align: center;" align="center">
  <span style="font-family: '微软雅黑',sans-serif;">图</span> - iptables<span style="font-family: '微软雅黑',sans-serif;">中的表与链的结构关系</span>
</p>

### <span id="131_filter">1.3.1 filter<span style="font-family: '微软雅黑',sans-serif;">表的详细介绍</span></span>

<table style="width: 100%; border-collapse: collapse; border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
  <tr>
    <td style="width: 20.3%; border-width: 1pt; border-style: solid; border-color: windowtext; background: #d99594; padding: 0cm 5.4pt;" width="20%">
      <p style="text-align: center;" align="center">
        <strong>filter</strong><strong><span style="font-family: '微软雅黑',sans-serif;">表</span></strong>
      </p>
    </td>
    
    <td style="width: 79.7%; border-top: 1pt solid windowtext; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: none; background: #92cddc; padding: 0cm 5.4pt;" valign="top" width="79%">
      <p>
        <span style="font-family: '微软雅黑',sans-serif;">主要和主机自身相关，真正负责主机防火墙功能的（过滤流入流出主机的数据包）</span>
      </p>
      
      <p>
        filter<span style="font-family: '微软雅黑',sans-serif;">表是</span>iptables<span style="font-family: '微软雅黑',sans-serif;">默认使用的表，这个表定义了三个链（</span>chains<span style="font-family: '微软雅黑',sans-serif;">）</span>
      </p>
      
      <p>
        <strong><span style="font-family: '微软雅黑',sans-serif;">企业工作场景</span>:</strong><strong><span style="font-family: '微软雅黑',sans-serif;">主机防火墙</span></strong>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 20.3%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="20%">
      <p style="text-align: center;" align="center">
        <strong>INPUT</strong>
      </p>
    </td>
    
    <td style="width: 79.7%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="79%">
      <p>
        <span style="font-family: '微软雅黑',sans-serif;">负责过滤所有目标是本机地址的数据包</span>
      </p>
      
      <p>
        <span style="font-family: '微软雅黑',sans-serif;">通俗来说：就是过滤进入主机的数据包</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 20.3%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="20%">
      <p style="text-align: center;" align="center">
        <strong>FORWARD</strong>
      </p>
    </td>
    
    <td style="width: 79.7%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="79%">
      <p>
        <span style="font-family: '微软雅黑',sans-serif;">负责转发流经主机的数据包。起到转发的作用，和</span>NAT<span style="font-family: '微软雅黑',sans-serif;">关系很大。</span>
      </p>
      
      <p>
        LVS NAT <span style="font-family: '微软雅黑',sans-serif;">模式，</span>net.ipv4.ip_forward=0
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 20.3%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="20%">
      <p style="text-align: center;" align="center">
        <strong>OUTPUT</strong>
      </p>
    </td>
    
    <td style="width: 79.7%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="79%">
      <p>
        <span style="font-family: '微软雅黑',sans-serif;">处理所有源地址是本机地址的数据包</span>
      </p>
      
      <p>
        <span style="font-family: '微软雅黑',sans-serif;">通俗的讲：就是处理从主机发出的数据包</span>
      </p>
    </td>
  </tr>
</table>

&nbsp;&nbsp; <span style="font-family: '微软雅黑',sans-serif;">对于</span>filter<span style="font-family: '微软雅黑',sans-serif;">表的控制是我们实现本机防火墙功能的重要手段，特别是</span>INPUT<span style="font-family: '微软雅黑',sans-serif;">链的控制。</span>

### <span id="132_NAT">1.3.2 NAT<span style="font-family: '微软雅黑',sans-serif;">表信息详细介绍</span></span>

<table style="width: 100%; border-collapse: collapse; border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
  <tr>
    <td style="width: 20.3%; border-width: 1pt; border-style: solid; border-color: windowtext; background: #fabf8f; padding: 0cm 5.4pt;" width="20%">
      <p style="text-align: center;" align="center">
        NAT<span style="font-family: '微软雅黑',sans-serif;">表</span>
      </p>
    </td>
    
    <td style="width: 79.7%; border-top: 1pt solid windowtext; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: none; background: #95b3d7; padding: 0cm 5.4pt;" width="79%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">负责网络地址转换的，即来源与目的的</span>IP<span style="font-family: '微软雅黑',sans-serif;">地址和</span>port<span style="font-family: '微软雅黑',sans-serif;">的转换。</span>
      </p>
      
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">应用：和主机本身无关，一般用于局域网共享上网或者特殊的端口转换相关</span>.
      </p>
      
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <strong><em><span style="font-family: '微软雅黑',sans-serif;">工作场景：</span></em></strong>
      </p>
      
      <p style="text-align: justify; text-justify: inter-ideograph;">
        1<span style="font-family: '微软雅黑',sans-serif;">、用于企业路由</span>(zebra)<span style="font-family: '微软雅黑',sans-serif;">或网关</span>(iptables),<span style="font-family: '微软雅黑',sans-serif;">共享上网</span>(POSTROUTING)
      </p>
      
      <p style="text-align: justify; text-justify: inter-ideograph;">
        2<span style="font-family: '微软雅黑',sans-serif;">、做内部外部</span>IP<span style="font-family: '微软雅黑',sans-serif;">地址一对一映射</span>(dmz),<span style="font-family: '微软雅黑',sans-serif;">硬件防火墙映射</span>IP<span style="font-family: '微软雅黑',sans-serif;">到内部服务器，</span>FTP<span style="font-family: '微软雅黑',sans-serif;">服务</span>(PREROUTING)
      </p>
      
      <p style="text-align: justify; text-justify: inter-ideograph;">
        3<span style="font-family: '微软雅黑',sans-serif;">、</span>WEB,<span style="font-family: '微软雅黑',sans-serif;">单个端口的映射，直接映射</span>80<span style="font-family: '微软雅黑',sans-serif;">端口</span>(PREROUTING)
      </p>
      
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">这个表定义了</span>3<span style="font-family: '微软雅黑',sans-serif;">个链，</span>nat<span style="font-family: '微软雅黑',sans-serif;">功能相当于网络的</span>acl<span style="font-family: '微软雅黑',sans-serif;">控制。和网络交换机</span>acl<span style="font-family: '微软雅黑',sans-serif;">类似。</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 20.3%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="20%">
      <p style="text-align: center;" align="center">
        <strong>OUTPUT</strong>
      </p>
    </td>
    
    <td style="width: 79.7%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="79%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">和主机放出去的数据包有关，改变主机发出数据包的目的地址。</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 20.3%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="20%">
      <p style="text-align: center;" align="center">
        <strong>PREROUTING</strong>
      </p>
    </td>
    
    <td style="width: 79.7%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="79%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">在数据包到达防火墙时，进行路由判断之前执行的规则，作用是改变数据包的目的地址、目的端口等</span>
      </p>
      
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">就是收信时，根据规则重写收件人的地址</span>
      </p>
      
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">例如：把公网</span>IP<span style="font-family: '微软雅黑',sans-serif;">：</span> xxx.xxx.xxx.xxx <span style="font-family: '微软雅黑',sans-serif;">映射到局域网的</span> x.x.x.x <span style="font-family: '微软雅黑',sans-serif;">服务器</span>
      </p>
      
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">如果是</span>web<span style="font-family: '微软雅黑',sans-serif;">服务，可以把</span>80<span style="font-family: '微软雅黑',sans-serif;">转换为局域网的服务器</span>9000<span style="font-family: '微软雅黑',sans-serif;">端口上。</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 20.3%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="20%">
      <p style="text-align: center;" align="center">
        <strong>POSTROUTING</strong>
      </p>
    </td>
    
    <td style="width: 79.7%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="79%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">在数据包离开防火墙时进行路由判断之后执行的规则，作用改变数据包的源地址，源端口等。</span>
      </p>
      
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">写好收件人的地址，要让家人回信时能够有地址可回。</span>
      </p>
      
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">例如。默认笔记本和虚拟机都是局域网地址，在出网的时候被路由器将源地址改为公网地址。</span>
      </p>
      
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <strong><em><span style="font-family: '微软雅黑',sans-serif;">生产应用：</span></em></strong><span style="font-family: '微软雅黑',sans-serif;">局域网共享上网。</span>
      </p>
    </td>
  </tr>
</table>

### <span id="133_Mangle">1.3.3 Mangle<span style="font-family: '微软雅黑',sans-serif;">表信息详细介绍</span></span>

<table style="width: 100%; border-collapse: collapse; border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
  <tr style="height: 29.55pt;">
    <td style="width: 20.3%; border-width: 1pt; border-style: solid; border-color: windowtext; background: #c2d69b; padding: 0cm 5.4pt; height: 29.55pt;" width="20%">
      <p style="text-align: center;" align="center">
        Mangle<span style="font-family: '微软雅黑',sans-serif;">表</span>
      </p>
    </td>
    
    <td style="width: 79.7%; border-top: 1pt solid windowtext; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: none; background: #92cddc; padding: 0cm 5.4pt; height: 29.55pt;" width="79%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">主要负责修改数据包中特殊的路由标记，如</span>TTL,TOS,MARK<span style="font-family: '微软雅黑',sans-serif;">等，这个表定义了</span>5<span style="font-family: '微软雅黑',sans-serif;">个链</span>(chains).
      </p>
    </td>
  </tr>
</table>

<p style="text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif;">由于这个表与特殊标记相关，一般倩况下，我们用不到这个</span>mangle<span style="font-family: '微软雅黑',sans-serif;">表。</span>
</p>

<p style="text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif;">这里就不做详细介绍了。</span>
</p>

## <span id="14_iptables">1.4 iptables<span style="font-family: '微软雅黑',sans-serif;">工作流程</span></span>

### <span id="141">1.4.1 <span style="font-family: '微软雅黑',sans-serif;">工作流程说明</span></span>

<p style="text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif;">前面介绍已经提到，</span>iptables<span style="font-family: '微软雅黑',sans-serif;">是采用数据包过滤机制工作的，所以它会对请求的数据包的包头数据进行分析，并根据我们预先设定的规则进行匹配来决定是否可以进入主机。</span>
</p>

<p style="text-indent: 21.0pt;">
  iptables<span style="font-family: '微软雅黑',sans-serif;">是采用数据包过滤机制工作的，所以它会对请求的数据包的包头数据进行分析，并根据我们预先设定的规则进行匹配来决定是否可以进入主机。</span>
</p>

<p style="text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif;">数据包的流向是从左向右的。</span>
</p>

<p style="text-align: center;" align="center">
  &nbsp;<img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20180118095142834-207194553.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="企业防火墙之iptables" alt="" />
</p>

<p style="text-align: center;" align="center">
  <span style="font-family: '微软雅黑',sans-serif;">图</span> - iptables<span style="font-family: '微软雅黑',sans-serif;">包处理流程图</span>
</p>

<p style="text-align: center;" align="center">
  &nbsp;<img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20180118095149740-1977616339.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="企业防火墙之iptables" alt="" />
</p>

<p style="text-align: center;" align="center">
  <span style="font-family: '微软雅黑',sans-serif;">图</span> - iptables<span style="font-family: '微软雅黑',sans-serif;">包处理流程图</span>(<span style="font-family: '微软雅黑',sans-serif;">简化</span>)
</p>

**_<span style="font-family: '微软雅黑',sans-serif; courier new"4courier new";background: yellow;">抽象说明：</span>_**<span style="font-family: '微软雅黑',sans-serif;">上图可以用北京地铁</span>1,2<span style="font-family: '微软雅黑',sans-serif;">号线来描述：</span>

<p style="text-indent: 21.0pt;">
  1<span style="font-family: '微软雅黑',sans-serif;">号线：主要是</span>NAT<span style="font-family: '微软雅黑',sans-serif;">功能</span>
</p>

> <p style="text-indent: 21.0pt;">
>   &nbsp;企业案例：
> </p>
> 
> <p style="text-indent: 21.0pt;">
>   &nbsp;　　1)局域网上网共享（路由和网关），使用NAT的POSTROUTING链。
> </p>
> 
> <p style="text-indent: 21.0pt;">
>   &nbsp;　　2)外部IP和端口映射为内部IP和端口（DMZ功能），使用NAT的PREROUTING链
> </p>

<p style="text-indent: 21.0pt;">
  2<span style="font-family: '微软雅黑',sans-serif;">号线：主要是</span>FILTER<span style="font-family: '微软雅黑',sans-serif;">功能，即防火墙功能</span>FILTER INPUT FORWARD
</p>

> 企业案例：
> 
> 　　主要应用就是主机服务器防火墙，使用FILTER的INPUT链

<p style="text-align: center;" align="center">
  &nbsp;<img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20180118095207678-1251478781.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="企业防火墙之iptables" alt="" />
</p>

<p style="text-align: center;" align="center">
  <span style="font-family: '微软雅黑',sans-serif;">图</span> - iptables<span style="font-family: '微软雅黑',sans-serif;">数据包转发流程图</span>
</p>

### <span id="142_iptables">1.4.2 iptables<span style="font-family: '微软雅黑',sans-serif;">工作流程小结</span></span>

> 1、防火墙是一层层过滤的。实际是按照配置规则的顺序从上到下，从前到后进行过滤的。
> 
> 2、如果匹配上了规则，即明确表明是阻止还是通过，此时数据包就不在向下匹配新规则了。
> 
> 3、如果所有规则中没有明确表明是阻止还是通过这个数据包，也就是没有匹配上规则，向下进行匹配，直到匹配默认规则得到明确的阻止还是通过。
> 
> 4、防火墙的默认规则是对应链的所有的规则执行完以后才会执行的（最后执行的规则）。

## <span id="15_iptables">1.5 iptables<span style="font-family: '微软雅黑',sans-serif;">操作</span></span>

<span style="font-family: '微软雅黑',sans-serif;">系统环境说明</span>

<div class="cnblogs_code">
  <pre>[root@clsn ~]<span style="color: #008000;">#</span><span style="color: #008000;"> cat /etc/redhat-release </span>
CentOS release 6.9<span style="color: #000000;"> (Final)
[root@clsn </span>~]<span style="color: #008000;">#</span><span style="color: #008000;"> hostname -I</span>
10.0.0.188 172.16.1.188</pre>
</div>

<span style="font-family: '微软雅黑',sans-serif;">软件版本</span>

<div class="cnblogs_code">
  <pre>[root@clsn ~]<span style="color: #008000;">#</span><span style="color: #008000;"> iptables -V</span>
iptables v1.4.7</pre>
</div>

### <span id="151_iptables">1.5.1 iptables<span style="font-family: '微软雅黑',sans-serif;">参数说明</span></span>

<table style="width: 100%; border-collapse: collapse; border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
  <tr>
    <td style="width: 32.48%; border-width: 1pt; border-style: solid; border-color: windowtext; background: #bfbfbf; padding: 0cm 5.4pt;" width="32%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: '微软雅黑',sans-serif;">参数</span></strong>
      </p>
    </td>
    
    <td style="width: 67.52%; border-top: 1pt solid windowtext; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: none; background: #bfbfbf; padding: 0cm 5.4pt;" colspan="3" width="67%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: '微软雅黑',sans-serif;">参数说明</span></strong>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 100%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; background: #fabf8f; padding: 0cm 5.4pt;" colspan="4" width="100%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <strong><span style="font-family: '微软雅黑',sans-serif;">显示相关参数</span></strong>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 32.48%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="32%">
      <p style="text-align: center;" align="center">
        <strong>-n/--numeric</strong>
      </p>
    </td>
    
    <td style="width: 67.52%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" colspan="3" width="67%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">以数字的方式显示地址或端口信息</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 32.48%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="32%">
      <p style="text-align: center;" align="center">
        <strong>-L/ --list</strong>
      </p>
    </td>
    
    <td style="width: 67.52%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" colspan="3" width="67%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">列出一个链或所有链中的规则信息</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 32.48%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="32%">
      <p style="text-align: center;" align="center">
        <strong>--list-rules/-S</strong>
      </p>
    </td>
    
    <td style="width: 67.52%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" colspan="3" width="67%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        Print the rules in a chain or all chains
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 32.48%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="32%">
      <p style="text-align: center;" align="center">
        <strong>--line-number</strong>
      </p>
    </td>
    
    <td style="width: 67.52%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" colspan="3" width="67%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">当列出规则信息时，打印规则行号</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 32.48%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="32%">
      <p style="text-align: center;" align="center">
        <strong>-v</strong>
      </p>
    </td>
    
    <td style="width: 67.52%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" colspan="3" width="67%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">显示详细信息，可以叠加</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 32.48%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="32%">
      <p style="text-align: center;" align="center">
        <strong>-h</strong>
      </p>
    </td>
    
    <td style="width: 67.52%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" colspan="3" width="67%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">显示帮助信息</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 100%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; background: #92cddc; padding: 0cm 5.4pt;" colspan="4" width="100%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <strong><span style="font-family: '微软雅黑',sans-serif;">初始化相关参数</span></strong>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 32.48%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="32%">
      <p style="text-align: center;" align="center">
        <strong>iptables -F</strong>
      </p>
    </td>
    
    <td style="width: 67.52%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" colspan="3" width="67%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">清除所有规则，不会处理默认的规则</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 32.48%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="32%">
      <p style="text-align: center;" align="center">
        <strong>iptables -X</strong>
      </p>
    </td>
    
    <td style="width: 67.52%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" colspan="3" width="67%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">删除用户自定义的链</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 32.48%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="32%">
      <p style="text-align: center;" align="center">
        <strong>iptables -Z</strong>
      </p>
    </td>
    
    <td style="width: 67.52%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" colspan="3" width="67%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">链的计数器清零（数据包计数器与数据包字节计数器）</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 100%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; background: #b2a1c7; padding: 0cm 5.4pt;" colspan="4" width="100%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <strong><span style="font-family: '微软雅黑',sans-serif;">配置常用参数</span></strong>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 32.48%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="32%">
      <p style="text-align: center;" align="center">
        <strong>-t </strong><strong><span style="font-family: '微软雅黑',sans-serif;">表名称</span></strong>
      </p>
    </td>
    
    <td style="width: 67.52%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" colspan="3" width="67%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">指定配置哪个表，指定配置表名称。</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 32.48%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="32%">
      <p style="text-align: center;" align="center">
        <strong>--append/-A </strong><strong><span style="font-family: '微软雅黑',sans-serif;">链名称</span></strong>
      </p>
    </td>
    
    <td style="width: 67.52%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" colspan="3" width="67%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">附加或追加上相应规则策略，到指定链</span>(<span style="font-family: '微软雅黑',sans-serif;">链名称必须大写</span>)<span style="font-family: '微软雅黑',sans-serif;">，默认将配置的规则插入到最后一条。</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 32.48%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="32%">
      <p style="text-align: center;" align="center">
        <strong>--check/-C</strong>
      </p>
    </td>
    
    <td style="width: 67.52%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" colspan="3" width="67%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        Check for the existence of a rule
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 32.48%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="32%">
      <p style="text-align: center;" align="center">
        <strong>--insert/-I </strong><strong><span style="font-family: '微软雅黑',sans-serif;">链名称</span></strong>
      </p>
    </td>
    
    <td style="width: 67.52%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" colspan="3" width="67%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">插入相应规则策略，到指定链上，默认将配置的规则插入到第一条（可以根据规则序号插入到指定位置）</span>--<span style="font-family: '微软雅黑',sans-serif;">封</span>IP<span style="font-family: '微软雅黑',sans-serif;">地址使用。</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 32.48%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="32%">
      <p style="text-align: center;" align="center">
        <strong>--delete/-D </strong><strong><span style="font-family: '微软雅黑',sans-serif;">链名称</span></strong>
      </p>
    </td>
    
    <td style="width: 67.52%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" colspan="3" width="67%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">删除指定的规则</span>(<span style="font-family: '微软雅黑',sans-serif;">可以根据规则序号进行删除</span>)
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 32.48%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="32%">
      <p style="text-align: center;" align="center">
        <strong>--replace/-R</strong>
      </p>
    </td>
    
    <td style="width: 67.52%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" colspan="3" width="67%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        Replace rule rulenum (1 = first) in chain
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 32.48%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="32%">
      <p style="text-align: center;" align="center">
        <strong>-P(</strong><strong><span style="font-family: '微软雅黑',sans-serif;">大写</span>)</strong><strong><span style="font-family: '微软雅黑',sans-serif;">链名称</span></strong>
      </p>
    </td>
    
    <td style="width: 67.52%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" colspan="3" width="67%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">改变链上的最终默认规则策略</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 32.48%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="32%">
      <p style="text-align: center;" align="center">
        <strong><span style="color: #c00000;">--new/-N</span></strong>
      </p>
    </td>
    
    <td style="width: 67.52%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" colspan="3" width="67%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">创建新的用户定义链</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 32.48%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="32%">
      <p style="text-align: center;" align="center">
        <strong>-p </strong><strong><span style="font-family: '微软雅黑',sans-serif;">协议名称</span></strong>
      </p>
      
      <p style="text-align: center;" align="center">
        <strong><span style="color: red;">[!] </span>--proto</strong>
      </p>
    </td>
    
    <td style="width: 67.52%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" colspan="3" width="67%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">指定规则的协议名称</span> all tcp udp icmp
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 32.48%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="32%">
      <p style="text-align: center;" align="center">
        <strong>--dport</strong>
      </p>
    </td>
    
    <td style="width: 67.52%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" colspan="3" width="67%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">指定匹配的目标端口信息</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 32.48%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="32%">
      <p style="text-align: center;" align="center">
        <strong>--sport</strong>
      </p>
    </td>
    
    <td style="width: 67.52%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" colspan="3" width="67%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">指定匹配的源端口信息</span>
      </p>
    </td>
  </tr>
  
  <tr style="height: 8.25pt;">
    <td style="width: 32.48%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt; height: 8.25pt;" rowspan="7" width="32%">
      <p style="text-align: center;" align="center">
        <strong>-j </strong><strong><span style="font-family: '微软雅黑',sans-serif;">动作</span></strong>
      </p>
    </td>
    
    <td style="width: 67.52%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; background: #9BBB59; padding: 0cm 5.4pt 0cm 5.4pt; height: 8.25pt;" colspan="3" width="67%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">匹配数据包后的动作</span>&nbsp;&nbsp;&nbsp;&nbsp;
      </p>
    </td>
  </tr>
  
  <tr style="height: 8.1pt;">
    <td style="width: 20.36%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; height: 8.1pt;" colspan="2" width="20%">
      <p style="text-align: center;" align="center">
        <strong>ACCEPT</strong>
      </p>
    </td>
    
    <td style="width: 47.16%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; height: 8.1pt;" width="47%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">允许</span>
      </p>
    </td>
  </tr>
  
  <tr style="height: 8.1pt;">
    <td style="width: 20.36%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; height: 8.1pt;" colspan="2" width="20%">
      <p style="text-align: center;" align="center">
        <strong>DROP</strong>
      </p>
    </td>
    
    <td style="width: 47.16%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; height: 8.1pt;" width="47%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">丢弃</span>(<span style="font-family: '微软雅黑',sans-serif;">没有响应</span>)
      </p>
    </td>
  </tr>
  
  <tr style="height: 8.1pt;">
    <td style="width: 20.36%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; height: 8.1pt;" colspan="2" width="20%">
      <p style="text-align: center;" align="center">
        <strong>REJECT</strong>
      </p>
    </td>
    
    <td style="width: 47.16%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; height: 8.1pt;" width="47%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">拒绝</span>(<span style="font-family: '微软雅黑',sans-serif;">回应请求者明确的拒绝</span>)
      </p>
    </td>
  </tr>
  
  <tr style="height: 8.1pt;">
    <td style="width: 20.36%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; height: 8.1pt;" colspan="2" width="20%">
      <p style="text-align: center;" align="center">
        <strong>MASQUERADE</strong>
      </p>
    </td>
    
    <td style="width: 47.16%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; height: 8.1pt;" width="47%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">伪装上网时使用</span>
      </p>
    </td>
  </tr>
  
  <tr style="height: 8.1pt;">
    <td style="width: 20.36%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; height: 8.1pt;" colspan="2" width="20%">
      <p style="text-align: center;" align="center">
        <strong>SNAT</strong>
      </p>
    </td>
    
    <td style="width: 47.16%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; height: 8.1pt;" width="47%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">共享地址上网</span>
      </p>
    </td>
  </tr>
  
  <tr style="height: 8.1pt;">
    <td style="width: 20.36%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; height: 8.1pt;" colspan="2" width="20%">
      <p style="text-align: center;" align="center">
        <strong>DNAT</strong>
      </p>
    </td>
    
    <td style="width: 47.16%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; height: 8.1pt;" width="47%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">目的地址改写</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 32.48%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="32%">
      <p style="text-align: center;" align="center">
        <strong>-i</strong>
      </p>
      
      <p style="text-align: center;" align="center">
        <strong><span style="color: red;">[!]</span> --in-interface </strong>
      </p>
    </td>
    
    <td style="width: 67.52%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" colspan="3" width="67%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">在</span>INPUT<span style="font-family: '微软雅黑',sans-serif;">链配置规则中，指定从哪一个网卡接口进入的流量（只能配置在</span>INPUT<span style="font-family: '微软雅黑',sans-serif;">链上）</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 32.48%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="32%">
      <p style="text-align: center;" align="center">
        <strong>-o</strong>
      </p>
      
      <p style="text-align: center;" align="center">
        <strong><span style="color: red;">[!]</span> --out-interface </strong>
      </p>
    </td>
    
    <td style="width: 67.52%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" colspan="3" width="67%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">在</span>OUTPUT<span style="font-family: '微软雅黑',sans-serif;">链配置规则中，指定从哪一个网接口出去的流量（只能配置在</span>OUTPUT<span style="font-family: '微软雅黑',sans-serif;">链上）</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 32.48%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" valign="top" width="32%">
      <p style="text-align: center;" align="center">
        <strong>-s</strong>
      </p>
      
      <p style="text-align: center;" align="center">
        &nbsp;<strong><span style="color: red;">[!] --source&nbsp; </span></strong>
      </p>
    </td>
    
    <td style="width: 67.52%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" colspan="3" width="67%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">指定源</span>IP<span style="font-family: '微软雅黑',sans-serif;">地址或源网段信息</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 32.48%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" valign="top" width="32%">
      <p style="text-align: center;" align="center">
        <strong>-d</strong>
      </p>
      
      <p style="text-align: center;" align="center">
        <strong><span style="color: red;">[!]</span> --destination </strong>
      </p>
    </td>
    
    <td style="width: 67.52%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" colspan="3" width="67%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">指定目标</span>IP<span style="font-family: '微软雅黑',sans-serif;">地址或目标网段信息</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 100%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; background: #d99594; padding: 0cm 5.4pt;" colspan="4" width="100%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <strong><span style="font-family: '微软雅黑',sans-serif;">扩展参数</span></strong>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 32.48%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" rowspan="4" width="32%">
      <p style="text-align: center;" align="center">
        <strong>-m </strong><strong><span style="font-family: '微软雅黑',sans-serif;">模块</span></strong>
      </p>
    </td>
    
    <td style="width: 67.52%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; background: #92D050; padding: 0cm 5.4pt 0cm 5.4pt;" colspan="3" width="67%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">表示增加扩展，匹配功能扩展匹配（可以加载扩展参数）</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 18.98%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="18%">
      <p style="text-align: center;" align="center">
        <strong>multiport</strong>
      </p>
    </td>
    
    <td style="width: 48.54%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" colspan="2" width="48%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">实现不连续多端口扩展匹配</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 18.98%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="18%">
      <p style="text-align: center;" align="center">
        <strong>icmp</strong>
      </p>
    </td>
    
    <td style="width: 48.54%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" colspan="2" width="48%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">使用</span>icmp<span style="font-family: '微软雅黑',sans-serif;">的扩展</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 18.98%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="18%">
      <p style="text-align: center;" align="center">
        <strong>state</strong>
      </p>
    </td>
    
    <td style="width: 48.54%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" colspan="2" width="48%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">状态模块扩展</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 32.48%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="32%">
      <p style="text-align: center;" align="center">
        <strong>--icmp-type</strong>
      </p>
    </td>
    
    <td style="width: 67.52%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" colspan="3" width="67%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">只有类型</span>8<span style="font-family: '微软雅黑',sans-serif;">是真正会影响</span>ping<span style="font-family: '微软雅黑',sans-serif;">，或者也可以采用</span>any<span style="font-family: '微软雅黑',sans-serif;">；了解很多</span>icmp<span style="font-family: '微软雅黑',sans-serif;">类型</span><em>iptables -p icmp -h</em>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 32.48%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="32%">
      <p style="text-align: center;" align="center">
        <strong>--limit n/{second/minute/hour}</strong>
      </p>
    </td>
    
    <td style="width: 67.52%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" colspan="3" width="67%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">指定时间内的请求速率&rdquo;</span>n<span style="font-family: '微软雅黑',sans-serif;">&rdquo;为速率，后面为时间分别为：秒</span> <span style="font-family: '微软雅黑',sans-serif;">分</span> <span style="font-family: '微软雅黑',sans-serif;">时</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 32.48%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="32%">
      <p style="text-align: center;" align="center">
        <strong>--limit-burst [n]</strong>
      </p>
    </td>
    
    <td style="width: 67.52%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" colspan="3" width="67%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">在同一时间内允许通过的请求&rdquo;</span>n<span style="font-family: '微软雅黑',sans-serif;">&rdquo;为数字，不指定默认为</span>5
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 32.48%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="32%">
      <p style="text-align: center;" align="center">
        <strong>--exact/-x</strong>
      </p>
    </td>
    
    <td style="width: 67.52%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" colspan="3" width="67%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">扩展数字（显示精确数值）</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="border-width: initial; border-style: none; border-color: initial;" width="282">
      &nbsp;
    </td>
    
    <td style="border-width: initial; border-style: none; border-color: initial;" width="129">
      &nbsp;
    </td>
    
    <td style="border-width: initial; border-style: none; border-color: initial;" width="9">
      &nbsp;
    </td>
    
    <td style="border-width: initial; border-style: none; border-color: initial;" width="287">
      &nbsp;
    </td>
  </tr>
</table>

**<span style="color: red; background: yellow;">!</span>****<span style="font-family: '微软雅黑',sans-serif; courier new"4courier new"; color: red; background: yellow;">的使用实例</span>**

<div class="cnblogs_code">
  <pre>[root@clsn ~]<span style="color: #008000;">#</span><span style="color: #008000;"> iptables ! -V</span>
Not 1.4.7 ;-<span style="color: #000000;">)
[root@clsn </span>~]<span style="color: #008000;">#</span><span style="color: #008000;"> iptables  -V</span>
iptables v1.4.7</pre>
</div>

<p style="text-indent: 15.75pt;">
  <span style="font-family: '微软雅黑',sans-serif;">注意：在</span>iptables<span style="font-family: '微软雅黑',sans-serif;">中所有链名必须大写，表明必须小写，动作必须大写，匹配必须小写。</span>
</p>

### <span id="152">1.5.2 <span style="font-family: '微软雅黑',sans-serif;">配置前准备</span></span>

<span style="font-family: '微软雅黑',sans-serif;">在配置防火墙首先要其中防火墙</span>

<div class="cnblogs_code">
  <pre>[root@clsn ~]<span style="color: #008000;">#</span><span style="color: #008000;"> /etc/init.d/iptables start </span>
iptables: Applying firewall rules:                         [  OK  ]</pre>
</div>

<span style="font-family: '微软雅黑',sans-serif;">清除</span>iptables<span style="font-family: '微软雅黑',sans-serif;">所有规则</span>

<div class="cnblogs_code">
  <pre>[root@clsn ~]<span style="color: #008000;">#</span><span style="color: #008000;"> iptables -Z</span>
[root@clsn ~]<span style="color: #008000;">#</span><span style="color: #008000;"> iptables -X</span>
[root@clsn ~]<span style="color: #008000;">#</span><span style="color: #008000;"> iptables -F</span></pre>
</div>

<span style="font-family: '微软雅黑',sans-serif;">查看</span>iptables<span style="font-family: '微软雅黑',sans-serif;">的规则</span>

<div class="cnblogs_code">
  <pre>[root@clsn ~]<span style="color: #008000;">#</span><span style="color: #008000;"> iptables -nvL</span>
<span style="color: #000000;">Chain INPUT (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt </span><span style="color: #0000ff;">in</span><span style="color: #000000;">     out     source               destination         

Chain FORWARD (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt </span><span style="color: #0000ff;">in</span><span style="color: #000000;">     out     source               destination         

Chain OUTPUT (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt </span><span style="color: #0000ff;">in</span>     out     source               destination</pre>
</div>

<span style="font-family: '微软雅黑',sans-serif;">查看其他的表配置（</span>-t <span style="font-family: '微软雅黑',sans-serif;">参数）</span>

<div class="cnblogs_code">
  <pre>[root@clsn ~]<span style="color: #008000;">#</span><span style="color: #008000;"> iptables -nL -t raw</span>
<span style="color: #000000;">Chain PREROUTING (policy ACCEPT)
target     prot opt source               destination         

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination</span></pre>
</div>

<span style="font-family: '微软雅黑',sans-serif;">查看配置规则的顺序号</span>

<div class="cnblogs_code">
  <pre>[root@clsn ~]<span style="color: #008000;">#</span><span style="color: #008000;"> iptables -nvL --number-list</span>
--line-number <span style="color: #008000;">#</span><span style="color: #008000;">  显示规则的序号</span></pre>
</div>

## <span id="16_iptables_filter">1.6 iptables filter<span style="font-family: '微软雅黑',sans-serif;">表配置实例</span></span>

### <span id="161">1.6.1 <span style="font-family: '微软雅黑',sans-serif;">基础配置</span></span>

**<span style="font-family: '微软雅黑',sans-serif; courier new"4courier new";background: yellow;">配置实例一：</span>**<span style="font-family: '微软雅黑',sans-serif;">配置</span>22/ssh<span style="font-family: '微软雅黑',sans-serif;">端口访问控制规则</span>

<div class="cnblogs_code">
  <pre>iptables -A INPUT -p tcp --dprot 22 -j DROP     <span style="color: #008000;">#</span><span style="color: #008000;"> 禁止所有人访问22端口</span>
iptables -I INPUT -p tcp --dprot 22 -j ACCEPT   <span style="color: #008000;">#</span><span style="color: #008000;"> 恢复连接方法</span>
iptables -I INPUT 2 -p tcp --dprot 22 -j ACCEPT <span style="color: #008000;">#</span><span style="color: #008000;"> 通过插入指定行号信息，指定将规则插入到第几行</span>
iptables -D INPUT -p tcp --dport 22 -j ACCEPT   <span style="color: #008000;">#</span><span style="color: #008000;"> 删除指定规则</span>
iptables -D INPUT 2                             <span style="color: #008000;">#</span><span style="color: #008000;"> 根据规则行号，删除相应的规则</span></pre>
</div>

<p style="text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif;">只允许</span>10.0.0.1<span style="font-family: '微软雅黑',sans-serif;">的</span>ip<span style="font-family: '微软雅黑',sans-serif;">通过</span>ssh<span style="font-family: '微软雅黑',sans-serif;">连接这台服务器</span>
</p>

<div class="cnblogs_code">
  <pre>iptables -I INPUT -s 10.0.0.1 -p tcp --dport 22 -j ACCEPT<span style="text-indent: 21pt;">&nbsp;</span></pre>
</div>

<span style="font-family: '微软雅黑',sans-serif; courier new"4courier new";background: yellow;">配置实例二：</span><span style="font-family: '微软雅黑',sans-serif;">禁止网段连入（禁止</span>172.16.1.0<span style="font-family: '微软雅黑',sans-serif;">网段访问</span>172.16.1.188<span style="font-family: '微软雅黑',sans-serif;">）</span>

<div class="cnblogs_code">
  <pre>iptables -A INPUT  -s 172.16.1.0/24 -d 172.16.1.188  -j DROP</pre>
</div>

<span style="font-family: '微软雅黑',sans-serif; courier new"4courier new";background: yellow;">配置实例三：</span><span style="font-family: '微软雅黑',sans-serif;">禁止某个</span>172.16.1.0<span style="font-family: '微软雅黑',sans-serif;">网段访问服务器主机的</span>22<span style="font-family: '微软雅黑',sans-serif;">端口</span>

<div class="cnblogs_code">
  <pre>iptables -A INPUT -s 172.16.1.0/24 -d 172.16.1.188  -p tcp --dport 22 -j DROP</pre>
</div>

<span style="font-family: '微软雅黑',sans-serif;">方向说明：</span>

<div class="cnblogs_code">
  <pre><span style="color: #008000;">#</span><span style="color: #008000;"> 在入方向控制</span>
iptables -I INPUT -i eth0  -p tcp --dport 22 -<span style="color: #000000;">j ACCEPT
</span><span style="color: #008000;">#</span><span style="color: #008000;"> 在出方向控制</span>
iptables -I OUTPUT -o eth0  -p tcp --sport 22 -j DROP</pre>
</div>

### <span id="162_10000">1.6.2 <span style="font-family: '微软雅黑',sans-serif; courier new"4courier new";background: yellow;">配置实例四：</span><span style="font-family: '微软雅黑',sans-serif;">除</span>10.0.0.0<span style="font-family: '微软雅黑',sans-serif;">网段可以进行连接服务器主机意外，其余网段都禁止</span></span>

&nbsp;_&nbsp;__<span style="font-family: '微软雅黑',sans-serif;">第一种方式：</span>_

<div class="cnblogs_code">
  <pre>iptables -A INPUT -s 10.0.0.0/24 -d 172.16.1.8  -j ACCEPT</pre>
</div>

&nbsp;&nbsp; <span style="font-family: '微软雅黑',sans-serif;">修改默认规则，将默认规则改为拒绝</span>

<p style="text-indent: 12.0pt;">
  <em><span style="font-family: '微软雅黑',sans-serif;">第二种方式：</span></em>
</p>

&nbsp;&nbsp; <span style="font-family: '微软雅黑',sans-serif; courier new"4courier new";background: yellow;">！</span><span style="background: yellow;">&nbsp; --- </span><span style="font-family: '微软雅黑',sans-serif; courier new"4courier new"; background: yellow;">表示对规则信息进行取反</span>

<div class="cnblogs_code">
  <pre>iptables -A INPUT ! -s 10.0.0.0/24 -d 172.16.1.8  -j DROP   ---<span style="color: #000000;"> centos6用法
iptables </span>-A INPUT -s ! 10.0.0.0/24 -d 172.16.1.8  -j DROP   --- centos5用法</pre>
</div>

<p style="text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif;">说明：只有</span>iptables<span style="font-family: '微软雅黑',sans-serif;">帮助手册中指定的参数可以用取反符号（</span>iptables --help<span style="font-family: '微软雅黑',sans-serif;">）</span>
</p>

### <span id="163">1.6.3 <span style="font-family: '微软雅黑',sans-serif; courier new"4courier new";background: yellow;">配置实例五：</span><span style="font-family: '微软雅黑',sans-serif;">测试匹配列举端口范围。</span></span>

<div class="cnblogs_code">
  <pre>iptables -A INPUT -p tcp --dport 22:80 -j DROP                 <span style="color: #008000;">#</span><span style="color: #008000;"> 设置连续多端口控制策略</span>
iptables -A INPUT -p tcp -m multiport  --dport 22,80 -j DROP   <span style="color: #008000;">#</span><span style="color: #008000;"> 设置不连续多端口控制策略</span></pre>
</div>

&nbsp;&nbsp; -m <span style="font-family: '微软雅黑',sans-serif;">参数表示增加扩展匹配功能，</span>multiport <span style="font-family: '微软雅黑',sans-serif;">实现不连续多端口扩展匹配</span>

### <span id="164_ICMP">1.6.4 <span style="font-family: '微软雅黑',sans-serif; courier new"4courier new";background: yellow;">配置实例六：</span><span style="font-family: '微软雅黑',sans-serif;">匹配</span>ICMP<span style="font-family: '微软雅黑',sans-serif;">类型</span></span>

&nbsp;&nbsp; <span style="font-family: '微软雅黑',sans-serif;">禁止</span>ping<span style="font-family: '微软雅黑',sans-serif;">策略原则</span>

&nbsp;&nbsp; iptables<span style="font-family: '微软雅黑',sans-serif;">服务器是</span>ping<span style="font-family: '微软雅黑',sans-serif;">命令发起者或是接受者</span>

<p style="text-indent: 21.0pt;">
  <strong><span style="font-family: '微软雅黑',sans-serif; courier new"4courier new";background: lime;">发起者：</span></strong>
</p>

input<span style="font-family: '微软雅黑',sans-serif;">链：</span>&nbsp;<span style="font-family: '微软雅黑',sans-serif;">禁止</span>icmp-type 0&nbsp;

<div class="cnblogs_code">
  <pre>iptables -A INPUT -i eth0 -p icmp --icmp-type 0 -j DROP</pre>
</div>

output<span style="font-family: '微软雅黑',sans-serif;">链：</span> <span style="font-family: '微软雅黑',sans-serif;">禁止</span>icmp-type 8&nbsp;

<div class="cnblogs_code">
  <pre>iptables -A OUTPUT -o eth0 -p icmp --icmp-type 8 -j DROP</pre>
</div>

**&nbsp;&nbsp;** **<span style="font-family: '微软雅黑',sans-serif; courier new"4courier new";background: lime;">接受者：</span>**

input<span style="font-family: '微软雅黑',sans-serif;">链：</span>&nbsp;<span style="font-family: '微软雅黑',sans-serif;">禁止</span>icmp-type 8&nbsp;

<div class="cnblogs_code">
  <pre>iptables -A INPUT -i eth0 -p icmp --icmp-type 8 -j DROP</pre>
</div>

output<span style="font-family: '微软雅黑',sans-serif;">链：</span> <span style="font-family: '微软雅黑',sans-serif;">禁止</span>icmp-type 0&nbsp;

<div class="cnblogs_code">
  <pre>iptables -A OUTPUT -o eth0 -p icmp --icmp-type 0 -j DROP</pre>
</div>

<span style="font-family: '微软雅黑',sans-serif;">简化配置：</span>

<div class="cnblogs_code">
  <pre>iptables -A INPUT -i eth0 -p icmp -m icmp --icmp-type any -j DROP  <span style="color: #008000;">#</span><span style="color: #008000;">禁止所有类型的icmp</span></pre>
</div>

&nbsp;&nbsp; <span style="font-family: '微软雅黑',sans-serif;">指定类型禁止</span>icmp

<div class="cnblogs_code">
  <pre>iptables -A INPUT -p icmp --icmp-type 8<span style="color: #000000;">
iptables </span>-A INPUT -p icmp --icmp-type 8 -<span style="color: #000000;">j DROP
iptables </span>-A INPUT -p icmp -m icmp --icmp-type any -<span style="color: #000000;">j ACCEPT
iptables </span>-A FORWARD -s 192.168.1.0/24 -p icmp -m icmp --icmp-type any -j ACCEPT</pre>
</div>

&nbsp;&nbsp; <span style="font-family: '微软雅黑',sans-serif;">说明：只有类型</span>8<span style="font-family: '微软雅黑',sans-serif;">是真正会影响</span>ping<span style="font-family: '微软雅黑',sans-serif;">，或者也可以采用</span>any<span style="font-family: '微软雅黑',sans-serif;">；了解很多</span>icmp<span style="font-family: '微软雅黑',sans-serif;">类型</span>iptables -p icmp -h

**ICMP****<span style="font-family: '微软雅黑',sans-serif;">类型的说明</span>**

<table style="width: 100%; border-collapse: collapse; border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
  <tr>
    <td style="width: 11%; border-top: 1pt solid black; border-bottom: 1pt solid black; border-left: 1pt solid black; border-right: none; background: black; padding: 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 11.0pt; font-family: 'Verdana',sans-serif; color: white;">TYPE</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: solid black 1.0pt; border-left: none; border-bottom: solid black 1.0pt; border-right: none; background: black; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 11.0pt; font-family: 'Verdana',sans-serif; color: white;">CODE</span>
      </p>
    </td>
    
    <td style="width: 56.0%; border-top: solid black 1.0pt; border-left: none; border-bottom: solid black 1.0pt; border-right: none; background: black; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="56%">
      <p>
        <span style="font-size: 11.0pt; font-family: 'Verdana',sans-serif; color: white;">Description</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: solid black 1.0pt; border-left: none; border-bottom: solid black 1.0pt; border-right: none; background: black; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 11.0pt; font-family: 'Verdana',sans-serif; color: white;">Query</span>
      </p>
    </td>
    
    <td style="width: 11%; border-top: 1pt solid black; border-right: 1pt solid black; border-bottom: 1pt solid black; border-left: none; background: black; padding: 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 11.0pt; font-family: 'Verdana',sans-serif; color: white;">Error</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 11%; border-right: 1pt solid #666666; border-bottom: 1pt solid #666666; border-left: 1pt solid #666666; border-top: none; background: #ffc000; padding: 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;"></span></strong>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #FFC000; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;"></span>
      </p>
    </td>
    
    <td style="width: 56.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #FFC000; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="56%">
      <p>
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">Echo Reply&mdash;&mdash;</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">回显应答（</span><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">Ping</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">应答）</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #FFC000; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">x</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #FFC000; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 11%; border-right: 1pt solid #666666; border-bottom: 1pt solid #666666; border-left: 1pt solid #666666; border-top: none; padding: 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">3</span></strong>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;"></span>
      </p>
    </td>
    
    <td style="width: 56.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="56%">
      <p>
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">Network Unreachable&mdash;&mdash;</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">网络不可达</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">x</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 11%; border-right: 1pt solid #666666; border-bottom: 1pt solid #666666; border-left: 1pt solid #666666; border-top: none; background: #cccccc; padding: 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">3</span></strong>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">1</span>
      </p>
    </td>
    
    <td style="width: 56.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="56%">
      <p>
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">Host Unreachable&mdash;&mdash;</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">主机不可达</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">x</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 11%; border-right: 1pt solid #666666; border-bottom: 1pt solid #666666; border-left: 1pt solid #666666; border-top: none; padding: 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">3</span></strong>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">2</span>
      </p>
    </td>
    
    <td style="width: 56.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="56%">
      <p>
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">Protocol Unreachable&mdash;&mdash;</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">协议不可达</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">x</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 11%; border-right: 1pt solid #666666; border-bottom: 1pt solid #666666; border-left: 1pt solid #666666; border-top: none; background: #cccccc; padding: 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">3</span></strong>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">3</span>
      </p>
    </td>
    
    <td style="width: 56.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="56%">
      <p>
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">Port Unreachable&mdash;&mdash;</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">端口不可达</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">x</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 11%; border-right: 1pt solid #666666; border-bottom: 1pt solid #666666; border-left: 1pt solid #666666; border-top: none; padding: 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">3</span></strong>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">4</span>
      </p>
    </td>
    
    <td style="width: 56.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="56%">
      <p>
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">Fragmentation needed but no frag. bit set&mdash;&mdash;</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">需要进行分片但设置不分片比特</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">x</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 11%; border-right: 1pt solid #666666; border-bottom: 1pt solid #666666; border-left: 1pt solid #666666; border-top: none; background: #cccccc; padding: 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">3</span></strong>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">5</span>
      </p>
    </td>
    
    <td style="width: 56.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="56%">
      <p>
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">Source routing failed&mdash;&mdash;</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">源站选路失败</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">x</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 11%; border-right: 1pt solid #666666; border-bottom: 1pt solid #666666; border-left: 1pt solid #666666; border-top: none; padding: 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">3</span></strong>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">6</span>
      </p>
    </td>
    
    <td style="width: 56.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="56%">
      <p>
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">Destination network unknown&mdash;&mdash;</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">目的网络未知</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">x</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 11%; border-right: 1pt solid #666666; border-bottom: 1pt solid #666666; border-left: 1pt solid #666666; border-top: none; background: #cccccc; padding: 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">3</span></strong>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">7</span>
      </p>
    </td>
    
    <td style="width: 56.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="56%">
      <p>
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">Destination host unknown&mdash;&mdash;</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">目的主机未知</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">x</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 11%; border-right: 1pt solid #666666; border-bottom: 1pt solid #666666; border-left: 1pt solid #666666; border-top: none; padding: 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">3</span></strong>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">8</span>
      </p>
    </td>
    
    <td style="width: 56.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="56%">
      <p>
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">Source host isolated (obsolete)&mdash;&mdash;</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">源主机被隔离（作废不用）</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">x</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 11%; border-right: 1pt solid #666666; border-bottom: 1pt solid #666666; border-left: 1pt solid #666666; border-top: none; background: #cccccc; padding: 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">3</span></strong>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">9</span>
      </p>
    </td>
    
    <td style="width: 56.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="56%">
      <p>
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">Destination network administratively prohibited&mdash;&mdash;</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">目的网络被强制禁止</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">x</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 11%; border-right: 1pt solid #666666; border-bottom: 1pt solid #666666; border-left: 1pt solid #666666; border-top: none; padding: 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">3</span></strong>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">10</span>
      </p>
    </td>
    
    <td style="width: 56.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="56%">
      <p>
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">Destination host administratively prohibited&mdash;&mdash;</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">目的主机被强制禁止</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">x</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 11%; border-right: 1pt solid #666666; border-bottom: 1pt solid #666666; border-left: 1pt solid #666666; border-top: none; background: #cccccc; padding: 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">3</span></strong>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">11</span>
      </p>
    </td>
    
    <td style="width: 56.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="56%">
      <p>
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">Network unreachable for TOS&mdash;&mdash;</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">由于服务类型</span><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">TOS</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">，网络不可达</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">x</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 11%; border-right: 1pt solid #666666; border-bottom: 1pt solid #666666; border-left: 1pt solid #666666; border-top: none; padding: 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">3</span></strong>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">12</span>
      </p>
    </td>
    
    <td style="width: 56.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="56%">
      <p>
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">Host unreachable for TOS&mdash;&mdash;</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">由于服务类型</span><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">TOS</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">，主机不可达</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">x</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 11%; border-right: 1pt solid #666666; border-bottom: 1pt solid #666666; border-left: 1pt solid #666666; border-top: none; background: #cccccc; padding: 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">3</span></strong>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">13</span>
      </p>
    </td>
    
    <td style="width: 56.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="56%">
      <p>
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">Communication administratively prohibited by filtering&mdash;&mdash;</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">由于过滤，通信被强制禁止</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">x</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 11%; border-right: 1pt solid #666666; border-bottom: 1pt solid #666666; border-left: 1pt solid #666666; border-top: none; padding: 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">3</span></strong>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">14</span>
      </p>
    </td>
    
    <td style="width: 56.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="56%">
      <p>
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">Host precedence violation&mdash;&mdash;</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">主机越权</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">x</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 11%; border-right: 1pt solid #666666; border-bottom: 1pt solid #666666; border-left: 1pt solid #666666; border-top: none; background: #cccccc; padding: 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">3</span></strong>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">15</span>
      </p>
    </td>
    
    <td style="width: 56.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="56%">
      <p>
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">Precedence cutoff in effect&mdash;&mdash;</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">优先中止生效</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">x</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 11%; border-right: 1pt solid #666666; border-bottom: 1pt solid #666666; border-left: 1pt solid #666666; border-top: none; padding: 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">4</span></strong>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;"></span>
      </p>
    </td>
    
    <td style="width: 56.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="56%">
      <p>
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">Source quench&mdash;&mdash;</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">源端被关闭（基本流控制）</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 11%; border-right: 1pt solid #666666; border-bottom: 1pt solid #666666; border-left: 1pt solid #666666; border-top: none; background: #cccccc; padding: 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">5</span></strong>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;"></span>
      </p>
    </td>
    
    <td style="width: 56.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="56%">
      <p>
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">Redirect for network&mdash;&mdash;</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">对网络重定向</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 11%; border-right: 1pt solid #666666; border-bottom: 1pt solid #666666; border-left: 1pt solid #666666; border-top: none; padding: 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">5</span></strong>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">1</span>
      </p>
    </td>
    
    <td style="width: 56.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="56%">
      <p>
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">Redirect for host&mdash;&mdash;</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">对主机重定向</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 11%; border-right: 1pt solid #666666; border-bottom: 1pt solid #666666; border-left: 1pt solid #666666; border-top: none; background: #cccccc; padding: 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">5</span></strong>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">2</span>
      </p>
    </td>
    
    <td style="width: 56.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="56%">
      <p>
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">Redirect for TOS and network&mdash;&mdash;</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">对服务类型和网络重定向</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 11%; border-right: 1pt solid #666666; border-bottom: 1pt solid #666666; border-left: 1pt solid #666666; border-top: none; padding: 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">5</span></strong>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">3</span>
      </p>
    </td>
    
    <td style="width: 56.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="56%">
      <p>
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">Redirect for TOS and host&mdash;&mdash;</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">对服务类型和主机重定向</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 11%; border-right: 1pt solid #666666; border-bottom: 1pt solid #666666; border-left: 1pt solid #666666; border-top: none; background: #ffc000; padding: 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">8</span></strong>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #FFC000; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;"></span>
      </p>
    </td>
    
    <td style="width: 56.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #FFC000; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="56%">
      <p>
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">Echo request&mdash;&mdash;</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">回显请求（</span><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">Ping</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">请求）</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #FFC000; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">x</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #FFC000; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 11%; border-right: 1pt solid #666666; border-bottom: 1pt solid #666666; border-left: 1pt solid #666666; border-top: none; padding: 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">9</span></strong>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;"></span>
      </p>
    </td>
    
    <td style="width: 56.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="56%">
      <p>
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">Router advertisement&mdash;&mdash;</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">路由器通告</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 11%; border-right: 1pt solid #666666; border-bottom: 1pt solid #666666; border-left: 1pt solid #666666; border-top: none; background: #cccccc; padding: 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">10</span></strong>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;"></span>
      </p>
    </td>
    
    <td style="width: 56.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="56%">
      <p>
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">Route solicitation&mdash;&mdash;</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">路由器请求</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 11%; border-right: 1pt solid #666666; border-bottom: 1pt solid #666666; border-left: 1pt solid #666666; border-top: none; padding: 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">11</span></strong>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;"></span>
      </p>
    </td>
    
    <td style="width: 56.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="56%">
      <p>
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">TTL equals 0 during transit&mdash;&mdash;</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">传输期间生存时间为</span><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;"></span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">x</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 11%; border-right: 1pt solid #666666; border-bottom: 1pt solid #666666; border-left: 1pt solid #666666; border-top: none; background: #cccccc; padding: 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">11</span></strong>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">1</span>
      </p>
    </td>
    
    <td style="width: 56.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="56%">
      <p>
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">TTL equals 0 during reassembly&mdash;&mdash;</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">在数据报组装期间生存时间为</span><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;"></span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">x</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 11%; border-right: 1pt solid #666666; border-bottom: 1pt solid #666666; border-left: 1pt solid #666666; border-top: none; padding: 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">12</span></strong>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;"></span>
      </p>
    </td>
    
    <td style="width: 56.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="56%">
      <p>
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">IP header bad (catchall error)&mdash;&mdash;</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">坏的</span><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">IP</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">首部（包括各种差错）</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">x</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 11%; border-right: 1pt solid #666666; border-bottom: 1pt solid #666666; border-left: 1pt solid #666666; border-top: none; background: #cccccc; padding: 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">12</span></strong>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">1</span>
      </p>
    </td>
    
    <td style="width: 56.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="56%">
      <p>
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">Required options missing&mdash;&mdash;</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">缺少必需的选项</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">x</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 11%; border-right: 1pt solid #666666; border-bottom: 1pt solid #666666; border-left: 1pt solid #666666; border-top: none; padding: 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">13</span></strong>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;"></span>
      </p>
    </td>
    
    <td style="width: 56.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="56%">
      <p>
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">Timestamp request (obsolete)&mdash;&mdash;</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">时间戳请求（作废不用）</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">x</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 11%; border-right: 1pt solid #666666; border-bottom: 1pt solid #666666; border-left: 1pt solid #666666; border-top: none; background: #cccccc; padding: 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">14</span></strong>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
    
    <td style="width: 56.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="56%">
      <p>
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">Timestamp reply (obsolete)&mdash;&mdash;</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">时间戳应答（作废不用）</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">x</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 11%; border-right: 1pt solid #666666; border-bottom: 1pt solid #666666; border-left: 1pt solid #666666; border-top: none; padding: 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">15</span></strong>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;"></span>
      </p>
    </td>
    
    <td style="width: 56.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="56%">
      <p>
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">Information request (obsolete)&mdash;&mdash;</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">信息请求（作废不用）</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">x</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 11%; border-right: 1pt solid #666666; border-bottom: 1pt solid #666666; border-left: 1pt solid #666666; border-top: none; background: #cccccc; padding: 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">16</span></strong>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;"></span>
      </p>
    </td>
    
    <td style="width: 56.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="56%">
      <p>
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">Information reply (obsolete)&mdash;&mdash;</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">信息应答（作废不用）</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">x</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 11%; border-right: 1pt solid #666666; border-bottom: 1pt solid #666666; border-left: 1pt solid #666666; border-top: none; padding: 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">17</span></strong>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;"></span>
      </p>
    </td>
    
    <td style="width: 56.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="56%">
      <p>
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">Address mask request&mdash;&mdash;</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">地址掩码请求</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">x</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 11%; border-right: 1pt solid #666666; border-bottom: 1pt solid #666666; border-left: 1pt solid #666666; border-top: none; background: #cccccc; padding: 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">18</span></strong>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      <p style="text-align: center;" align="center">
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;"></span>
      </p>
    </td>
    
    <td style="width: 56.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="56%">
      <p>
        <span style="font-size: 9.0pt; font-family: 'Verdana',sans-serif;">Address mask reply&mdash;&mdash;</span><span style="font-size: 9.0pt; font-family: '微软雅黑',sans-serif;">地址掩码应答</span>
      </p>
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      &nbsp;
    </td>
    
    <td style="width: 11.0%; border-top: none; border-left: none; border-bottom: solid #666666 1.0pt; border-right: solid #666666 1.0pt; background: #CCCCCC; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="11%">
      &nbsp;
    </td>
  </tr>
</table>

<p style="text-align: right;" align="right">
  <span style="font-family: '微软雅黑',sans-serif;">数据来源：</span>http://www.cnitblog.com/yang55xiaoguang/articles/59581.html
</p>

### <span id="165">1.6.5 <span style="font-family: '微软雅黑',sans-serif;">防火墙状态机制配置</span></span>

<span style="font-family: '微软雅黑',sans-serif;">状态集简单说明</span>:

<table style="width: 100%; border-collapse: collapse; border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
  <tr>
    <td style="width: 50%; border-top: 1pt solid #9bbb59; border-bottom: 1pt solid #9bbb59; border-left: 1pt solid #9bbb59; border-right: none; background: #9bbb59; padding: 0cm 5.4pt;" valign="top" width="50%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: '微软雅黑',sans-serif; courier new"4courier new";color: white;">状态集</span></strong>
      </p>
    </td>
    
    <td style="width: 50%; border-top: 1pt solid #9bbb59; border-right: 1pt solid #9bbb59; border-bottom: 1pt solid #9bbb59; border-left: none; background: #9bbb59; padding: 0cm 5.4pt;" valign="top" width="50%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: '微软雅黑',sans-serif; courier new"4courier new";color: white;">说明</span></strong>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 50%; border-right: 1pt solid #c2d69b; border-bottom: 1pt solid #c2d69b; border-left: 1pt solid #c2d69b; border-top: none; background: #eaf1dd; padding: 0cm 5.4pt;" valign="top" width="50%">
      <p style="text-align: center;" align="center">
        <strong>NEW</strong>
      </p>
    </td>
    
    <td style="width: 50.0%; border-top: none; border-left: none; border-bottom: solid #C2D69B 1.0pt; border-right: solid #C2D69B 1.0pt; background: #EAF1DD; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="50%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">表示新建立连接的数据包状态</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 50%; border-right: 1pt solid #c2d69b; border-bottom: 1pt solid #c2d69b; border-left: 1pt solid #c2d69b; border-top: none; padding: 0cm 5.4pt;" valign="top" width="50%">
      <p style="text-align: center;" align="center">
        <strong>ESTABLISHED</strong>
      </p>
    </td>
    
    <td style="width: 50.0%; border-top: none; border-left: none; border-bottom: solid #C2D69B 1.0pt; border-right: solid #C2D69B 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="50%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">表示新建立连接数据包发送之后，回复响应的数据包状态</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 50%; border-right: 1pt solid #c2d69b; border-bottom: 1pt solid #c2d69b; border-left: 1pt solid #c2d69b; border-top: none; background: #eaf1dd; padding: 0cm 5.4pt;" valign="top" width="50%">
      <p style="text-align: center;" align="center">
        <strong>RELATED</strong>
      </p>
    </td>
    
    <td style="width: 50.0%; border-top: none; border-left: none; border-bottom: solid #C2D69B 1.0pt; border-right: solid #C2D69B 1.0pt; background: #EAF1DD; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="50%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">表示借助已经建立的链路，发送新的连接数据包</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 50%; border-right: 1pt solid #c2d69b; border-bottom: 1pt solid #c2d69b; border-left: 1pt solid #c2d69b; border-top: none; padding: 0cm 5.4pt;" valign="top" width="50%">
      <p style="text-align: center;" align="center">
        <strong>INVALID</strong>
      </p>
    </td>
    
    <td style="width: 50.0%; border-top: none; border-left: none; border-bottom: solid #C2D69B 1.0pt; border-right: solid #C2D69B 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="50%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">无效无法识别的数据包</span>
      </p>
    </td>
  </tr>
</table>

<p style="margin-left: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif;">注意：允许关联的状态包通过（</span>web<span style="font-family: '微软雅黑',sans-serif;">服务不要使用</span>FTP<span style="font-family: '微软雅黑',sans-serif;">服务）</span>
</p>

<span style="font-family: '微软雅黑',sans-serif;">防火墙服务配置在</span>FTP<span style="font-family: '微软雅黑',sans-serif;">服务器上时，需要配置以下策略</span>

&nbsp;

<div class="cnblogs_code">
  <pre>iptables -A INPUT -m state --state ESTABLISHED,RELATED -<span style="color: #000000;">j ACCEPT
iptables </span>-A OUTPUT -m state --state ESTABLISHED,RELATED -j ACCEPT</pre>
</div>

<span style="font-family: '微软雅黑',sans-serif;">实现发现</span>sent_syn<span style="font-family: '微软雅黑',sans-serif;">状态</span>

<div class="cnblogs_code">
  <pre>iptables -A INPUT -m state --state NEW -j DROP    <span style="color: #008000;">#</span><span style="color: #008000;"> 防火墙所连接客户端上配置</span></pre>
</div>

<span style="font-family: '微软雅黑',sans-serif;">实现发现</span>sent_rcvd<span style="font-family: '微软雅黑',sans-serif;">状态</span>

<div class="cnblogs_code">
  <pre>iptables -I INPUT -i eth0 -s 10.0.0.201 -m state --state ESTABLISHED -j DROP  <span style="color: #008000;">#</span><span style="color: #008000;"> 防护墙上配置的</span></pre>
</div>

### <span id="166_iptables">1.6.6 <span style="font-family: '微软雅黑',sans-serif;">使用</span>iptables<span style="font-family: '微软雅黑',sans-serif;">实现限速功能</span></span>

<p style="text-indent: 21.0pt;">
  limit<span style="font-family: '微软雅黑',sans-serif;">是</span>iptables<span style="font-family: '微软雅黑',sans-serif;">的一个匹配模块，用它结合</span>iptables<span style="font-family: '微软雅黑',sans-serif;">的其它命令可以实现限速的功能。</span>
</p>

<p style="text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif;">不过首先必须明确，</span>limit<span style="font-family: '微软雅黑',sans-serif;">本身只是一个&ldquo;匹配&rdquo;模块。我们知道，</span>iptables<span style="font-family: '微软雅黑',sans-serif;">的基本原理是&ldquo;匹配</span>--<span style="font-family: '微软雅黑',sans-serif;">处理&rdquo;，</span>limit<span style="font-family: '微软雅黑',sans-serif;">在这个工作过程中只能起到匹配的作用，它本身是无法对网络数据包进行任何处理的。我看到网上有些</span>limit<span style="font-family: '微软雅黑',sans-serif;">的例子里面说只</span> <span style="font-family: '微软雅黑',sans-serif;">用一条包含</span>limit<span style="font-family: '微软雅黑',sans-serif;">匹配规则的</span>iptables<span style="font-family: '微软雅黑',sans-serif;">语句就可以实现限速，那是错误的。</span>
</p>

<p style="text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif;">实际上，利用</span>imit<span style="font-family: '微软雅黑',sans-serif;">来限速需要包括两个步骤</span>:
</p>

<p style="text-indent: 21.0pt;">
  1.<span style="font-family: '微软雅黑',sans-serif;">对符合</span>limit<span style="font-family: '微软雅黑',sans-serif;">匹配规则包放行</span>
</p>

<p style="text-indent: 21.0pt;">
  2.<span style="font-family: '微软雅黑',sans-serif;">丢弃</span>/<span style="font-family: '微软雅黑',sans-serif;">拒绝未放行的包</span>
</p>

<span style="font-family: '微软雅黑',sans-serif;">示例：</span>

<div class="cnblogs_code">
  <pre>iptables -I INPUT -s 10.0.0.7 -p icmp --icmp-type 8 -m limit --limit 6/min --limit-burst 5 -<span style="color: #000000;">j ACCEPT 
iptables </span>-I INPUT -s 10.0.0.7 -p icmp --icmp-type 8 -j DROP</pre>
</div>

&nbsp;&nbsp; <span style="font-family: '微软雅黑',sans-serif;">语句含义：当来自</span>10.0.0.7 <span style="font-family: '微软雅黑',sans-serif;">的</span>ping<span style="font-family: '微软雅黑',sans-serif;">包超过</span>5<span style="font-family: '微软雅黑',sans-serif;">个时进行限速，限制为每</span>10s<span style="font-family: '微软雅黑',sans-serif;">一个。</span>

<span style="font-family: '微软雅黑',sans-serif;">参数说明：</span>

<table style="width: 100%; border-collapse: collapse; border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
  <tr>
    <td style="width: 44.7%; border-top: 1pt solid #9bbb59; border-bottom: 1pt solid #9bbb59; border-left: 1pt solid #9bbb59; border-right: none; background: #9bbb59; padding: 0cm 5.4pt;" width="44%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: '微软雅黑',sans-serif; courier new"4courier new";color: white;">参数</span></strong>
      </p>
    </td>
    
    <td style="width: 55.3%; border-top: 1pt solid #9bbb59; border-right: 1pt solid #9bbb59; border-bottom: 1pt solid #9bbb59; border-left: none; background: #9bbb59; padding: 0cm 5.4pt;" width="55%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: '微软雅黑',sans-serif; courier new"4courier new";color: white;">参数含义</span></strong>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 44.7%; border-right: 1pt solid #c2d69b; border-bottom: 1pt solid #c2d69b; border-left: 1pt solid #c2d69b; border-top: none; background: #eaf1dd; padding: 0cm 5.4pt;" width="44%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <strong>--limit n/{second/minute/hour}</strong>
      </p>
    </td>
    
    <td style="width: 55.3%; border-top: none; border-left: none; border-bottom: solid #C2D69B 1.0pt; border-right: solid #C2D69B 1.0pt; background: #EAF1DD; padding: 0cm 5.4pt 0cm 5.4pt;" width="55%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">指定时间内的请求速率&rdquo;</span>n<span style="font-family: '微软雅黑',sans-serif;">&rdquo;为速率，后面为时间分别为：秒</span> <span style="font-family: '微软雅黑',sans-serif;">分</span> <span style="font-family: '微软雅黑',sans-serif;">时</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 44.7%; border-right: 1pt solid #c2d69b; border-bottom: 1pt solid #c2d69b; border-left: 1pt solid #c2d69b; border-top: none; padding: 0cm 5.4pt;" width="44%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <strong>--limit-burst [n]</strong>
      </p>
    </td>
    
    <td style="width: 55.3%; border-top: none; border-left: none; border-bottom: solid #C2D69B 1.0pt; border-right: solid #C2D69B 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="55%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">在同一时间内允许通过的请求&rdquo;</span>n<span style="font-family: '微软雅黑',sans-serif;">&rdquo;为数字，不指定默认为</span>5
      </p>
    </td>
  </tr>
</table>

**<span style="background: yellow;">limit</span>****<span style="font-family: '微软雅黑',sans-serif; courier new"4courier new"; background: yellow;">模块具体是如何工作的。？</span>**

<p style="text-indent: 21.0pt;">
  limit<span style="font-family: '微软雅黑',sans-serif;">的匹配是基于<span style="text-decoration: underline;">令牌桶</span></span><span style="text-decoration: underline;"> (Token bucket</span><span style="text-decoration: underline;"><span style="font-family: '微软雅黑',sans-serif;">）</span></span><span style="font-family: '微软雅黑',sans-serif;">模型的。</span>
</p>

<p style="text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif;">令牌桶是一种网络通讯中常见的缓冲区工作原理，它有两个重要的参数，令牌桶容量</span>n<span style="font-family: '微软雅黑',sans-serif;">和令牌产生速率</span>s<span style="font-family: '微软雅黑',sans-serif;">。</span>
</p>

> <p style="text-indent: 21.0pt;">
>   <span style="font-family: '微软雅黑',sans-serif;">我们可以把令牌当成是门票，而令牌桶则是负责制作和发放门票的管理员，它手里最多有n张令牌。一开始，管理员开始手里有n张令牌。每当一个数据包到达后，管理员就看看手里是否还有可用的令牌。如果有，就把令牌发给这个数据包，limit就告诉iptables，这个数据包被匹配了。而当管理员把手上所有的令牌都发完了，再来的数据包就拿不到令牌了。这时，limit模块就告诉iptables，这个数据包不能被匹配。除了发放令牌之外，只要令牌桶中的令牌数量少于n，它就会以速率s来产生新的令牌，直到令牌数量到达n为止。</span>
> </p>

<p style="text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif;">通过令牌桶机制，即可以有效的控制单位时间内通过（匹配）的数据包数量，又可以容许短时间内突发的大量数据包的通过（只要数据包数量不超过令牌桶</span>n<span style="font-family: '微软雅黑',sans-serif;">）。</span>
</p>

<p style="text-indent: 21.0pt;">
  <span style="text-decoration: underline;">limit</span><span style="text-decoration: underline;"><span style="font-family: '微软雅黑',sans-serif;">模块提供了两个参数</span>--limit</span><span style="text-decoration: underline;"><span style="font-family: '微软雅黑',sans-serif;">和</span>--limit-burst</span><span style="font-family: '微软雅黑',sans-serif;">，分别对应于令牌产生速率和令牌桶容量。除了令牌桶模型外，</span>limit<span style="font-family: '微软雅黑',sans-serif;">匹配的另外一个重要概念是匹配项。在</span>limit<span style="font-family: '微软雅黑',sans-serif;">中，每个匹配项拥有一个单独的令牌桶，执行独立的匹配计算。</span>
</p>

### <span id="167">1.6.7 <span style="font-family: '微软雅黑',sans-serif;">企业级防火墙配置</span></span>

<span style="font-family: '微软雅黑',sans-serif;">清除防火墙规则</span>

<div class="cnblogs_code">
  <pre>[root@clsn ~]<span style="color: #008000;">#</span><span style="color: #008000;"> iptables -F</span>
[root@clsn ~]<span style="color: #008000;">#</span><span style="color: #008000;"> iptables -X</span>
[root@clsn ~]<span style="color: #008000;">#</span><span style="color: #008000;"> iptables -Z</span></pre>
</div>

<span style="font-family: '微软雅黑',sans-serif;">修改默认规则为拒绝（修改前先放行</span>22<span style="font-family: '微软雅黑',sans-serif;">端口，保证自己能够连上主机）</span>

<div class="cnblogs_code">
  <pre>[root@clsn ~]<span style="color: #008000;">#</span><span style="color: #008000;"> iptables -A INPUT -p tcp --dport  22 -j ACCEPT</span>
[root@clsn ~]<span style="color: #008000;">#</span><span style="color: #008000;"> iptables -P INPUT DROP </span>
[root@clsn ~]<span style="color: #008000;">#</span><span style="color: #008000;"> iptables -P FORWARD DROP</span></pre>
</div>

<span style="font-family: '微软雅黑',sans-serif;">放行指定的端口</span>

<div class="cnblogs_code">
  <pre>[root@clsn ~]<span style="color: #008000;">#</span><span style="color: #008000;"> iptables -A INPUT -i lo -j ACCEPT</span>
[root@clsn ~]<span style="color: #008000;">#</span><span style="color: #008000;"> iptables -A INPUT  -p tcp  -m multiport --dport  80,443 -j ACCEPT</span>
[root@clsn ~]<span style="color: #008000;">#</span><span style="color: #008000;"> iptables -A INPUT -s 172.16.1.0/24 -j ACCEPT</span>
[root@clsn ~]<span style="color: #008000;">#</span><span style="color: #008000;"> iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT</span></pre>
</div>

**<span style="font-family: '微软雅黑',sans-serif; courier new"4courier new";background: yellow;">保存</span><span style="background: yellow;">iptables</span>****<span style="font-family: '微软雅黑',sans-serif; courier new"4courier new"; background: yellow;">配置</span>**

<p style="text-indent: 15.75pt;">
  01. <span style="font-family: '微软雅黑',sans-serif;">第一种方式</span>
</p>

<div class="cnblogs_code">
  <pre>[root@clsn ~]<span style="color: #008000;">#</span><span style="color: #008000;"> /etc/init.d/iptables save</span>
iptables: Saving firewall rules to /etc/sysconfig/<span style="color: #000000;">iptables:[  OK  ]
[root@clsn </span>~]<span style="color: #008000;">#</span><span style="color: #008000;"> cat /etc/sysconfig/iptables</span><span style="color: #008000;">
#</span><span style="color: #008000;"> Generated by iptables-save v1.4.7 on Tue Apr  4 12:24:43 2017</span>
*<span style="color: #000000;">filter
:INPUT DROP [0:0]
:FORWARD DROP [0:0]
:OUTPUT ACCEPT [</span>159:10664<span style="color: #000000;">]
</span>-A INPUT -s 10.0.0.0/24 -<span style="color: #000000;">j ACCEPT 
</span>-A INPUT -p tcp -m tcp --dport 22 -<span style="color: #000000;">j ACCEPT 
</span>-A INPUT -p tcp -m multiport --dports 80,443 -<span style="color: #000000;">j ACCEPT 
</span>-A INPUT -s 172.16.1.0/24 -<span style="color: #000000;">j ACCEPT 
</span>-A INPUT -i lo -<span style="color: #000000;">j ACCEPT 
</span>-A INPUT -m state --state RELATED,ESTABLISHED -<span style="color: #000000;">j ACCEPT 
COMMIT
</span><span style="color: #008000;">#</span><span style="color: #008000;"> Completed on Tue Apr  4 12:24:43 2017</span></pre>
</div>

<p style="text-indent: 15.75pt;">
  02. <span style="font-family: '微软雅黑',sans-serif;">第二种方式</span>
</p>

<div class="cnblogs_code">
  <pre>iptables-save >/etc/sysconfig/iptables</pre>
</div>

## <span id="17_iptables_nat">1.7 iptables nat<span style="font-family: '微软雅黑',sans-serif;">表配置实例</span></span>

### <span id="171_iptables">1.7.1 iptables<span style="font-family: '微软雅黑',sans-serif;">实现共享上网</span></span>

<p style="text-align: center;" align="center">
  &nbsp;<img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20180118095907193-681615791.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="企业防火墙之iptables" alt="" />
</p>

<p style="text-align: center;" align="center">
  <span style="font-family: '微软雅黑',sans-serif;">图</span> - SNAT <span style="font-family: '微软雅黑',sans-serif;">配置原理图</span>
</p>

<p style="text-indent: 7.1pt;">
  <span style="font-family: '微软雅黑',sans-serif;">第一个里程碑：配置内网服务器，设置网关地址</span>
</p>

<div class="cnblogs_code">
  <pre>/etc/init.d/iptables stop      <span style="color: #008000;">#</span><span style="color: #008000;"> 内网服务器停止防火墙服务</span>
ifdown eth0                    <span style="color: #008000;">#</span><span style="color: #008000;"> 模拟关闭内网服务器外网网卡</span>
setup                          <span style="color: #008000;">#</span><span style="color: #008000;"> 修改内网网卡网关和DNS地址信息</span></pre>
</div>

<span style="font-family: '微软雅黑',sans-serif;">也可以使用命令添加默认网关</span>

<div class="cnblogs_code">
  <pre>route add default gw 172.16.1.188</pre>
</div>

<span style="font-family: '微软雅黑',sans-serif;">查看默认的路由信息</span>

<div class="cnblogs_code">
  <pre>[root@test ~]<span style="color: #008000;">#</span><span style="color: #008000;"> route -n</span>
<span style="color: #000000;">Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
</span>172.16.1.0      0.0.0.0         255.255.255.0<span style="color: #000000;">   U     0      0        0 eth1
</span>169.254.0.0     0.0.0.0         255.255.0.0     U     1003<span style="color: #000000;">   0        0 eth1
</span>0.0.0.0         172.16.1.188    0.0.0.0         UG    0      0        0 eth1</pre>
</div>

<p style="text-indent: 15.75pt;">
  <span style="font-family: '微软雅黑',sans-serif;">说明：内网服务器网关地址指定为共享上网服务器内网网卡地址</span>
</p>

<span style="font-family: '微软雅黑',sans-serif;">第二个里程碑：配置共享上网服务器，开启共享上网服务器路由转发功能</span>

<div class="cnblogs_code">
  <pre>[root@clsn ~]<span style="color: #008000;">#</span><span style="color: #008000;"> vim /etc/sysctl.conf </span>
[root@clsn ~]<span style="color: #008000;">#</span><span style="color: #008000;"> sysctl -p</span>
~~~<span style="color: #000000;">
net.ipv4.ip_forward </span>= 1
~~~</pre>
</div>

<span style="font-family: '微软雅黑',sans-serif;">第三个里程碑：配置共享上网服务器，实现内网访问外网的</span>NAT<span style="font-family: '微软雅黑',sans-serif;">映射</span>

<div class="cnblogs_code">
  <pre>iptables -t nat -A POSTROUTING -s 172.16.1.0/24 -o eth0 -j SNAT --to-source 10.0.0.188</pre>
</div>

<span style="font-family: '微软雅黑',sans-serif;">参数详解：</span>

<table style="width: 100%; border-collapse: collapse; border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
  <tr>
    <td style="width: 37.92%; border-top: 1pt solid #9bbb59; border-bottom: 1pt solid #9bbb59; border-left: 1pt solid #9bbb59; border-right: none; background: #9bbb59; padding: 0cm 5.4pt;" width="37%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: '微软雅黑',sans-serif; courier new"4courier new";color: white;">参数</span></strong>
      </p>
    </td>
    
    <td style="width: 62.08%; border-top: 1pt solid #9bbb59; border-right: 1pt solid #9bbb59; border-bottom: 1pt solid #9bbb59; border-left: none; background: #9bbb59; padding: 0cm 5.4pt;" width="62%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: '微软雅黑',sans-serif; courier new"4courier new";color: white;">参数说明</span></strong>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 37.92%; border-right: 1pt solid #c2d69b; border-bottom: 1pt solid #c2d69b; border-left: 1pt solid #c2d69b; border-top: none; background: #eaf1dd; padding: 0cm 5.4pt;" width="37%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <strong>-s 172.16.1.0/24</strong>
      </p>
    </td>
    
    <td style="width: 62.08%; border-top: none; border-left: none; border-bottom: solid #C2D69B 1.0pt; border-right: solid #C2D69B 1.0pt; background: #EAF1DD; padding: 0cm 5.4pt 0cm 5.4pt;" width="62%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">指定将哪些内网网段进行映射转换</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 37.92%; border-right: 1pt solid #c2d69b; border-bottom: 1pt solid #c2d69b; border-left: 1pt solid #c2d69b; border-top: none; padding: 0cm 5.4pt;" width="37%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <strong>-o eth0</strong>
      </p>
    </td>
    
    <td style="width: 62.08%; border-top: none; border-left: none; border-bottom: solid #C2D69B 1.0pt; border-right: solid #C2D69B 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="62%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">指定在共享上网哪个网卡接口上做</span>NAT<span style="font-family: '微软雅黑',sans-serif;">地址转换</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 37.92%; border-right: 1pt solid #c2d69b; border-bottom: 1pt solid #c2d69b; border-left: 1pt solid #c2d69b; border-top: none; background: #eaf1dd; padding: 0cm 5.4pt;" width="37%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <strong>-j SNAT</strong>
      </p>
    </td>
    
    <td style="width: 62.08%; border-top: none; border-left: none; border-bottom: solid #C2D69B 1.0pt; border-right: solid #C2D69B 1.0pt; background: #EAF1DD; padding: 0cm 5.4pt 0cm 5.4pt;" width="62%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">将源地址进行转换变更</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 37.92%; border-right: 1pt solid #c2d69b; border-bottom: 1pt solid #c2d69b; border-left: 1pt solid #c2d69b; border-top: none; padding: 0cm 5.4pt;" width="37%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <strong>-j DNAT</strong>
      </p>
    </td>
    
    <td style="width: 62.08%; border-top: none; border-left: none; border-bottom: solid #C2D69B 1.0pt; border-right: solid #C2D69B 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="62%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">将目标地址进行转换变更</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 37.92%; border-right: 1pt solid #c2d69b; border-bottom: 1pt solid #c2d69b; border-left: 1pt solid #c2d69b; border-top: none; background: #eaf1dd; padding: 0cm 5.4pt;" width="37%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <strong>--to-source ip</strong><strong><span style="font-family: '微软雅黑',sans-serif;">地址</span></strong>
      </p>
    </td>
    
    <td style="width: 62.08%; border-top: none; border-left: none; border-bottom: solid #C2D69B 1.0pt; border-right: solid #C2D69B 1.0pt; background: #EAF1DD; padding: 0cm 5.4pt 0cm 5.4pt;" width="62%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">将源地址映射为什么</span>IP<span style="font-family: '微软雅黑',sans-serif;">地址</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 37.92%; border-right: 1pt solid #c2d69b; border-bottom: 1pt solid #c2d69b; border-left: 1pt solid #c2d69b; border-top: none; padding: 0cm 5.4pt;" width="37%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <strong>--to-destination ip</strong><strong><span style="font-family: '微软雅黑',sans-serif;">地址</span></strong>
      </p>
    </td>
    
    <td style="width: 62.08%; border-top: none; border-left: none; border-bottom: solid #C2D69B 1.0pt; border-right: solid #C2D69B 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="62%">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">将目标地址映射为什么</span>IP<span style="font-family: '微软雅黑',sans-serif;">地址</span>
      </p>
    </td>
  </tr>
</table>

<span style="font-family: '微软雅黑',sans-serif;">当</span>filter<span style="font-family: '微软雅黑',sans-serif;">表中的</span>forward<span style="font-family: '微软雅黑',sans-serif;">默认为</span>drop<span style="font-family: '微软雅黑',sans-serif;">策略时，如何配置</span>forward<span style="font-family: '微软雅黑',sans-serif;">链？</span>

<p style="text-align: center;" align="center">
  &nbsp;<img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20180118100154553-999721017.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="企业防火墙之iptables" alt="" />
</p>

<p style="text-align: center;" align="center">
  <span style="font-family: '微软雅黑',sans-serif;">图</span> - forward<span style="font-family: '微软雅黑',sans-serif;">工作原理</span>
</p>

**&nbsp;&nbsp;** **<span style="font-family: '微软雅黑',sans-serif;">配置示例</span>**

<div class="cnblogs_code">
  <pre>iptables -A FORWARD -i eth1 -s 172.16.1.0/24 -<span style="color: #000000;">j ACCEPT
</span><span style="color: #008000;">#</span><span style="color: #008000;"> iptables -A FORWARD -o eth0 -s 172.16.1.0/24 -j ACCEPT  # 可以不进行配置</span>
iptables -A FORWARD -i eth0 -d 172.16.1.0/24 -<span style="color: #000000;">j ACCEPT
</span><span style="color: #008000;">#</span><span style="color: #008000;"> iptables -A FORWARD -o eth1 -d 172.16.1.0/24 -j ACCEPT   # 可以不进行配置</span></pre>
</div>

<span style="font-family: '微软雅黑',sans-serif;">当外网</span>ip<span style="font-family: '微软雅黑',sans-serif;">不固定时如何配置？</span>

<div class="cnblogs_code">
  <pre>iptables -t nat -A POSTROUTING -s 172.16.1.0/24 -o eth0 -j MASQUERADE   <span style="color: #008000;">#</span><span style="color: #008000;"> 伪装共享上网</span></pre>
</div>

<span style="font-family: '微软雅黑',sans-serif;">说明：在企业中如何没有固定外网</span>IP<span style="font-family: '微软雅黑',sans-serif;">地址，可以采取以上伪装映射的方式进行共享上网</span>

**<span style="font-family: '微软雅黑',sans-serif; courier new"4courier new";background: yellow;">配置映射方法小结</span>**

> &nbsp;01.&nbsp;指定哪些网段需要进行映射&nbsp; &nbsp;&nbsp;&nbsp;-s 172.16.1.0/24
> 
> 02.&nbsp;指定在哪做映射&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -o eth0
> 
> 03.&nbsp;用什么方法做映射&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -j SNAT/DNAT MASQUERADE
> 
> 04.&nbsp;映射成什么地址&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --to-source&nbsp; ip地址/--to-destination ip地址

### <span id="172_iptablesIPIP">1.7.2 iptables<span style="font-family: '微软雅黑',sans-serif;">实现外网</span>IP<span style="font-family: '微软雅黑',sans-serif;">的端口映射到内网</span>IP<span style="font-family: '微软雅黑',sans-serif;">的端口</span></span>

<p style="text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif;">实际需求：将网关的</span>IP<span style="font-family: '微软雅黑',sans-serif;">和</span>9000<span style="font-family: '微软雅黑',sans-serif;">端口映射到内网服务器的</span>22<span style="font-family: '微软雅黑',sans-serif;">端口</span>
</p>

<p style="text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif;">端口映射</span> 10.0.0.188:9000 -->172.16.1.180:22
</p>

<span style="font-family: '微软雅黑',sans-serif;">配置实例：</span>

<div class="cnblogs_code">
  <pre>iptables -t nat -A PREROUTING -d 10.0.0.188 -p tcp --dport 9000 -i eth0 -j DNAT --to-destination 172.16.1.7:22</pre>
</div>

<span style="font-family: '微软雅黑',sans-serif;">参数说明</span>:

<table style="width: 100%; border-collapse: collapse; border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
  <tr>
    <td style="width: 44.7%; border-top: 1pt solid #9bbb59; border-bottom: 1pt solid #9bbb59; border-left: 1pt solid #9bbb59; border-right: none; background: #9bbb59; padding: 0cm 5.4pt;" width="44%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: '微软雅黑',sans-serif; courier new"4courier new";color: white;">参数</span></strong>
      </p>
    </td>
    
    <td style="width: 55.3%; border-top: 1pt solid #9bbb59; border-right: 1pt solid #9bbb59; border-bottom: 1pt solid #9bbb59; border-left: none; background: #9bbb59; padding: 0cm 5.4pt;" width="55%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: '微软雅黑',sans-serif; courier new"4courier new";color: white;">参数说明</span></strong>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 44.7%; border-right: 1pt solid #c2d69b; border-bottom: 1pt solid #c2d69b; border-left: 1pt solid #c2d69b; border-top: none; background: #eaf1dd; padding: 0cm 5.4pt;" width="44%">
      <p style="text-align: center;" align="center">
        <strong>-d 10.0.0.188</strong>
      </p>
    </td>
    
    <td style="width: 55.3%; border-top: none; border-left: none; border-bottom: solid #C2D69B 1.0pt; border-right: solid #C2D69B 1.0pt; background: #EAF1DD; padding: 0cm 5.4pt 0cm 5.4pt;" width="55%">
      <p style="text-align: center;" align="center">
        <span style="font-family: '微软雅黑',sans-serif;">目标地址。</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 44.7%; border-right: 1pt solid #c2d69b; border-bottom: 1pt solid #c2d69b; border-left: 1pt solid #c2d69b; border-top: none; padding: 0cm 5.4pt;" width="44%">
      <p style="text-align: center;" align="center">
        <strong>-j DNAT</strong>
      </p>
    </td>
    
    <td style="width: 55.3%; border-top: none; border-left: none; border-bottom: solid #C2D69B 1.0pt; border-right: solid #C2D69B 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="55%">
      <p style="text-align: center;" align="center">
        <span style="font-family: '微软雅黑',sans-serif;">目的地址改写。</span>
      </p>
    </td>
  </tr>
</table>

### <span id="173_IP">1.7.3 IP<span style="font-family: '微软雅黑',sans-serif;">一对一映射</span></span>

<p style="text-align: center;" align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20180118100320756-725387577.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="企业防火墙之iptables" alt="" />
</p>

<p style="text-align: center;" align="center">
  <span style="font-family: '微软雅黑',sans-serif;">图</span> - DNAT <span style="font-family: '微软雅黑',sans-serif;">映射原理</span>
</p>

&nbsp;&nbsp; <span style="font-family: '微软雅黑',sans-serif;">实际需求：将</span>ip <span style="font-family: '微软雅黑',sans-serif;">地址</span>172.16.1.180 <span style="font-family: '微软雅黑',sans-serif;">映射到</span>10.0.0.188

<span style="font-family: '微软雅黑',sans-serif;">通过辅助</span>IP<span style="font-family: '微软雅黑',sans-serif;">配置：</span>

<div class="cnblogs_code">
  <pre>ip addr add 10.0.0.81/24 dev eth0 label eth0:0   <span style="color: #008000;">#</span><span style="color: #008000;"> 添加辅助IP</span>
iptables  -t nat -I PREROUTING -d 10.0.0.81 -j DNAT --to-destination 172.16.1.51<span style="color: #000000;">
iptables  </span>-t nat -I POSTROUTING -s 172.16.1.51 -o eth0 -j SNAT --to-source 10.0.0.81</pre>
</div>

<span style="font-family: '微软雅黑',sans-serif;">适合内网的机器访问</span>NAT<span style="font-family: '微软雅黑',sans-serif;">外网的</span>IP

<div class="cnblogs_code">
  <pre>iptables  -t nat -I POSTROUTING -s 172.16.1.0/255.255.240.0 -d 10.0.0.81 -j SNAT --to-source 172.16.1.8</pre>
</div>

<span style="font-family: '微软雅黑',sans-serif;">检查配置：</span>

<div class="cnblogs_code">
  <pre>ping 10.0.0.81 -<span style="color: #000000;">t
tcpdump</span>|grep -<span style="color: #000000;">i icmp（两台机器上分别监测）
telnet </span>10.0.0.81 22</pre>
</div>

### <span id="174_IP">1.7.4 <span style="font-family: '微软雅黑',sans-serif;">映射多个外网</span>IP<span style="font-family: '微软雅黑',sans-serif;">上网</span></span>

&nbsp;&nbsp; <span style="font-family: '微软雅黑',sans-serif;">方法</span>1<span style="font-family: '微软雅黑',sans-serif;">：</span>

<div class="cnblogs_code">
  <pre>iptables -t nat -A POSTROUTING -s 10.0.1.0/255.255.240.0 -o eth0 -j SNAT --to-source 124.42.60.11-124.42.60.16</pre>
</div>

&nbsp;&nbsp; &nbsp;&nbsp; <span style="font-family: '微软雅黑',sans-serif;">在三层交换机或路由器，划分</span>VLAN<span style="font-family: '微软雅黑',sans-serif;">。</span>

&nbsp;&nbsp; <span style="font-family: '微软雅黑',sans-serif;">方法</span>2<span style="font-family: '微软雅黑',sans-serif;">：</span>

<div class="cnblogs_code">
  <pre>iptables -t nat -A POSTROUTING -s 10.0.1.0/22 -o eth0 -j SNAT --to-source 124.42.60.11<span style="color: #000000;">
iptables </span>-t nat -A POSTROUTING -s 10.0.2.0/22 -o eth0 -j SNAT --to-source 124.42.60.12</pre>
</div>

&nbsp;&nbsp; &nbsp;&nbsp; <span style="font-family: '微软雅黑',sans-serif;">扩大子网，会增加广播风暴。</span>

### <span id="175">1.7.5 <span style="font-family: '微软雅黑',sans-serif;">系统防火墙与网络内核优化标准参数</span></span>

<span style="font-family: '微软雅黑',sans-serif;">有关</span>iptables<span style="font-family: '微软雅黑',sans-serif;">的内核优化</span>

<p style="text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif;">调整内核参数文件</span>/etc/sysctl.conf
</p>

<span style="font-family: '微软雅黑',sans-serif;">以下是我的生产环境的某个服务器的配置：</span>

**<span style="font-family: '微软雅黑',sans-serif; courier new"4courier new";background: yellow;">解决</span><span style="background: yellow;">time-wait</span>****<span style="font-family: '微软雅黑',sans-serif; courier new"4courier new"; background: yellow;">过多</span>**<span style="font-family: '微软雅黑',sans-serif;">的解决办法：</span>

<div class="cnblogs_code">
  <pre>net.ipv4.tcp_fin_timeout = 2<span style="color: #000000;">
net.ipv4.tcp_tw_reuse </span>= 1<span style="color: #000000;">
net.ipv4.tcp_tw_recycle </span>= 1<span style="color: #000000;">
net.ipv4.tcp_syncookies </span>= 1<span style="color: #000000;">
net.ipv4.tcp_keepalive_time </span>= 600<span style="color: #000000;">
net.ipv4.tcp_max_tw_buckets </span>= 36000</pre>
</div>

<div class="cnblogs_code">
  <pre>net.ipv4.ip_local_port_range = 4000  65000<span style="color: #000000;">
net.ipv4.tcp_max_syn_backlog </span>= 16384<span style="color: #000000;">
net.ipv4.route.gc_timeout </span>= 100<span style="color: #000000;">
net.ipv4.tcp_syn_retries </span>= 1<span style="color: #000000;">
net.ipv4.tcp_synack_retries </span>= 1</pre>
</div>

<p style="text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif;">在</span>dmesg<span style="font-family: '微软雅黑',sans-serif;">中显示&nbsp;<span class="cnblogs_code"> ip_conntrack: table full, dropping packet.</span>&nbsp;</span><span style="font-family: '微软雅黑',sans-serif;">的错误提示，什么原因？</span>
</p>

<span style="font-family: '微软雅黑',sans-serif;">如何解决？</span>

&nbsp;&nbsp; #iptables<span style="font-family: '微软雅黑',sans-serif;">优化</span>

<div class="cnblogs_code">
  <pre>net.nf_conntrack_max = 25000000<span style="color: #000000;">
net.netfilter.nf_conntrack_max </span>= 25000000<span style="color: #000000;">
net.netfilter.nf_conntrack_tcp_timeout_established </span>= 180<span style="color: #000000;">
net.netfilter.nf_conntrack_tcp_timeout_time_wait </span>= 120<span style="color: #000000;">
net.netfilter.nf_conntrack_tcp_timeout_close_wait </span>= 60<span style="color: #000000;">
net.netfilter.nf_conntrack_tcp_timeout_fin_wait </span>= 120</pre>
</div>

## <span id="18">1.8 <span style="font-family: '微软雅黑',sans-serif;">自定义链的配置</span></span>

<p style="text-align: center;" align="center">
  &nbsp;<img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20180118100524162-470889662.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="企业防火墙之iptables" alt="" />
</p>

<p style="text-align: center;" align="center">
  <span style="font-family: '微软雅黑',sans-serif;">图</span> - <span style="font-family: '微软雅黑',sans-serif;">自定义链原理</span>
</p>

<span style="font-family: '微软雅黑',sans-serif;">创建自定义链</span>

<div class="cnblogs_code">
  <pre><span style="color: #008000;">#</span><span style="color: #008000;">示例：在filter表中创建NOICMP自定义链</span>
iptables -t filter -N NOICMP</pre>
</div>

<span style="font-family: '微软雅黑',sans-serif;">引用自定义链</span>

<div class="cnblogs_code">
  <pre><span style="color: #008000;">#</span><span style="color: #008000;">示例：在INPUT链中引用刚才创建的自定义链</span>
iptables -t filter -I INPUT -p icmp  -j NOICMP</pre>
</div>

<span style="font-family: '微软雅黑',sans-serif;">重命名自定义链</span>

<div class="cnblogs_code">
  <pre><span style="color: #008000;">#</span><span style="color: #008000;">示例：将IN_WEB自定义链重命名为WEB</span>
iptables -E NOICMP ACCEPTICMP</pre>
</div>

<span style="font-family: '微软雅黑',sans-serif;">删除自定义链</span>

> <p style="margin-left: 30px;">
>   &nbsp;删除自定义链需要满足两个条件
> </p>
> 
> 　　1、自定义链没有被引用
> 
> 　　2、自定义链中没有任何规则

<div class="cnblogs_code">
  <pre><span style="color: #008000;">#</span><span style="color: #008000;"> 示例： 删除引用数为0且不包含任何规则的ACCEPTICMP链</span>
iptables -X ACCEPTICMP</pre>
</div>

## <span id="19">1.9 <span style="font-family: '微软雅黑',sans-serif;">附录</span>-<span style="font-family: '微软雅黑',sans-serif;">防火墙状态机制</span></span>

<p style="text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif;">状态机制是</span>iptables<span style="font-family: '微软雅黑',sans-serif;">中较为特殊的一部分，这也是</span>iptables<span style="font-family: '微软雅黑',sans-serif;">和比较老的</span>ipchains<span style="font-family: '微软雅黑',sans-serif;">的一个比较大的区別之一，运行状态机制（连接跟踪）的防火墙称作带有状态机制的防火墙，以下简称为状态防火墙</span>.<span style="font-family: '微软雅黑',sans-serif;">状态防火墙比非状态防火墙要安全，因为它允许我们编写更严密的规则。</span>
</p>

<span style="font-family: '微软雅黑',sans-serif;">在</span>iptables<span style="font-family: '微软雅黑',sans-serif;">上一共有四种状态，分别被称为</span>NEW<span style="font-family: '微软雅黑',sans-serif;">、</span>ESTABLISHED<span style="font-family: '微软雅黑',sans-serif;">、</span>INVALID<span style="font-family: '微软雅黑',sans-serif;">、</span>RELATED,<span style="font-family: '微软雅黑',sans-serif;">这四种状态对于</span>TCP<span style="font-family: '微软雅黑',sans-serif;">、</span>UDP<span style="font-family: '微软雅黑',sans-serif;">、</span>ICMP<span style="font-family: '微软雅黑',sans-serif;">三种协议均有效。下面，我们来分别阐述四种状态的特性</span>.

<p style="margin-left: 42.0pt; text-indent: -21.0pt;">
  <strong>? NEW</strong>
</p>

<p style="text-indent: 21.0pt;">
  meaning that the packet has started a new connection, or otherwise associated with a connection which has not seen packets in both directions
</p>

<p style="text-indent: 21.0pt;">
  NEW<span style="font-family: '微软雅黑',sans-serif;">说明这个包是我们看到的笛一个包。意思就是，这是</span>conntrack<span style="font-family: '微软雅黑',sans-serif;">横块看到的某个连接的第一个包，它即格被匹配了。比如，我们看到一个</span>SYN<span style="font-family: '微软雅黑',sans-serif;">包，是我们所留意的连接的第一</span> <span style="font-family: '微软雅黑',sans-serif;">个包，就要匹配它。</span>
</p>

<p style="text-align: center;" align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20180118100700365-1333317962.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="企业防火墙之iptables" alt="" />&nbsp;
</p>

<p style="margin-left: 42.0pt; text-indent: -21.0pt;">
  <strong><strong>?&nbsp;</strong>ESTABLISHED</strong>
</p>

<p style="text-indent: 21.0pt;">
  meaning that the packet is associated with a connection which has seen packets in both directions
</p>

<p style="text-indent: 21.0pt;">
  ESTABLISHED<span style="font-family: '微软雅黑',sans-serif;">已经注意到两个方向上的数据传输，而且会继续匹配这个连接的包</span>.<span style="font-family: '微软雅黑',sans-serif;">处于</span>ESTABLISHED<span style="font-family: '微软雅黑',sans-serif;">状态的连接是非常容易理解的</span>.<span style="font-family: '微软雅黑',sans-serif;">只要发送并接到应答，连接就是</span>ESTABLISHED<span style="font-family: '微软雅黑',sans-serif;">的了。一个连接要从</span>NEW<span style="font-family: '微软雅黑',sans-serif;">变为</span>ESTABLISHED,<span style="font-family: '微软雅黑',sans-serif;">只需要接到应答包即可，不管这个包是发往防火墙的，还是要由防火墙转发的</span>.ICMP<span style="font-family: '微软雅黑',sans-serif;">的错误和重定向等信息包也被看作是</span>ESTABLISHED,<span style="font-family: '微软雅黑',sans-serif;">只要它们是我们所发出的信息的应答。</span>
</p>

<p style="text-align: center;" align="center">
  &nbsp;<img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20180118100709240-1842733823.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="企业防火墙之iptables" alt="" />
</p>

<p style="margin-left: 42.0pt; text-indent: -21.0pt;">
  <strong>?&nbsp;</strong>RELATED
</p>

<p style="text-indent: 21.0pt;">
  meaning that the packet is starting a new connection, but is associated with an existing connection, such as an FTP data transfer, or an ICMP error.
</p>

<p style="text-indent: 21.0pt;">
  RELATED<span style="font-family: '微软雅黑',sans-serif;">是个比较麻烦的状态</span>.<span style="font-family: '微软雅黑',sans-serif;">当一个连接和某个已处于</span>ESTABLISHED<span style="font-family: '微软雅黑',sans-serif;">状态的连接有关系时，就被认为是</span>RELATED<span style="font-family: '微软雅黑',sans-serif;">的了，换句话说，一个连接要想是</span>RELATED<span style="font-family: '微软雅黑',sans-serif;">的，首先要有一个</span>ESTABLISHED<span style="font-family: '微软雅黑',sans-serif;">的连接。这个</span>ESTABLISHED<span style="font-family: '微软雅黑',sans-serif;">连接再产生一个主连接之外的连接，这个新的连接就是</span>RELATED<span style="font-family: '微软雅黑',sans-serif;">的了，当然前提是</span>conntrack<span style="font-family: '微软雅黑',sans-serif;">模块要能理解</span>RELATED<span style="font-family: '微软雅黑',sans-serif;">。</span>ftp<span style="font-family: '微软雅黑',sans-serif;">是个很好的例子，</span>FTP-data<span style="font-family: '微软雅黑',sans-serif;">连接就是和</span>FTP-control<span style="font-family: '微软雅黑',sans-serif;">有关联的，如果没有在</span>iptables<span style="font-family: '微软雅黑',sans-serif;">的策略中配</span>RELATED<span style="font-family: '微软雅黑',sans-serif;">状态，</span>FTP-data<span style="font-family: '微软雅黑',sans-serif;">的连接是无法正确建立的，还有其他的例子，比如，通过</span>IRC<span style="font-family: '微软雅黑',sans-serif;">的</span>DCC<span style="font-family: '微软雅黑',sans-serif;">连接</span>#<span style="font-family: '微软雅黑',sans-serif;">有了这个状态，</span>ICMP<span style="font-family: '微软雅黑',sans-serif;">应答、</span>FTP<span style="font-family: '微软雅黑',sans-serif;">传输、</span>DCC<span style="font-family: '微软雅黑',sans-serif;">等才能穿过防火墙正常工作</span>.<span style="font-family: '微软雅黑',sans-serif;">注意，大部分还有一些</span>UDP<span style="font-family: '微软雅黑',sans-serif;">协议都依赖这个机制。这些协议是很复杂的，它们把连接信息放在数据包里，并且要求这些信息能被正确理解。</span>
</p>

<p style="text-align: center;" align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20180118100716459-532997150.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="企业防火墙之iptables" alt="" />&nbsp;
</p>

<p style="margin-left: 42.0pt; text-indent: -21.0pt;">
  <strong><strong>?&nbsp;</strong>INVALID</strong>
</p>

<p style="text-indent: 21.0pt;">
  meaning that the packet is associated with no known connection
</p>

<p style="text-indent: 21.0pt;">
  INVALID<span style="font-family: '微软雅黑',sans-serif;">说明数据包不能被识别属于哪个连接或没有任何状态</span>.<span style="font-family: '微软雅黑',sans-serif;">有几个原因可以产生这种情况，比如，内存溢出，收到不知厲于哪个连接的</span>ICMP<span style="font-family: '微软雅黑',sans-serif;">错误信息。一般地，我们</span>DROP<span style="font-family: '微软雅黑',sans-serif;">这个状态的任何东西，因为防火墙认为这是不安全的东西</span>
</p>

<p style="text-align: center;" align="center">
  &nbsp;<img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20180118100722240-904097578.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="企业防火墙之iptables" alt="" />
</p>

### <span id="191_iptables">1.9.1 iptables<span style="font-family: '微软雅黑',sans-serif;">配置哲学</span></span>

<span style="font-family: '微软雅黑',sans-serif;">如何防止自己被关在门外？</span>

> &nbsp;01、去机房重启系统或者登陆服努器删除刚才的禁止规则。
> 
> <div>
>   <p class="a">
>     02、让机房人员重启服芳器或者让机房人员拿用户密码登录进去。
>   </p>
>   
>   <p class="a">
>     03、通过服努器的远程管理卡管理（推荐）。
>   </p>
>   
>   <p class="a">
>     04、先写一个定时任务，每5分钟就停止防火墙。
>   </p>
>   
>   <p class="a">
>     05、测试环境测试好，写成脚本，批置执行
>   </p>
> </div>

<span style="font-family: '微软雅黑',sans-serif;">配置禁用</span>22<span style="font-family: '微软雅黑',sans-serif;">端口策略</span>:

<div class="cnblogs_code">
  <pre>iptables -I INPUT -p tcp - dport 22 -<span style="color: #000000;">j DROP
</span><span style="color: #008000;">#</span><span style="color: #008000;"> 说明：利用-I参数，实现强行阻止访问22端口，将Jffc规则放在第一位</span></pre>
</div>

<span style="font-family: '微软雅黑',sans-serif;">删除配置的禁止连接</span>22<span style="font-family: '微软雅黑',sans-serif;">端口的规则</span>

<div class="cnblogs_code">
  <pre>iptables -t filter -D INPUT -p tcp &mdash;dport 22 -<span style="color: #000000;">j DROP
iptables </span>-<span style="color: #000000;">F
</span>/etc/init.d/iptables restart</pre>
</div>

&nbsp;1.10 <span style="font-family: '微软雅黑',sans-serif;">参考文献</span>

> &nbsp;[1]&nbsp; [http://www.aichengxu.com/linux/3122717.htm][1]
> 
> <div>
>   <p class="a">
>     [2]&nbsp; <a href="/wp-content/themes/clsn-003/inc/go.php?url=http://blog.csdn.net/huguohu2006/article/details/6453522" >http://blog.csdn.net/huguohu2006/article/details/6453522</a>
>   </p>
>   
>   <p class="a">
>     [3]&nbsp; <a href="/wp-content/themes/clsn-003/inc/go.php?url=http://blog.csdn.net/lin_credible/article/details/8614907" >http://blog.csdn.net/lin_credible/article/details/8614907</a>
>   </p>
>   
>   <p class="a">
>     [4]&nbsp; <a href="/wp-content/themes/clsn-003/inc/go.php?url=http://blog.chinaunix.net/uid-27057175-id-5179329.html" >http://blog.chinaunix.net/uid-27057175-id-5179329.html</a>
>   </p>
>   
>   <p class="a">
>     [5]&nbsp; <a href="/wp-content/themes/clsn-003/inc/go.php?url=http://blog.51cto.com/oldboy/974194" >http://blog.51cto.com/oldboy/974194</a>
>   </p>
>   
>   <p class="a">
>     [6]&nbsp; <a href="/wp-content/themes/clsn-003/inc/go.php?url=http://blog.sina.com.cn/s/blog_773d9b6701018rwo.html" >http://blog.sina.com.cn/s/blog_773d9b6701018rwo.html</a>
>   </p>
>   
>   <p class="a">
>     [7]&nbsp; <a href="/wp-content/themes/clsn-003/inc/go.php?url=http://www.zsythink.net/archives/1625" >http://www.zsythink.net/archives/1625</a>
>   </p>
> </div>

&nbsp;

<div id="toc_container" class="toc_white have_bullets">
  <ul class="toc_list">
    <li>
      <a href="#11">1.1 企业中安全优化配置原则</a><ul>
        <li>
          <a href="#111_iptables">1.1.1 生产中iptables的实际应用</a>
        </li>
        <li>
          <a href="#112">1.1.2 企业常用案例功能小结：</a>
        </li>
      </ul>
    </li>
    
    <li>
      <a href="#12_iptables">1.2 iptables防火墙简介</a><ul>
        <li>
          <a href="#121_iptables">1.2.1 iptables名词和术语</a>
        </li>
        <li>
          <a href="#122">1.2.2 什么是容器</a>
        </li>
        <li>
          <a href="#123_Netfilteriptables">1.2.3 什么是 Netfilter/iptables ?</a>
        </li>
        <li>
          <a href="#124_tables">1.2.4 什么是表（tables）？</a>
        </li>
        <li>
          <a href="#125_chains">1.2.5 什么是链（chains）？</a>
        </li>
        <li>
          <a href="#126_Policy">1.2.6 什么是规则（Policy）？</a>
        </li>
      </ul>
    </li>
    
    <li>
      <a href="#13_iptables">1.3 iptables 表和链</a><ul>
        <li>
          <a href="#131_filter">1.3.1 filter表的详细介绍</a>
        </li>
        <li>
          <a href="#132_NAT">1.3.2 NAT表信息详细介绍</a>
        </li>
        <li>
          <a href="#133_Mangle">1.3.3 Mangle表信息详细介绍</a>
        </li>
      </ul>
    </li>
    
    <li>
      <a href="#14_iptables">1.4 iptables工作流程</a><ul>
        <li>
          <a href="#141">1.4.1 工作流程说明</a>
        </li>
        <li>
          <a href="#142_iptables">1.4.2 iptables工作流程小结</a>
        </li>
      </ul>
    </li>
    
    <li>
      <a href="#15_iptables">1.5 iptables操作</a><ul>
        <li>
          <a href="#151_iptables">1.5.1 iptables参数说明</a>
        </li>
        <li>
          <a href="#152">1.5.2 配置前准备</a>
        </li>
      </ul>
    </li>
    
    <li>
      <a href="#16_iptables_filter">1.6 iptables filter表配置实例</a><ul>
        <li>
          <a href="#161">1.6.1 基础配置</a>
        </li>
        <li>
          <a href="#162_10000">1.6.2 配置实例四：除10.0.0.0网段可以进行连接服务器主机意外，其余网段都禁止</a>
        </li>
        <li>
          <a href="#163">1.6.3 配置实例五：测试匹配列举端口范围。</a>
        </li>
        <li>
          <a href="#164_ICMP">1.6.4 配置实例六：匹配ICMP类型</a>
        </li>
        <li>
          <a href="#165">1.6.5 防火墙状态机制配置</a>
        </li>
        <li>
          <a href="#166_iptables">1.6.6 使用iptables实现限速功能</a>
        </li>
        <li>
          <a href="#167">1.6.7 企业级防火墙配置</a>
        </li>
      </ul>
    </li>
    
    <li>
      <a href="#17_iptables_nat">1.7 iptables nat表配置实例</a><ul>
        <li>
          <a href="#171_iptables">1.7.1 iptables实现共享上网</a>
        </li>
        <li>
          <a href="#172_iptablesIPIP">1.7.2 iptables实现外网IP的端口映射到内网IP的端口</a>
        </li>
        <li>
          <a href="#173_IP">1.7.3 IP一对一映射</a>
        </li>
        <li>
          <a href="#174_IP">1.7.4 映射多个外网IP上网</a>
        </li>
        <li>
          <a href="#175">1.7.5 系统防火墙与网络内核优化标准参数</a>
        </li>
      </ul>
    </li>
    
    <li>
      <a href="#18">1.8 自定义链的配置</a>
    </li>
    <li>
      <a href="#19">1.9 附录-防火墙状态机制</a><ul>
        <li>
          <a href="#191_iptables">1.9.1 iptables配置哲学</a>
        </li>
      </ul>
    </li>
  </ul>
</div>

 [1]: /wp-content/themes/clsn-003/inc/go.php?url=http://www.aichengxu.com/linux/3122717.htm