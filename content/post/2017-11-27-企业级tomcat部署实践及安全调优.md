---
title: 企业级Tomcat部署实践及安全调优
author: 惨绿少年
type: post
date: 2017-11-27T00:39:00+00:00
url: /clsn/lx630.html
Baidusubmit:
  - 1
views:
  - 323
categories:
  - Linux运维
  - Web应用
  - 玩转Linux
  - 运维基本功

---
<div>
  <div style="border-top: #E1E1E1; border-left: #F0F0F0; border-bottom: #E1E1E1; border-right: #F0F0F0; border-style: solid; border-width: 1.0pt; padding: 1.0pt 2.0pt 1.0pt 2.0pt; background: #F0F0F0;">
    <p style="background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">
      <strong>1.1 Tomcat<span style="font-family: 微软雅黑, sans-serif;">简介</span></strong>
    </p>
  </div>
</div>

<p style="text-indent: 21.0pt;">
  Tomcat<span style="font-family: 等线;">是</span>Apache<span style="font-family: 等线;">软件基金会（</span>Apache Software Foundation<span style="font-family: 等线;">）的</span>Jakarta <span style="font-family: 等线;">项目中的一个核心项目，由</span>Apache<span style="font-family: 等线;">、</span>Sun<span style="font-family: 等线;">和其他一些公司及个人共同开发而成。</span>
</p>

<p style="text-indent: 21.0pt;">
  Tomcat<span style="font-family: 等线;">服务器是一个免费的开放源代码的</span>Web<span style="font-family: 等线;">应用服务器，属于轻量级应用服务器，在中小型系统和并发访问用户不是很多的场合下被普遍使用，是开发和调试</span>JSP<span style="font-family: 等线;">程序的首选。</span>
</p>

<p style="text-indent: 21.0pt;">
  Tomcat<span style="font-family: 等线;">和</span>Nginx<span style="font-family: 等线;">、</span>Apache(httpd)<span style="font-family: 等线;">、</span>lighttpd<span style="font-family: 等线;">等</span>Web<span style="font-family: 等线;">服务器一样，具有处理</span>HTML<span style="font-family: 等线;">页面的功能，另外它还是一个</span>Servlet<span style="font-family: 等线;">和</span>JSP<span style="font-family: 等线;">容器，独立的</span>Servlet<span style="font-family: 等线;">容器是</span>Tomcat<span style="font-family: 等线;">的默认模式。不过，</span>Tomcat<span style="font-family: 等线;">处理静态</span>HTML<span style="font-family: 等线;">的能力不如</span>Nginx/Apache<span style="font-family: 等线;">服务器。</span>
</p>

<p style="text-indent: 21.0pt;">
  <span style="font-family: 等线;">目前</span>Tomcat<span style="font-family: 等线;">最新版本为</span>9.0<span style="font-family: 等线;">。</span>Java<span style="font-family: 等线;">容器还有</span>resin<span style="font-family: 等线;">、</span>weblogic<span style="font-family: 等线;">等。</span>
</p>

<p style="text-indent: 21.0pt;">
  <strong><em><span style="text-decoration: underline;">Tomcat</span></em></strong><strong><em><span style="text-decoration: underline;"><span style="font-family: 等线;">官网：</span></span></em></strong> <a href="/wp-content/themes/clsn-003/inc/go.php?url=http://tomcat.apache.org/" >http://tomcat.apache.org</a>
</p>

### <span id="111_Tomcat---JDKnbspnbsp">1.1.1 Tomcat<span style="font-family: '微软雅黑',sans-serif;">好帮手</span>---JDK&nbsp;&nbsp;</span>

<p style="text-indent: 21.0pt;">
  JDK<span style="font-family: 等线;">是</span> Java <span style="font-family: 等线;">语言的软件开发工具包，主要用于移动设备、嵌入式设备上的</span>java<span style="font-family: 等线;">应用程序。</span>JDK<span style="font-family: 等线;">是整个</span>java<span style="font-family: 等线;">开发的<a name="_GoBack"></a>核心，它包含了</span>JAVA<span style="font-family: 等线;">的运行环境（</span>JVM+Java<span style="font-family: 等线;">系统类库）和</span>JAVA<span style="font-family: 等线;">工具。</span>
</p>

**<span style="background: lime;">JDK</span>****<span style="font-family: 等线; background: lime;">包含了一批用于</span><span style="background: lime;">Java</span>****<span style="font-family: 等线; background: lime;">开发的组件，其中包括：</span>**

<div class="cnblogs_code">
  <pre>javac：编译器，将后缀名为.java的源代码编译成后缀名为&ldquo;.<span style="color: #0000ff;">class</span><span style="color: #000000;">&rdquo;的字节码
java：运行工具，运行.class的字节码
jar：打包工具，将相关的类文件打包成一个文件
javadoc：文档生成器，从源码注释中提取文档，注释需匹配规范
jdb debugger：调试工具
jps：显示当前java程序运行的进程状态
javap：反编译程序
appletviewer：运行和调试applet程序的工具，不需要使用浏览器
javah：从Java类生成C头文件和C源文件。这些文件提供了连接胶合，使Java和C代码可进行交互。
javaws：运行JNLP程序
extcheck：一个检测jar包冲突的工具
apt：注释处理工具 
jhat：java堆分析工具
jstack：栈跟踪程序
jstat：JVM检测统计工具
jstatd：jstat守护进程
jinfo：获取正在运行或崩溃的java程序配置信息
jmap：获取java进程内存映射信息
idlj：IDL</span>-to-<span style="color: #000000;">Java编译器。将IDL语言转化为java文件 
policytool：一个GUI的策略文件创建和管理工具
jrunscript：命令行脚本运行</span></pre>
</div>

<p style="text-indent: 21.0pt;">
  JDK<span style="font-family: 等线;">中还包括完整的</span>JRE<span style="font-family: 等线;">（</span>Java Runtime Environment<span style="font-family: 等线;">），</span>Java<span style="font-family: 等线;">运行环境，也被称为</span>private runtime<span style="font-family: 等线;">。包括了用于产品环境的各种库类，如基础类库</span>rt.jar<span style="font-family: 等线;">，以及给开发人员使用的补充库，如国际化与本地化的类库、</span>IDL<span style="font-family: 等线;">库等等。</span>
</p>

<p style="text-indent: 21.0pt;">
  JDK<span style="font-family: 等线;">中还包括各种样例程序，用以展示</span>Java API<span style="font-family: 等线;">中的各部分。</span>
</p>

**_<span style="text-decoration: underline;">JDK</span>_****_<span style="text-decoration: underline;"><span style="font-family: 等线;">下载面页：</span></span>_**

<p style="text-indent: 21.0pt;">
  <a href="/wp-content/themes/clsn-003/inc/go.php?url=http://www.oracle.com/technetwork/java/javase/downloads/index.html" >http://www.oracle.com/technetwork/java/javase/downloads/index.html</a>
</p>

## <span id="12_Tomcat_JDK">1.2 <span style="font-family: '微软雅黑',sans-serif;">安装</span>Tomcat & JDK</span>

<p style="text-indent: 21.0pt;">
  <span style="font-family: 等线;">安装时候选择</span>tomcat<span style="font-family: 等线;">软件版本要与程序开发使用的版本一致。</span>jdk<span style="font-family: 等线;">版本要进行与</span>tomcat<span style="font-family: 等线;">保持一致。</span>
</p>

### <span id="121">1.2.1 <span style="font-family: '微软雅黑',sans-serif;">系统环境说明</span></span>

<div class="cnblogs_code">
  <pre>[root@web03 ~]<span style="color: #008000;">#</span><span style="color: #008000;"> cat /etc/redhat-release </span>
CentOS Linux release 7.4.1708<span style="color: #000000;"> (Core) 
[root@web03 </span>~]<span style="color: #008000;">#</span><span style="color: #008000;"> uname -a </span>
Linux web03 3.10.0-693.el7.x86_64 <span style="color: #008000;">#</span><span style="color: #008000;">1 SMP Tue Aug 22 21:09:27 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux</span>
[root@web03 ~]<span style="color: #008000;">#</span><span style="color: #008000;"> getenforce </span>
<span style="color: #000000;">Disabled
[root@web03 </span>~]<span style="color: #008000;">#</span><span style="color: #008000;"> systemctl status firewalld.service</span>
● firewalld.service - firewalld -<span style="color: #000000;"> dynamic firewall daemon
   Loaded: loaded (</span>/usr/lib/systemd/system/<span style="color: #000000;">firewalld.service; disabled; vendor preset: enabled)
   Active: inactive (dead)
     Docs: man:firewalld(</span>1)</pre>
</div>

### <span id="122_nbspJDK">1.2.2 &nbsp;<span style="font-family: '微软雅黑',sans-serif;">安装</span>JDK</span>

_<span style="text-decoration: underline;"><span style="font-family: 等线;">命令集：</span></span>_

<div class="cnblogs_code">
  <pre>tar xf jdk-8u60-linux-x64.tar.gz -C /application/<span style="color: #000000;">
ln </span>-s /application/jdk1.8.0_60 /application/<span style="color: #000000;">jdk
</span><span style="color: #008000;">#</span><span style="color: #008000;"> 设置环境变量</span>
sed -i.ori <span style="color: #800000;">'</span><span style="color: #800000;">$a export JAVA_HOME=/application/jdk\nexport PATH=$JAVA_HOME/bin:$JAVA_HOME/jre/bin:$PATH\nexport CLASSPATH=.:$JAVA_HOME/lib:$JAVA_HOME/jre/lib:$JAVA_HOME/lib/tools.jar</span><span style="color: #800000;">'</span> /etc/<span style="color: #000000;">profile
source </span>/etc/profile</pre>
</div>

<span style="font-family: 等线;">测试</span>jdk<span style="font-family: 等线;">是否安装成功&darr;</span>

<div class="cnblogs_code">
  <pre>[root@web03 ~]<span style="color: #008000;">#</span><span style="color: #008000;"> java -version</span>
java version <span style="color: #800000;">"</span><span style="color: #800000;">1.8.0_60</span><span style="color: #800000;">"</span><span style="color: #000000;">
Java(TM) SE Runtime Environment (build </span>1.8.0_60-<span style="color: #000000;">b27)
Java HotSpot(TM) </span>64-Bit Server VM (build 25.60-b23, mixed mode)</pre>
</div>

### <span id="123_Tomcat">1.2.3 <span style="font-family: '微软雅黑',sans-serif;">安装</span>Tomcat</span>

_<span style="text-decoration: underline;"><span style="font-family: 等线;">命令集：</span></span>_

<div class="cnblogs_code">
  <pre>tar xf apache-tomcat-8.0.27.tar.gz -C /application/<span style="color: #000000;">
ln </span>-s /application/apache-tomcat-8.0.27 /application/<span style="color: #000000;">tomcat
</span><span style="color: #008000;">#</span><span style="color: #008000;"> 设置环境变量</span>
echo <span style="color: #800000;">'</span><span style="color: #800000;">export TOMCAT_HOME=/application/tomcat</span><span style="color: #800000;">'</span>>>/etc/<span style="color: #000000;">profile
source </span>/etc/<span style="color: #000000;">profile
</span><span style="color: #008000;">#</span><span style="color: #008000;"> 注意授权，统一权限</span>
chown -R root.root /application/jdk/ /application/tomcat/</pre>
</div>

<span style="font-family: 等线;">检查</span>tomcat<span style="font-family: 等线;">是否安装成功</span>

<div class="cnblogs_code">
  <pre>[root@web03 ~]<span style="color: #008000;">#</span><span style="color: #008000;"> /application/tomcat/bin/version.sh</span>
Using CATALINA_BASE:   /application/<span style="color: #000000;">tomcat
Using CATALINA_HOME:   </span>/application/<span style="color: #000000;">tomcat
Using CATALINA_TMPDIR: </span>/application/tomcat/<span style="color: #000000;">temp
Using JRE_HOME:        </span>/application/<span style="color: #000000;">jdk
Using CLASSPATH:       </span>/application/tomcat/bin/bootstrap.jar:/application/tomcat/bin/tomcat-<span style="color: #000000;">juli.jar
Server version: Apache Tomcat</span>/8.0.27<span style="color: #000000;">
Server built:   Sep </span>28 2015 08:17:25<span style="color: #000000;"> UTC
Server number:  </span>8.0.27.0<span style="color: #000000;">
OS Name:        Linux
OS Version:     </span>3.10.0-693<span style="color: #000000;">.el7.x86_64
Architecture:   amd64
JVM Version:    </span>1.8.0_60-<span style="color: #000000;">b27
JVM Vendor:     Oracle Corporation</span></pre>
</div>

## <span id="13_Tomcat">1.3 Tomcat<span style="font-family: '微软雅黑',sans-serif;">目录介绍</span></span>

### <span id="131_tomcat">1.3.1 tomcat<span style="font-family: '微软雅黑',sans-serif;">主目录介绍</span></span>

<div class="cnblogs_code">
  <pre>[root@web03 ~]<span style="color: #008000;">#</span><span style="color: #008000;"> cd /application/tomcat/</span>
[root@web03 tomcat]<span style="color: #008000;">#</span><span style="color: #008000;"> tree -L 1</span>
<span style="color: #000000;">.
├── bin              </span><span style="color: #008000;">#</span><span style="color: #008000;">存放tomcat管理脚本</span>
├── conf             <span style="color: #008000;">#</span><span style="color: #008000;"> tomcat 配置文件存放目录</span>
├── lib              <span style="color: #008000;">#</span><span style="color: #008000;"> web应用调用的jar包存放路径</span>
<span style="color: #000000;">├── LICENSE
├── logs             </span><span style="color: #008000;">#</span><span style="color: #008000;"> tomcat 日志存放目录，catalina.out 为主要输出日志</span>
<span style="color: #000000;">├── NOTICE
├── RELEASE</span>-<span style="color: #000000;">NOTES
├── RUNNING.txt
├── temp             </span><span style="color: #008000;">#</span><span style="color: #008000;"> 存放临时文件</span>
├── webapps         <span style="color: #008000;">#</span><span style="color: #008000;"> web程序存放目录</span>
└── work             <span style="color: #008000;">#</span><span style="color: #008000;"> 存放编译产生的.java 与 .class文件</span>

7 directories, 4 files</pre>
</div>

### <span id="132_webapps">1.3.2 webapps<span style="font-family: '微软雅黑',sans-serif;">目录介绍</span></span>

<div class="cnblogs_code">
  <pre>[root@web03 tomcat]<span style="color: #008000;">#</span><span style="color: #008000;"> cd webapps/</span>
[root@web03 webapps]<span style="color: #008000;">#</span><span style="color: #008000;"> tree -L 1</span>
<span style="color: #000000;">.
├── docs            </span><span style="color: #008000;">#</span><span style="color: #008000;"> tomcat 帮助文档</span>
├── examples       <span style="color: #008000;">#</span><span style="color: #008000;"> web应用实例</span>
├── host-manager  <span style="color: #008000;">#</span><span style="color: #008000;"> 主机管理</span>
├── manager         <span style="color: #008000;">#</span><span style="color: #008000;"> 管理</span>
└── ROOT             <span style="color: #008000;">#</span><span style="color: #008000;"> 默认站点根目录</span>

5 directories, 0 files</pre>
</div>

### <span id="133_Tomcatconf">1.3.3 Tomcat<span style="font-family: '微软雅黑',sans-serif;">配置文件目录介绍（</span>conf<span style="font-family: '微软雅黑',sans-serif;">）</span></span>

<div class="cnblogs_code">
  <pre>[root@web03 conf]<span style="color: #008000;">#</span><span style="color: #008000;"> tree -L 1</span>
<span style="color: #000000;">.
├── Catalina
├── catalina.policy
├── catalina.properties
├── context.xml
├── logging.properties
├── logs
├── server.xml           </span><span style="color: #008000;">#</span><span style="color: #008000;"> tomcat 主配置文件</span>
<span style="color: #000000;">├── server.xml.bak
├── server.xml.bak2
├── tomcat</span>-users.xml    <span style="color: #008000;">#</span><span style="color: #008000;"> tomcat 管理用户配置文件</span>
├── tomcat-<span style="color: #000000;">users.xsd
└── web.xml

</span>2 directories, 10 files</pre>
</div>

## <span id="14_Tomcat">1.4 Tomcat<span style="font-family: '微软雅黑',sans-serif;">的管理</span></span>

<div class="cnblogs_code">
  <pre><span style="color: #008000;">#</span><span style="color: #008000;">  启动程序/application/tomcat/bin/startup.sh</span><span style="color: #008000;">
#</span><span style="color: #008000;">  关闭程序/application/tomcat/bin/shutdown.sh</span></pre>
</div>

<span style="font-family: 等线;">启动停止</span>

<div class="cnblogs_code">
  <pre>[root@web03 ~]<span style="color: #008000;">#</span><span style="color: #008000;"> /application/tomcat/bin/shutdown.sh </span>
Using CATALINA_BASE:   /application/<span style="color: #000000;">tomcat
Using CATALINA_HOME:   </span>/application/<span style="color: #000000;">tomcat
Using CATALINA_TMPDIR: </span>/application/tomcat/<span style="color: #000000;">temp
Using JRE_HOME:        </span>/application/<span style="color: #000000;">jdk
Using CLASSPATH:       </span>/application/tomcat/bin/bootstrap.jar:/application/tomcat/bin/tomcat-<span style="color: #000000;">juli.jar
[root@web03 </span>~]<span style="color: #008000;">#</span><span style="color: #008000;"> /application/tomcat/bin/startup.sh </span>
Using CATALINA_BASE:   /application/<span style="color: #000000;">tomcat
Using CATALINA_HOME:   </span>/application/<span style="color: #000000;">tomcat
Using CATALINA_TMPDIR: </span>/application/tomcat/<span style="color: #000000;">temp
Using JRE_HOME:        </span>/application/<span style="color: #000000;">jdk
Using CLASSPATH:       </span>/application/tomcat/bin/bootstrap.jar:/application/tomcat/bin/tomcat-<span style="color: #000000;">juli.jar
Tomcat started.</span></pre>
</div>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: 等线;">注意：</span>tomcat<span style="font-family: 等线;">未启动的情况下使用</span>shutdown<span style="font-family: 等线;">脚本，会有大量的输出信息。</span>

_<span style="text-decoration: underline;"><span style="font-family: 等线;">检查</span>tomcat</span>__<span style="text-decoration: underline;"><span style="font-family: 等线;">是否启动正常</span></span>_

<div class="cnblogs_code">
  <pre>[root@web03 ~]<span style="color: #008000;">#</span><span style="color: #008000;"> netstat -lntup  |grep java</span>
tcp6       0      0 :::8080         :::*                   LISTEN      30560/<span style="color: #000000;">java          
tcp6       0      0 </span>127.0.0.1:8005          :::*          LISTEN      30560/<span style="color: #000000;">java          
tcp6       0      0 :::</span>8009                 :::*           LISTEN      30560/java      </pre>
</div>

<p style="text-indent: 15.75pt;">
  <strong><em><span style="text-decoration: underline;"><span style="font-family: 等线; background: lime;">说明：</span></span></em></strong><span style="font-family: 等线;">所有与</span>java<span style="font-family: 等线;">相关的，服务启动都是</span>java<span style="font-family: 等线;">命名的进程</span>
</p>

### <span id="141">1.4.1 <span style="font-family: '微软雅黑',sans-serif;">启动完成浏览器进行访问</span></span>

<p style="margin-left: 7.1pt; text-indent: 13.9pt;">
  http://10.0.0.17:8080/
</p>

<p style="margin-left: 7.1pt; text-indent: 13.9pt;">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171127161441800-1077081232.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="企业级Tomcat部署实践及安全调优" alt="" />
</p>

## <span id="15_Tomcat">1.5 Tomcat<span style="font-family: '微软雅黑',sans-serif;">日志说明</span></span>

### <span id="151">1.5.1 <span style="font-family: '微软雅黑',sans-serif;">查看日志</span></span>

<div class="cnblogs_code">
  <pre>[root@web03 ~]<span style="color: #008000;">#</span><span style="color: #008000;"> tailf /application/tomcat/logs/catalina.out</span>
24-Nov-2017 15:09:51.654 INFO [main] org.apache.coyote.AbstractProtocol.start Starting ProtocolHandler [<span style="color: #800000;">"</span><span style="color: #800000;">http-nio-8080</span><span style="color: #800000;">"</span><span style="color: #000000;">]
</span>24-Nov-2017 15:09:51.665 INFO [main] org.apache.coyote.AbstractProtocol.start Starting ProtocolHandler [<span style="color: #800000;">"</span><span style="color: #800000;">ajp-nio-8009</span><span style="color: #800000;">"</span><span style="color: #000000;">]
</span>24-Nov-2017 15:09:51.670 INFO [main] org.apache.catalina.startup.Catalina.start Server startup <span style="color: #0000ff;">in</span> <span style="background-color: #00ffff;">60037</span> ms</pre>
</div>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: 等线;">发现启动时间较长，其中有一项的启动时间占据了绝大多数</span>

<div class="cnblogs_code">
  <pre>24-Nov-2017 15:09:50.629 INFO [localhost-startStop-1] org.apache.catalina.startup.HostConfig.deployWAR Deployment of web application archive /application/apache-tomcat-8.0.27/webapps/memtest.war has finished <span style="color: #0000ff;">in</span> <span style="background-color: #00ffff;">58,892</span> ms</pre>
</div>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: 等线;">发现耗时在这里：是</span>session<span style="font-family: 等线;">引起的随机数问题导致的。</span>Tocmat<span style="font-family: 等线;">的</span>Session ID<span style="font-family: 等线;">是通过</span>SHA1<span style="font-family: 等线;">算法计算得到的，计算</span>Session ID<span style="font-family: 等线;">的时候必须有一个密钥。为了提高安全性</span>Tomcat<span style="font-family: 等线;">在启动的时候会通过随机生成一个密钥。</span>

### <span id="152_Tomcat">1.5.2 <span style="font-family: '微软雅黑',sans-serif;">解决</span>Tomcat<span style="font-family: '微软雅黑',sans-serif;">启动慢的方法</span></span>

Tomcat<span style="font-family: 等线;">启动慢主要原因是生成随机数的时候卡住了</span>,<span style="font-family: 等线;">导致</span>tomcat<span style="font-family: 等线;">启动不了。</span>

<p style="text-indent: 21.0pt;">
  <span style="font-family: 等线;">是否有足够的熵来用于产生随机数，可以通过如下命令来查看</span>
</p>

<div class="cnblogs_code">
  <pre>[root@web03 ~]<span style="color: #008000;">#</span><span style="color: #008000;"> cat /proc/sys/kernel/random/entropy_avail</span>
6</pre>
</div>

<p style="text-indent: 15.75pt;">
  <span style="font-family: 等线;">为了加速</span>/dev/random<span style="font-family: 等线;">提供随机数的速度，你可以通过操作设备的外设，让其产生大量的中断，网络传输数据，按键，移动鼠标，在命令行敲几个不同的命令，俗称聚气。</span>
</p>

cat /dev/random <span style="font-family: 等线;">会消耗能量</span>

**<span style="text-decoration: underline;"><span style="font-family: 等线; background: lime;">方法</span><span style="background: lime;">1</span></span>****<span style="text-decoration: underline;"><span style="font-family: 等线; background: lime;">：</span></span>**

<div class="cnblogs_code">
  <pre>vim $JAVA_HOME/jre/lib/security/<span style="color: #000000;">java.security
securerandom.source</span>=file:/dev/random</pre>
</div>

<span style="font-family: 等线;">改为</span>

<div class="cnblogs_code">
  <pre>securerandom.source=file:/dev/urandom</pre>
</div>

**<span style="text-decoration: underline;"><span style="font-family: 等线; background: lime;">方法</span><span style="background: lime;">2</span></span>****<span style="text-decoration: underline;"><span style="font-family: 等线; background: lime;">：</span></span>**

<div class="cnblogs_code">
  <pre>vim $TOMCAT_HOME/bin/<span style="color: #000000;">catalina.sh
</span><span style="color: #0000ff;">if</span> [[ <span style="color: #800000;">"</span><span style="color: #800000;">$JAVA_OPTS</span><span style="color: #800000;">"</span> != *-Djava.security.egd=*<span style="color: #000000;"> ]]; then
    JAVA_OPTS</span>=<span style="color: #800000;">"</span><span style="color: #800000;">$JAVA_OPTS -Djava.security.egd=file:/dev/urandom</span><span style="color: #800000;">"</span><span style="color: #000000;">
fi</span></pre>
</div>

<p style="text-indent: 15.75pt;">
  <span style="font-family: 等线;">这个系统属性</span>egd<span style="font-family: 等线;">表示熵收集守护进程</span>(entropy gathering daemon)
</p>

**<span style="text-decoration: underline;"><span style="font-family: 等线; background: yellow;">方法</span><span style="background: yellow;">3</span></span>****<span style="text-decoration: underline;"><span style="font-family: 等线; background: yellow;">：（推荐）</span></span>**

<div class="cnblogs_code">
  <pre>yum install rng-tools <span style="color: #008000;">#</span><span style="color: #008000;"> 安装rngd服务（熵服务，增大熵池）</span>
systemctl start rngd  <span style="color: #008000;">#</span><span style="color: #008000;"> 启动服务</span></pre>
</div>

## <span id="16_Tomcat">1.6 Tomcat<span style="font-family: '微软雅黑',sans-serif;">管理功能使用</span></span>

<p style="margin-left: 21.0pt;">
  <strong><span style="font-family: 等线; color: red;">注意：测试功能，生产环境不要用</span></strong>
</p>

<p style="text-indent: 21.0pt;">
  Tomcat<span style="font-family: 等线;">管理功能用于对</span>Tomcat<span style="font-family: 等线;">自身以及部署在</span>Tomcat<span style="font-family: 等线;">上的应用进行管理的</span>web<span style="font-family: 等线;">应用。在默认情况下是处于禁用状态的。如果需要开启这个功能，就需要配置管理用户，即配置</span>tomcat-users.xml <span style="font-family: 等线;">文件。</span>
</p>

<div class="cnblogs_code">
  <pre>[root@web03 ~]<span style="color: #008000;">#</span><span style="color: #008000;"> vim /application/tomcat/conf/tomcat-users.xml</span>
<span style="color: #000000;">&hellip;&hellip;
</span>39 &lt;role rolename=<span style="color: #800000;">"</span><span style="color: #800000;">manager-gui</span><span style="color: #800000;">"</span>/>
 40 &lt;role rolename=<span style="color: #800000;">"</span><span style="color: #800000;">admin-gui</span><span style="color: #800000;">"</span>/>
 41 &lt;user username=<span style="color: #800000;">"</span><span style="color: #800000;">tomcat</span><span style="color: #800000;">"</span> password=<span style="color: #800000;">"</span><span style="color: #800000;">tomcat</span><span style="color: #800000;">"</span> roles=<span style="color: #800000;">"</span><span style="color: #800000;">manager-gui,admin-gui</span><span style="color: #800000;">"</span>/>
 42 &lt;/tomcat-users>   <span style="color: #008000;">#</span><span style="color: #008000;"> 在此行前加入上面三行</span></pre>
</div>

**_<span style="text-decoration: underline;"><span style="font-family: 等线; background: yellow;">未修改文件前进行访问</span></span>_**

<p style="text-align: center;" align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171127161652222-1076194549.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="企业级Tomcat部署实践及安全调优" alt="" />
</p>

<div class="cnblogs_code">
  <pre>&lt;role rolename=<span style="color: #800000;">"</span><span style="color: #800000;">manager-gui</span><span style="color: #800000;">"</span>/>
&lt;user username=<span style="color: #800000;">"</span><span style="color: #800000;">tomcat</span><span style="color: #800000;">"</span> password=<span style="color: #800000;">"</span><span style="color: #800000;">s3cret</span><span style="color: #800000;">"</span> roles=<span style="color: #800000;">"</span><span style="color: #800000;">manager-gui</span><span style="color: #800000;">"</span>/></pre>
</div>

<p style="text-align: center;" align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171127161724815-1070672278.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="企业级Tomcat部署实践及安全调优" alt="" />
</p>

<div class="cnblogs_code">
  <pre>&lt;role rolename=<span style="color: #800000;">"</span><span style="color: #800000;">admin-gui</span><span style="color: #800000;">"</span>/>
&lt;user username=<span style="color: #800000;">"</span><span style="color: #800000;">tomcat</span><span style="color: #800000;">"</span> password=<span style="color: #800000;">"</span><span style="color: #800000;">s3cret</span><span style="color: #800000;">"</span> roles=<span style="color: #800000;">"</span><span style="color: #800000;">admin-gui</span><span style="color: #800000;">"</span>/></pre>
</div>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: 等线;">从而得出上面的配置文件信息。</span>

### <span id="161_web">1.6.1 <span style="font-family: '微软雅黑',sans-serif;">在</span>web<span style="font-family: '微软雅黑',sans-serif;">界面访问管理界面</span></span>

<p style="text-align: center;" align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171127161751487-2030329982.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="企业级Tomcat部署实践及安全调优" alt="" />
</p>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: 等线;">输入之前配置的账户与密码即可</span>

<p style="text-align: center;" align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171127161800081-74753629.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="企业级Tomcat部署实践及安全调优" alt="" />
</p>

<p style="text-align: center;" align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171127161808956-1963855479.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="企业级Tomcat部署实践及安全调优" alt="" />
</p>

## <span id="17_Tomcat">1.7 Tomcat<span style="font-family: '微软雅黑',sans-serif;">主配置文件详解</span></span>

### <span id="171_serverxml">1.7.1 server.xml<span style="font-family: '微软雅黑',sans-serif;">组件类别</span></span>

<div style="border: solid windowtext 2.0pt; padding: 1.0pt 4.0pt 1.0pt 4.0pt; background: #F2F2F2;">
  <p style="text-indent: 21.2pt; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">
    <span style="font-family: '微软雅黑',sans-serif;">顶级组件：位于整个配置的顶层，如</span>server<span style="font-family: '微软雅黑',sans-serif;">。</span>
  </p>
  
  <p style="text-indent: 21.2pt; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">
    <span style="font-family: '微软雅黑',sans-serif;">容器类组件：可以包含其它组件的组件，如</span>service<span style="font-family: '微软雅黑',sans-serif;">、</span>engine<span style="font-family: '微软雅黑',sans-serif;">、</span>host<span style="font-family: '微软雅黑',sans-serif;">、</span>context<span style="font-family: '微软雅黑',sans-serif;">。</span>
  </p>
  
  <p style="text-indent: 21.2pt; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">
    <span style="font-family: '微软雅黑',sans-serif;">连接器组件：连接用户请求至</span>tomcat<span style="font-family: '微软雅黑',sans-serif;">，如</span>connector<span style="font-family: '微软雅黑',sans-serif;">。</span>
  </p>
  
  <p style="text-indent: 21.2pt; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">
    <span style="font-family: '微软雅黑',sans-serif;">被嵌套类组件：位于一个容器当中，不能包含其他组件，如</span>Valve<span style="font-family: '微软雅黑',sans-serif;">、</span>logger<span style="font-family: '微软雅黑',sans-serif;">。</span>
  </p>
</div>

<div class="cnblogs_code">
  <pre>&lt;server>
     &lt;service>
     &lt;connector />
     &lt;engine>
     &lt;host>
     &lt;context>&lt;/context>
     &lt;/host>
     &lt;host>
     &lt;context>&lt;/context>
     &lt;/host>
     &lt;/engine>
     &lt;/service>
&lt;/server></pre>
</div>

### <span id="172">1.7.2 <span style="font-family: '微软雅黑',sans-serif;">组件介绍</span></span>

<div align="center">
  <table style="border-collapse: collapse; border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
    <tr>
      <td style="width: 133.25pt; border-top: 1pt solid #a5a5a5; border-bottom: 1pt solid #a5a5a5; border-left: 1pt solid #a5a5a5; border-right: none; background: #a5a5a5; padding: 0cm 5.4pt;" valign="top" width="178">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 宋体; times new roman"4times new roman";times new roman";color: white;">组件名称</span></strong>
        </p>
      </td>
      
      <td style="width: 389.55pt; border-top: 1pt solid #a5a5a5; border-right: 1pt solid #a5a5a5; border-bottom: 1pt solid #a5a5a5; border-left: none; background: #a5a5a5; padding: 0cm 5.4pt;" valign="top" width="519">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 宋体; times new roman"4times new roman";times new roman";color: white;">功能介绍</span></strong>
        </p>
      </td>
    </tr>
    
    <tr>
      <td style="width: 133.25pt; border-right: 1pt solid #c9c9c9; border-bottom: 1pt solid #c9c9c9; border-left: 1pt solid #c9c9c9; border-top: none; background: #ededed; padding: 0cm 5.4pt;" width="178">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">engine</span></strong>
        </p>
      </td>
      
      <td style="width: 389.55pt; border-top: none; border-left: none; border-bottom: solid #C9C9C9 1.0pt; border-right: solid #C9C9C9 1.0pt; background: #EDEDED; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="519">
        <p style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;">
          <span style="font-size: 10.0pt; font-family: 宋体;">核心容器组件，</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">catalina</span><span style="font-size: 10.0pt; font-family: 宋体;">引擎，负责通过</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">connector</span><span style="font-size: 10.0pt; font-family: 宋体;">接收用户请求，并处理请求，将请求转至对应的虚拟主机</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">host</span><span style="font-size: 10.0pt; font-family: 宋体;">。</span>
        </p>
      </td>
    </tr>
    
    <tr>
      <td style="width: 133.25pt; border-right: 1pt solid #c9c9c9; border-bottom: 1pt solid #c9c9c9; border-left: 1pt solid #c9c9c9; border-top: none; padding: 0cm 5.4pt;" width="178">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">host</span></strong>
        </p>
      </td>
      
      <td style="width: 389.55pt; border-top: none; border-left: none; border-bottom: solid #C9C9C9 1.0pt; border-right: solid #C9C9C9 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="519">
        <p style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;">
          <span style="font-size: 10.0pt; font-family: 宋体;">类似于</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">httpd</span><span style="font-size: 10.0pt; font-family: 宋体;">中的虚拟主机，一般而言支持基于</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">FQDN</span><span style="font-size: 10.0pt; font-family: 宋体;">的虚拟主机。</span>
        </p>
      </td>
    </tr>
    
    <tr>
      <td style="width: 133.25pt; border-right: 1pt solid #c9c9c9; border-bottom: 1pt solid #c9c9c9; border-left: 1pt solid #c9c9c9; border-top: none; background: #ededed; padding: 0cm 5.4pt;" width="178">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">context</span></strong>
        </p>
      </td>
      
      <td style="width: 389.55pt; border-top: none; border-left: none; border-bottom: solid #C9C9C9 1.0pt; border-right: solid #C9C9C9 1.0pt; background: #EDEDED; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="519">
        <p style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;">
          <span style="font-size: 10.0pt; font-family: 宋体;">定义一个应用程序，是一个最内层的容器类组件（不能再嵌套）。配置</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">context</span><span style="font-size: 10.0pt; font-family: 宋体;">的主要目的指定对应对的</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">webapp</span><span style="font-size: 10.0pt; font-family: 宋体;">的根目录，类似于</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">httpd</span><span style="font-size: 10.0pt; font-family: 宋体;">的</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">alias</span><span style="font-size: 10.0pt; font-family: 宋体;">，其还能为</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">webapp</span><span style="font-size: 10.0pt; font-family: 宋体;">指定额外的属性，如部署方式等。</span>
        </p>
      </td>
    </tr>
    
    <tr>
      <td style="width: 133.25pt; border-right: 1pt solid #c9c9c9; border-bottom: 1pt solid #c9c9c9; border-left: 1pt solid #c9c9c9; border-top: none; padding: 0cm 5.4pt;" width="178">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">connector</span></strong>
        </p>
      </td>
      
      <td style="width: 389.55pt; border-top: none; border-left: none; border-bottom: solid #C9C9C9 1.0pt; border-right: solid #C9C9C9 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="519">
        <p style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;">
          <span style="font-size: 10.0pt; font-family: 宋体;">接收用户请求，类似于</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">httpd</span><span style="font-size: 10.0pt; font-family: 宋体;">的</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">listen</span><span style="font-size: 10.0pt; font-family: 宋体;">配置监听端口的。</span>
        </p>
      </td>
    </tr>
    
    <tr>
      <td style="width: 133.25pt; border-right: 1pt solid #c9c9c9; border-bottom: 1pt solid #c9c9c9; border-left: 1pt solid #c9c9c9; border-top: none; background: #ededed; padding: 0cm 5.4pt;" width="178">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">service</span></strong><strong><span style="font-size: 10.0pt; font-family: 宋体;">（服务）</span></strong>
        </p>
      </td>
      
      <td style="width: 389.55pt; border-top: none; border-left: none; border-bottom: solid #C9C9C9 1.0pt; border-right: solid #C9C9C9 1.0pt; background: #EDEDED; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="519">
        <p style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;">
          <span style="font-size: 10.0pt; font-family: 宋体;">将</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">connector</span><span style="font-size: 10.0pt; font-family: 宋体;">关联至</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">engine</span><span style="font-size: 10.0pt; font-family: 宋体;">，因此一个</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">service</span><span style="font-size: 10.0pt; font-family: 宋体;">内部可以有多个</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">connector</span><span style="font-size: 10.0pt; font-family: 宋体;">，但只能有一个引擎</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">engine</span><span style="font-size: 10.0pt; font-family: 宋体;">。</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">service</span><span style="font-size: 10.0pt; font-family: 宋体;">内部有两个</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">connector</span><span style="font-size: 10.0pt; font-family: 宋体;">，一个</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">engine</span><span style="font-size: 10.0pt; font-family: 宋体;">。因此，一般情况下一个</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">server</span><span style="font-size: 10.0pt; font-family: 宋体;">内部只有一个</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">service</span><span style="font-size: 10.0pt; font-family: 宋体;">，一个</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">service</span><span style="font-size: 10.0pt; font-family: 宋体;">内部只有一个</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">engine</span><span style="font-size: 10.0pt; font-family: 宋体;">，但一个</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">service</span><span style="font-size: 10.0pt; font-family: 宋体;">内部可以有多个</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">connector</span><span style="font-size: 10.0pt; font-family: 宋体;">。</span>
        </p>
      </td>
    </tr>
    
    <tr>
      <td style="width: 133.25pt; border-right: 1pt solid #c9c9c9; border-bottom: 1pt solid #c9c9c9; border-left: 1pt solid #c9c9c9; border-top: none; padding: 0cm 5.4pt;" width="178">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">server</span></strong>
        </p>
      </td>
      
      <td style="width: 389.55pt; border-top: none; border-left: none; border-bottom: solid #C9C9C9 1.0pt; border-right: solid #C9C9C9 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="519">
        <p style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;">
          <span style="font-size: 10.0pt; font-family: 宋体;">表示一个运行于</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">JVM</span><span style="font-size: 10.0pt; font-family: 宋体;">中的</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">tomcat</span><span style="font-size: 10.0pt; font-family: 宋体;">实例。</span>
        </p>
      </td>
    </tr>
    
    <tr>
      <td style="width: 133.25pt; border-right: 1pt solid #c9c9c9; border-bottom: 1pt solid #c9c9c9; border-left: 1pt solid #c9c9c9; border-top: none; background: #ededed; padding: 0cm 5.4pt;" width="178">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">Valve</span></strong>
        </p>
      </td>
      
      <td style="width: 389.55pt; border-top: none; border-left: none; border-bottom: solid #C9C9C9 1.0pt; border-right: solid #C9C9C9 1.0pt; background: #EDEDED; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="519">
        <p style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;">
          <span style="font-size: 10.0pt; font-family: 宋体;">阀门，拦截请求并在将其转至对应的</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">webapp</span><span style="font-size: 10.0pt; font-family: 宋体;">前进行某种处理操作，可以用于任何容器中，比如记录日志</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">(access log valve)</span><span style="font-size: 10.0pt; font-family: 宋体;">、基于</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">IP</span><span style="font-size: 10.0pt; font-family: 宋体;">做访问控制</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">(remote address filter valve)</span><span style="font-size: 10.0pt; font-family: 宋体;">。</span>
        </p>
      </td>
    </tr>
    
    <tr>
      <td style="width: 133.25pt; border-right: 1pt solid #c9c9c9; border-bottom: 1pt solid #c9c9c9; border-left: 1pt solid #c9c9c9; border-top: none; padding: 0cm 5.4pt;" width="178">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">logger</span></strong>
        </p>
      </td>
      
      <td style="width: 389.55pt; border-top: none; border-left: none; border-bottom: solid #C9C9C9 1.0pt; border-right: solid #C9C9C9 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="519">
        <p style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;">
          <span style="font-size: 10.0pt; font-family: 宋体;">日志记录器，用于记录组件内部的状态信息，可以用于除</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">context</span><span style="font-size: 10.0pt; font-family: 宋体;">外的任何容器中。</span>
        </p>
      </td>
    </tr>
    
    <tr>
      <td style="width: 133.25pt; border-right: 1pt solid #c9c9c9; border-bottom: 1pt solid #c9c9c9; border-left: 1pt solid #c9c9c9; border-top: none; background: #ededed; padding: 0cm 5.4pt;" width="178">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">realm</span></strong>
        </p>
      </td>
      
      <td style="width: 389.55pt; border-top: none; border-left: none; border-bottom: solid #C9C9C9 1.0pt; border-right: solid #C9C9C9 1.0pt; background: #EDEDED; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="519">
        <p style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;">
          <span style="font-size: 10.0pt; font-family: 宋体;">可以用于任意容器类的组件中，关联一个用户认证库，实现认证和授权。可以关联的认证库有两种：</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">UserDatabaseRealm</span><span style="font-size: 10.0pt; font-family: 宋体;">、</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">MemoryRealm</span><span style="font-size: 10.0pt; font-family: 宋体;">和</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">JDBCRealm</span><span style="font-size: 10.0pt; font-family: 宋体;">。</span>
        </p>
      </td>
    </tr>
    
    <tr>
      <td style="width: 133.25pt; border-right: 1pt solid #c9c9c9; border-bottom: 1pt solid #c9c9c9; border-left: 1pt solid #c9c9c9; border-top: none; padding: 0cm 5.4pt;" width="178">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">UserDatabaseRealm</span></strong>
        </p>
      </td>
      
      <td style="width: 389.55pt; border-top: none; border-left: none; border-bottom: solid #C9C9C9 1.0pt; border-right: solid #C9C9C9 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="519">
        <p style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;">
          <span style="font-size: 10.0pt; font-family: 宋体;">使用</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">JNDI</span><span style="font-size: 10.0pt; font-family: 宋体;">自定义的用户认证库。</span>
        </p>
      </td>
    </tr>
    
    <tr>
      <td style="width: 133.25pt; border-right: 1pt solid #c9c9c9; border-bottom: 1pt solid #c9c9c9; border-left: 1pt solid #c9c9c9; border-top: none; background: #ededed; padding: 0cm 5.4pt;" width="178">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">MemoryRealm</span></strong>
        </p>
      </td>
      
      <td style="width: 389.55pt; border-top: none; border-left: none; border-bottom: solid #C9C9C9 1.0pt; border-right: solid #C9C9C9 1.0pt; background: #EDEDED; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="519">
        <p style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;">
          <span style="font-size: 10.0pt; font-family: 宋体;">认证信息定义在</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">tomcat-users.xml</span><span style="font-size: 10.0pt; font-family: 宋体;">中。</span>
        </p>
      </td>
    </tr>
    
    <tr>
      <td style="width: 133.25pt; border-right: 1pt solid #c9c9c9; border-bottom: 1pt solid #c9c9c9; border-left: 1pt solid #c9c9c9; border-top: none; padding: 0cm 5.4pt;" width="178">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">JDBCRealm</span></strong>
        </p>
      </td>
      
      <td style="width: 389.55pt; border-top: none; border-left: none; border-bottom: solid #C9C9C9 1.0pt; border-right: solid #C9C9C9 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="519">
        <p style="margin-bottom: .0001pt; text-align: justify; text-justify: inter-ideograph;">
          <span style="font-size: 10.0pt; font-family: 宋体;">认证信息定义在数据库中，并通过</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">JDBC</span><span style="font-size: 10.0pt; font-family: 宋体;">连接至数据库中查找认证用户。</span>
        </p>
      </td>
    </tr>
  </table>
</div>

### <span id="173_serverxml">1.7.3 server.xml<span style="font-family: '微软雅黑',sans-serif;">配置文件注释</span></span>

<div class="cnblogs_code">
  <pre><span style="color: #0000ff;"><?</span>

<span style="color: #ff00ff;">xml version='1.0' encoding='utf-8'</span><span style="color: #0000ff;">?></span>
<span style="color: #008000;"><!--</span><span style="color: #008000;">
<Server>元素代表整个容器,是Tomcat实例的顶层元素.由org.apache.catalina.Server接口来定义.它包含一个<Service>元素.并且它不能做为任何元素的子元素.
    port指定Tomcat监听shutdown命令端口.终止服务器运行时,必须在Tomcat服务器所在的机器上发出shutdown命令.该属性是必须的.
    shutdown指定终止Tomcat服务器运行时,发给Tomcat服务器的shutdown监听端口的字符串.该属性必须设置
</span><span style="color: #008000;">--></span>


<span style="color: #0000ff;"><</span><span style="color: #800000;">Server </span><span style="color: #ff0000;">port</span><span style="color: #0000ff;">="8005"</span><span style="color: #ff0000;"> shutdown</span><span style="color: #0000ff;">="SHUTDOWN"</span><span style="color: #0000ff;">></span>
  <span style="color: #0000ff;"><</span><span style="color: #800000;">Listener </span><span style="color: #ff0000;">className</span><span style="color: #0000ff;">="org.apache.catalina.startup.VersionLoggerListener"</span> <span style="color: #0000ff;">/></span>
  <span style="color: #0000ff;"><</span><span style="color: #800000;">Listener </span><span style="color: #ff0000;">className</span><span style="color: #0000ff;">="org.apache.catalina.core.AprLifecycleListener"</span><span style="color: #ff0000;"> SSLEngine</span><span style="color: #0000ff;">="on"</span> <span style="color: #0000ff;">/></span>
  <span style="color: #0000ff;"><</span><span style="color: #800000;">Listener </span><span style="color: #ff0000;">className</span><span style="color: #0000ff;">="org.apache.catalina.core.JreMemoryLeakPreventionListener"</span> <span style="color: #0000ff;">/></span>
  <span style="color: #0000ff;"><</span><span style="color: #800000;">Listener </span><span style="color: #ff0000;">className</span><span style="color: #0000ff;">="org.apache.catalina.mbeans.GlobalResourcesLifecycleListener"</span> <span style="color: #0000ff;">/></span>
  <span style="color: #0000ff;"><</span><span style="color: #800000;">Listener </span><span style="color: #ff0000;">className</span><span style="color: #0000ff;">="org.apache.catalina.core.ThreadLocalLeakPreventionListener"</span> <span style="color: #0000ff;">/></span>
  <span style="color: #0000ff;"><</span><span style="color: #800000;">GlobalNamingResources</span><span style="color: #0000ff;">></span>
    <span style="color: #0000ff;"><</span><span style="color: #800000;">Resource </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">="UserDatabase"</span><span style="color: #ff0000;"> auth</span><span style="color: #0000ff;">="Container"</span><span style="color: #ff0000;">
              type</span><span style="color: #0000ff;">="org.apache.catalina.UserDatabase"</span><span style="color: #ff0000;">
              description</span><span style="color: #0000ff;">="User database that can be updated and saved"</span><span style="color: #ff0000;">
              factory</span><span style="color: #0000ff;">="org.apache.catalina.users.MemoryUserDatabaseFactory"</span><span style="color: #ff0000;">
              pathname</span><span style="color: #0000ff;">="conf/tomcat-users.xml"</span> <span style="color: #0000ff;">/></span>
  <span style="color: #0000ff;"></</span><span style="color: #800000;">GlobalNamingResources</span><span style="color: #0000ff;">></span>
  <span style="color: #008000;"><!--</span><span style="color: #008000;">service服务组件</span><span style="color: #008000;">--></span>
  

<span style="color: #0000ff;"><</span><span style="color: #800000;">Service </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">="Catalina"</span><span style="color: #0000ff;">></span>
    <span style="color: #008000;"><!--</span><span style="color: #008000;"> Connector主要参数说明（见下表） </span><span style="color: #008000;">--></span>
    

<span style="color: #0000ff;"><</span><span style="color: #800000;">Connector </span><span style="color: #ff0000;">port</span><span style="color: #0000ff;">="8080"</span><span style="color: #ff0000;"> protocol</span><span style="color: #0000ff;">="HTTP/1.1"</span><span style="color: #ff0000;">
               connectionTimeout</span><span style="color: #0000ff;">="20000"</span><span style="color: #ff0000;">
               redirectPort</span><span style="color: #0000ff;">="8443"</span> <span style="color: #0000ff;">/></span>
    <span style="color: #0000ff;"><</span><span style="color: #800000;">Connector </span><span style="color: #ff0000;">port</span><span style="color: #0000ff;">="8009"</span><span style="color: #ff0000;"> protocol</span><span style="color: #0000ff;">="AJP/1.3"</span><span style="color: #ff0000;"> redirectPort</span><span style="color: #0000ff;">="8443"</span> <span style="color: #0000ff;">/></span>
    <span style="color: #008000;"><!--</span><span style="color: #008000;">engine,核心容器组件,catalina引擎,负责通过connector接收用户请求,并处理请求,将请求转至对应的虚拟主机host
        defaultHost指定缺省的处理请求的主机名，它至少与其中的一个host元素的name属性值是一样的
    </span><span style="color: #008000;">--></span>
    

<span style="color: #0000ff;"><</span><span style="color: #800000;">Engine </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">="Catalina"</span><span style="color: #ff0000;"> defaultHost</span><span style="color: #0000ff;">="localhost"</span><span style="color: #0000ff;">></span>
      <span style="color: #008000;"><!--</span><span style="color: #008000;">Realm表示存放用户名，密码及role的数据库</span><span style="color: #008000;">--></span>
      

<span style="color: #0000ff;"><</span><span style="color: #800000;">Realm </span><span style="color: #ff0000;">className</span><span style="color: #0000ff;">="org.apache.catalina.realm.LockOutRealm"</span><span style="color: #0000ff;">></span>
        <span style="color: #0000ff;"><</span><span style="color: #800000;">Realm </span><span style="color: #ff0000;">className</span><span style="color: #0000ff;">="org.apache.catalina.realm.UserDatabaseRealm"</span><span style="color: #ff0000;">
               resourceName</span><span style="color: #0000ff;">="UserDatabase"</span><span style="color: #0000ff;">/></span>
      <span style="color: #0000ff;"></</span><span style="color: #800000;">Realm</span><span style="color: #0000ff;">></span>
      <span style="color: #008000;"><!--</span><span style="color: #008000;"> 详情常见下表（host参数详解）</span><span style="color: #008000;">--></span>
      

<span style="color: #0000ff;"><</span><span style="color: #800000;">Host </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">="localhost"</span><span style="color: #ff0000;">  appBase</span><span style="color: #0000ff;">="webapps"</span><span style="color: #ff0000;">
            unpackWARs</span><span style="color: #0000ff;">="true"</span><span style="color: #ff0000;"> autoDeploy</span><span style="color: #0000ff;">="true"</span><span style="color: #0000ff;">></span>
        <span style="color: #008000;"><!--</span><span style="color: #008000;"> 详情常见下表（Context参数说明 ）</span><span style="color: #008000;">--></span>
        

<span style="color: #0000ff;"><</span><span style="color: #800000;">Context </span><span style="color: #ff0000;">path</span><span style="color: #0000ff;">=""</span><span style="color: #ff0000;"> docBase</span><span style="color: #0000ff;">=""</span><span style="color: #ff0000;"> debug</span><span style="color: #0000ff;">=""</span><span style="color: #0000ff;">/></span>
        <span style="color: #0000ff;"><</span><span style="color: #800000;">Valve </span><span style="color: #ff0000;">className</span><span style="color: #0000ff;">="org.apache.catalina.valves.AccessLogValve"</span><span style="color: #ff0000;"> directory</span><span style="color: #0000ff;">="logs"</span><span style="color: #ff0000;">
               prefix</span><span style="color: #0000ff;">="localhost_access_log"</span><span style="color: #ff0000;"> suffix</span><span style="color: #0000ff;">=".txt"</span><span style="color: #ff0000;">
               pattern</span><span style="color: #0000ff;">="%h %l %u %t "%r" %s %b"</span> <span style="color: #0000ff;">/></span>
      <span style="color: #0000ff;"></</span><span style="color: #800000;">Host</span><span style="color: #0000ff;">></span>
    <span style="color: #0000ff;"></</span><span style="color: #800000;">Engine</span><span style="color: #0000ff;">></span>
  <span style="color: #0000ff;"></</span><span style="color: #800000;">Service</span><span style="color: #0000ff;">></span>
<span style="color: #0000ff;"></</span><span style="color: #800000;">Server</span><span style="color: #0000ff;">></span></pre>
</div>


<h3>
  <span id="174_Connector">1.7.4 Connector<span style="font-family: '微软雅黑',sans-serif;">主要参数说明</span></span>
</h3>


<div align="center">
  <table style="border-collapse: collapse; border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
    
    
    
    <tr>
      <td style="width: 133.25pt; border-top: 1pt solid #a5a5a5; border-bottom: 1pt solid #a5a5a5; border-left: 1pt solid #a5a5a5; border-right: none; background: #a5a5a5; padding: 0cm 5.4pt;" valign="top" width="178">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 宋体; times new roman"4times new roman";times new roman";color: white;">参数</span></strong>
        </p>
        
      </td>
      
      
      <td style="width: 389.55pt; border-top: 1pt solid #a5a5a5; border-right: 1pt solid #a5a5a5; border-bottom: 1pt solid #a5a5a5; border-left: none; background: #a5a5a5; padding: 0cm 5.4pt;" valign="top" width="519">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 宋体; times new roman"4times new roman";times new roman";color: white;">参数说明</span></strong>
        </p>
        
      </td>
      
    </tr>
    
    
    <tr>
      <td style="width: 133.25pt; border-right: 1pt solid #c9c9c9; border-bottom: 1pt solid #c9c9c9; border-left: 1pt solid #c9c9c9; border-top: none; background: #ededed; padding: 0cm 5.4pt;" width="178">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">connector</span></strong>
        </p>
        
      </td>
      
      
      <td style="width: 389.55pt; border-top: none; border-left: none; border-bottom: solid #C9C9C9 1.0pt; border-right: solid #C9C9C9 1.0pt; background: #EDEDED; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="519">
        <p style="margin-bottom: .0001pt;">
          <span style="font-size: 10.0pt; font-family: 宋体;">接收用户请求，类似于</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">httpd</span><span style="font-size: 10.0pt; font-family: 宋体;">的</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">listen</span><span style="font-size: 10.0pt; font-family: 宋体;">配置监听端口</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">.</span>
        </p>
        
      </td>
      
    </tr>
    
    
    <tr>
      <td style="width: 133.25pt; border-right: 1pt solid #c9c9c9; border-bottom: 1pt solid #c9c9c9; border-left: 1pt solid #c9c9c9; border-top: none; padding: 0cm 5.4pt;" width="178">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">port</span></strong>
        </p>
        
      </td>
      
      
      <td style="width: 389.55pt; border-top: none; border-left: none; border-bottom: solid #C9C9C9 1.0pt; border-right: solid #C9C9C9 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="519">
        <p style="margin-bottom: .0001pt;">
          <span style="font-size: 10.0pt; font-family: 宋体;">指定服务器端要创建的端口号，并在这个端口监听来自客户端的请求。</span>
        </p>
        
      </td>
      
    </tr>
    
    
    <tr>
      <td style="width: 133.25pt; border-right: 1pt solid #c9c9c9; border-bottom: 1pt solid #c9c9c9; border-left: 1pt solid #c9c9c9; border-top: none; background: #ededed; padding: 0cm 5.4pt;" width="178">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">address</span></strong>
        </p>
        
      </td>
      
      
      <td style="width: 389.55pt; border-top: none; border-left: none; border-bottom: solid #C9C9C9 1.0pt; border-right: solid #C9C9C9 1.0pt; background: #EDEDED; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="519">
        <p style="margin-bottom: .0001pt;">
          <span style="font-size: 10.0pt; font-family: 宋体;">指定连接器监听的地址，默认为所有地址（即</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">0.0.0.0</span><span style="font-size: 10.0pt; font-family: 宋体;">）</span>
        </p>
        
      </td>
      
    </tr>
    
    
    <tr>
      <td style="width: 133.25pt; border-right: 1pt solid #c9c9c9; border-bottom: 1pt solid #c9c9c9; border-left: 1pt solid #c9c9c9; border-top: none; padding: 0cm 5.4pt;" width="178">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">protocol</span></strong>
        </p>
        
      </td>
      
      
      <td style="width: 389.55pt; border-top: none; border-left: none; border-bottom: solid #C9C9C9 1.0pt; border-right: solid #C9C9C9 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="519">
        <p style="margin-bottom: .0001pt;">
          <span style="font-size: 10.0pt; font-family: 宋体;">连接器使用的协议，支持</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">HTTP</span><span style="font-size: 10.0pt; font-family: 宋体;">和</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">AJP</span><span style="font-size: 10.0pt; font-family: 宋体;">。</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">AJP</span><span style="font-size: 10.0pt; font-family: 宋体;">（</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">Apache Jserv Protocol</span><span style="font-size: 10.0pt; font-family: 宋体;">）专用于</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">tomcat</span><span style="font-size: 10.0pt; font-family: 宋体;">与</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">apache</span><span style="font-size: 10.0pt; font-family: 宋体;">建立通信的，</span> <span style="font-size: 10.0pt; font-family: 宋体;">在</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">httpd</span><span style="font-size: 10.0pt; font-family: 宋体;">反向代理用户请求至</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">tomcat</span><span style="font-size: 10.0pt; font-family: 宋体;">时使用（可见</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">Nginx</span><span style="font-size: 10.0pt; font-family: 宋体;">反向代理时不可用</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">AJP</span><span style="font-size: 10.0pt; font-family: 宋体;">协议）。</span>
        </p>
        
      </td>
      
    </tr>
    
    
    <tr>
      <td style="width: 133.25pt; border-right: 1pt solid #c9c9c9; border-bottom: 1pt solid #c9c9c9; border-left: 1pt solid #c9c9c9; border-top: none; background: #ededed; padding: 0cm 5.4pt;" width="178">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">minProcessors</span></strong>
        </p>
        
      </td>
      
      
      <td style="width: 389.55pt; border-top: none; border-left: none; border-bottom: solid #C9C9C9 1.0pt; border-right: solid #C9C9C9 1.0pt; background: #EDEDED; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="519">
        <p style="margin-bottom: .0001pt;">
          <span style="font-size: 10.0pt; font-family: 宋体;">服务器启动时创建的处理请求的线程数</span>
        </p>
        
      </td>
      
    </tr>
    
    
    <tr>
      <td style="width: 133.25pt; border-right: 1pt solid #c9c9c9; border-bottom: 1pt solid #c9c9c9; border-left: 1pt solid #c9c9c9; border-top: none; padding: 0cm 5.4pt;" width="178">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">maxProcessors</span></strong>
        </p>
        
      </td>
      
      
      <td style="width: 389.55pt; border-top: none; border-left: none; border-bottom: solid #C9C9C9 1.0pt; border-right: solid #C9C9C9 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="519">
        <p style="margin-bottom: .0001pt;">
          <span style="font-size: 10.0pt; font-family: 宋体;">最大可以创建的处理请求的线程数</span>
        </p>
        
      </td>
      
    </tr>
    
    
    <tr>
      <td style="width: 133.25pt; border-right: 1pt solid #c9c9c9; border-bottom: 1pt solid #c9c9c9; border-left: 1pt solid #c9c9c9; border-top: none; background: #ededed; padding: 0cm 5.4pt;" width="178">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">enableLookups</span></strong>
        </p>
        
      </td>
      
      
      <td style="width: 389.55pt; border-top: none; border-left: none; border-bottom: solid #C9C9C9 1.0pt; border-right: solid #C9C9C9 1.0pt; background: #EDEDED; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="519">
        <p style="margin-bottom: .0001pt;">
          <span style="font-size: 10.0pt; font-family: 宋体;">如果为</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">true</span><span style="font-size: 10.0pt; font-family: 宋体;">，则可以通过调用</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">request.getRemoteHost()</span><span style="font-size: 10.0pt; font-family: 宋体;">进行</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">DNS</span><span style="font-size: 10.0pt; font-family: 宋体;">查询来得到远程客户端的实际主机名，若为</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">false</span><span style="font-size: 10.0pt; font-family: 宋体;">则不进行</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">DNS</span><span style="font-size: 10.0pt; font-family: 宋体;">查询，而是返回其</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">ip</span><span style="font-size: 10.0pt; font-family: 宋体;">地址</span>
        </p>
        
      </td>
      
    </tr>
    
    
    <tr>
      <td style="width: 133.25pt; border-right: 1pt solid #c9c9c9; border-bottom: 1pt solid #c9c9c9; border-left: 1pt solid #c9c9c9; border-top: none; padding: 0cm 5.4pt;" width="178">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">redirectPort</span></strong>
        </p>
        
      </td>
      
      
      <td style="width: 389.55pt; border-top: none; border-left: none; border-bottom: solid #C9C9C9 1.0pt; border-right: solid #C9C9C9 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="519">
        <p style="margin-bottom: .0001pt;">
          <span style="font-size: 10.0pt; font-family: 宋体;">指定服务器正在处理</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">http</span><span style="font-size: 10.0pt; font-family: 宋体;">请求时收到了一个</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">SSL</span><span style="font-size: 10.0pt; font-family: 宋体;">传输请求后重定向的端口号</span>
        </p>
        
      </td>
      
    </tr>
    
    
    <tr>
      <td style="width: 133.25pt; border-right: 1pt solid #c9c9c9; border-bottom: 1pt solid #c9c9c9; border-left: 1pt solid #c9c9c9; border-top: none; background: #ededed; padding: 0cm 5.4pt;" width="178">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">acceptCount</span></strong>
        </p>
        
      </td>
      
      
      <td style="width: 389.55pt; border-top: none; border-left: none; border-bottom: solid #C9C9C9 1.0pt; border-right: solid #C9C9C9 1.0pt; background: #EDEDED; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="519">
        <p style="margin-bottom: .0001pt;">
          <span style="font-size: 10.0pt; font-family: 宋体;">指定当所有可以使用的处理请求的线程数都被使用时，可以放到处理队列中的请求数，超过这个数的请求将不予处理</span>
        </p>
        
      </td>
      
    </tr>
    
    
    <tr>
      <td style="width: 133.25pt; border-right: 1pt solid #c9c9c9; border-bottom: 1pt solid #c9c9c9; border-left: 1pt solid #c9c9c9; border-top: none; padding: 0cm 5.4pt;" width="178">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">connectionTimeout</span></strong>
        </p>
        
      </td>
      
      
      <td style="width: 389.55pt; border-top: none; border-left: none; border-bottom: solid #C9C9C9 1.0pt; border-right: solid #C9C9C9 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="519">
        <p style="margin-bottom: .0001pt;">
          <span style="font-size: 10.0pt; font-family: 宋体;">指定超时的时间数</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">(</span><span style="font-size: 10.0pt; font-family: 宋体;">以毫秒为单位</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">)</span>
        </p>
        
      </td>
      
    </tr>
    
    
  </table>
  
</div>


<h3>
  <span id="175_host">1.7.5 host<span style="font-family: '微软雅黑',sans-serif;">参数详解</span></span>
</h3>


<div align="center">
  <table style="border-collapse: collapse; border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
    
    
    
    <tr>
      <td style="width: 134.45pt; border-top: 1pt solid #a5a5a5; border-bottom: 1pt solid #a5a5a5; border-left: 1pt solid #a5a5a5; border-right: none; background: #a5a5a5; padding: 0cm 5.4pt;" valign="top" width="179">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 宋体; times new roman"4times new roman";times new roman";color: white;">参数</span></strong>
        </p>
        
      </td>
      
      
      <td style="width: 388.35pt; border-top: 1pt solid #a5a5a5; border-right: 1pt solid #a5a5a5; border-bottom: 1pt solid #a5a5a5; border-left: none; background: #a5a5a5; padding: 0cm 5.4pt;" valign="top" width="518">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 宋体; times new roman"4times new roman";times new roman";color: white;">参数说明</span></strong>
        </p>
        
      </td>
      
    </tr>
    
    
    <tr>
      <td style="width: 134.45pt; border-right: 1pt solid #c9c9c9; border-bottom: 1pt solid #c9c9c9; border-left: 1pt solid #c9c9c9; border-top: none; background: #ededed; padding: 0cm 5.4pt;" width="179">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">host</span></strong>
        </p>
        
      </td>
      
      
      <td style="width: 388.35pt; border-top: none; border-left: none; border-bottom: solid #C9C9C9 1.0pt; border-right: solid #C9C9C9 1.0pt; background: #EDEDED; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="518">
        <p style="margin-bottom: .0001pt;">
          <span style="font-size: 10.0pt; font-family: 宋体;">表示一个虚拟主机</span>
        </p>
        
      </td>
      
    </tr>
    
    
    <tr>
      <td style="width: 134.45pt; border-right: 1pt solid #c9c9c9; border-bottom: 1pt solid #c9c9c9; border-left: 1pt solid #c9c9c9; border-top: none; padding: 0cm 5.4pt;" width="179">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">name</span></strong>
        </p>
        
      </td>
      
      
      <td style="width: 388.35pt; border-top: none; border-left: none; border-bottom: solid #C9C9C9 1.0pt; border-right: solid #C9C9C9 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="518">
        <p style="margin-bottom: .0001pt;">
          <span style="font-size: 10.0pt; font-family: 宋体;">指定主机名</span>
        </p>
        
      </td>
      
    </tr>
    
    
    <tr>
      <td style="width: 134.45pt; border-right: 1pt solid #c9c9c9; border-bottom: 1pt solid #c9c9c9; border-left: 1pt solid #c9c9c9; border-top: none; background: #ededed; padding: 0cm 5.4pt;" width="179">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">appBase</span></strong>
        </p>
        
      </td>
      
      
      <td style="width: 388.35pt; border-top: none; border-left: none; border-bottom: solid #C9C9C9 1.0pt; border-right: solid #C9C9C9 1.0pt; background: #EDEDED; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="518">
        <p style="margin-bottom: .0001pt;">
          <span style="font-size: 10.0pt; font-family: 宋体;">应用程序基本目录，即存放应用程序的目录</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">.</span><span style="font-size: 10.0pt; font-family: 宋体;">一般为</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">appBase="webapps" </span><span style="font-size: 10.0pt; font-family: 宋体;">，相对于</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">CATALINA_HOME</span><span style="font-size: 10.0pt; font-family: 宋体;">而言的，也可以写绝对路径。</span>
        </p>
        
      </td>
      
    </tr>
    
    
    <tr>
      <td style="width: 134.45pt; border-right: 1pt solid #c9c9c9; border-bottom: 1pt solid #c9c9c9; border-left: 1pt solid #c9c9c9; border-top: none; padding: 0cm 5.4pt;" width="179">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">unpackWARs</span></strong>
        </p>
        
      </td>
      
      
      <td style="width: 388.35pt; border-top: none; border-left: none; border-bottom: solid #C9C9C9 1.0pt; border-right: solid #C9C9C9 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="518">
        <p style="margin-bottom: .0001pt;">
          <span style="font-size: 10.0pt; font-family: 宋体;">如果为</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">true</span><span style="font-size: 10.0pt; font-family: 宋体;">，则</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">tomcat</span><span style="font-size: 10.0pt; font-family: 宋体;">会自动将</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">WAR</span><span style="font-size: 10.0pt; font-family: 宋体;">文件解压，否则不解压，直接从</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">WAR</span><span style="font-size: 10.0pt; font-family: 宋体;">文件中运行应用程序</span>
        </p>
        
      </td>
      
    </tr>
    
    
    <tr>
      <td style="width: 134.45pt; border-right: 1pt solid #c9c9c9; border-bottom: 1pt solid #c9c9c9; border-left: 1pt solid #c9c9c9; border-top: none; background: #ededed; padding: 0cm 5.4pt;" width="179">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">autoDeploy</span></strong>
        </p>
        
      </td>
      
      
      <td style="width: 388.35pt; border-top: none; border-left: none; border-bottom: solid #C9C9C9 1.0pt; border-right: solid #C9C9C9 1.0pt; background: #EDEDED; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="518">
        <p style="margin-bottom: .0001pt;">
          <span style="font-size: 10.0pt; font-family: 宋体;">在</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">tomcat</span><span style="font-size: 10.0pt; font-family: 宋体;">启动时，是否自动部署。</span>
        </p>
        
      </td>
      
    </tr>
    
    
    <tr>
      <td style="width: 134.45pt; border-right: 1pt solid #c9c9c9; border-bottom: 1pt solid #c9c9c9; border-left: 1pt solid #c9c9c9; border-top: none; padding: 0cm 5.4pt;" width="179">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">xmlValidation</span></strong>
        </p>
        
      </td>
      
      
      <td style="width: 388.35pt; border-top: none; border-left: none; border-bottom: solid #C9C9C9 1.0pt; border-right: solid #C9C9C9 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="518">
        <p style="margin-bottom: .0001pt;">
          <span style="font-size: 10.0pt; font-family: 宋体;">是否启动</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">xml</span><span style="font-size: 10.0pt; font-family: 宋体;">的校验功能，一般</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">xmlValidation="false"</span><span style="font-size: 10.0pt; font-family: 宋体;">。</span>
        </p>
        
      </td>
      
    </tr>
    
    
    <tr>
      <td style="width: 134.45pt; border-right: 1pt solid #c9c9c9; border-bottom: 1pt solid #c9c9c9; border-left: 1pt solid #c9c9c9; border-top: none; background: #ededed; padding: 0cm 5.4pt;" width="179">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">xmlNamespaceAware</span></strong>
        </p>
        
      </td>
      
      
      <td style="width: 388.35pt; border-top: none; border-left: none; border-bottom: solid #C9C9C9 1.0pt; border-right: solid #C9C9C9 1.0pt; background: #EDEDED; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="518">
        <p style="margin-bottom: .0001pt;">
          <span style="font-size: 10.0pt; font-family: 宋体;">检测名称空间，一般</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">xmlNamespaceAware="false"</span><span style="font-size: 10.0pt; font-family: 宋体;">。</span>
        </p>
        
      </td>
      
    </tr>
    
    
  </table>
  
</div>


<h3>
  <span id="176_Context">1.7.6 Context<span style="font-family: '微软雅黑',sans-serif;">参数说明</span></span>
</h3>


<div align="center">
  <table style="border-collapse: collapse; border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
    
    
    
    <tr>
      <td style="width: 82.85pt; border-top: 1pt solid #a5a5a5; border-bottom: 1pt solid #a5a5a5; border-left: 1pt solid #a5a5a5; border-right: none; background: #a5a5a5; padding: 0cm 5.4pt;" valign="top" width="110">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 宋体; times new roman"4times new roman";times new roman";color: white;">参数</span></strong>
        </p>
        
      </td>
      
      
      <td style="width: 439.95pt; border-top: 1pt solid #a5a5a5; border-right: 1pt solid #a5a5a5; border-bottom: 1pt solid #a5a5a5; border-left: none; background: #a5a5a5; padding: 0cm 5.4pt;" valign="top" width="587">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 宋体; times new roman"4times new roman";times new roman";color: white;">参数说明</span></strong>
        </p>
        
      </td>
      
    </tr>
    
    
    <tr>
      <td style="width: 82.85pt; border-right: 1pt solid #c9c9c9; border-bottom: 1pt solid #c9c9c9; border-left: 1pt solid #c9c9c9; border-top: none; background: #ededed; padding: 0cm 5.4pt;" width="110">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">Context</span></strong>
        </p>
        
      </td>
      
      
      <td style="width: 439.95pt; border-top: none; border-left: none; border-bottom: solid #C9C9C9 1.0pt; border-right: solid #C9C9C9 1.0pt; background: #EDEDED; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="587">
        <p style="margin-bottom: .0001pt;">
          <span style="font-size: 10.0pt; font-family: 宋体;">表示一个</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">web</span><span style="font-size: 10.0pt; font-family: 宋体;">应用程序，通常为</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">WAR</span><span style="font-size: 10.0pt; font-family: 宋体;">文件</span>
        </p>
        
      </td>
      
    </tr>
    
    
    <tr>
      <td style="width: 82.85pt; border-right: 1pt solid #c9c9c9; border-bottom: 1pt solid #c9c9c9; border-left: 1pt solid #c9c9c9; border-top: none; padding: 0cm 5.4pt;" width="110">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">docBase</span></strong>
        </p>
        
      </td>
      
      
      <td style="width: 439.95pt; border-top: none; border-left: none; border-bottom: solid #C9C9C9 1.0pt; border-right: solid #C9C9C9 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="587">
        <p style="margin-bottom: .0001pt;">
          <span style="font-size: 10.0pt; font-family: 宋体;">应用程序的路径或者是</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">WAR</span><span style="font-size: 10.0pt; font-family: 宋体;">文件存放的路径</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">,</span><span style="font-size: 10.0pt; font-family: 宋体;">也可以使用相对路径，起始路径为此</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">Context</span><span style="font-size: 10.0pt; font-family: 宋体;">所属</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">Host</span><span style="font-size: 10.0pt; font-family: 宋体;">中</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">appBase</span><span style="font-size: 10.0pt; font-family: 宋体;">定义的路径。</span>
        </p>
        
      </td>
      
    </tr>
    
    
    <tr>
      <td style="width: 82.85pt; border-right: 1pt solid #c9c9c9; border-bottom: 1pt solid #c9c9c9; border-left: 1pt solid #c9c9c9; border-top: none; background: #ededed; padding: 0cm 5.4pt;" width="110">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">path</span></strong>
        </p>
        
      </td>
      
      
      <td style="width: 439.95pt; border-top: none; border-left: none; border-bottom: solid #C9C9C9 1.0pt; border-right: solid #C9C9C9 1.0pt; background: #EDEDED; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="587">
        <p style="margin-bottom: .0001pt;">
          <span style="font-size: 10.0pt; font-family: 宋体;">表示此</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">web</span><span style="font-size: 10.0pt; font-family: 宋体;">应用程序的</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">url</span><span style="font-size: 10.0pt; font-family: 宋体;">的前缀，这样请求的</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">url</span><span style="font-size: 10.0pt; font-family: 宋体;">为</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">http://localhost:8080/path/****</span>
        </p>
        
      </td>
      
    </tr>
    
    
    <tr>
      <td style="width: 82.85pt; border-right: 1pt solid #c9c9c9; border-bottom: 1pt solid #c9c9c9; border-left: 1pt solid #c9c9c9; border-top: none; padding: 0cm 5.4pt;" width="110">
        <p style="margin-bottom: .0001pt; text-align: center;" align="center">
          <strong><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">reloadable</span></strong>
        </p>
        
      </td>
      
      
      <td style="width: 439.95pt; border-top: none; border-left: none; border-bottom: solid #C9C9C9 1.0pt; border-right: solid #C9C9C9 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" valign="top" width="587">
        <p style="margin-bottom: .0001pt;">
          <span style="font-size: 10.0pt; font-family: 宋体;">这个属性非常重要，如果为</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">true</span><span style="font-size: 10.0pt; font-family: 宋体;">，则</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">tomcat</span><span style="font-size: 10.0pt; font-family: 宋体;">会自动检测应用程序的</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">/WEB-INF/lib </span><span style="font-size: 10.0pt; font-family: 宋体;">和</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">/WEB-INF/classes</span><span style="font-size: 10.0pt; font-family: 宋体;">目录的变化，自动装载新的应用程序，可以在不重启</span><span style="font-size: 10.0pt; font-family: 'Times New Roman',serif;">tomcat</span><span style="font-size: 10.0pt; font-family: 宋体;">的情况下改变应用程序</span>
        </p>
        
      </td>
      
    </tr>
    
    
  </table>
  
</div>


<h2>
  <span id="18_WEB">1.8 WEB<span style="font-family: '微软雅黑',sans-serif;">站点部署</span></span>
</h2>


<p>
  <em><span style="text-decoration: underline;"><span style="font-family: 等线;">上线的代码有两种方式：</span></span></em>
</p>


<div style="border: solid windowtext 2.0pt; padding: 1.0pt 4.0pt 1.0pt 4.0pt; background: #F2F2F2;">
  <p style="text-indent: 21pt; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">
    <span style="font-family: '微软雅黑',sans-serif;">第一种方式是直接将程序目录放在</span>webapps<span style="font-family: '微软雅黑',sans-serif;">目录下面，这种方式大家已经明白了，就不多说了。</span>
  </p>
  
  
  <p style="text-indent: 21pt; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">
    <span style="font-family: '微软雅黑',sans-serif;">第二种方式是使用开发工具将程序打包成</span>war<span style="font-family: '微软雅黑',sans-serif;">包，然后上传到</span>webapps<span style="font-family: '微软雅黑',sans-serif;">目录下面。</span>
  </p>
  
</div>


<h3>
  <span id="181_warweb">1.8.1 <span style="font-family: '微软雅黑',sans-serif;">使用</span>war<span style="font-family: '微软雅黑',sans-serif;">包部署</span>web<span style="font-family: '微软雅黑',sans-serif;">站点</span></span>
</h3>


<div class="cnblogs_code">
  <pre><span style="color: #000000;">[root@web03 webapps]# pwd
/application/tomcat/webapps
[root@web03 webapps]# wget http://10.0.0.1/apache/tomcat/memtest.war</span></pre>
  
</div>


<p>
  <span style="font-family: 等线;">站点主动解压部署</span>
</p>


<div class="cnblogs_code">
  <pre>[root@web03 webapps]<span style="color: #008000;">#</span><span style="color: #008000;"> ls</span>
docs  examples  host-manager  logs  manager  memtest  memtest.war  ROOT</pre>
  
</div>


<p>
  <span style="font-family: 等线;">浏览器访问：</span>
</p>


<p style="text-indent: 21.0pt;">
  <em><span style="text-decoration: underline;">http://10.0.0.17:8080//memtest/meminfo.jsp</span></em>
</p>


<p style="text-align: center;" align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171127162004050-628167729.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="企业级Tomcat部署实践及安全调优" alt="" />
</p>



<h3>
  <span id="182">1.8.2 <span style="font-family: '微软雅黑',sans-serif;">自定义默认网站目录</span></span>
</h3>


<p style="text-indent: 7.1pt;">
  <span style="font-family: 等线;">上面访问的网址为</span> <em><span style="text-decoration: underline;">http://10.0.0.3:8080/memtest/meminfo.jsp </span></em>
</p>


<p style="text-indent: 7.1pt;">
  <span style="font-family: 等线;">现在想访问格式为</span><em><span style="text-decoration: underline;">http://10.0.0.3:8080/meminfo.jsp</span></em>
</p>


<p>
  <strong><span style="text-decoration: underline;"><span style="font-family: 等线; background: yellow;">方法一</span></span></strong>
</p>


<div style="border: solid windowtext 2.0pt; padding: 1.0pt 4.0pt 1.0pt 4.0pt; background: #F2F2F2;">
  <p>
    <span style="font-family: '微软雅黑',sans-serif;">将</span>meminfo.jsp<span style="font-family: '微软雅黑',sans-serif;">或其他程序放在</span>tomcat/webapps/ROOT<span style="font-family: '微软雅黑',sans-serif;">目录下即可。因为默认网站根目录为</span>tomcat/webapps/ROOT
  </p>
  
</div>


<p>
  <strong><span style="font-family: 等线; background: yellow;">方法二</span></strong>
</p>


<div class="cnblogs_code">
  <pre>[root@web03 ~]<span style="color: #008000;">#</span><span style="color: #008000;"> vim /application/tomcat/conf/server.xml +125</span>
&hellip;&hellip; <span style="color: #008000;">#</span><span style="color: #008000;">添加上这两行</span>
        &lt;Context path=<span style="color: #800000;">""</span> docBase=<span style="color: #800000;">"</span><span style="color: #800000;">/application/tomcat/webapps/memtest</span><span style="color: #800000;">"</span> debug=<span style="color: #800000;">"</span><span style="color: #800000;"></span><span style="color: #800000;">"</span> reloadable=<span style="color: #800000;">"</span><span style="color: #800000;">false</span><span style="color: #800000;">"</span> crossContext=<span style="color: #800000;">"</span><span style="color: #800000;">true</span><span style="color: #800000;">"</span>/>
        &lt;Context path=<span style="color: #800000;">"</span><span style="color: #800000;">/40team</span><span style="color: #800000;">"</span> docBase=<span style="color: #800000;">"</span><span style="color: #800000;">/application/tomcat/webapps/memtest</span><span style="color: #800000;">"</span> debug=<span style="color: #800000;">"</span><span style="color: #800000;"></span><span style="color: #800000;">"</span> reloadable=<span style="color: #800000;">"</span><span style="color: #800000;">false</span><span style="color: #800000;">"</span> crossContext=<span style="color: #800000;">"</span><span style="color: #800000;">true</span><span style="color: #800000;">"</span>/><span style="color: #000000;">
&hellip;&hellip;</span></pre>
  
</div>


<p>
  <span style="font-family: 等线;">修改配置文件后，要重启服务</span>
</p>


<div class="cnblogs_code">
  <pre>[root@web03 ~]<span style="color: #008000;">#</span><span style="color: #008000;"> /application/tomcat/bin/shutdown.sh </span>
[root@web03 ~]<span style="color: #008000;">#</span><span style="color: #008000;"> /application/tomcat/bin/startup.sh  </span></pre>
  
</div>


<h3>
  <span id="183_jpress">1.8.3 <span style="font-family: '微软雅黑',sans-serif;">部署开源站点（</span>jpress<span style="font-family: '微软雅黑',sans-serif;">）</span></span>
</h3>


<p style="margin-left: 7.1pt; text-indent: 13.9pt;">
  jpress<span style="font-family: 等线;">官网：</span><em><span style="text-decoration: underline;">http://jpress.io</span></em>
</p>


<p style="margin-left: 7.1pt; text-indent: 13.9pt;">
  <span style="font-family: 等线;">下载地址：</span><em><span style="text-decoration: underline;">https://github.com/JpressProjects/jpress</span></em>
</p>


<p>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: 等线; background: yellow;">第一个里程碑：安装配置数据库</span>
</p>


<div class="cnblogs_code">
  <pre>yum -y install mariadb-<span style="color: #000000;">server
systemctl start mariadb.service</span></pre>
  
</div>


<p>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #<em><span style="text-decoration: underline;"><span style="font-family: 等线;">配置数据库</span></span></em>
</p>


<div class="cnblogs_code">
  <pre><span style="color: #000000;">mysql
create database jpress DEFAULT CHARACTER SET utf8;
grant all on jpress.</span>* to jpress@<span style="color: #800000;">'</span><span style="color: #800000;">localhost</span><span style="color: #800000;">'</span> identified by <span style="color: #800000;">'</span><span style="color: #800000;">123456</span><span style="color: #800000;">'</span><span style="color: #000000;">;
exit</span></pre>
  
</div>


<p>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: 等线; background: yellow;">第二个里程碑：</span><span style="background: yellow;">jpress</span><span style="font-family: 等线; background: yellow;">站点上线</span>
</p>


<div class="cnblogs_code">
  <pre>[root@web03 webapps]<span style="color: #008000;">#</span><span style="color: #008000;"> pwd</span>
/application/tomcat/<span style="color: #000000;">webapps
[root@web03 webapps]</span><span style="color: #008000;">#</span><span style="color: #008000;"> wget http://10.0.0.1/apache/tomcat/jpress-web-newest.war</span></pre>
  
</div>


<p>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: 等线; background: yellow;">第三个里程碑：浏览器访问</span>
</p>


<p>
  <span style="font-family: 等线;">浏览器访问：</span> <em><span style="text-decoration: underline;">http://10.0.0.17:8080/jpress-web-newest/install</span></em>
</p>


<p style="text-align: center;" align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171127162126425-251381726.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="企业级Tomcat部署实践及安全调优" alt="" />
</p>



<p>
  <span style="font-family: 等线;">填写数据库信息</span>
</p>


<p style="text-align: center;" align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171127162135190-1727193752.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="企业级Tomcat部署实践及安全调优" alt="" />
</p>



<p>
  <span style="font-family: 等线;">设置站点名称等</span>
</p>


<p style="text-align: center;" align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171127162142753-1410863007.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="企业级Tomcat部署实践及安全调优" alt="" />
</p>



<p>
  <span style="font-family: 等线;">安装完成</span>
</p>


<p style="text-align: center;" align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171127162149956-1281737675.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="企业级Tomcat部署实践及安全调优" alt="" />
</p>



<p>
  <span style="font-family: 等线;">重启</span>tomcat<span style="font-family: 等线;">服务</span>
</p>


<div class="cnblogs_code">
  <pre>[root@web03 ~]<span style="color: #008000;">#</span><span style="color: #008000;"> /application/tomcat/bin/shutdown.sh </span>
[root@web03 ~]<span style="color: #008000;">#</span><span style="color: #008000;"> /application/tomcat/bin/startup.sh  </span></pre>
  
</div>


<h2>
  <span id="19_Tomcat">1.9 Tomcat<span style="font-family: '微软雅黑',sans-serif;">多实例配置</span></span>
</h2>


<p style="text-indent: 21.0pt;">
  <strong><span style="font-family: 等线;">多虚拟主机</span></strong><span style="font-family: 等线;">：</span>nginx <span style="font-family: 等线;">多个</span>Server<span style="font-family: 等线;">标签（域名，</span>ip<span style="font-family: 等线;">，端口）</span>&nbsp;<span style="font-family: 等线;">进程数量固定</span> master+worker
</p>


<p style="text-indent: 21.0pt;">
  <strong><span style="font-family: 等线;">多实例（多进程）</span></strong><span style="font-family: 等线;">：同一个程序启动多次，分为两种情况</span>:
</p>


<p style="margin-left: 105.0pt; text-indent: 33.0pt;">
  <span style="font-family: 等线;">第一种：一台机器跑多个站点；</span>&nbsp;
</p>


<p style="margin-left: 105.0pt; text-indent: 33.0pt;">
  <span style="font-family: 等线;">第二种：一个机器跑一个站点多个实例，配合负载均衡</span>
</p>


<h3>
  <span id="191">1.9.1 <span style="font-family: '微软雅黑',sans-serif;">复制程序文件</span></span>
</h3>


<div class="cnblogs_code">
  <pre>    cd /application/tools/<span style="color: #000000;">
    tar xf apache</span>-tomcat-8.0.27<span style="color: #000000;">.tar.gz
    cp </span>-a apache-tomcat-8.0.27<span style="color: #000000;"> tomcat8_1
    cp </span>-a apache-tomcat-8.0.27 tomcat8_2</pre>
  
</div>


<p>
  <span style="font-family: 等线;">修改端口，以启动多实例。多实例之间端口不能一致</span>
</p>


<div class="cnblogs_code">
  <pre>sed -i <span style="color: #800000;">'</span><span style="color: #800000;">s#8005#8011#;s#8080#8081#</span><span style="color: #800000;">'</span> tomcat8_1/conf/<span style="color: #000000;">server.xml
sed </span>-i <span style="color: #800000;">'</span><span style="color: #800000;">s#8005#8012#;s#8080#8082#</span><span style="color: #800000;">'</span> tomcat8_2/conf/server.xml</pre>
  
</div>


<div class="cnblogs_code">
  <pre>[root@web03 application]<span style="color: #008000;">#</span><span style="color: #008000;"> diff tomcat8_1/conf/server.xml tomcat8_2/conf/server.xml</span>
<span style="color: #000000;">22c22
</span>&lt; &lt;Server port=<span style="color: #800000;">"</span><span style="color: #800000;">8011</span><span style="color: #800000;">"</span> shutdown=<span style="color: #800000;">"</span><span style="color: #800000;">SHUTDOWN</span><span style="color: #800000;">"</span>>
---
> &lt;Server port=<span style="color: #800000;">"</span><span style="color: #800000;">8012</span><span style="color: #800000;">"</span> shutdown=<span style="color: #800000;">"</span><span style="color: #800000;">SHUTDOWN</span><span style="color: #800000;">"</span>><span style="color: #000000;">
67c67
</span>&lt;          Define a non-SSL/TLS HTTP/1.1 Connector on port 8081
---
>          Define a non-SSL/TLS HTTP/1.1 Connector on port 8082<span style="color: #000000;">
69c69
</span>&lt;     &lt;Connector port=<span style="color: #800000;">"</span><span style="color: #800000;">8081</span><span style="color: #800000;">"</span> protocol=<span style="color: #800000;">"</span><span style="color: #800000;">HTTP/1.1</span><span style="color: #800000;">"</span>
---
>     &lt;Connector port=<span style="color: #800000;">"</span><span style="color: #800000;">8082</span><span style="color: #800000;">"</span> protocol=<span style="color: #800000;">"</span><span style="color: #800000;">HTTP/1.1</span><span style="color: #800000;">"</span><span style="color: #000000;">
75c75
</span>&lt;                port=<span style="color: #800000;">"</span><span style="color: #800000;">8081</span><span style="color: #800000;">"</span> protocol=<span style="color: #800000;">"</span><span style="color: #800000;">HTTP/1.1</span><span style="color: #800000;">"</span>
---
>                port=<span style="color: #800000;">"</span><span style="color: #800000;">8082</span><span style="color: #800000;">"</span> protocol=<span style="color: #800000;">"</span><span style="color: #800000;">HTTP/1.1</span><span style="color: #800000;">"</span></pre>
  
</div>


<p>
  　　 <span style="font-family: 等线;">将配置好的</span>tomcat<span style="font-family: 等线;">程序打包，以备之后使用</span>
</p>


<div class="cnblogs_code">
  <pre>tar zcf muti_tomcat8.tar.gz ./tomcat8_1 ./tomcat8_2</pre>
  
</div>


<p style="text-indent: 15.75pt;">
  <span style="font-family: 等线;">启动</span>tomcat<span style="font-family: 等线;">多实例</span>
</p>


<div class="cnblogs_code">
  <pre> /application/tomcat8_1/bin/<span style="color: #000000;">startup.sh 
 </span>/application/tomcat8_2/bin/startup.sh</pre>
  
</div>


<p style="text-indent: 15.75pt;">
  <span style="font-family: 等线;">检查端口是否启动</span>
</p>


<div class="cnblogs_code">
  <pre>[root@web03 tomcat8_1]<span style="color: #008000;">#</span><span style="color: #008000;"> netstat -lntup |grep java</span>
tcp6   0   0 127.0.0.1:8011    :::*    LISTEN   31906/<span style="color: #000000;">java
tcp6   0   0 </span>127.0.0.1:8012    :::*    LISTEN   31932/<span style="color: #000000;">java
tcp6   0   0 :::</span>8080           :::*    LISTEN   31812/<span style="color: #000000;">java
tcp6   0   0 :::</span>8081           :::*    LISTEN   31906/<span style="color: #000000;">java
tcp6   0   0 :::</span>8082           :::*    LISTEN   31932/<span style="color: #000000;">java
tcp6   0   0 </span>127.0.0.1:8005    :::*    LISTEN   31812/<span style="color: #000000;">java
tcp6   0   0 :::</span>8009           :::*    LISTEN   31812/java</pre>
  
</div>


<p style="text-indent: 11.0pt;">
  <span style="font-family: 等线;">将每个实例的网页进行区分</span>
</p>


<div class="cnblogs_code">
  <pre>echo 8081 >>/application/tomcat8_1/webapps/ROOT/<span style="color: #000000;">index.jsp 
echo </span>8082 >>/application/tomcat8_2/webapps/ROOT/index.jsp</pre>
  
</div>


<h3>
  <span id="192">1.9.2 <span style="font-family: '微软雅黑',sans-serif;">在浏览器访问，进行测试</span></span>
</h3>


<p style="margin-left: 42.0pt;">
  <span style="font-family: 等线;">检查多实例的启动</span>
</p>


<p>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; http://10.0.0.17:8082
</p>


<p style="text-align: center;" align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171127162343831-1147071210.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="企业级Tomcat部署实践及安全调优" alt="" />
</p>



<p style="text-indent: 21.0pt;">
  http://10.0.0.17:8081
</p>


<p style="text-align: center;" align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171127162353581-1370700278.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="企业级Tomcat部署实践及安全调优" alt="" />
</p>



<h2>
  <span id="110_tomcat">1.10 tomcat<span style="font-family: '微软雅黑',sans-serif;">反向代理集群</span></span>
</h2>


<h3>
  <span id="1101">1.10.1 <span style="font-family: '微软雅黑',sans-serif;">负载均衡器说明</span></span>
</h3>


<div class="cnblogs_code">
  <pre>[root@lb01 ~]<span style="color: #008000;">#</span><span style="color: #008000;"> cat /etc/redhat-release </span>
CentOS release 6.9<span style="color: #000000;"> (Final)
[root@lb01 </span>~]<span style="color: #008000;">#</span><span style="color: #008000;"> uname -a</span>
Linux lb01 2.6.32-696.el6.x86_64 <span style="color: #008000;">#</span><span style="color: #008000;">1 SMP Tue Mar 21 19:29:05 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux</span>
[root@lb01 ~]<span style="color: #008000;">#</span><span style="color: #008000;"> getenforce </span>
<span style="color: #000000;">Disabled
[root@lb01 </span>~]<span style="color: #008000;">#</span><span style="color: #008000;"> /etc/init.d/iptables status</span>
iptables: Firewall <span style="color: #0000ff;">is</span> <span style="color: #0000ff;">not</span> running.</pre>
  
</div>


<p style="text-indent: 15.75pt;">
  <span style="font-family: 等线;">负载均衡软件使用</span>nginx<span style="font-family: 等线;">，详情参照</span>
</p>


<p style="text-indent: 15.75pt;">
  http://www.cnblogs.com/clsn/p/7750615.html
</p>


<h3>
  <span id="1102">1.10.2 <span style="font-family: '微软雅黑',sans-serif;">配置负载均衡器</span></span>
</h3>


<p style="margin-left: 7.1pt; text-indent: 8.65pt;">
  <span style="font-family: 等线;">备份原配置文件</span>
</p>


<div class="cnblogs_code">
  <pre>mv  /application/nginx/conf/nginx.conf{,.20171127<span style="color: #000000;">}
    egrep </span>-v <span style="color: #800000;">'</span><span style="color: #800000;">#|^$</span><span style="color: #800000;">'</span> /application/nginx/conf/nginx.conf.default  > /application/nginx/conf/nginx.conf</pre>
  
</div>


<p>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: 等线;">配置文件内容</span>
</p>


<div class="cnblogs_code">
  <pre>[root@lb01 ~]<span style="color: #008000;">#</span><span style="color: #008000;"> cat /application/nginx/conf/nginx.conf</span>
worker_processes  1<span style="color: #000000;">;
events {
    worker_connections  </span>1024<span style="color: #000000;">;
}
http {
    include       mime.types;
    default_type  application</span>/octet-<span style="color: #000000;">stream;
    sendfile        on;
    keepalive_timeout  </span>65<span style="color: #000000;">;
    upstream web_pools {
        server </span>10.0.0.17:8081<span style="color: #000000;">;
        server </span>10.0.0.17:8082<span style="color: #000000;">;
    }

    server {
        listen       </span>80<span style="color: #000000;">;
        server_name  localhost;
        location </span>/<span style="color: #000000;"> {
            root   html;
            index  index.jsp index.htm;
        proxy_pass http:</span>//<span style="color: #000000;">web_pools;
        }
        error_page   </span>500 502 503 504  /<span style="color: #000000;">50x.html;
        location </span>= /<span style="color: #000000;">50x.html {
            root   html;
        }
    }
}</span></pre>
  
</div>


<p>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: 等线;">配置完成后重启</span>nginx<span style="font-family: 等线;">服务</span>
</p>


<div class="cnblogs_code">
  <pre>/application/nginx/sbin/nginx  -<span style="color: #000000;">s stop 
</span>/application/nginx/sbin/nginx</pre>
  
</div>


<h3>
  <span id="1103">1.10.3 <span style="font-family: '微软雅黑',sans-serif;">使用命令进行访问测试</span></span>
</h3>


<p style="text-indent: 15.75pt;">
  <span style="font-family: 等线;">使用</span>curl <span style="font-family: 等线;">命令进行测试，</span>tail<span style="font-family: 等线;">进行关键字提取</span>
</p>


<div class="cnblogs_code">
  <pre>[root@lb01 ~]<span style="color: #008000;">#</span><span style="color: #008000;"> curl -s 10.0.0.5|tail -1</span>
8081<span style="color: #000000;">
[root@lb01 </span>~]<span style="color: #008000;">#</span><span style="color: #008000;"> curl -s 10.0.0.5|tail -1</span>
8082</pre>
  
</div>


<p style="text-indent: 15.75pt;">
  <span style="font-family: 等线;">使用</span>curl <span style="font-family: 等线;">命令进行测试，</span>awk<span style="font-family: 等线;">进行关键字提取</span>
</p>


<div class="cnblogs_code">
  <pre>[root@lb01 ~]<span style="color: #008000;">#</span><span style="color: #008000;"> curl -s 10.0.0.5|awk 'END{print}'</span>
8082<span style="color: #000000;">
[root@lb01 </span>~]<span style="color: #008000;">#</span><span style="color: #008000;"> curl -s 10.0.0.5|awk 'END{print}'</span>
8081</pre>
  
</div>


<p style="text-indent: 15.75pt;">
  &nbsp;
</p>


<p style="text-indent: 15.75pt;">
  &nbsp;<span style="font-family: 等线;">使用</span>curl <span style="font-family: 等线;">命令进行测试，</span>sed<span style="font-family: 等线;">进行关键字提取</span>
</p>


<div class="cnblogs_code">
  <pre>[root@lb01 ~]<span style="color: #008000;">#</span><span style="color: #008000;"> curl -s 10.0.0.5|sed -n '$p'</span>
8082<span style="color: #000000;">
[root@lb01 </span>~]<span style="color: #008000;">#</span><span style="color: #008000;"> curl -s 10.0.0.5|sed -n '$p'</span>
8081</pre>
  
</div>


<h3>
  <span id="1104">1.10.4 <span style="font-family: '微软雅黑',sans-serif;">在浏览器上进行访问测试</span></span>
</h3>


<p style="text-align: center;" align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171127162541722-347092218.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="企业级Tomcat部署实践及安全调优" alt="" />
</p>



<p style="text-align: center;" align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171127162551550-1844076575.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="企业级Tomcat部署实践及安全调优" alt="" />
</p>



<p>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: 等线;">建议使用</span>google<span style="font-family: 等线;">浏览器</span>chrome <span style="font-family: 等线;">的隐身模式进行访问，使用</span>ctrl+f5 <span style="font-family: 等线;">进行强制刷新</span>
</p>


<h2>
  <span id="111_tomcat">1.11 <span style="font-family: '微软雅黑',sans-serif;">监控</span>tomcat<span style="font-family: '微软雅黑',sans-serif;">集群状态</span></span>
</h2>


<h3>
  <span id="1111_java">1.11.1 <span style="font-family: '微软雅黑',sans-serif;">方法一：开发</span>java<span style="font-family: '微软雅黑',sans-serif;">监控页面</span></span>
</h3>


<div class="cnblogs_code">
  <pre>[root@web03 tomcat8_1]<span style="color: #008000;">#</span><span style="color: #008000;"> cat /application/tomcat/webapps/memtest/meminfo.jsp </span>
&lt;%<span style="color: #000000;">
Runtime rtm </span>=<span style="color: #000000;"> Runtime.getRuntime();
long mm </span>= rtm.maxMemory()/1024/1024<span style="color: #000000;">;
long tm </span>= rtm.totalMemory()/1024/1024<span style="color: #000000;">;
long fm </span>= rtm.freeMemory()/1024/1024<span style="color: #000000;">;

out.println(</span><span style="color: #800000;">"</span><span style="color: #800000;">JVM memory detail info :<br /></span><span style="color: #800000;">"</span><span style="color: #000000;">);
out.println(</span><span style="color: #800000;">"</span><span style="color: #800000;">Max memory:</span><span style="color: #800000;">"</span>+mm+<span style="color: #800000;">"</span><span style="color: #800000;">MB</span><span style="color: #800000;">"</span>+<span style="color: #800000;">"</span><span style="color: #800000;"><br /></span><span style="color: #800000;">"</span><span style="color: #000000;">);
out.println(</span><span style="color: #800000;">"</span><span style="color: #800000;">Total memory:</span><span style="color: #800000;">"</span>+tm+<span style="color: #800000;">"</span><span style="color: #800000;">MB</span><span style="color: #800000;">"</span>+<span style="color: #800000;">"</span><span style="color: #800000;"><br /></span><span style="color: #800000;">"</span><span style="color: #000000;">);
out.println(</span><span style="color: #800000;">"</span><span style="color: #800000;">Free memory:</span><span style="color: #800000;">"</span>+fm+<span style="color: #800000;">"</span><span style="color: #800000;">MB</span><span style="color: #800000;">"</span>+<span style="color: #800000;">"</span><span style="color: #800000;"><br /></span><span style="color: #800000;">"</span><span style="color: #000000;">);
out.println(</span><span style="color: #800000;">"</span><span style="color: #800000;">Available memory can be used is :</span><span style="color: #800000;">"</span>+(mm+fm-tm)+<span style="color: #800000;">"</span><span style="color: #800000;">MB</span><span style="color: #800000;">"</span>+<span style="color: #800000;">"</span><span style="color: #800000;"><br /></span><span style="color: #800000;">"</span><span style="color: #000000;">);
</span>%></pre>
  
</div>


<h3>
  <span id="1112_jps">1.11.2 <span style="font-family: '微软雅黑',sans-serif;">方法二：使用</span>jps<span style="font-family: '微软雅黑',sans-serif;">命令进行监控</span></span>
</h3>


<div class="cnblogs_code">
  <pre>[root@web03 ~]# jps -<span style="color: #000000;">lvm

</span>31906 org.apache.catalina.startup.Bootstrap start -Djava.util.logging.config.file=/application/tomcat8_1/conf/logging.properties -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -Djava.endorsed.dirs=/application/tomcat8_1/endorsed -Dcatalina.base=/application/tomcat8_1 -Dcatalina.home=/application/tomcat8_1 -Djava.io.tmpdir=/application/tomcat8_1/<span style="color: #000000;">temp

</span>31812 org.apache.catalina.startup.Bootstrap start -Djava.util.logging.config.file=/application/tomcat/conf/logging.properties -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -Djava.endorsed.dirs=/application/tomcat/endorsed -Dcatalina.base=/application/tomcat -Dcatalina.home=/application/tomcat -Djava.io.tmpdir=/application/tomcat/<span style="color: #000000;">temp

</span>31932 org.apache.catalina.startup.Bootstrap start -Djava.util.logging.config.file=/application/tomcat8_2/conf/logging.properties -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -Djava.endorsed.dirs=/application/tomcat8_2/endorsed -Dcatalina.base=/application/tomcat8_2 -Dcatalina.home=/application/tomcat8_2 -Djava.io.tmpdir=/application/tomcat8_2/<span style="color: #000000;">temp

</span>32079 sun.tools.jps.Jps -lvm -Denv.<span style="color: #0000ff;">class</span>.path=.:/application/jdk/lib:/application/jdk/jre/lib:/application/jdk/lib/tools.jar -Dapplication.home=/application/jdk1.8.0_60 -Xms8m</pre>
  
</div>


<h3>
  <span id="1113_Tomcat">1.11.3 Tomcat<span style="font-family: '微软雅黑',sans-serif;">远程监控功能</span></span>
</h3>


<p style="margin-left: 7.1pt; text-indent: 8.65pt;">
  <span style="font-family: 等线;">修改配置文件，开启远程监控</span>
</p>


<div class="cnblogs_code">
  <pre>vim /application/tomcat8_1/bin/catalina.sh +97<span style="color: #000000;">

CATALINA_OPTS</span>="$CATALINA_OPTS
-<span style="color: #000000;">Dcom.sun.management.jmxremote 
</span>-Dcom.sun.management.jmxremote.port=12345  
-Dcom.sun.management.jmxremote.authenticate=<span style="color: #0000ff;">false</span> 
-Dcom.sun.management.jmxremote.ssl=<span style="color: #0000ff;">false</span> 
-Djava.rmi.server.hostname=10.0.0.17"</pre>
  
</div>


<p>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: 等线;">重启服务，检查</span>12345<span style="font-family: 等线;">端口是否开启</span>
</p>


<div class="cnblogs_code">
  <pre>/application/tomcat8_1/bin/<span style="color: #000000;">shutdown.sh 
</span>/application/tomcat8_1/bin/<span style="color: #000000;">startup.sh 
netstat </span>-tunlp|grep 12345</pre>
  
</div>


<p>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: 等线;">检查端口</span>
</p>


<div class="cnblogs_code">
  <pre>[root@web03 ~]# netstat -tunlp|grep 12345<span style="color: #000000;">
tcp6       </span>0      0 :::12345           :::*          LISTEN      33158/java  </pre>
  
</div>


<p>
  <strong><span style="font-family: 等线; background: lime;">在</span><span style="background: lime;">windows</span></strong><strong><span style="font-family: 等线; background: lime;">上监控</span><span style="background: lime;">tomcat</span></strong>
</p>


<div style="border: solid windowtext 2.0pt; padding: 1.0pt 4.0pt 1.0pt 4.0pt; background: #F2F2F2;">
  <p>
    <strong><span style="font-family: '微软雅黑',sans-serif; color: red;">注意：</span><span style="color: red;">windwos</span></strong><strong><span style="font-family: '微软雅黑',sans-serif; color: red;">需要安装</span><span style="color: red;">jdk</span></strong><strong><span style="font-family: '微软雅黑',sans-serif; color: red;">环境！</span></strong>
  </p>
  
  
  <p>
    <em><span style="font-family: '微软雅黑',sans-serif;">查考：</span><span style="text-decoration: underline;">http://www.oracle.com/technetwork/java/javase/downloads/index.html</span></em>
  </p>
  
</div>


<p>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: 等线;">软件路径</span>
</p>


<div class="cnblogs_code">
  <pre>C:\Program Files\Java\jdk1.8<span style="color: #000000;">.0_31\bin
<span style="background-color: #00ffff;">jconsole.exe   jvisualvm.exe</span></span></pre>
  
</div>


<p>
  <strong><em><span style="text-decoration: underline;">jconsole.exe </span></em></strong><strong><em><span style="text-decoration: underline;"><span style="font-family: 等线;">使用说明</span></span></em></strong>
</p>


<p style="text-align: center;" align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171127162727784-599308853.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="企业级Tomcat部署实践及安全调优" alt="" />
</p>



<p>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: 等线;">连接成功即可进行监控，连接的时候注意端口信息。</span>
</p>


<p style="text-align: center;" align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171127162738565-738384915.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="企业级Tomcat部署实践及安全调优" alt="" />
</p>



<p>
  <strong><em><span style="text-decoration: underline;">jvisualvm.exe</span></em></strong><strong><em><span style="text-decoration: underline;"><span style="font-family: 等线;">使用说明</span></span></em></strong>
</p>


<p style="text-align: center;" align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171127162750784-48883054.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="企业级Tomcat部署实践及安全调优" alt="" />
</p>



<p>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: 等线;">输入</span>ip<span style="font-family: 等线;">地址</span>
</p>


<p style="text-align: center;" align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171127162759081-1663450024.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="企业级Tomcat部署实践及安全调优" alt="" />
</p>



<p>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: 等线;">主机添加完成，添加</span>JMX<span style="font-family: 等线;">监控</span>
</p>


<p style="text-align: center;" align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171127162808253-922440046.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="企业级Tomcat部署实践及安全调优" alt="" />
</p>



<p>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: 等线;">注意添加的时候输入端口信息。</span>
</p>


<p style="text-align: center;" align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171127162819378-1066040054.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="企业级Tomcat部署实践及安全调优" alt="" />
</p>



<p>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: 等线;">添加完成后就能够多</span>tomcat<span style="font-family: 等线;">程序进行监控。</span>
</p>


<h3>
  <span id="1114_zabbixtomcat">1.11.4 zabbix<span style="font-family: '微软雅黑',sans-serif;">监控</span>tomcat<span style="font-family: '微软雅黑',sans-serif;">程序</span></span>
</h3>


<p style="margin-left: 21.0pt;">
  zabbix<span style="font-family: 等线;">搭建详情参考：</span><em><span style="text-decoration: underline;">http://www.cnblogs.com/clsn/p/7885990.html</span></em>
</p>


<p>
  <strong><span style="font-family: 等线; background: lime;">服务端安装配置</span><span style="background: lime;">java</span></strong><strong><span style="font-family: 等线; background: lime;">监控服务</span></strong>
</p>


<div class="cnblogs_code">
  <pre>[root@m01 ~]<span style="color: #008000;">#</span><span style="color: #008000;"> yum install zabbix-java-gateway -y</span></pre>
  
</div>


<p style="text-indent: 15.75pt;">
  <strong><span style="font-family: 等线;">查看配置文件</span></strong>
</p>


<div class="cnblogs_code">
  <pre><em>配置文件路径：/etc/zabbix/</em><span style="color: #000000;"><em>zabbix_java_gateway.conf</em>
sed </span>-i -e <span style="color: #800000;">'</span><span style="color: #800000;">220a JavaGateway=127.0.0.1</span><span style="color: #800000;">'</span> -e <span style="color: #800000;">'</span><span style="color: #800000;">236a StartJavaPollers=5</span><span style="color: #800000;">'</span>  /etc/zabbix/zabbix_server.conf</pre>
  
</div>


<p style="text-indent: 15.75pt;">
  <span style="font-family: 等线;">启动</span>zabbix-java-gateway<span style="font-family: 等线;">服务，与</span>zabbix<span style="font-family: 等线;">服务</span>
</p>


<div class="cnblogs_code">
  <pre>systemctl start zabbix-java-<span style="color: #000000;">gateway.service
systemctl restart zabbix</span>-server.service</pre>
  
</div>


<p style="text-indent: 15.75pt;">
  <span style="font-family: 等线;">检查</span><span style="text-indent: 15.75pt;">java</span><span style="font-family: 等线;">端口是否开启</span>
</p>


<div class="cnblogs_code">
  <pre>[root@m01 ~]<span style="color: #008000;">#</span><span style="color: #008000;"> netstat -lntup |grep java</span>
tcp6       0      0 :::10052   :::*    LISTEN      72971/java  </pre>
  
</div>


<p>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: 等线;">检查</span>java<span style="font-family: 等线;">进程是否存在</span>
</p>


<div class="cnblogs_code">
  <pre>[root@m01 ~]<span style="color: #008000;">#</span><span style="color: #008000;"> ps -ef |grep [j]ava</span>
zabbix    72971      1  0 11:29 ?        00:00:00 java -server -Dlogback.configurationFile=/etc/zabbix/zabbix_java_gateway_logback.xml -classpath lib:lib/android-json-4.3_r3.1.jar:lib/logback-classic-0.9.27.jar:lib/logback-core-0.9.27.jar:lib/slf4j-api-1.6.1.jar:bin/zabbix-java-gateway-3.0.13.jar -Dzabbix.pidFile=/var/run/zabbix/zabbix_java.pid -Dzabbix.timeout=3 -Dsun.rmi.transport.tcp.responseTimeout=3000<span style="color: #000000;"> com.zabbix.gateway.JavaGateway
zabbix    </span>73255  73226  0 11:35 ?        00:00:00 /usr/sbin/zabbix_server: java poller <span style="color: #008000;">#</span><span style="color: #008000;">1 [got 0 values in 0.000002 sec, idle 5 sec]</span>
zabbix    73256  73226  0 11:35 ?        00:00:00 /usr/sbin/zabbix_server: java poller <span style="color: #008000;">#</span><span style="color: #008000;">2 [got 0 values in 0.000002 sec, idle 5 sec]</span>
zabbix    73257  73226  0 11:35 ?        00:00:00 /usr/sbin/zabbix_server: java poller <span style="color: #008000;">#</span><span style="color: #008000;">3 [got 0 values in 0.000002 sec, idle 5 sec]</span>
zabbix    73258  73226  0 11:35 ?        00:00:00 /usr/sbin/zabbix_server: java poller <span style="color: #008000;">#</span><span style="color: #008000;">4 [got 0 values in 0.000002 sec, idle 5 sec]</span>
zabbix    73259  73226  0 11:35 ?        00:00:00 /usr/sbin/zabbix_server: java poller <span style="color: #008000;">#</span><span style="color: #008000;">5 [got 0 values in 0.000004 sec, idle 5 sec]</span></pre>
  
</div>


<p>
  <strong><span style="background: lime;">web</span></strong><strong><span style="font-family: 等线; background: lime;">界面添加</span></strong>
</p>


<p>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: 等线;">添加主机</span>
</p>


<p style="text-align: center;" align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171127163059878-505035611.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="企业级Tomcat部署实践及安全调优" alt="" />&nbsp;
</p>



<p>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: 等线;">主机管理模板，注意是</span>JMX<span style="font-family: 等线;">模板</span>
</p>


<p style="text-align: center;" align="center">
  &nbsp;<img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171127163107737-761922553.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="企业级Tomcat部署实践及安全调优" alt="" />
</p>



<p>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: 等线;">监控完成</span>
</p>


<p style="text-align: center;" align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171127163113909-1086285598.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="企业级Tomcat部署实践及安全调优" alt="" />&nbsp;
</p>



<h3>
  <span id="1115_tomcat"><span style="courier new"4courier new"; background: lime;">1.11.5 </span><span style="font-family: '微软雅黑',sans-serif; courier new"4courier new";background: lime;">排除</span><span style="background: lime;">tomcat</span><span style="font-family: '微软雅黑',sans-serif; courier new"4courier new";background: lime;">故障步骤</span></span>
</h3>


<p style="text-indent: 21.0pt;">
  a. <span style="font-family: 等线;">查看</span>catalina.out
</p>


<p style="text-indent: 21.0pt;">
  b. <span style="font-family: 等线;">使用</span>sh show-busy-java-threads.sh<span style="font-family: 等线;">脚本进行检测</span>
</p>


<div style="border: solid windowtext 2.0pt; padding: 1.0pt 4.0pt 1.0pt 4.0pt; background: #F2F2F2;">
  <p>
    <span style="font-family: '微软雅黑',sans-serif;">脚本下载地址</span>
  </p>
  
  
  <p>
    <span style="text-decoration: underline;"><em>https://files.cnblogs.com/files/clsn/show-busy-java-threads.sh</em></span>
  </p>
  
</div>


<h2>
  <span id="112_Tomcat">1.12 Tomcat<span style="font-family: '微软雅黑',sans-serif;">安全优化</span></span>
</h2>


<h2>
  <span id="1nbspnbspnbspnbsp_telnet"><span style="font-family: 'Cambria',serif;">1.<span style="font-variant-numeric: normal; font-weight: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp; </span></span>telnet<span style="font-family: '微软雅黑',sans-serif;">管理端口保护（强制）</span></span>
</h2>


<div align="center">
  <table style="width: 100%; border-collapse: collapse; border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
    
    
    
    <tr>
      <td style="width: 19.5%; border-width: 1pt; border-style: solid; border-color: windowtext; background: #e6e6e6; padding: 0cm 5.4pt;" width="19%">
        <p style="text-align: center;" align="center">
          <strong><span style="font-family: 等线;">类别</span></strong>
        </p>
        
      </td>
      
      
      <td style="width: 28.58%; border-top: 1pt solid windowtext; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: none; background: #e6e6e6; padding: 0cm 5.4pt;" width="28%">
        <p style="text-align: center;" align="center">
          <strong><span style="font-family: 等线;">配置内容及说明</span></strong>
        </p>
        
      </td>
      
      
      <td style="width: 30.08%; border-top: 1pt solid windowtext; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: none; background: #e6e6e6; padding: 0cm 5.4pt;" width="30%">
        <p style="text-align: center;" align="center">
          <strong><span style="font-family: 等线;">标准配置</span></strong>
        </p>
        
      </td>
      
      
      <td style="width: 21.84%; border-top: 1pt solid windowtext; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: none; background: #e6e6e6; padding: 0cm 5.4pt;" width="21%">
        <p style="text-align: center;" align="center">
          <strong><span style="font-family: 等线;">备注</span></strong>
        </p>
        
      </td>
      
    </tr>
    
    
    <tr>
      <td style="width: 19.5%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="19%">
        <p style="text-align: center;" align="center">
          telnet<span style="font-family: 等线;">管理端口保护</span>
        </p>
        
      </td>
      
      
      <td style="width: 28.58%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="28%">
        <p style="margin-left: 18.0pt; text-align: center;" align="center">
          1.<span style="font-family: 等线;">修改默认的</span>8005<span style="font-family: 等线;">管理端口为不易猜测的端口（大于</span>1024<span style="font-family: 等线;">）；</span>
        </p>
        
        
        <p style="margin-left: 18.0pt; text-align: center;" align="center">
          2.<span style="font-family: 等线;">修改</span>SHUTDOWN<span style="font-family: 等线;">指令为其他字符串；</span>
        </p>
        
      </td>
      
      
      <td style="width: 30.08%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="30%">
        <p style="text-align: center;" align="center">
          <Server port="<strong><span style="color: red;">8527</span></strong>" shutdown="<strong><span style="color: red;">dangerous</span></strong>">
        </p>
        
      </td>
      
      
      <td style="width: 21.84%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="21%">
        <p style="text-align: center;" align="center">
          1.<span style="font-family: 等线;">以上配置项的配置内容只是建议配置，可以按照服务实际情况进行合理配置，但要求端口配置在</span><strong><span style="color: red;">8000~8999</span></strong><span style="font-family: 等线;">之间；</span>
        </p>
        
      </td>
      
    </tr>
    
    
  </table>
  
</div>


<h2>
  <span id="2_ajp">2. ajp<span style="font-family: '微软雅黑',sans-serif;">连接端口保护（推荐）</span></span>
</h2>


<div align="center">
  <table style="width: 100%; border-collapse: collapse; border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
    
    
    
    <tr>
      <td style="width: 20.28%; border-width: 1pt; border-style: solid; border-color: windowtext; background: #e6e6e6; padding: 0cm 5.4pt;" width="20%">
        <p style="text-align: center;" align="center">
          <strong><span style="font-family: 等线;">类别</span></strong>
        </p>
        
      </td>
      
      
      <td style="width: 29.72%; border-top: 1pt solid windowtext; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: none; background: #e6e6e6; padding: 0cm 5.4pt;" width="29%">
        <p style="text-align: center;" align="center">
          <strong><span style="font-family: 等线;">配置内容及说明</span></strong>
        </p>
        
      </td>
      
      
      <td style="width: 27.32%; border-top: 1pt solid windowtext; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: none; background: #e6e6e6; padding: 0cm 5.4pt;" width="27%">
        <p style="text-align: center;" align="center">
          <strong><span style="font-family: 等线;">标准配置</span></strong>
        </p>
        
      </td>
      
      
      <td style="width: 22.7%; border-top: 1pt solid windowtext; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: none; background: #e6e6e6; padding: 0cm 5.4pt;" width="22%">
        <p style="text-align: center;" align="center">
          <strong><span style="font-family: 等线;">备注</span></strong>
        </p>
        
      </td>
      
    </tr>
    
    
    <tr>
      <td style="width: 20.28%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="20%">
        <p style="text-align: center;" align="center">
          Ajp <span style="font-family: 等线;">连接端口保护</span>
        </p>
        
      </td>
      
      
      <td style="width: 29.72%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="29%">
        <p style="text-align: center;" align="center">
          1.<span style="font-family: 等线;">修改默认的</span>ajp 8009<span style="font-family: 等线;">端口为不易冲突的大于</span>1024<span style="font-family: 等线;">端口；</span>
        </p>
        
        
        <p style="text-align: center;" align="center">
          2.<span style="font-family: 等线;">通过</span>iptables<span style="font-family: 等线;">规则</span><span style="font-family: 等线;">限制</span>ajp<span style="font-family: 等线;">端口访问的权限仅为线上机器；</span>
        </p>
        
      </td>
      
      
      <td style="width: 27.32%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="27%">
        <p style="text-align: center;" align="center">
          <Connector port="<strong><span style="color: red;">8528</span></strong>"
        </p>
        
        
        <p style="text-align: center;" align="center">
          protocol="AJP/1.3" />
        </p>
        
      </td>
      
      
      <td style="width: 22.7%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="22%">
        <p style="text-align: center;" align="center">
          <span style="font-family: 等线;">以上配置项的配置内容仅为建议配置，请按照服务实际情况进行合理配置，</span><span style="font-family: 等线;">但要求端口配置在</span><strong><span style="color: red;">8000~8999</span></strong><span style="font-family: 等线;">之间；</span><span style="font-family: 等线;">；</span>
        </p>
        
        
        <p style="text-align: center;" align="center">
          <span style="font-family: 等线;">保护此端口的目的在于防止线下的测试流量被</span>mod_jk<span style="font-family: 等线;">转发至线上</span>tomcat<span style="font-family: 等线;">服务器；</span>
        </p>
        
      </td>
      
    </tr>
    
    
  </table>
  
</div>


<h2>
  <span id="3">3. <span style="font-family: '微软雅黑',sans-serif;">禁用管理端（强制）</span></span>
</h2>


<div align="center">
  <table style="width: 100%; border-collapse: collapse; border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
    
    
    
    <tr>
      <td style="width: 16.22%; border-width: 1pt; border-style: solid; border-color: windowtext; background: #e6e6e6; padding: 0cm 5.4pt;" width="16%">
        <p style="text-align: center;" align="center">
          <strong><span style="font-family: 等线;">类别</span></strong>
        </p>
        
      </td>
      
      
      <td style="width: 11.8%; border-top: 1pt solid windowtext; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: none; background: #e6e6e6; padding: 0cm 5.4pt;" width="11%">
        <p style="text-align: center;" align="center">
          <strong><span style="font-family: 等线;">配置内容及说明</span></strong>
        </p>
        
      </td>
      
      
      <td style="width: 35.12%; border-top: 1pt solid windowtext; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: none; background: #e6e6e6; padding: 0cm 5.4pt;" width="35%">
        <p style="text-align: center;" align="center">
          <strong><span style="font-family: 等线;">标准配置</span></strong>
        </p>
        
      </td>
      
      
      <td style="width: 36.86%; border-top: 1pt solid windowtext; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: none; background: #e6e6e6; padding: 0cm 5.4pt;" width="36%">
        <p style="text-align: center;" align="center">
          <strong><span style="font-family: 等线;">备注</span></strong>
        </p>
        
      </td>
      
    </tr>
    
    
    <tr style="height: 35.0pt;">
      <td style="width: 16.22%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt; height: 35pt;" width="16%">
        <p style="text-align: center;" align="center">
          <span style="font-family: 等线;">禁用管理端</span>
        </p>
        
      </td>
      
      
      <td style="width: 11.8%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; height: 35.0pt;" width="11%">
        <p style="text-align: center;" align="center">
          1. <span style="font-family: 等线;">删除默认的</span>{Tomcat<span style="font-family: 等线;">安装目录</span>}/conf/tomcat-users.xml<span style="font-family: 等线;">文件，重启</span>tomcat<span style="font-family: 等线;">后将会自动生成新的文件；</span>
        </p>
        
        
        <p style="text-align: center;" align="center">
          2. <span style="font-family: 等线;">删除</span>{Tomcat<span style="font-family: 等线;">安装目录</span>}/webapps<span style="font-family: 等线;">下默认的所有目录和文件；</span>
        </p>
        
        
        <p style="text-align: center;" align="center">
          3.<span style="font-family: 等线;">将</span>tomcat <span style="font-family: 等线;">应用根目录配置为</span>tomcat<span style="font-family: 等线;">安装目录以外的目录；</span>
        </p>
        
      </td>
      
      
      <td style="width: 35.12%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; height: 35.0pt;" width="35%">
        <p style="text-align: center;" align="center">
          &nbsp;
        </p>
        
        
        <p style="text-align: center;" align="center">
          <Context path="" docBase=
        </p>
        
        
        <p style="text-align: center;" align="center">
          "<strong><span style="color: red;">/home/work/local/tomcat</span></strong>
        </p>
        
        
        <p style="text-align: center;" align="center">
          <strong><span style="color: red;">_webapps</span></strong>"
        </p>
        
        
        <p style="text-align: center;" align="center">
          debug="0"
        </p>
        
        
        <p style="text-align: center;" align="center">
          reloadable="false"
        </p>
        
        
        <p style="text-align: center;" align="center">
          crossContext="true"/>
        </p>
        
      </td>
      
      
      <td style="width: 36.86%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; height: 35.0pt;" width="36%">
        <p style="text-align: center;" align="center">
          &nbsp;&nbsp;<span style="font-family: 等线;">对于前段</span>web<span style="font-family: 等线;">模块，</span>Tomcat<span style="font-family: 等线;">管理端属于</span>tomcat<span style="font-family: 等线;">的高危安全隐患，一旦被攻破，黑客通过上传</span>web shell<span style="font-family: 等线;">的方式将会直接取得服务器的控制权，后果极其严重；</span>
        </p>
        
      </td>
      
    </tr>
    
    
  </table>
  
</div>


<h2>
  <span id="4">4. <span style="font-family: '微软雅黑',sans-serif;">降权启动（强制）</span></span>
</h2>


<table style="width: 100%; border-collapse: collapse; border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
  
  
  
  <tr>
    <td style="width: 14.88%; border-width: 1pt; border-style: solid; border-color: windowtext; background: #e6e6e6; padding: 0cm 5.4pt;" width="14%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: 等线;">类别</span></strong>
      </p>
      
    </td>
    
    
    <td style="width: 40.66%; border-top: 1pt solid windowtext; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: none; background: #e6e6e6; padding: 0cm 5.4pt;" width="40%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: 等线;">配置内容及说明</span></strong>
      </p>
      
    </td>
    
    
    <td style="width: 8.14%; border-top: 1pt solid windowtext; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: none; background: #e6e6e6; padding: 0cm 5.4pt;" width="8%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: 等线;">标准配置</span></strong>
      </p>
      
    </td>
    
    
    <td style="width: 36.32%; border-top: 1pt solid windowtext; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: none; background: #e6e6e6; padding: 0cm 5.4pt;" width="36%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: 等线;">备注</span></strong>
      </p>
      
    </td>
    
  </tr>
  
  
  <tr>
    <td style="width: 14.88%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="14%">
      <p style="text-align: center;" align="center">
        <span style="font-family: 等线;">降权启动</span>
      </p>
      
    </td>
    
    
    <td style="width: 40.66%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="40%">
      <p style="text-align: center;" align="center">
        1.tomcat<span style="font-family: 等线;">启动用户权限必须为非</span>root<span style="font-family: 等线;">权限，尽量降低</span>tomcat<span style="font-family: 等线;">启动用户的目录访问权限；</span>
      </p>
      
      
      <p style="text-align: center;" align="center">
        2.<span style="font-family: 等线;">如需直接对外使用</span>80<span style="font-family: 等线;">端口，可通过普通账号启动后，配置</span>iptables<span style="font-family: 等线;">规则进行转发；</span>
      </p>
      
    </td>
    
    
    <td style="width: 8.14%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="8%">
      &nbsp;
    </td>
    
    
    <td style="width: 36.32%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="36%">
      <p style="text-align: center;" align="center">
        <span style="font-family: 等线;">避免一旦</span>tomcat <span style="font-family: 等线;">服务</span><span style="font-family: 等线;">被入侵，黑客直接获取高级用户权限危害整个</span>server<span style="font-family: 等线;">的安全；</span>
      </p>
      
    </td>
    
  </tr>
  
  
</table>


<div class="cnblogs_code">
  <pre>[root@web03 ~]<span style="color: #008000;">#</span><span style="color: #008000;"> useradd tomcat</span>
[root@web03 ~]<span style="color: #008000;">#</span><span style="color: #008000;"> cp -a /application/tools/tomcat8_1 /home/tomcat/</span>
[root@web03 ~]<span style="color: #008000;">#</span><span style="color: #008000;"> chown -R tomcat.tomcat /home/tomcat/tomcat8_1/</span>
[root@web03 ~]<span style="color: #008000;">#</span><span style="color: #008000;"> su -c '/home/tomcat/tomcat8_1/bin/startup.sh' tomcat</span>
Using CATALINA_BASE:   /home/tomcat/<span style="color: #000000;">tomcat8_1
Using CATALINA_HOME:   </span>/home/tomcat/<span style="color: #000000;">tomcat8_1
Using CATALINA_TMPDIR: </span>/home/tomcat/tomcat8_1/<span style="color: #000000;">temp
Using JRE_HOME:        </span>/application/<span style="color: #000000;">jdk
Using CLASSPATH:       </span>/home/tomcat/tomcat8_1/bin/bootstrap.jar:/home/tomcat/tomcat8_1/bin/tomcat-<span style="color: #000000;">juli.jar
Tomcat started.
[root@web03 </span>~]<span style="color: #008000;">#</span><span style="color: #008000;"> ps -ef|grep tomcat</span></pre>
  
</div>


<h2>
  <span id="5">5.<span style="font-family: '微软雅黑',sans-serif;">文件列表访问控制（强制）</span></span>
</h2>


<table style="width: 100%; border-collapse: collapse; border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
  
  
  
  <tr>
    <td style="width: 15.28%; border-width: 1pt; border-style: solid; border-color: windowtext; background: #e6e6e6; padding: 0cm 5.4pt;" width="15%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: 等线;">类别</span></strong>
      </p>
      
    </td>
    
    
    <td style="width: 24.3%; border-top: 1pt solid windowtext; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: none; background: #e6e6e6; padding: 0cm 5.4pt;" width="24%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: 等线;">配置内容及说明</span></strong>
      </p>
      
    </td>
    
    
    <td style="width: 40.36%; border-top: 1pt solid windowtext; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: none; background: #e6e6e6; padding: 0cm 5.4pt;" width="40%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: 等线;">标准配置</span></strong>
      </p>
      
    </td>
    
    
    <td style="width: 20.06%; border-top: 1pt solid windowtext; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: none; background: #e6e6e6; padding: 0cm 5.4pt;" width="20%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: 等线;">备注</span></strong>
      </p>
      
    </td>
    
  </tr>
  
  
  <tr>
    <td style="width: 15.28%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="15%">
      <p style="text-align: center;" align="center">
        <span style="font-family: 等线;">文件列表访问控制</span>
      </p>
      
    </td>
    
    
    <td style="width: 24.3%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="24%">
      <p style="text-align: center;" align="center">
        1.conf/web.xml<span style="font-family: 等线;">文件中</span>default<span style="font-family: 等线;">部分</span>listings<span style="font-family: 等线;">的配置必须为</span>false<span style="font-family: 等线;">；</span>
      </p>
      
    </td>
    
    
    <td style="width: 40.36%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="40%">
      <p style="text-align: center;" align="center">
        <init-param>
      </p>
      
      
      <p style="text-align: center;" align="center">
        <param-name />
        
        <strong>listings</strong></param-name>
      </p>
      
      
      <p style="text-align: center;" align="center">
        <param-value />
        
        <strong><span style="color: red;">false</span></strong></param-value>
      </p>
      
      
      <p style="text-align: center;" align="center">
        </init-param>
      </p>
      
    </td>
    
    
    <td style="width: 20.06%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="20%">
      <p style="text-align: center;" align="center">
        false<span style="font-family: 等线;">为不列出目录文件，</span>true<span style="font-family: 等线;">为允许列出，默认为</span>false<span style="font-family: 等线;">；</span>
      </p>
      
    </td>
    
  </tr>
  
  
</table>


<h2>
  <span id="6">6. <span style="font-family: '微软雅黑',sans-serif;">版本信息隐藏（强制）</span></span>
</h2>


<table style="width: 100%; border-collapse: collapse; border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
  
  
  
  <tr>
    <td style="width: 10.46%; border-width: 1pt; border-style: solid; border-color: windowtext; background: #e6e6e6; padding: 0cm 5.4pt;" width="10%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: 等线;">类别</span></strong>
      </p>
      
    </td>
    
    
    <td style="width: 20.96%; border-top: 1pt solid windowtext; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: none; background: #e6e6e6; padding: 0cm 5.4pt;" width="20%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: 等线;">配置内容及说明</span></strong>
      </p>
      
    </td>
    
    
    <td style="width: 40%; border-top: 1pt solid windowtext; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: none; background: #e6e6e6; padding: 0cm 5.4pt;" width="40%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: 等线;">标准配置</span></strong>
      </p>
      
    </td>
    
    
    <td style="width: 28.56%; border-top: 1pt solid windowtext; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: none; background: #e6e6e6; padding: 0cm 5.4pt;" width="28%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: 等线;">备注</span></strong>
      </p>
      
    </td>
    
  </tr>
  
  
  <tr style="height: 211.85pt;">
    <td style="width: 10.46%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt; height: 211.85pt;" width="10%">
      <p style="text-align: center;" align="center">
        <span style="font-family: 等线;">版本信息隐藏</span>
      </p>
      
    </td>
    
    
    <td style="width: 20.96%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; height: 211.85pt;" width="20%">
      <p style="text-align: center;" align="center">
        1.<span style="font-family: 等线;">修改</span>conf/web.xml<span style="font-family: 等线;">，重定向</span>403<span style="font-family: 等线;">、</span>404<span style="font-family: 等线;">以及</span>500<span style="font-family: 等线;">等错误到指定的错误页面；</span>
      </p>
      
      
      <p style="text-align: center;" align="center">
        2.<span style="font-family: 等线;">也可以通过修改应用程序目录下的</span>WEB-INF/web.xml<span style="font-family: 等线;">下的配置进行错误页面的重定向；</span>
      </p>
      
    </td>
    
    
    <td style="width: 40.0%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; height: 211.85pt;" width="40%">
      <p style="text-align: center;" align="center">
        <error-page>
      </p>
      
      
      <p style="text-align: center;" align="center">
        <error-code><strong><span style="color: red;">403</span></strong></error-code>
      </p>
      
      
      <p style="text-align: center;" align="center">
        <location><strong><span style="color: red;">/forbidden.jsp</span></strong></location>
      </p>
      
      
      <p style="text-align: center;" align="center">
        </error-page>
      </p>
      
      
      <p style="text-align: center;" align="center">
        <error-page>
      </p>
      
      
      <p style="text-align: center;" align="center">
        <error-code><strong><span style="color: red;">404</span></strong></error-code>
      </p>
      
      
      <p style="text-align: center;" align="center">
        <location><strong><span style="color: red;">/notfound.jsp</span></strong></location>
      </p>
      
      
      <p style="text-align: center;" align="center">
        </error-page>
      </p>
      
      
      <p style="text-align: center;" align="center">
        <error-page>
      </p>
      
      
      <p style="text-align: center;" align="center">
        <error-code><strong><span style="color: red;">500</span></strong></error-code>
      </p>
      
      
      <p style="text-align: center;" align="center">
        <location><strong><span style="color: red;">/systembusy.jsp</span></strong></location>
      </p>
      
      
      <p style="text-align: center;" align="center">
        </error-page>
      </p>
      
    </td>
    
    
    <td style="width: 28.56%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt; height: 211.85pt;" width="28%">
      <p style="text-align: center;" align="center">
        <span style="font-family: 等线;">在配置中对一些常见错误进行重定向，避免当出现错误时</span>tomcat<span style="font-family: 等线;">默认显示的错误页面暴露服务器和版本信息；</span>
      </p>
      
      
      <p style="text-align: center;" align="center">
        <span style="font-family: 等线;">必须确保程序根目录下的错误页面已经存在；</span>
      </p>
      
    </td>
    
  </tr>
  
  
</table>


<h2>
  <span id="7_Server_header">7. Server header<span style="font-family: '微软雅黑',sans-serif;">重写（推荐）</span></span>
</h2>


<table style="width: 100%; border-collapse: collapse; border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
  
  
  
  <tr>
    <td style="width: 18.62%; border-width: 1pt; border-style: solid; border-color: windowtext; background: #e6e6e6; padding: 0cm 5.4pt;" width="18%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: 等线;">类别</span></strong>
      </p>
      
    </td>
    
    
    <td style="width: 25.24%; border-top: 1pt solid windowtext; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: none; background: #e6e6e6; padding: 0cm 5.4pt;" width="25%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: 等线;">配置内容及说明</span></strong>
      </p>
      
    </td>
    
    
    <td style="width: 25.24%; border-top: 1pt solid windowtext; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: none; background: #e6e6e6; padding: 0cm 5.4pt;" width="25%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: 等线;">标准配置</span></strong>
      </p>
      
    </td>
    
    
    <td style="width: 30.9%; border-top: 1pt solid windowtext; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: none; background: #e6e6e6; padding: 0cm 5.4pt;" width="30%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: 等线;">备注</span></strong>
      </p>
      
    </td>
    
  </tr>
  
  
  <tr>
    <td style="width: 18.62%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="18%">
      <p style="text-align: center;" align="center">
        Server header<span style="font-family: 等线;">重写</span>
      </p>
      
    </td>
    
    
    <td style="width: 25.24%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="25%">
      <p style="text-align: center;" align="center">
        <span style="font-family: 等线;">在</span>HTTP Connector<span style="font-family: 等线;">配置中加入</span>server<span style="font-family: 等线;">的配置；</span>
      </p>
      
    </td>
    
    
    <td style="width: 25.24%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="25%">
      <p style="text-align: center;" align="center">
        server="<strong><span style="color: red;">webserver</span></strong>"
      </p>
      
      
      <p style="text-align: center;" align="center">
        &nbsp;
      </p>
      
    </td>
    
    
    <td style="width: 30.9%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="30%">
      <p style="text-align: center;" align="center">
        <span style="font-family: 等线;">当</span>tomcat HTTP<span style="font-family: 等线;">端口直接提供</span>web<span style="font-family: 等线;">服务时此配置生效，加入此配置，将会替换</span>http <span style="font-family: 等线;">响应</span>Server header<span style="font-family: 等线;">部分的默认配置，默认是</span><code>&lt;span style="font-size: 10.5pt; font-family: 'Times New Roman',serif;">Apache-Coyote/1.1&lt;/span></code>
      </p>
      
    </td>
    
  </tr>
  
  
</table>


<h2>
  <span id="8">8. <span style="font-family: '微软雅黑',sans-serif;">访问限制（可选）</span></span>
</h2>


<table style="border-collapse: collapse; border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
  
  
  
  <tr>
    <td style="border-width: 1pt; border-style: solid; border-color: windowtext; background: #e6e6e6; padding: 0cm 5.4pt;">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: 等线;">类别</span></strong>
      </p>
      
    </td>
    
    
    <td style="border-top: 1pt solid windowtext; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: none; background: #e6e6e6; padding: 0cm 5.4pt;">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: 等线;">配置内容及说明</span></strong>
      </p>
      
    </td>
    
    
    <td style="border-top: 1pt solid windowtext; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: none; background: #e6e6e6; padding: 0cm 5.4pt;">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: 等线;">标准配置或操作</span></strong>
      </p>
      
    </td>
    
    
    <td style="border-top: 1pt solid windowtext; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: none; background: #e6e6e6; padding: 0cm 5.4pt;">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: 等线;">备注</span></strong>
      </p>
      
    </td>
    
  </tr>
  
  
  <tr>
    <td style="border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;">
      <p style="text-align: center;" align="center">
        <span style="font-family: 等线;">访问限制</span>
      </p>
      
    </td>
    
    
    <td style="border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;">
      <p style="text-align: center;" align="center">
        <span style="font-family: 等线;">通过配置，限定访问的</span>ip<span style="font-family: 等线;">来源</span>
      </p>
      
    </td>
    
    
    <td style="border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;">
      <p style="text-align: center;" align="center">
        <Context path="" docBase="/home/work/tomcat" debug="0" reloadable="false" crossContext="true">
      </p>
      
      
      <p style="text-align: center;" align="center">
        <Valve className="org.apache.catalina.valves.RemoteAddrValve" <strong><span style="color: red;">allow="61.148.18.138,61.135.165.*" deny="*.*.*.*"</span></strong><span style="color: red;">/</span>>
      </p>
      
      
      <p style="text-align: center;" align="center">
        </Context>
      </p>
      
    </td>
    
    
    <td style="border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;">
      <p style="text-align: center;" align="center">
        <span style="font-family: 等线;">通过配置信任</span>ip<span style="font-family: 等线;">的白名单，拒绝非白名单</span>ip<span style="font-family: 等线;">的访问，此配置主要是针对高保密级别的系统，一般产品线不需要；</span>
      </p>
      
    </td>
    
  </tr>
  
  
</table>


<h2>
  <span id="9nbspnbspnbspnbsp"><span style="font-family: 'Cambria',serif;">9.<span style="font-variant-numeric: normal; font-weight: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family: '微软雅黑',sans-serif;">起停脚本权限回收（推荐）</span></span>
</h2>


<div align="center">
  <table style="width: 100%; border-collapse: collapse; border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
    
    
    
    <tr>
      <td style="width: 13.48%; border-width: 1pt; border-style: solid; border-color: windowtext; background: #e6e6e6; padding: 0cm 5.4pt;" width="13%">
        <p style="text-align: center;" align="center">
          <strong><span style="font-family: 等线;">类别</span></strong>
        </p>
        
      </td>
      
      
      <td style="width: 25.98%; border-top: 1pt solid windowtext; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: none; background: #e6e6e6; padding: 0cm 5.4pt;" width="25%">
        <p style="text-align: center;" align="center">
          <strong><span style="font-family: 等线;">配置内容及说明</span></strong>
        </p>
        
      </td>
      
      
      <td style="width: 47.06%; border-top: 1pt solid windowtext; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: none; background: #e6e6e6; padding: 0cm 5.4pt;" width="47%">
        <p style="text-align: center;" align="center">
          <strong><span style="font-family: 等线;">标准配置或操作</span></strong>
        </p>
        
      </td>
      
      
      <td style="width: 13.48%; border-top: 1pt solid windowtext; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: none; background: #e6e6e6; padding: 0cm 5.4pt;" width="13%">
        <p style="text-align: center;" align="center">
          <strong><span style="font-family: 等线;">备注</span></strong>
        </p>
        
      </td>
      
    </tr>
    
    
    <tr>
      <td style="width: 13.48%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="13%">
        <p style="text-align: center;" align="center">
          <span style="font-family: 等线;">起停脚本权限回收</span>
        </p>
        
      </td>
      
      
      <td style="width: 25.98%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="25%">
        <p style="text-align: center;" align="center">
          <span style="font-family: 等线;">去除其他用户对</span>Tomcat<span style="font-family: 等线;">的</span>bin<span style="font-family: 等线;">目录下</span>shutdown.sh<span style="font-family: 等线;">、</span>startup.sh<span style="font-family: 等线;">、</span>catalina.sh<span style="font-family: 等线;">的可执行权限；</span>
        </p>
        
      </td>
      
      
      <td style="width: 47.06%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="47%">
        <p style="text-align: center;" align="center">
          chmod -R 744 tomcat/bin/*
        </p>
        
      </td>
      
      
      <td style="width: 13.48%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="13%">
        <p style="text-align: center;" align="center">
          <span style="font-family: 等线;">防止其他用户有起停线上</span>Tomcat<span style="font-family: 等线;">的权限；</span>
        </p>
        
      </td>
      
    </tr>
    
    
  </table>
  
</div>


<h2>
  <span id="10nbspnbspnbsp">10.<span style="font-variant-numeric: normal; font-weight: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp; </span><span style="font-family: '微软雅黑',sans-serif;">访问日志格式规范（推荐）</span></span>
</h2>


<table style="width: 100%; border-collapse: collapse; border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
  
  
  
  <tr>
    <td style="width: 7.66%; border-width: 1pt; border-style: solid; border-color: windowtext; background: #e6e6e6; padding: 0cm 5.4pt;" width="7%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: 等线;">类别</span></strong>
      </p>
      
    </td>
    
    
    <td style="width: 18.7%; border-top: 1pt solid windowtext; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: none; background: #e6e6e6; padding: 0cm 5.4pt;" width="18%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: 等线;">配置内容及说明</span></strong>
      </p>
      
    </td>
    
    
    <td style="width: 60.66%; border-top: 1pt solid windowtext; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: none; background: #e6e6e6; padding: 0cm 5.4pt;" width="60%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: 等线;">标准配置或操作</span></strong>
      </p>
      
    </td>
    
    
    <td style="width: 12.98%; border-top: 1pt solid windowtext; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: none; background: #e6e6e6; padding: 0cm 5.4pt;" width="12%">
      <p style="text-align: center;" align="center">
        <strong><span style="font-family: 等线;">备注</span></strong>
      </p>
      
    </td>
    
  </tr>
  
  
  <tr>
    <td style="width: 7.66%; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="7%">
      <p style="text-align: center;" align="center">
        <span style="font-family: 等线;">访问日志格式规范</span>
      </p>
      
    </td>
    
    
    <td style="width: 18.7%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="18%">
      <p style="text-align: center;" align="center">
        <span style="font-family: 等线;">开启</span>Tomcat<span style="font-family: 等线;">默认访问日志中的</span>Referer<span style="font-family: 等线;">和</span>User-Agent<span style="font-family: 等线;">记录</span>
      </p>
      
    </td>
    
    
    <td style="width: 60.66%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="60%">
      <p style="text-align: center;" align="center">
        <Valve className="org.apache.catalina.valves.AccessLogValve"
      </p>
      
      
      <p style="text-align: center;" align="center">
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory="logs"&nbsp; prefix="localhost_access_log." suffix=".txt"
      </p>
      
      
      <p style="text-align: center;" align="center">
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pattern="%h %l %u %t %r %s %b %{Referer}i %{User-Agent}i %D" resolveHosts="false"/>
      </p>
      
    </td>
    
    
    <td style="width: 12.98%; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="12%">
      <p style="text-align: center;" align="center">
        <span style="font-family: 等线;">开启</span>Referer<span style="font-family: 等线;">和</span>User-Agent<span style="font-family: 等线;">是为了一旦出现安全问题能够更好的根据日志进行问题排查；</span>
      </p>
      
    </td>
    
  </tr>
  
  
</table>


<h2>
  <span id="11nbspnbspnbsp">11.<span style="font-variant-numeric: normal; font-weight: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp; </span><span style="font-family: '微软雅黑',sans-serif;">附录：建议配置及标准执行方案</span></span>
</h2>


<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: .0001pt; margin-left: 21.0pt; text-align: justify; text-justify: inter-ideograph; text-indent: -21.0pt;">
  <strong>1.<span style="font-variant-numeric: normal; font-weight: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></strong><strong><span style="font-family: 等线;">配置部分（</span></strong><strong>${ CATALINA_HOME }conf/server.xml</strong><strong><span style="font-family: 等线;">）</span></strong>
</p>


<div class="cnblogs_code">
  <pre>&lt;Server port="8527" shutdown=" dangerous">

<!-- Define a non-SSL HTTP/1.1 Connector on port 8080 -->
&lt;Connector port="8080" server="webserver"/> 



<!-- Define an AJP 1.3 Connector on port 8528 -->


<!--Define an accesslog --> 
&lt;Valve className="org.apache.catalina.valves.AccessLogValve"

<span style="color: #000000;">
                 directory</span>="logs"  prefix="localhost_access_log." suffix=".txt"<span style="color: #000000;">
                 pattern</span>="%h %l %u %t %r %s %b %{Referer}i %{User-Agent}i %D" resolveHosts="false"/>

    &lt;Connector port="8528" protocol="AJP/1.3" />

&lt;Context path="" docBase="/home/work/local/tomcat_webapps" debug="0" reloadable="false" crossContext="true"/></pre>
  
</div>


<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: .0001pt; margin-left: 21.0pt; text-align: justify; text-justify: inter-ideograph; text-indent: -21.0pt;">
  &nbsp;
</p>


<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: .0001pt; margin-left: 21.0pt; text-align: justify; text-justify: inter-ideograph; text-indent: -21.0pt;">
  <strong>2.<span style="font-variant-numeric: normal; font-weight: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></strong><strong><span style="font-family: 等线;">配置部分（</span></strong><strong>${ CATALINA_HOME }conf/web.xml</strong><strong><span style="font-family: 等线;">或者</span></strong><strong>WEB-INF/web.xml</strong><strong><span style="font-family: 等线;">）</span></strong>
</p>


<div class="cnblogs_code">
  <pre>&lt;init-param>
    

<param-name />
listings&lt;/param-name>
    

<param-value />

<span style="color: #0000ff;">false</span>&lt;/param-value>
&lt;/init-param>

&lt;error-page>
    &lt;error-code>403&lt;/error-code>
    &lt;location>/forbidden.jsp&lt;/location>
&lt;/error-page>
&lt;error-page>
    &lt;error-code>404&lt;/error-code>
    &lt;location>/notfound.jsp&lt;/location>
&lt;/error-page>
&lt;error-page>
    &lt;error-code>500&lt;/error-code>
    &lt;location>/systembusy.jsp&lt;/location>
&lt;/error-page></pre>
  
</div>


<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: .0001pt; margin-left: 21.0pt; text-align: justify; text-justify: inter-ideograph; text-indent: -21.0pt;">
  <strong>3.<span style="font-variant-numeric: normal; font-weight: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></strong><strong><span style="font-family: 等线;">删除如下</span></strong><strong>tomcat</strong><strong><span style="font-family: 等线;">的默认目录和默认文件</span></strong>
</p>


<div class="cnblogs_code">
  <pre>tomcat/webapps<span style="color: #008000;">/*</span><span style="color: #008000;">
tomcat/conf/tomcat-user.xml</span></pre>
  
</div>


<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: .0001pt; margin-left: 21.0pt; text-align: justify; text-justify: inter-ideograph; text-indent: -21.0pt;">
  <strong>4.<span style="font-variant-numeric: normal; font-weight: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></strong><strong><span style="font-family: 等线;">去除其他用户对</span></strong><strong>tomcat </strong><strong><span style="font-family: 等线;">起停脚本的执行权限</span></strong>
</p>


<div class="cnblogs_code">
  <pre>chmod 744 &ndash;R tomcat/bin<span style="color: #008000;">/*</span></pre>
  
</div>


<h2>
  <span id="113_Tomcat">1.13 Tomcat<span style="font-family: '微软雅黑',sans-serif;">性能优化</span></span>
</h2>


<p style="text-indent: 21.0pt;">
  <span style="background: lime;">tomcat</span><span style="font-family: 等线; background: lime;">性能取决于</span> <span style="font-family: 等线; background: lime;">内存大小</span>
</p>


<p>
  <strong><span style="text-decoration: underline;"><span style="font-family: 等线; background: yellow;">上策：优化代码</span> </span></strong>
</p>


<div style="border: solid windowtext 2.0pt; padding: 1.0pt 4.0pt 1.0pt 4.0pt; background: #F2F2F2;">
  <p style="background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">
    &nbsp;&nbsp;&nbsp;<span style="font-family: '微软雅黑',sans-serif;">该项需要开发经验足够丰富，对开发人员要求较高</span>
  </p>
  
</div>


<p>
  <strong><span style="text-decoration: underline;"><span style="font-family: 等线; background: yellow;">中策：</span><span style="background: yellow;">jvm</span></span></strong><strong><span style="text-decoration: underline;"><span style="font-family: 等线; background: yellow;">优化机制</span>&nbsp;</span></strong><strong><span style="text-decoration: underline;"><span style="font-family: 等线; background: yellow;">垃圾回收机制</span> </span></strong><strong><span style="text-decoration: underline;"><span style="font-family: 等线; background: yellow;">把不需要的内存回收</span></span></strong>
</p>


<p>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: 等线;">优化</span>jvm--<span style="font-family: 等线;">优化垃圾回收策略</span>
</p>


<p style="margin-left: 21.0pt; text-indent: 21.0pt;">
  <span style="font-family: 等线;">优化</span>catalina.sh<span style="font-family: 等线;">配置文件。在</span>catalina.sh<span style="font-family: 等线;">配置文件中添加以下代码</span>
</p>


<div class="cnblogs_code">
  <pre><span style="color: #000000;"># tomcat分配1G内存模板
JAVA_OPTS</span>="-Djava.awt.headless=true -Dfile.encoding=UTF-8 -server -Xms1024m -Xmx1024m -XX:NewSize=512m -XX:MaxNewSize=512m -XX:PermSize=512m -XX:MaxPermSize=512m"<span style="color: #000000;">        

JAVA_OPTS</span>="-Djava.awt.headless=true -Dfile.encoding=UTF-8 -server -Xms800m -Xmx800m -XX:NewSize=400m -XX:MaxNewSize=400m -XX:PermSize=400m -XX:MaxPermSize=400m"<span style="color: #000000;">    
# 重启服务
su </span>-c '/home/tomcat/tomcat8_1/bin/shutdown.sh'<span style="color: #000000;"> tomcat
su </span>-c '/home/tomcat/tomcat8_1/bin/startup.sh' tomcat</pre>
  
</div>


<p>
  <strong><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </em></strong><strong><em><span style="text-decoration: underline;"><span style="font-family: 等线;">修改之前</span></span></em></strong>
</p>


<p style="text-align: center;" align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171127163243831-313808608.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="企业级Tomcat部署实践及安全调优" alt="" />
</p>



<p>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong><em><span style="text-decoration: underline;"><span style="font-family: 等线;">修改之后</span></span></em></strong>
</p>


<p style="text-align: center;" align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171127163252128-1901433795.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="企业级Tomcat部署实践及安全调优" alt="" />
</p>



<p>
  <strong><span style="text-decoration: underline;"><span style="font-family: 等线; background: yellow;">下策：加足够大的内存</span></span></strong>
</p>


<div style="border: solid windowtext 2.0pt; padding: 1.0pt 4.0pt 1.0pt 4.0pt; background: #F2F2F2;">
  <p style="background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">
    <span style="font-family: '微软雅黑',sans-serif;">该项的资金投入较大</span>
  </p>
  
</div>


<p>
  <strong><span style="text-decoration: underline;"><span style="font-family: 等线; background: yellow;">下下策：每天</span><span style="background: yellow;"></span></span></strong><strong><span style="text-decoration: underline;"><span style="font-family: 等线; background: yellow;">点定时重启</span><span style="background: yellow;">tomcat</span></span></strong>
</p>


<div style="border: solid windowtext 2.0pt; padding: 1.0pt 4.0pt 1.0pt 4.0pt; background: #F2F2F2;">
  <p style="background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">
    <span style="font-family: '微软雅黑',sans-serif;">使用较为广泛</span>
  </p>
  
</div>


<div id="toc_container" class="toc_white have_bullets">
  <ul class="toc_list">
    <ul>
      <li>
        <a href="#111_Tomcat---JDKnbspnbsp">1.1.1 Tomcat好帮手---JDK&nbsp;&nbsp;</a>
      </li>
    </ul></li>
    
    <li>
      <a href="#12_Tomcat_JDK">1.2 安装Tomcat & JDK</a><ul>
        <li>
          <a href="#121">1.2.1 系统环境说明</a>
        </li>
        <li>
          <a href="#122_nbspJDK">1.2.2 &nbsp;安装JDK</a>
        </li>
        <li>
          <a href="#123_Tomcat">1.2.3 安装Tomcat</a>
        </li>
      </ul>
    </li>
    
    <li>
      <a href="#13_Tomcat">1.3 Tomcat目录介绍</a><ul>
        <li>
          <a href="#131_tomcat">1.3.1 tomcat主目录介绍</a>
        </li>
        <li>
          <a href="#132_webapps">1.3.2 webapps目录介绍</a>
        </li>
        <li>
          <a href="#133_Tomcatconf">1.3.3 Tomcat配置文件目录介绍（conf）</a>
        </li>
      </ul>
    </li>
    
    <li>
      <a href="#14_Tomcat">1.4 Tomcat的管理</a><ul>
        <li>
          <a href="#141">1.4.1 启动完成浏览器进行访问</a>
        </li>
      </ul>
    </li>
    
    <li>
      <a href="#15_Tomcat">1.5 Tomcat日志说明</a><ul>
        <li>
          <a href="#151">1.5.1 查看日志</a>
        </li>
        <li>
          <a href="#152_Tomcat">1.5.2 解决Tomcat启动慢的方法</a>
        </li>
      </ul>
    </li>
    
    <li>
      <a href="#16_Tomcat">1.6 Tomcat管理功能使用</a><ul>
        <li>
          <a href="#161_web">1.6.1 在web界面访问管理界面</a>
        </li>
      </ul>
    </li>
    
    <li>
      <a href="#17_Tomcat">1.7 Tomcat主配置文件详解</a><ul>
        <li>
          <a href="#171_serverxml">1.7.1 server.xml组件类别</a>
        </li>
        <li>
          <a href="#172">1.7.2 组件介绍</a>
        </li>
        <li>
          <a href="#173_serverxml">1.7.3 server.xml配置文件注释</a>
        </li>
        <li>
          <a href="#174_Connector">1.7.4 Connector主要参数说明</a>
        </li>
        <li>
          <a href="#175_host">1.7.5 host参数详解</a>
        </li>
        <li>
          <a href="#176_Context">1.7.6 Context参数说明</a>
        </li>
      </ul>
    </li>
    
    <li>
      <a href="#18_WEB">1.8 WEB站点部署</a><ul>
        <li>
          <a href="#181_warweb">1.8.1 使用war包部署web站点</a>
        </li>
        <li>
          <a href="#182">1.8.2 自定义默认网站目录</a>
        </li>
        <li>
          <a href="#183_jpress">1.8.3 部署开源站点（jpress）</a>
        </li>
      </ul>
    </li>
    
    <li>
      <a href="#19_Tomcat">1.9 Tomcat多实例配置</a><ul>
        <li>
          <a href="#191">1.9.1 复制程序文件</a>
        </li>
        <li>
          <a href="#192">1.9.2 在浏览器访问，进行测试</a>
        </li>
      </ul>
    </li>
    
    <li>
      <a href="#110_tomcat">1.10 tomcat反向代理集群</a><ul>
        <li>
          <a href="#1101">1.10.1 负载均衡器说明</a>
        </li>
        <li>
          <a href="#1102">1.10.2 配置负载均衡器</a>
        </li>
        <li>
          <a href="#1103">1.10.3 使用命令进行访问测试</a>
        </li>
        <li>
          <a href="#1104">1.10.4 在浏览器上进行访问测试</a>
        </li>
      </ul>
    </li>
    
    <li>
      <a href="#111_tomcat">1.11 监控tomcat集群状态</a><ul>
        <li>
          <a href="#1111_java">1.11.1 方法一：开发java监控页面</a>
        </li>
        <li>
          <a href="#1112_jps">1.11.2 方法二：使用jps命令进行监控</a>
        </li>
        <li>
          <a href="#1113_Tomcat">1.11.3 Tomcat远程监控功能</a>
        </li>
        <li>
          <a href="#1114_zabbixtomcat">1.11.4 zabbix监控tomcat程序</a>
        </li>
        <li>
          <a href="#1115_tomcat">1.11.5 排除tomcat故障步骤</a>
        </li>
      </ul>
    </li>
    
    <li>
      <a href="#112_Tomcat">1.12 Tomcat安全优化</a>
    </li>
    <li>
      <a href="#1nbspnbspnbspnbsp_telnet">1.&nbsp;&nbsp;&nbsp;&nbsp; telnet管理端口保护（强制）</a>
    </li>
    <li>
      <a href="#2_ajp">2. ajp连接端口保护（推荐）</a>
    </li>
    <li>
      <a href="#3">3. 禁用管理端（强制）</a>
    </li>
    <li>
      <a href="#4">4. 降权启动（强制）</a>
    </li>
    <li>
      <a href="#5">5.文件列表访问控制（强制）</a>
    </li>
    <li>
      <a href="#6">6. 版本信息隐藏（强制）</a>
    </li>
    <li>
      <a href="#7_Server_header">7. Server header重写（推荐）</a>
    </li>
    <li>
      <a href="#8">8. 访问限制（可选）</a>
    </li>
    <li>
      <a href="#9nbspnbspnbspnbsp">9.&nbsp;&nbsp;&nbsp;&nbsp; 起停脚本权限回收（推荐）</a>
    </li>
    <li>
      <a href="#10nbspnbspnbsp">10.&nbsp;&nbsp;&nbsp; 访问日志格式规范（推荐）</a>
    </li>
    <li>
      <a href="#11nbspnbspnbsp">11.&nbsp;&nbsp;&nbsp; 附录：建议配置及标准执行方案</a>
    </li>
    <li>
      <a href="#113_Tomcat">1.13 Tomcat性能优化</a>
    </li>
  </ul>
</div>