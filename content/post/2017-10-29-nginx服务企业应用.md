---
title: nginx服务企业应用
author: 惨绿少年
type: post
date: 2017-10-29T01:55:00+00:00
url: /clsn/lx892.html
Baidusubmit:
  - 1
views:
  - 208
specs_zan:
  - 2
categories:
  - Linux运维
  - Web应用
  - 运维基本功

---
<img data-original="/wp-content/uploads/2018/03/nginx-300x61.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="nginx服务企业应用" alt="" />

<h2 style="margin-top: 8.15pt; margin-right: 0cm; margin-bottom: 8.15pt; margin-left: 25.1pt; mso-list: l14 level2 lfo4;">
  <span id="11"><a name="_Toc496797994"></a><a name="_Toc496384583"></a><!--[if !supportLists]-->
  
  <span lang="EN-US">1.1 </span><!--[endif]-->
  
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">常用来提供<span style="text-decoration: underline;"><span style="background: yellow; mso-highlight: yellow;">静态服务</span></span>的软件</span></span>
</h2>

<p class="MsoListParagraph" style="margin-left: 28.1pt; text-indent: -21.0pt; mso-list: l7 level1 lfo10;">
  <span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;" lang="EN-US"><span style="font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span><!--[endif]-->
  
  <span lang="EN-US">Apache :</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">这是中小型</span><span lang="EN-US">Web</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">服务的主流，</span><span lang="EN-US">Web</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">服务器中的老大哥，</span>
</p>

<p class="MsoListParagraph" style="margin-left: 28.1pt; text-indent: -21.0pt; mso-list: l7 level1 lfo10;">
  <span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;" lang="EN-US"><span style="font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span><!--[endif]-->
  
  <span lang="EN-US">Nginx :</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">大型网站</span><span lang="EN-US">Web</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">服务的主流，曾经</span><span lang="EN-US">Web</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">服务器中的初生牛犊，现已长大。</span>
</p>

<p class="MsoListParagraph" style="margin-left: 28.1pt; text-indent: -21.0pt; mso-list: l7 level1 lfo10;">
  <span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;" lang="EN-US"><span style="font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span><!--[endif]-->
  
  <span lang="EN-US">Nginx </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">的分支</span><span lang="EN-US"> Tengine ( http://tengine.taobao.org/)</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">目前也在飞速发展•</span>
</p>

<p class="MsoListParagraph" style="margin-left: 28.1pt; text-indent: -21.0pt; mso-list: l7 level1 lfo10;">
  <span lang="EN-US">Lighttpd :</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">这是一个不溫不火的优秀</span><span lang="EN-US"> Web</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">软件，社区不活跃，静态解析效率很高</span><span lang="EN-US">.</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">在</span><span lang="EN-US"> Nginx </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">流行前，它是大并发静态业务的首选，国内百度贴吧、豆瓣等众多网站都有</span><span lang="EN-US">Lighttpd</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">奋斗的身彩</span><span lang="EN-US">"   </span>
</p>

<h2 style="margin-top: 8.15pt; margin-right: 0cm; margin-bottom: 8.15pt; margin-left: 25.1pt; mso-list: l14 level2 lfo4;">
  <span id="12"><a name="_Toc496797995"></a><a name="_Toc496384584"></a><!--[if !supportLists]-->
  
  <span lang="EN-US">1.2 </span><!--[endif]-->
  
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">常用来提供<span style="background: yellow; mso-highlight: yellow;">动态服务</span>的软件</span></span>
</h2>

> * PHP ( FastCGI ):大中小型网站都会使用，动态网页语言PHP程序的解析容器。它可配合Apache解析动态程序，不过，这里的PHP不是FastCGI守护进程横式，而是mod_php5.so ( module）也可配合Nginx解析动态程序，此时的PHP常用FastCGI守护进程模式提供服务。  
> * Tomcat :中小企业动态Web服务主流，互联网Java容器主流（如jsp、do ）  
> * Resin :大型动态Web服务主流，互联网Java容器主流（如jsp、do ）  
> * IIS ( Internet information services ):微软 windows 下的 Web 服务软件（如 asp、aspx ）

# <span id="2_nginx"><a name="_Toc496797996"></a><!--[if !supportLists]-->

<span lang="EN-US">第2章 </span><!--[endif]-->

<span lang="EN-US">nginx </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">软件</span></span>

<h2 style="margin-top: 8.15pt; margin-right: 0cm; margin-bottom: 8.15pt; margin-left: 25.1pt; mso-list: l14 level2 lfo4;">
  <span id="21"><a name="_Toc496797997"></a><a name="_Toc496384586"></a><!--[if !supportLists]-->
  
  <span lang="EN-US">2.1 </span><!--[endif]-->
  
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">软件介绍</span></span>
</h2>

<p class="MsoNormal" style="text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">如果你听说或使用过</span><span lang="EN-US"> Apache</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">软件，那么很快就会熟悉</span><span lang="EN-US"> Nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">软件，与</span><span lang="EN-US"> Apache</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">软件类似，</span><span lang="EN-US"> Nginx ( </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">“</span><span lang="EN-US">engme x")</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">是一个开源的，支持高性能、高并发的</span><span lang="EN-US"> WWW</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">服务器和代理服务软件。它是由俄罗斯人</span><span lang="EN-US"> Igor Sysoev</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">开发的，最初被应用在勘罗斯的大型网站</span><span lang="EN-US"> www.rambler.ru </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">上</span><span lang="EN-US">,</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">后来作者将源代码以类</span><span lang="EN-US">BSD</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">许可证的形式开源出来供全球使用。</span>
</p>

<p class="MsoNormal" style="text-indent: 21.0pt;">
  <span lang="EN-US">Nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">因具有高并发（特别是静态资源）占用系统资源少等特性，且功能丰富而逐渐流行起来。</span>
</p>

<p class="MsoNormal" style="text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">在功能应用发面，</span><span lang="EN-US">Nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">不但是一个优秀的</span><span lang="EN-US">Web</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">服务软件，还具有反向代理负载均衡功能和缓存服务功能。在反向代理负载均衡功能方面，它类似于大名鼎鼎的</span><span lang="EN-US">LVS</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">负载均衡及</span><span lang="EN-US">Haproxy</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">等专业代理软件，但是</span><span lang="EN-US">Nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">部署起来更为简单、方便；在缓存服务功能方面，它又类似于</span><span lang="EN-US">Squid</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">等专业的缓存服务软件。</span>
</p>

<p class="MsoNormal" style="text-indent: 21.0pt;">
  <span lang="EN-US">Nginx </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">可以运行在</span><span lang="EN-US"> UNIX</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">、</span><span lang="EN-US">Linux</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">、</span><span lang="EN-US">BSD</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">、</span><span lang="EN-US">Mac 0S X</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">、</span><span lang="EN-US">Solaris,</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">以及</span><span lang="EN-US"> Microsoft Windows </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">等操作系统中。随着</span><span lang="EN-US">Nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">在国内很多大型网站中的稳定高效运行，近两年它也逐渐被越来越多的中小型网站所使用。当前流行的</span><span lang="EN-US">Nginx Web</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">组合被称为</span><span lang="EN-US">LNMP</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">或</span><span lang="EN-US">LEMP(</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">即</span><span lang="EN-US">Linux Nginx MySQL PHP),</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">其中</span><span lang="EN-US"> LNMP </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">里的</span><span lang="EN-US"> N </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">取自</span><span lang="EN-US">Nginx ( "engine x" ) </span>
</p>

<p class="MsoNormal" style="text-indent: 21.0pt;">
  <span lang="EN-US">Nginx </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">的官方介绍见</span> <span class="ad"><span style="font-size: 10.5pt; mso-bidi-font-size: 11.0pt; mso-bidi-font-family: 'Times New Roman';" lang="EN-US">http://nginx.org/en</span></span>
</p>

<h2 style="margin-top: 8.15pt; margin-right: 0cm; margin-bottom: 8.15pt; margin-left: 25.1pt; mso-list: l14 level2 lfo4;">
  <span id="22_NGINX"><a name="_Toc496797998"></a><a name="_Toc496384587"></a><!--[if !supportLists]-->
  
  <span lang="EN-US">2.2 </span><!--[endif]-->
  
  <span lang="EN-US">NGINX </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">软件特性</span></span>
</h2>

### <span id="221_HTTP"><a name="_Toc496797999"></a><!--[if !supportLists]-->

<span lang="EN-US">2.2.1 </span><!--[endif]-->

<span lang="EN-US">HTTP</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">服务器的特色及<span style="background: yellow; mso-highlight: yellow;">优点</span>：</span></span>

<p class="MsoListParagraph" style="margin-left: 42.0pt; text-indent: -21.0pt; mso-list: l11 level1 lfo12;">
  <!--[if !supportLists]-->
  
  <span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;" lang="EN-US">u<span style="font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span><!--[endif]-->
  
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">支持高并发：能支持几万并发连接（特别是静态小文件业务环境）</span>
</p>

<p class="MsoListParagraph" style="margin-left: 42.0pt; text-indent: -21.0pt; mso-list: l11 level1 lfo12;">
  <!--[if !supportLists]-->
  
  <span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;" lang="EN-US">u<span style="font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span><!--[endif]-->
  
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">资源消耗少：在</span><span lang="EN-US">3</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">万并发连接下，开启</span><span lang="EN-US">10</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">个</span><span lang="EN-US">Nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">线程消耗的内存不到</span><span lang="EN-US">200MB</span>
</p>

<p class="MsoListParagraph" style="margin-left: 42.0pt; text-indent: -21.0pt; mso-list: l11 level1 lfo12;">
  <!--[if !supportLists]-->
  
  <span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;" lang="EN-US">u<span style="font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span><!--[endif]-->
  
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">可以做</span><span lang="EN-US">HTTP</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">反向代理及加速<span style="background: yellow; mso-highlight: yellow;">缓存</span>、即<span style="background: yellow; mso-highlight: yellow;">负载均衡</span>功能，内置对</span><span lang="EN-US">RS</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">节点服务器健康检查功能，这相当于专业的</span><span lang="EN-US">Haproxy</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">软件或</span><span style="background: yellow; mso-highlight: yellow;" lang="EN-US">LV</span><span lang="EN-US">S</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">的功能。</span>
</p>

<p class="MsoListParagraph" style="margin-left: 42.0pt; text-indent: -21.0pt; mso-list: l11 level1 lfo12;">
  <!--[if !supportLists]-->
  
  <span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;" lang="EN-US">u<span style="font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span><!--[endif]-->
  
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">具备</span><span lang="EN-US">Squid</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">等专业缓存软件等的缓存功能。</span>
</p>

<p class="MsoListParagraph" style="margin-left: 42.0pt; text-indent: -21.0pt; mso-list: l11 level1 lfo12;">
  <!--[if !supportLists]-->
  
  <span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;" lang="EN-US">u<span style="font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span><!--[endif]-->
  
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">支持异步网络</span><span lang="EN-US">I/O</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">事件横型</span><span lang="EN-US">epoll(Linux2.6+)</span>
</p>

### <span id="222_nginx"><a name="_Toc496798000"></a><!--[if !supportLists]-->

<span lang="EN-US">2.2.2 </span><!--[endif]-->

<span lang="EN-US">nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">功能特性</span></span>

<p class="MsoListParagraph" style="margin-left: 45.0pt; text-indent: -21.0pt; mso-list: l4 level1 lfo13;">
  <!--[if !supportLists]-->
  
  <span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;" lang="EN-US">Ø<span style="font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span><!--[endif]-->
  
  <span lang="EN-US">web</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">网站服务</span>
</p>

<p class="MsoListParagraph" style="margin-left: 45.0pt; text-indent: -21.0pt; mso-list: l4 level1 lfo13;">
  <!--[if !supportLists]-->
  
  <span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;" lang="EN-US">Ø<span style="font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span><!--[endif]-->
  
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">反向代理负载均衡</span><span lang="EN-US">(nginx /lvs /haproxy)</span>
</p>

<p class="MsoListParagraph" style="margin-left: 45.0pt; text-indent: -21.0pt; mso-list: l4 level1 lfo13;">
  <!--[if !supportLists]-->
  
  <span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;" lang="EN-US">Ø<span style="font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span><!--[endif]-->
  
  <span lang="EN-US">nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">缓存服务（</span><span lang="EN-US">memcache /redis /mongodb</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">）</span>
</p>

<h2 style="margin-top: 8.15pt; margin-right: 0cm; margin-bottom: 8.15pt; margin-left: 25.1pt; mso-list: l14 level2 lfo4;">
  <span id="23_nginx"><a name="_Toc496798001"></a><!--[if !supportLists]-->
  
  <span lang="EN-US">2.3 </span><!--[endif]-->
  
  <span lang="EN-US">nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">软件的企业功能应用</span></span>
</h2>

<table class="MsoTable15Grid4Accent3" style="border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
  <tr>
    <td style="width: 84.8pt; border-top-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-top-color: #9bbb59; border-bottom-color: #9bbb59; border-left-color: #9bbb59; border-right: none; background: #9bbb59; padding: 0cm 5.4pt;" width="113">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph; mso-yfti-cnfc: 5;">
        <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; color: white; mso-themecolor: background1;">业务类型</span></strong>
      </p>
    </td>
    
    <td style="width: 438pt; border-top-width: 1pt; border-right-width: 1pt; border-bottom-width: 1pt; border-top-color: #9bbb59; border-right-color: #9bbb59; border-bottom-color: #9bbb59; border-left: none; background: #9bbb59; padding: 0cm 5.4pt;" width="584">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph; mso-yfti-cnfc: 1;">
        <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; color: white; mso-themecolor: background1;">应用方案</span></strong>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 84.8pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: #c2d69b; border-bottom-color: #c2d69b; border-left-color: #c2d69b; border-top: none; background: #eaf1dd; padding: 0cm 5.4pt;" width="113">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph; mso-yfti-cnfc: 68;">
        <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">静态业务</span></strong>
      </p>
    </td>
    
    <td style="width: 438pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: #c2d69b; border-right-width: 1pt; border-right-color: #c2d69b; background: #eaf1dd; padding: 0cm 5.4pt;" width="584">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph; mso-yfti-cnfc: 64;">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">若是高并发场景，尽量采用</span><span lang="EN-US">Nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">或</span><span lang="EN-US">Lighttpd</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">，二者首选</span><span lang="EN-US">Nginx</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 84.8pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: #c2d69b; border-bottom-color: #c2d69b; border-left-color: #c2d69b; border-top: none; padding: 0cm 5.4pt;" width="113">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph; mso-yfti-cnfc: 4;">
        <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">动态业务</span></strong>
      </p>
    </td>
    
    <td style="width: 438pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: #c2d69b; border-right-width: 1pt; border-right-color: #c2d69b; padding: 0cm 5.4pt;" width="584">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">理论上采用</span><span lang="EN-US">Nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">和</span><span lang="EN-US">Apache</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">均可，建议选择</span><span lang="EN-US">Nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">，为了避免相同业务的服务软件多样化，增加额外维护成本。动态业务可以由</span><span lang="EN-US">Nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">兼做前端代理，再根据页面元素的类型或目录，转发到后端相应的服务器处理进程。</span>
      </p>
      
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
        <span style="background: lime; mso-highlight: lime;" lang="EN-US">---</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; background: lime; mso-highlight: lime;">首选</span><span style="background: lime; mso-highlight: lime;" lang="EN-US">tomcat</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 84.8pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: #c2d69b; border-bottom-color: #c2d69b; border-left-color: #c2d69b; border-top: none; background: #eaf1dd; padding: 0cm 5.4pt;" width="113">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph; mso-yfti-cnfc: 68;">
        <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">既有静态业务又有动态业务</span></strong>
      </p>
    </td>
    
    <td style="width: 438pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: #c2d69b; border-right-width: 1pt; border-right-color: #c2d69b; background: #eaf1dd; padding: 0cm 5.4pt;" width="584">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph; text-indent: 24.0pt; mso-char-indent-count: 2.0; mso-yfti-cnfc: 64;">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">采用</span><span lang="EN-US">Nginx</span>
      </p>
      
      <p class="MsoNormal" style="text-indent: 21.0pt; mso-yfti-cnfc: 64;">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">利用</span><span lang="EN-US">nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">软件是无法处理动态业务请求，要让</span><span lang="EN-US">nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">结合</span><span lang="EN-US">php</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">软件处理动态业务请求，在加上</span><span lang="EN-US">mysql </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">即</span> <strong><span lang="EN-US">LNMP</span></strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">架构</span>
      </p>
    </td>
  </tr>
</table>

<h2 style="margin-top: 8.15pt; margin-right: 0cm; margin-bottom: 8.15pt; margin-left: 25.1pt; mso-list: l14 level2 lfo4;">
  <span id="24_nginx"><a name="_Toc496798002"></a><!--[if !supportLists]-->
  
  <span lang="EN-US">2.4 </span><!--[endif]-->
  
  <span lang="EN-US">nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">软件的动态访问瓶颈</span></span>
</h2>

### <span id="241"><a name="_Toc496798003"></a><a name="_Toc496384590"></a><!--[if !supportLists]-->

<span lang="EN-US">2.4.1 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">与其他软件的对比</span></span>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">先来看看</span><strong><span style="background: lime; mso-highlight: lime;" lang="EN-US">Apache</span></strong><strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; background: lime; mso-highlight: lime;">软件的特点</span></strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">，如下</span>
</p>

<p class="MsoListParagraph" style="margin-left: 63.0pt; text-indent: -21.0pt; mso-list: l13 level1 lfo14;">
  <!--[if !supportLists]-->
  
  <span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;" lang="EN-US">²<span style="font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span><!--[endif]-->
  
  <span lang="EN-US">Apache2.2</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">版本非常稳定强大，据官方说，</span><span lang="EN-US">Apache2.4</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">版本性能更强。</span>
</p>

<p class="MsoListParagraph" style="margin-left: 63.0pt; text-indent: -21.0pt; mso-list: l13 level1 lfo14;">
  <!--[if !supportLists]-->
  
  <span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;" lang="EN-US">²<span style="font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span><!--[endif]-->
  
  <span lang="EN-US">Prefork</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">模式取消了进程创建开销，性能很高。</span>
</p>

<p class="MsoListParagraph" style="margin-left: 63.0pt; text-indent: -21.0pt; mso-list: l13 level1 lfo14;">
  <!--[if !supportLists]-->
  
  <span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;" lang="EN-US">²<span style="font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span><!--[endif]-->
  
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">处理动态业务数据时，因关联到后端的引擎和数据库，瓶颈不在</span><span lang="EN-US">Apache</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">上。</span>
</p>

<p class="MsoListParagraph" style="margin-left: 63.0pt; text-indent: -21.0pt; mso-list: l13 level1 lfo14;">
  <!--[if !supportLists]-->
  
  <span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;" lang="EN-US">²<span style="font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span><!--[endif]-->
  
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">高并发时消耗系统资源相对多一些。</span>
</p>

<p class="MsoListParagraph" style="margin-left: 63.0pt; text-indent: -21.0pt; mso-list: l13 level1 lfo14;">
  <!--[if !supportLists]-->
  
  <span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;" lang="EN-US">²<span style="font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span><!--[endif]-->
  
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">基于传统的</span><span lang="EN-US">select</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">模型，高并发能力有限。</span>
</p>

<p class="MsoListParagraph" style="margin-left: 63.0pt; text-indent: -21.0pt; mso-list: l13 level1 lfo14;">
  <!--[if !supportLists]-->
  
  <span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;" lang="EN-US">²<span style="font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span><!--[endif]-->
  
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">支持扩展库，可通过</span><span lang="EN-US">DSO</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">、</span><span lang="EN-US">apxs</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">方法编译安装额外的插件功能，不需要重新编译</span><span lang="EN-US">Apache</span>
</p>

<p class="MsoListParagraph" style="margin-left: 63.0pt; text-indent: -21.0pt; mso-list: l13 level1 lfo14;">
  <!--[if !supportLists]-->
  
  <span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;" lang="EN-US">²<span style="font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span><!--[endif]-->
  
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">功能多，更稳定，更安全，插件也多。</span>
</p>

<p class="MsoListParagraph" style="margin-left: 63.0pt; text-indent: -21.0pt; mso-list: l13 level1 lfo14;">
  <!--[if !supportLists]-->
  
  <span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;" lang="EN-US">²<span style="font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span><!--[endif]-->
  
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">市场份额在逐年递减</span>
</p>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">再来看看</span><strong><span style="background: lime; mso-highlight: lime;" lang="EN-US">Nginx</span></strong><strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; background: lime; mso-highlight: lime;">软件</span></strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">的特点，如下：</span>
</p>

<p class="MsoListParagraph" style="margin-left: 63.0pt; text-indent: -21.0pt; mso-list: l0 level1 lfo15;">
  <!--[if !supportLists]-->
  
  <span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;" lang="EN-US">n<span style="font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span><!--[endif]-->
  
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">基于异步网结</span><span lang="EN-US">I/O</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">模</span> <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">型（</span><span lang="EN-US">epollk kqueue</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">）</span>
</p>

<p class="MsoListParagraph" style="margin-left: 63.0pt; text-indent: -21.0pt; mso-list: l0 level1 lfo15;">
  <!--[if !supportLists]-->
  
  <span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;" lang="EN-US">n<span style="font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span><!--[endif]-->
  
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">具备支持高性能，高并发的特性，并发连接可达数万。</span>
</p>

<p class="MsoListParagraph" style="margin-left: 63.0pt; text-indent: -21.0pt; mso-list: l0 level1 lfo15;">
  <!--[if !supportLists]-->
  
  <span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;" lang="EN-US">n<span style="font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span><!--[endif]-->
  
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">对小文件（小于</span><span lang="EN-US">1 MB</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">的静态文件）高并发支持很好，性能很高</span>
</p>

<p class="MsoListParagraph" style="margin-left: 63.0pt; text-indent: -21.0pt; mso-list: l0 level1 lfo15;">
  <!--[if !supportLists]-->
  
  <span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;" lang="EN-US">n<span style="font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span><!--[endif]-->
  
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">不支持类似</span><span lang="EN-US"> Apache</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">的</span><span lang="EN-US">DSO</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">模式、扩展库必须编译进主程序（缺点）</span>
</p>

<p class="MsoListParagraph" style="margin-left: 63.0pt; text-indent: -21.0pt; mso-list: l0 level1 lfo15;">
  <!--[if !supportLists]-->
  
  <span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;" lang="EN-US">n<span style="font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span><!--[endif]-->
  
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">进程占用系统资源比较低。</span>
</p>

<p class="MsoListParagraph" style="margin-left: 63.0pt; text-indent: -21.0pt; mso-list: l0 level1 lfo15;">
  <!--[if !supportLists]-->
  
  <span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;" lang="EN-US">n<span style="font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span><!--[endif]-->
  
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">支持</span><span lang="EN-US">Web</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">、反向</span><span lang="EN-US">Proxy</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">、</span><span lang="EN-US">Cache</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">三大重点功能，幷且都很优秀。</span>
</p>

<p class="MsoListParagraph" style="margin-left: 63.0pt; text-indent: -21.0pt; mso-list: l0 level1 lfo15;">
  <!--[if !supportLists]-->
  
  <span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;" lang="EN-US">n<span style="font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span><!--[endif]-->
  
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">市场份额在逐年快速增加。</span>
</p>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">最后是</span><strong><span style="background: lime; mso-highlight: lime;" lang="EN-US">Lighttpd</span></strong><strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; background: lime; mso-highlight: lime;">的特点</span></strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">，如下：</span>
</p>

<p class="MsoListParagraph" style="margin-left: 63.0pt; text-indent: -21.0pt; mso-list: l1 level1 lfo16;">
  <!--[if !supportLists]-->
  
  <span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;" lang="EN-US">²<span style="font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span><!--[endif]-->
  
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">基于异步网络</span><span lang="EN-US"> I/ O</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">模型，性能、并发都与</span><span lang="EN-US"> Nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">相近。</span>
</p>

<p class="MsoListParagraph" style="margin-left: 63.0pt; text-indent: -21.0pt; mso-list: l1 level1 lfo16;">
  <!--[if !supportLists]-->
  
  <span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;" lang="EN-US">²<span style="font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span><!--[endif]-->
  
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">扩展库是</span><span lang="EN-US"> SO</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">模式，比</span><span lang="EN-US">Nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">灵活</span>
</p>

<p class="MsoListParagraph" style="margin-left: 63.0pt; text-indent: -21.0pt; mso-list: l1 level1 lfo16;">
  <!--[if !supportLists]-->
  
  <span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;" lang="EN-US">²<span style="font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span><!--[endif]-->
  
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">目前国内的使用率比较低，安全性没有</span><span lang="EN-US"> Apache</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">和</span><span lang="EN-US">Nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">好。</span>
</p>

<p class="MsoListParagraph" style="margin-left: 63.0pt; text-indent: -21.0pt; mso-list: l1 level1 lfo16;">
  <!--[if !supportLists]-->
  
  <span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;" lang="EN-US">²<span style="font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span><!--[endif]-->
  
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">通过插件</span><span lang="EN-US">(mod_secdownload)</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">可实现文件</span><span lang="EN-US"> URL</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">地址加密（优点）</span>
</p>

<p class="MsoListParagraph" style="margin-left: 63.0pt; text-indent: -21.0pt; mso-list: l1 level1 lfo16;">
  <!--[if !supportLists]-->
  
  <span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;" lang="EN-US">²<span style="font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span><!--[endif]-->
  
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">社区不活跃，市场份额较低，</span>
</p>

### <span id="242_select_epoll"><a name="_Toc496798004"></a><a name="_Toc496384591"></a><!--[if !supportLists]-->

<span lang="EN-US">2.4.2 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">最主要的区别</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">（</span><span lang="EN-US">select & epoll</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">）</span></span>

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">NGINX 使用的是epoll 和Kqueue 异步网络I/O模型，而apache使用的是传统的select模型</span>

<p class="MsoNormal">
  <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">比喻：</span></strong>
</p>

> <p class="MsoNormal">
>    第一个比喻：
> </p>
> 
> <p class="MsoNormal">
>    假设你在大学读书，住的宿舍楼有很多房间，你的朋友要来找你。select版宿管大妈就会带着你的朋友到各房间挨个去找，直到找到你为止。而epoll版宿管大妈会先记下每位入住同学的房间号，你的朋友来找你时，只需告诉你的朋友你住在哪个房间即可，不用亲自带着你的朋友满宿舍楼找人了。如果同时来了100个人，都要找自己住这栋楼的同学，select版和epoll版宿管大妈,谁的效率更高，就很明显了。
> </p>

<p class="MsoNormal" style="text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">第二个比喻：</span>
</p>

> <p class="MsoNormal" style="text-indent: 21pt; margin-left: 30px;">
>   <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">select的调用复杂度是线性的，即O(n)。举个例子，一个保姆照看照看一群孩子，如果把孩子是否需要尿尿比作网络I/O事件，select的作用就好比这个保姆挨个询问每个孩子"你要尿尿吗？”如果孩子回答是，保姆则把孩子领出来放到另外一个地方。当所有孩子询问完之后，保姆领着这些要尿尿的孩子去上厕所（处理网络I/O事件).在epoll机制下，保姆不再需要挨个询问每个孩子是否需要尿尿。取而代之的是，如果孩子需要尿尿，他就自己主动站到事先约定好的地方，而保姆的职责就是查看事先约定好的地方是否有孩子。如果有小孩，则领着孩子去上厕所（网络事件处理)。因此，epoll的这种机制，能够高效地处理成千上万的并发连接，并且性能不会随着连接数増加而下降太多。</span>
> </p>

### <span id="243_apache_selectnginx_epoll"><a name="_Toc496798005"></a><a name="_Toc496384592"></a><!--[if !supportLists]-->

<span lang="EN-US">2.4.3 </span><!--[endif]-->

<span lang="EN-US">apache select</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">和</span><span lang="EN-US">nginx epoll</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">技术对比图</span></span>

<table class="MsoTable15Grid4Accent5" style="border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
  <tr>
    <td style="width: 99pt; border-top-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-top-color: #4bacc6; border-bottom-color: #4bacc6; border-left-color: #4bacc6; border-right: none; background: #4bacc6; padding: 0cm 5.4pt;" valign="top" width="132">
      <p class="MsoNormal">
        <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; color: white; mso-themecolor: background1;">指标</span></strong>
      </p>
    </td>
    
    <td style="width: 219.7pt; border-top-width: 1pt; border-top-color: #4bacc6; border-left: none; border-bottom-width: 1pt; border-bottom-color: #4bacc6; border-right: none; background: #4bacc6; padding: 0cm 5.4pt;" valign="top" width="293">
      <p class="MsoNormal">
        <strong><span style="color: white; mso-themecolor: background1;" lang="EN-US">select</span></strong>
      </p>
    </td>
    
    <td style="width: 204.1pt; border-top-width: 1pt; border-right-width: 1pt; border-bottom-width: 1pt; border-top-color: #4bacc6; border-right-color: #4bacc6; border-bottom-color: #4bacc6; border-left: none; background: #4bacc6; padding: 0cm 5.4pt;" valign="top" width="272">
      <p class="MsoNormal">
        <strong><span style="color: white; mso-themecolor: background1;" lang="EN-US">epoll</span></strong>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 99pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: #92cddc; border-bottom-color: #92cddc; border-left-color: #92cddc; border-top: none; background: #daeef3; padding: 0cm 5.4pt;" valign="top" width="132">
      <p class="MsoNormal">
        <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">性能</span></strong>
      </p>
    </td>
    
    <td style="width: 219.7pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: #92cddc; border-right-width: 1pt; border-right-color: #92cddc; background: #daeef3; padding: 0cm 5.4pt;" valign="top" width="293">
      <p class="MsoNormal">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">随着连接数的增加性能急剧下降。处理成千上万的并发连接数，性能很差</span>
      </p>
    </td>
    
    <td style="width: 204.1pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: #92cddc; border-right-width: 1pt; border-right-color: #92cddc; background: #daeef3; padding: 0cm 5.4pt;" valign="top" width="272">
      <p class="MsoNormal">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">随着连接数的增加，性能基本上没有下降。处理成千上万连接时性能很好</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 99pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: #92cddc; border-bottom-color: #92cddc; border-left-color: #92cddc; border-top: none; padding: 0cm 5.4pt;" valign="top" width="132">
      <p class="MsoNormal">
        <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">连接数</span></strong>
      </p>
    </td>
    
    <td style="width: 219.7pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: #92cddc; border-right-width: 1pt; border-right-color: #92cddc; padding: 0cm 5.4pt;" valign="top" width="293">
      <p class="MsoNormal">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">连接数有限制，处理的最大连接数不超过</span><span lang="EN-US">1024</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">，如果要处理的连接数超过</span><span lang="EN-US">1024</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">个，则需要修改</span><span lang="EN-US">FD_SETSIZE</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">宏，并重新编译</span>
      </p>
    </td>
    
    <td style="width: 204.1pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: #92cddc; border-right-width: 1pt; border-right-color: #92cddc; padding: 0cm 5.4pt;" valign="top" width="272">
      <p class="MsoNormal">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">连接数无限制</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 99pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: #92cddc; border-bottom-color: #92cddc; border-left-color: #92cddc; border-top: none; background: #daeef3; padding: 0cm 5.4pt;" valign="top" width="132">
      <p class="MsoNormal">
        <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">内在处理机制</span></strong>
      </p>
    </td>
    
    <td style="width: 219.7pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: #92cddc; border-right-width: 1pt; border-right-color: #92cddc; background: #daeef3; padding: 0cm 5.4pt;" valign="top" width="293">
      <p class="MsoNormal">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">线性轮询</span>
      </p>
    </td>
    
    <td style="width: 204.1pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: #92cddc; border-right-width: 1pt; border-right-color: #92cddc; background: #daeef3; padding: 0cm 5.4pt;" valign="top" width="272">
      <p class="MsoNormal">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">回调</span><span lang="EN-US">callback</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 99pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: #92cddc; border-bottom-color: #92cddc; border-left-color: #92cddc; border-top: none; padding: 0cm 5.4pt;" valign="top" width="132">
      <p class="MsoNormal">
        <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">开发复杂性</span></strong>
      </p>
    </td>
    
    <td style="width: 219.7pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: #92cddc; border-right-width: 1pt; border-right-color: #92cddc; padding: 0cm 5.4pt;" valign="top" width="293">
      <p class="MsoNormal">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">低</span>
      </p>
    </td>
    
    <td style="width: 204.1pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: #92cddc; border-right-width: 1pt; border-right-color: #92cddc; padding: 0cm 5.4pt;" valign="top" width="272">
      <p class="MsoNormal">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">中</span>
      </p>
    </td>
  </tr>
</table>

# <span id="3_nginx"><a name="_Toc496798006"></a><a name="_Toc496384594"></a><!--[if !supportLists]-->

<span lang="EN-US">第3章 </span><!--[endif]-->

<span lang="EN-US">nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">的安装</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">与使用</span></span>

<h2 style="margin-top: 8.15pt; margin-right: 0cm; margin-bottom: 8.15pt; margin-left: 25.1pt; mso-list: l14 level2 lfo4;">
  <span id="31_nginx"><a name="_Toc496798007"></a><a name="_Toc496384595"></a><!--[if !supportLists]-->
  
  <span lang="EN-US">3.1 </span><!--[endif]-->
  
  <span lang="EN-US">nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">软件的编译安装步骤</span></span>
</h2>

### <span id="311"><a name="_Toc496798008"></a><a name="_Toc496384596"></a><!--[if !supportLists]-->

<span lang="EN-US">3.1.1 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">检查软件安装的系统环境</span></span>

<div class="cnblogs_code">
  <pre>[root@web01 ~]<span style="color: #008000;">#</span><span style="color: #008000;"> cat /etc/redhat-release</span>
CentOS release 6.9<span style="color: #000000;"> (Final)
[root@web01 </span>~]<span style="color: #008000;">#</span><span style="color: #008000;"> uname -r</span>
2.6.32-696.el6.x86_64</pre>
</div>

### <span id="312_nginxpcre-devel_openssl-devel"><a name="_Toc496798009"></a><a name="_Toc496384597"></a><!--[if !supportLists]-->

<span lang="EN-US">3.1.2 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">安装</span><span lang="EN-US">nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">的依赖包（</span><span lang="EN-US">pcre-devel openssl-devel</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">）</span></span>

<div class="cnblogs_code">
  <pre>yum install -y pcre-devel openssl-devel</pre>
</div>

<div style="mso-element: para-border-div; border: solid windowtext 2.0pt; padding: 1.0pt 4.0pt 1.0pt 4.0pt; mso-border-shadow: yes; background: #F2F2F2; mso-shading: windowtext; mso-pattern: gray-5 auto; margin-left: 35.4pt; margin-right: 76.7pt;">
  <p class="a3" style="margin: 1pt 0cm; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">
    <span lang="EN-US">pcre</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">：兼容</span><span lang="EN-US">perl</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">语言正则表达式，</span><span lang="EN-US">perl compatible regular expressions</span>
  </p>
  
  <p class="a3" style="margin: 1pt 0cm; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">
    <span lang="EN-US">      rewirte</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">模块</span> <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">参数信息（</span><span lang="EN-US">perl</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">方式定义正则表达式）</span>
  </p>
  
  <p class="a3" style="margin: 1pt 0cm; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">
    <span lang="EN-US">openssl</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">：</span><span lang="EN-US">ssh---openssh/openssl---https</span>
  </p>
  
  <p class="a3" style="margin: 1pt 0cm; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">
    <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体; color: #00b050;">总结：所有安装依赖软件，后面都要加上</span><span style="color: #00b050;" lang="EN-US">-devel</span></strong>
  </p>
</div>

### <span id="313_nginx"><a name="_Toc496798010"></a><a name="_Toc496384598"></a><!--[if !supportLists]-->

<span lang="EN-US">3.1.3 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">下载</span><span lang="EN-US">nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">软件</span></span>

<div class="cnblogs_code">
  <pre>wget http://nginx.org/download/nginx-1.10.2.tar.gz</pre>
</div>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">说明：软件很小，用心查看一下</span>
</p>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">解压软件</span>
</p>

<div class="cnblogs_code">
  <pre>tar xf nginx-1.10.2.tar.gz</pre>
</div>

### <span id="314_www"><a name="_Toc496798011"></a><a name="_Toc496384599"></a><!--[if !supportLists]-->

<span lang="EN-US">3.1.4 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">创建管理用户</span><span lang="EN-US"> www</span></span>

<div class="cnblogs_code">
  <pre>useradd -M -s /sbin/nologin www</pre>
</div>

### <span id="315_nginx"><!--[if !supportLists]-->

<span lang="EN-US">3.1.5 </span><!--[endif]-->

<span lang="EN-US"> <a name="_Toc496798012"></a><a name="_Toc496384600"></a>nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">软件编译安装过程</span></span>

#### <span id="3151"><!--[if !supportLists]-->

<strong><span style="mso-fareast-font-family: 'Courier New'; mso-bidi-font-family: 'Courier New'; color: red;" lang="EN-US">3.1.5.1<span style="font-variant-numeric: normal; font-weight: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span></strong><!--[endif]-->

<strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; color: red;">注意</span></strong></span>

<div style="mso-element: para-border-div; border: solid windowtext 2.0pt; padding: 1.0pt 4.0pt 1.0pt 4.0pt; mso-border-shadow: yes; background: #F2F2F2; mso-shading: windowtext; mso-pattern: gray-5 auto; margin-left: 35.4pt; margin-right: 55.45pt;">
  <p class="a3" style="margin: 1pt 0cm; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">
    <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">软件编译安装步骤</span>
  </p>
  
  <p class="a3" style="margin: 1pt 0cm; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">
    <span lang="EN-US"> a></span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">软件解压配置（将软件程序安装到哪个目录中</span> <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">开启</span><span lang="EN-US">nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">软件的哪些功能）</span>
  </p>
  
  <p class="a3" style="margin: 1pt 0cm; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">
    <span lang="EN-US"> b></span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">软件编译过程</span>
  </p>
  
  <p class="a3" style="margin: 1pt 0cm; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">
    <span lang="EN-US"> c></span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">软件编译安装过程</span>
  </p>
</div>

<p class="MsoNormal">
  <span lang="EN-US">   </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; background: lime; mso-highlight: lime;">注意顺序，顺序不对软件安装会出错</span>
</p>

#### <span id="3152"><!--[if !supportLists]-->

<strong><span lang="EN-US">3.1.5.2<span style="font-variant-numeric: normal; font-weight: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span></strong><!--[endif]-->

<strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">编译安装软件</span></strong></span>

<p class="MsoNormal" style="margin-left: 21.0pt;">
  <span style="background: lime; mso-highlight: lime;" lang="EN-US">1</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; background: lime; mso-highlight: lime;">、配置软件，</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">在软件的解压目录中</span>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 nginx-1.10.2]<span style="color: #008000;">#</span><span style="color: #008000;"> ./configure --prefix=/application/nginx-1.10.2 --user=www --group=www --with-http_stub_status_module --with-http_ssl_module</span></pre>
</div>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">编译参数说明：</span>
</p>

> <p class="MsoNormal">
>    --prefix           表示指定软件安装到哪个目录中，指定目录不存在会自动创建
> </p>
> 
> <p class="MsoNormal">
>    --user/--group       nginx工作进程由哪个用户运行管理
> </p>
> 
> <p class="MsoNormal">
>    --with-http_stub_status_module   启动nginx状态模块功能（用户访问nginx的网络信息）
> </p>
> 
> <p class="MsoNormal">
>    --with-http_ssl_module           启动https功能模块
> </p>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">通过软件编译过程中的返回值是否正确，确认配置是否正确</span>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 nginx-1.10.2]<span style="color: #008000;">#</span><span style="color: #008000;"> echo $?</span>
0</pre>
</div>

<p class="MsoNormal">
  <span lang="EN-US">   <span style="background: lime; mso-highlight: lime;">2</span></span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; background: lime; mso-highlight: lime;">、编译软件</span>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 nginx-1.10.2]<span style="color: #008000;">#</span><span style="color: #008000;"> make</span></pre>
</div>

<p class="MsoNormal">
  <span lang="EN-US">   <span style="background: lime; mso-highlight: lime;">3</span></span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; background: lime; mso-highlight: lime;">、编译安装</span>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 nginx-1.10.2]<span style="color: #008000;">#</span><span style="color: #008000;"> make install</span></pre>
</div>

### <span id="316"><a name="_Toc496798013"></a><a name="_Toc496384601"></a><!--[if !supportLists]-->

<span lang="EN-US">3.1.6 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">创建软连接</span></span>

<div class="cnblogs_code">
  <pre>[root@web01 application]<span style="color: #008000;">#</span><span style="color: #008000;"> ln -s /application/nginx-1.10.2/ /application/nginx</span></pre>
</div>

### <span id="317_nginxconf"><a name="_Toc496798014"></a><a name="_Toc496384611"></a><!--[if !supportLists]-->

<span lang="EN-US">3.1.7 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">精简化</span><span lang="EN-US">nginx.conf </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">主配置文件内容</span></span>

<div class="cnblogs_code">
  <pre>[root@web01 conf]<span style="color: #008000;">#</span><span style="color: #008000;"> egrep -v "#|^$" nginx.conf.default >nginx.conf</span></pre>
</div>

### <span id="318"><a name="_Toc496798015"></a><a name="_Toc496384602"></a><!--[if !supportLists]-->

<span lang="EN-US">3.1.8 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">启动程序</span></span>

<div class="cnblogs_code">
  <pre>[root@web01 application]<span style="color: #008000;">#</span><span style="color: #008000;"> /application/nginx/sbin/nginx</span>
[root@web01 application]<span style="color: #008000;">#</span></pre>
</div>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">检查是否启动</span>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 application]<span style="color: #008000;">#</span><span style="color: #008000;"> ps -ef |grep nginx</span>
root      26548      1  0 20:13 ?        00:00:00 nginx: master process /application/nginx/sbin/<span style="color: #000000;">nginx
www       </span>26549  26548  0 20:13 ?        00:00:00<span style="color: #000000;"> nginx: worker process       
root      </span>26551  23431  3 20:13 pts/0    00:00:00 grep --color=auto nginx</pre>
</div>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">检查端口信息</span>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 application]<span style="color: #008000;">#</span><span style="color: #008000;"> netstat -lntup |grep 80</span>
tcp        0      0 0.0.0.0:80                  0.0.0.0:*                   LISTEN      26548/nginx </pre>
</div>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">服务部署完成</span>
</p>

<p class="MsoNormal">
  <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; background: yellow; mso-highlight: yellow;">至此软件安装完毕！</span></strong>
</p>

<p class="MsoNormal">
  <strong><span style="background: lime; mso-highlight: lime;" lang="EN-US">nginx</span></strong><strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; background: lime; mso-highlight: lime;">命令简化方法</span></strong>
</p>

<div class="cnblogs_code">
  <pre>echo <span style="color: #800000;">'</span><span style="color: #800000;">export PATH=/application/nginx/sbin:$PATH</span><span style="color: #800000;">'</span>>>/etc/<span style="color: #000000;">profile
source </span>/etc/<span style="color: #000000;">profile
which nginx</span></pre>
</div>

<h2 style="margin-top: 8.15pt; margin-right: 0cm; margin-bottom: 8.15pt; margin-left: 25.1pt; mso-list: l14 level2 lfo19;">
  <span id="31_nginx-2"><a name="_Toc496384603"></a><a name="_Toc496798016"></a><a name="_Toc496384610"></a><!--[if !supportLists]-->
  
  <span lang="EN-US">3.1 </span><!--[endif]-->
  
  <span lang="EN-US">nginx </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">目录结构</span></span>
</h2>

<div class="cnblogs_code">
  <pre>[root@web01 nginx]<span style="color: #008000;">#</span><span style="color: #008000;"> ll</span>
total 36<span style="color: #000000;">
drwxr</span>-xr-x 2 root root 4096 Oct 21 19:34 conf    <span style="color: #008000;">#</span><span style="color: #008000;">配置文件保存目录</span>
drwxr-xr-x 2 root root 4096 Oct 21 19:34 html    <span style="color: #008000;">#</span><span style="color: #008000;">站点目录</span>
drwxr-xr-x 2 root root 4096 Oct 21 20:26 logs    <span style="color: #008000;">#</span><span style="color: #008000;">nginx 服务相关日志文件保存目录（错误日志访问日志）</span>
drwxr-xr-x 2 root root 4096 Oct 21 19:34 sbin    <span style="color: #008000;">#</span><span style="color: #008000;"> 服务命令目录（只有一个nginx文件）</span></pre>
</div>

<h2 style="margin-top: 8.15pt; margin-right: 0cm; margin-bottom: 8.15pt; margin-left: 25.1pt; mso-list: l14 level2 lfo4;">
  <span id="32_nginxconf"><a name="_Toc496798017"></a><a name="_Toc496384612"></a><!--[if !supportLists]-->
  
  <span lang="EN-US">3.2 </span><!--[endif]-->
  
  <span lang="EN-US">nginx.conf </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">配置文件说明</span></span>
</h2>

<p class="MsoNormal" style="margin-left: 21.0pt;">
  <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">这样的配置文件是通过精简化配置文件得到！</span></strong>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 conf]<span style="color: #008000;">#</span><span style="color: #008000;"> cat nginx.conf</span>
worker_processes  1<span style="color: #000000;">;                        ← worker 进程数量
events {                                    ←事件区块
    worker_connections  </span>1024<span style="color: #000000;">;               ←每个worker进程可以处理的连接数
}                                            ←事件区块结束
http {                                      ← HTTP 区块
    include       mime.types;               ←支持的媒体文件
    default_type  application</span>/octet-<span style="color: #000000;">stream;←默认的媒体类型
    sendfile        on;                     ←高效传输模式
    keepalive_timeout  </span>65<span style="color: #000000;">;                  ←超时时间
    server {                                 ← server 区块
        listen       </span>80<span style="color: #000000;">;                    ←端口
        server_name  localhost;             ←域名
        location </span>/<span style="color: #000000;"> {                        ←第一个location区块
            root   html;                     ←站点目录
            index  index.html index.htm;     ←首页文件
        }                                    ←第一个location区块结束
        error_page   </span>500 502 503 504  /<span style="color: #000000;">50x.html;  ← 错误信息配置
        location </span>= /<span style="color: #000000;">50x.html {                  文件位置
            root   html;                      在哪找：路径
        }                                     
    }                                         ← server 区块结束
}                                            ← HTTP 区块结束</span></pre>
</div>

### <span id="321"><a name="_Toc496798018"></a><!--[if !supportLists]-->

<span lang="EN-US">3.2.1 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">站点目录与首页文件概</span> </span>

### <span id="322"><a name="_Toc496798019"></a><!--[if !supportLists]-->

<span lang="EN-US">3.2.2 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">配置文件详解</span> </span>

<h2 style="margin-top: 8.15pt; margin-right: 0cm; margin-bottom: 8.15pt; margin-left: 25.1pt; mso-list: l14 level2 lfo4;">
  <span id="33_nginx"><a name="_Toc496384604"></a><a name="_Toc496798020"></a><!--[if !supportLists]-->
  
  <span lang="EN-US">3.3 </span><!--[endif]-->
  
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; color: red;">【常见错误】</span><span lang="EN-US">nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">软件的编译安装常见错误说明</span></span>
</h2>

### <span id="331_nginx"><a name="_Toc496798021"></a><!--[if !supportLists]-->

<span lang="EN-US">3.3.1 </span><!--[endif]-->

<span lang="EN-US">nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">软件安装过程中遇到的问题</span></span>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">软件依赖包未正确安装问题</span><span lang="EN-US">---PCRE</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">依赖包没有安装</span>
</p>

<div class="cnblogs_code">
  <pre>./<span style="color: #000000;">configure: error: the HTTP rewrite module requires the PCRE library.
You can either disable the module by using </span>--without-<span style="color: #000000;">http_rewrite_module
option, </span><span style="color: #0000ff;">or</span> install the PCRE library into the system, <span style="color: #0000ff;">or</span><span style="color: #000000;"> build the PCRE library
statically </span><span style="color: #0000ff;">from</span> the source with nginx by using --with-pcre=&lt;path> option.</pre>
</div>

<div style="mso-element: para-border-div; border: solid windowtext 2.0pt; padding: 1.0pt 4.0pt 1.0pt 4.0pt; mso-border-shadow: yes; background: #F2F2F2; mso-shading: windowtext; mso-pattern: gray-5 auto;">
  <p class="a3">
    <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">解决方法：</span><span lang="EN-US">yum install pcre pcre-devel -y</span>
  </p>
</div>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">软件依赖包未正确安装问题</span><span lang="EN-US">---OPENSSL</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">依赖包没有安装</span>
</p>

<div class="cnblogs_code">
  <pre>./<span style="color: #000000;">configure: error: SSL modules require the OpenSSL library.
You can either do </span><span style="color: #0000ff;">not</span> enable the modules, <span style="color: #0000ff;">or</span><span style="color: #000000;"> install the OpenSSL library
into the system, </span><span style="color: #0000ff;">or</span> build the OpenSSL library statically <span style="color: #0000ff;">from</span><span style="color: #000000;"> the source
with nginx by using </span>--with-openssl=&lt;path> option.</pre>
</div>

<div style="mso-element: para-border-div; border: solid windowtext 2.0pt; padding: 1.0pt 4.0pt 1.0pt 4.0pt; mso-border-shadow: yes; background: #F2F2F2; mso-shading: windowtext; mso-pattern: gray-5 auto;">
  <p class="a3">
    <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">解决方法：</span><span lang="EN-US">yum install openssl openssl-devel -y</span>
  </p>
</div>

### <span id="332_nginx"><a name="_Toc496798022"></a><!--[if !supportLists]-->

<span lang="EN-US">3.3.2 </span><!--[endif]-->

<span lang="EN-US">nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">软件启动过程中遇到的问题</span></span>

<p class="MsoNormal">
  <span lang="EN-US">nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">软件重复启动产生的错误信息</span>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 nginx-1.10.2]<span style="color: #008000;">#</span><span style="color: #008000;"> /application/nginx/sbin/nginx</span>
nginx: [emerg] bind() to 0.0.0.0:80 failed (98: Address already <span style="color: #0000ff;">in</span><span style="color: #000000;"> use)
nginx: [emerg] bind() to </span>0.0.0.0:80 failed (98: Address already <span style="color: #0000ff;">in</span><span style="color: #000000;"> use)
nginx: [emerg] bind() to </span>0.0.0.0:80 failed (98: Address already <span style="color: #0000ff;">in</span><span style="color: #000000;"> use)
nginx: [emerg] bind() to </span>0.0.0.0:80 failed (98: Address already <span style="color: #0000ff;">in</span><span style="color: #000000;"> use)
nginx: [emerg] bind() to </span>0.0.0.0:80 failed (98: Address already <span style="color: #0000ff;">in</span><span style="color: #000000;"> use)
nginx: [emerg] still could </span><span style="color: #0000ff;">not</span> bind()</pre>
</div>

<div style="mso-element: para-border-div; border: solid windowtext 2.0pt; padding: 1.0pt 4.0pt 1.0pt 4.0pt; mso-border-shadow: yes; background: #F2F2F2; mso-shading: windowtext; mso-pattern: gray-5 auto;">
  <p class="a3">
    <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">解决方法：</span>
  </p>
  
  <p class="a3" style="text-indent: 21pt; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">
    <span lang="EN-US">nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">软件已经启动无需反复启动，如果需要重新启动需要停止</span><span lang="EN-US">nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">进程或者用</span><span lang="EN-US">reload</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">方式进行重启</span>
  </p>
</div>

### <span id="333_Nginx_nginxemerggetpwnamnginxfailed"><a name="_Toc496798023"></a><!--[if !supportLists]-->

<span lang="EN-US">3.3.3 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">启动</span><span lang="EN-US"> Nginx </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">时如下报错</span><span lang="EN-US">"nginx:[emerg]getpwnam(</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">“</span><span lang="EN-US">nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">”〉</span><span lang="EN-US">failed"</span></span>

<div style="mso-element: para-border-div; border: solid windowtext 2.0pt; padding: 1.0pt 4.0pt 1.0pt 4.0pt; mso-border-shadow: yes; background: #F2F2F2; mso-shading: windowtext; mso-pattern: gray-5 auto;">
  <p class="a3">
    <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">解答这是因为没有对应的</span><span lang="EN-US">Nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">服务用户，执行</span><span lang="EN-US">useradd nginx-s/sbin/no</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">丨</span><span lang="EN-US">ogin-M</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">创建</span><span lang="EN-US"> Nginx</span>
  </p>
</div>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">用户即可。为了让读者理解问题，重现上述错误过程，命令如下：</span>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 tools]<span style="color: #008000;">#</span><span style="color: #008000;"> pkill nginx</span>
[root@web01 tools]<span style="color: #008000;">#</span><span style="color: #008000;"> userdel nginx</span>
[root@web01 tools]<span style="color: #008000;">#</span><span style="color: #008000;"> /application/nginx/sbin/nginx</span>
nginx: [emerg] getpwnam(Mnginx<span style="color: #800000;">"</span><span style="color: #800000;">) failed</span>
[root@web01 tools]<span style="color: #008000;">#</span><span style="color: #008000;"> useradd nginx -s /sbin/nologin -M</span>
[root@web01 tools]<span style="color: #008000;">#</span><span style="color: #008000;"> /application/nginx/sbin/nginx</span></pre>
</div>

### <span id="334_pcregccyum"><a name="_Toc496798024"></a><!--[if !supportLists]-->

<span lang="EN-US">3.3.4 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">编译安装</span><span lang="EN-US">pcre</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">编译软件时，</span><span lang="EN-US">gcc</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">不全导致报错（本文使用</span><span lang="EN-US">yum</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">安装不存在此问题</span><span lang="EN-US">)</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">。</span></span>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">报错信息如下：</span>
</p>

<div class="cnblogs_code">
  <pre>[root@gjlin2 pcre-8.30]<span style="color: #008000;">#</span><span style="color: #008000;"> make && make install</span>
make all-<span style="color: #000000;">am
make[l] : Entering directory 7home</span>/gjlin/tools/pcre-8.30<span style="color: #800000;">'
</span><span style="color: #000000;">CXX pcrecpp.lo
libtool : compile : unrecognized option </span><span style="color: #800000;">'</span><span style="color: #800000;">-DHAVE_CONFIG_H</span><span style="color: #800000;">'</span><span style="color: #000000;">
libtool : compile : Try </span><span style="color: #800000;">'</span><span style="color: #800000;">libtool --help* for more information.</span>
make[l】：*** [pcrecpp.lo】错误 1<span style="color: #000000;">
make[l] : Leaving directory Vhome</span>/gjlin/tools/pcre-8.30<span style="color: #800000;">'
</span>make : *** [all]错误 </pre>
</div>

<div style="mso-element: para-border-div; border: solid windowtext 2.0pt; padding: 1.0pt 4.0pt 1.0pt 4.0pt; mso-border-shadow: yes; background: #F2F2F2; mso-shading: windowtext; mso-pattern: gray-5 auto;">
  <p class="a3">
    <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">解答：执行“</span><span lang="EN-US">yum -y install gcc-c++</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">”命令安装</span><span lang="EN-US">gcc-c++</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">依赖包。</span>
  </p>
</div>

### <span id="335_nginxapplication"><a name="_Toc496798025"></a><!--[if !supportLists]-->

<span lang="EN-US">3.3.5 </span><!--[endif]-->

<span lang="EN-US">nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">软件编译安装后，看不到程序目录（</span><span lang="EN-US">/application</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">）</span></span>

<p class="MsoNormal">
  <span lang="EN-US">   </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">说明：编译安装步骤不对（配置</span> <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">编译</span> <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">编译安装生成</span><span lang="EN-US">/appliation</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">）</span>
</p>

### <span id="336_nginx"><a name="_Toc496798026"></a><!--[if !supportLists]-->

<span lang="EN-US">3.3.6 </span><!--[endif]-->

<span lang="EN-US">nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">软件排查问题三部曲说明</span></span>

<p class="MsoNormal">
  <span lang="EN-US">       a </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">在客户端上</span><span lang="EN-US">ping</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">服务器端</span><span lang="EN-US">IP</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">，检查链路是否通畅</span>
</p>

<p class="MsoNormal">
  <span lang="EN-US">      b </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">在客户端上</span><span lang="EN-US">telnet</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">服务器端</span><span lang="EN-US">IP</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">、端口，检查链路访问是否通畅</span>
</p>

<p class="MsoNormal">
  <span lang="EN-US">      c </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">在客户端上</span><span lang="EN-US">wget</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">检测模拟页面访问是否正常</span>
</p>

### <span id="337_403"><a name="_Toc496798027"></a><!--[if !supportLists]-->

<span lang="EN-US">3.3.7 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; color: red;">【注意】</span><span style="color: red;" lang="EN-US">403</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; color: red;">状态码出现情况原因</span></span>

<p class="MsoNormal">
  <span lang="EN-US">    01. </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">服务阻止客户端访问</span>
</p>

<p class="MsoNormal">
  <span lang="EN-US">    02. </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">服务端站点目录中，没有指定首页文件信息</span><span lang="EN-US">    </span>
</p>

<h2 style="margin-top: 8.15pt; margin-right: 0cm; margin-bottom: 8.15pt; margin-left: 25.1pt; mso-list: l14 level2 lfo4;">
  <span id="34_nginx"><a name="_Toc496798028"></a><!--[if !supportLists]-->
  
  <span lang="EN-US">3.4 </span><!--[endif]-->
  
  <span lang="EN-US">nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">软件使用</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">命令参数</span></span>
</h2>

### <span id="341_nginx"><a name="_Toc496798029"></a><a name="_Toc496384605"></a><!--[if !supportLists]-->

<span lang="EN-US">3.4.1 </span><!--[endif]-->

<span lang="EN-US">nginx </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">启动方法</span></span>

<div class="cnblogs_code">
  <pre>[root@web01 application]<span style="color: #008000;">#</span><span style="color: #008000;"> /application/nginx/sbin/nginx</span></pre>
</div>

### <span id="342_nginx"><a name="_Toc496798030"></a><a name="_Toc496384606"></a><!--[if !supportLists]-->

<span lang="EN-US">3.4.2 </span><!--[endif]-->

<span lang="EN-US">nginx </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">停止方法</span></span>

<div class="cnblogs_code">
  <pre>[root@web01 application]<span style="color: #008000;">#</span><span style="color: #008000;"> /application/nginx/sbin/nginx -s stop</span></pre>
</div>

### <span id="343_nginx"><a name="_Toc496798031"></a><a name="_Toc496384607"></a><!--[if !supportLists]-->

<span lang="EN-US">3.4.3 </span><!--[endif]-->

<span lang="EN-US">nginx </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">重启方法</span> <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">（平滑重启）</span></span>

<div class="cnblogs_code">
  <pre>[root@web01 application]<span style="color: #008000;">#</span><span style="color: #008000;"> /application/nginx/sbin/nginx -s reload</span></pre>
</div>

### <span id="344"><a name="_Toc496798032"></a><a name="_Toc496384608"></a><!--[if !supportLists]-->

<span lang="EN-US">3.4.4 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">检查配置文件语法是否正确</span></span>

<div class="cnblogs_code">
  <pre>[root@web01 application]<span style="color: #008000;">#</span><span style="color: #008000;"> /application/nginx/sbin/nginx -t</span>
nginx: the configuration file /application/nginx-1.10.2/conf/nginx.conf syntax <span style="color: #0000ff;">is</span><span style="color: #000000;"> ok
nginx: configuration file </span>/application/nginx-1.10.2/conf/nginx.conf test <span style="color: #0000ff;">is</span> successful</pre>
</div>

### <span id="345_-V_V"><a name="_Toc496798033"></a><a name="_Toc496384609"></a><!--[if !supportLists]-->

<span lang="EN-US">3.4.5 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">显示配置参数</span><span lang="EN-US">  -V </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; color: red;">（大写</span><span style="color: red;" lang="EN-US">V</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; color: red;">）</span></span>

<div class="cnblogs_code">
  <pre>[root@web01 application]<span style="color: #008000;">#</span><span style="color: #008000;"> /application/nginx/sbin/nginx -V</span>
nginx version: nginx/1.10.2<span style="color: #000000;">
built by gcc </span>4.4.7 20120313 (Red Hat 4.4.7-18<span style="color: #000000;">) (GCC)
built with OpenSSL </span>1.0.1e-fips 11 Feb 2013<span style="color: #000000;">
TLS SNI support enabled
configure arguments: </span>--prefix=/application/nginx-1.10.2 --user=www --group=www --with-http_stub_status_module --with-http_ssl_module</pre>
</div>

### <span id="346_nginx"><a name="_Toc496798034"></a><!--[if !supportLists]-->

<span lang="EN-US">3.4.6 </span><!--[endif]-->

<span lang="EN-US">nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">软件使用过程中深入说明</span></span>

<p class="MsoNormal" style="text-indent: 15.75pt;">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">①</span><span lang="EN-US">. nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">软件语法检查方法</span><span lang="EN-US">:</span>
</p>

<div class="cnblogs_code">
  <pre>    nginx -t </pre>
</div>

<p class="MsoNormal" style="text-indent: 15.75pt;">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">②</span><span lang="EN-US">. nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">软件访问测试过程</span><span lang="EN-US">:</span>
</p>

<div class="cnblogs_code">
  <pre>curl -v www.baidu.com</pre>
</div>

<p class="MsoNormal" style="text-indent: 15.75pt;">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">③</span><span lang="EN-US">. nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">软件编译参数查看：</span>
</p>

<div class="cnblogs_code">
  <pre>    nginx -V                 &lt;--- 查看原有的编译参数信息</pre>
</div>

<h2 style="margin-top: 8.15pt; margin-right: 0cm; margin-bottom: 8.15pt; margin-left: 25.1pt; mso-list: l14 level2 lfo4;">
  <span id="35_nginx"><a name="_Toc496798035"></a><!--[if !supportLists]-->
  
  <span lang="EN-US">3.5 </span><!--[endif]-->
  
  <span lang="EN-US">nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">软件静态页面编写过程</span></span>
</h2>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">编写配置文件</span>
</p>

<div class="cnblogs_code">
  <pre>[root@web02 www]<span style="color: #008000;">#</span><span style="color: #008000;"> cat ../../conf/nginx.conf</span>
worker_processes  1<span style="color: #000000;">;
events {
    worker_connections  </span>1024<span style="color: #000000;">;
}
http {
    include       mime.types;
    default_type  application</span>/octet-<span style="color: #000000;">stream;
    sendfile        on;
    keepalive_timeout  </span>65<span style="color: #000000;">;
    server {
        listen       </span>80<span style="color: #000000;">;
        server_name www.zinx.top;
        location </span>/<span style="color: #000000;"> {
            root   html</span>/<span style="color: #000000;">www;
            index  clsn.html index.html index.htm;
        }
        error_page   </span>500 502 503 504  /<span style="color: #000000;">50x.html;
        location </span>= /<span style="color: #000000;">50x.html {
            root   html;
        }
    }
}</span></pre>
</div>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">编写静态访问页面文件信息</span>
</p>

<div class="cnblogs_code">
  <pre>[root@web1 www]<span style="color: #008000;">#</span><span style="color: #008000;"> cat clsn.html  </span>

&lt;meta charset=<span style="color: #800000;">"</span><span style="color: #800000;">utf-8</span><span style="color: #800000;">"</span>>

<span style="color: #000000;">
惨绿少年
</span>&lt;table border=1>


<tr>
  <td>
    01
  </td> 
  
  <td>
    
  </td> 
</tr>


<tr>
  <td>
    02
  </td> 
  
  <td>
    
  </td> 
</tr>
 

<tr>
  <td>
    03
  </td> 
  
  <td>
    
  </td> 
</tr>
 &lt;/table>
&lt;a href=

<span style="color: #800000;">"</span><span style="color: #800000;">http://blog.znix.top</span><span style="color: #800000;">"</span>>
&lt;img src=<span style="color: #800000;">"</span><span style="color: #800000;">znix.png</span><span style="color: #800000;">"</span> />
&lt;/a>

</pre>
</div>

# <span id="4_nginx"><a name="_Toc496798036"></a><!--[if !supportLists]-->

<span lang="EN-US">第4章 </span><!--[endif]-->

<span lang="EN-US">nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">进阶</span><a name="_Toc496466418"></a><span lang="EN-US"> --</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">虚拟主机配置</span></span>

<h2 style="margin-top: 8.15pt; margin-right: 0cm; margin-bottom: 8.15pt; margin-left: 25.1pt; mso-list: l14 level2 lfo4;">
  <span id="41_nginx"><a name="_Toc496798037"></a><!--[if !supportLists]-->
  
  <span lang="EN-US">4.1 </span><!--[endif]-->
  
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">【<span style="background: yellow; mso-highlight: yellow;">企业要求</span>】需要按照以前</span><span lang="EN-US">nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">服务编译安装过程安装</span></span>
</h2>

<p class="MsoNormal">
  <span lang="EN-US">1</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">、参看已安装服务的配置参数信息</span>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 sbin]<span style="color: #008000;">#</span><span style="color: #008000;"> /application/nginx/sbin/nginx -V</span>
nginx version: nginx/1.10.2<span style="color: #000000;">
built by gcc </span>4.4.7 20120313 (Red Hat 4.4.7-18<span style="color: #000000;">) (GCC)
built with OpenSSL </span>1.0.1e-fips 11 Feb 2013<span style="color: #000000;">
TLS SNI support enabled
configure arguments: </span>--prefix=/application/nginx-1.10.2 --user=www --group=www --with-http_stub_status_module --with-http_ssl_module</pre>
</div>

<p class="MsoNormal">
  <span lang="EN-US">   -V </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">参数能显示软件的详细详细，安装配置参数</span>
</p>

<p class="MsoNormal">
  <span lang="EN-US">2</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">、按照配置参数进行部署</span>
</p>

### <span id="411"><a name="_Toc496798038"></a><!--[if !supportLists]-->

<span lang="EN-US">4.1.1 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">【<span style="background: yellow; mso-highlight: yellow;">语法检查</span>】检查配置文件</span></span>

<div class="cnblogs_code">
  <pre>[root@web01 nginx]<span style="color: #008000;">#</span><span style="color: #008000;"> /application/nginx/sbin/nginx -t</span>
nginx: the configuration file /application/nginx-1.10.2/conf/nginx.conf syntax <span style="color: #0000ff;">is</span><span style="color: #000000;"> ok
nginx: configuration file </span>/application/nginx-1.10.2/conf/nginx.conf test <span style="color: #0000ff;">is</span> successful</pre>
</div>

<h2 style="margin-top: 8.15pt; margin-right: 0cm; margin-bottom: 8.15pt; margin-left: 25.1pt; mso-list: l14 level2 lfo4;">
  <span id="42_--nginx"><a name="_Toc496798039"></a><a name="_Toc496466419"></a><!--[if !supportLists]-->
  
  <span lang="EN-US">4.2 </span><!--[endif]-->
  
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">首页文件不存在</span><span lang="EN-US">--</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">利用</span><span lang="EN-US">nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">服务搭建文件共享服务器</span></span>
</h2>

<p class="MsoNormal" style="margin-left: 42.0pt;">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">通过配置</span> <span class="ad"><span style="font-size: 10.5pt; mso-bidi-font-size: 11.0pt; mso-bidi-font-family: 'Times New Roman';"> <span lang="EN-US">autoindex on; </span></span></span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">参数</span>
</p>

<p class="MsoNormal" style="margin-left: 21.0pt; text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">使用</span><span lang="EN-US"> autoindex</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">参数，</span><span lang="EN-US">nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">能识别的直接显示，不识别的直接下载</span>
</p>

<p class="MsoNormal" style="margin-left: 21.0pt; text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">配置完</span><span lang="EN-US"> autoindex on; </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">参数以后</span> <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">会显示站点下的文件信息</span>
</p>

<p class="MsoNormal" style="margin-left: 21.0pt; text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">对于</span><span lang="EN-US">nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">可以解析的资源会解析相应的内容</span>
</p>

<p class="MsoNormal" style="margin-left: 21.0pt; text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">对于</span><span lang="EN-US">nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">不可以解析的资源会直接下载</span>
</p>

### <span id="421_curl403"><a name="_Toc496798040"></a><!--[if !supportLists]-->

<span lang="EN-US">4.2.1 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">进行</span><span lang="EN-US">curl</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">时，报</span><span lang="EN-US">403</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">错误，因为没有首页文件信息</span></span>

<div class="cnblogs_code">
  <pre> [root@web02 ~]<span style="color: #008000;">#</span><span style="color: #008000;"> echo 'web01 www' > /application/nginx/html/www/index.html</span></pre>
</div>

<p class="MsoNormal">
  <span lang="EN-US">        <- </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">在虚拟主机指定的站点目录中创建首页文件</span><span lang="EN-US">         </span>
</p>

<div class="cnblogs_code">
  <pre>[root@web02 ~]<span style="color: #008000;">#</span><span style="color: #008000;"> curl www.nmtui.com</span>
&lt;- 利用curl命令本地检测nginx配置是否成功；已经存在首页文件，测试成功</pre>
</div>

### <span id="422_autoindex_on"><a name="_Toc496798041"></a><!--[if !supportLists]-->

<span lang="EN-US">4.2.2 </span><!--[endif]-->

<span lang="EN-US">autoindex on</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">参数实践</span></span>

<p class="MsoNormal">
  <span lang="EN-US">1</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">）修改配置文件</span>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 www]<span style="color: #008000;">#</span><span style="color: #008000;"> cat ../../conf/nginx.conf</span>
worker_processes  1<span style="color: #000000;">;
events {
    worker_connections  </span>1024<span style="color: #000000;">;
}
http {
    include       mime.types;
    default_type  application</span>/octet-<span style="color: #000000;">stream;
    sendfile        on;
    keepalive_timeout  </span>65<span style="color: #000000;">;
    server {
        listen       </span>10.0.0.8:80<span style="color: #000000;">;
        server_name  www.nmtui.com;
        location </span>/<span style="color: #000000;"> {
            root   html</span>/<span style="color: #000000;">www;
            autoindex on;
        }
        error_page   </span>500 502 503 504  /<span style="color: #000000;">50x.html;
        location </span>= /<span style="color: #000000;">50x.html {
            root   html;
        }
    }
}</span></pre>
</div>

<p class="MsoNormal">
  <span lang="EN-US">2</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">）重启服务</span>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 conf]<span style="color: #008000;">#</span><span style="color: #008000;"> /application/nginx/sbin/nginx -t</span>
nginx: the configuration file /application/nginx-1.10.2/conf/nginx.conf syntax <span style="color: #0000ff;">is</span><span style="color: #000000;"> ok
nginx: configuration file </span>/application/nginx-1.10.2/conf/nginx.conf test <span style="color: #0000ff;">is</span><span style="color: #000000;"> successful
[root@web01 conf]</span><span style="color: #008000;">#</span><span style="color: #008000;"> /application/nginx/sbin/nginx -s reload</span></pre>
</div>

<p class="MsoNormal">
  <span lang="EN-US">3</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">）访问测试</span> 
</p>

<h2 style="margin-top: 8.15pt; margin-right: 0cm; margin-bottom: 8.15pt; margin-left: 25.1pt; mso-list: l14 level2 lfo4;">
  <span id="43"><a name="_Toc496798042"></a><a name="_Toc496466420"></a><!--[if !supportLists]-->
  
  <span lang="EN-US">4.3 </span><!--[endif]-->
  
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; background: lime; mso-highlight: lime;">【概念】</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">虚拟主机的概念和类型</span></span>
</h2>

<p class="MsoNormal" style="text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">虚拟主机使用的是特殊的软硬件技术，它把一台运行在因特网上的服务器主机分成一台台“虚拟”的主机，每台虚拟主机都可以是一个独立的网站，可以具有独立的域名，具有完整的</span><span lang="EN-US">Intemet</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">服务器功能（</span><span lang="EN-US">WWW</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">、</span><span lang="EN-US">FTP</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">、</span><span lang="EN-US">Email</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">等），同一台主机上的虚拟主机之间是完全独立的。从网站访问者来看，每一台虚拟主机和一台独立的主机完全一样。</span>
</p>

<p class="MsoNormal" style="text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">利用虚拟主机，不用为每个要运行的网站提供一台单独的</span><span lang="EN-US">Nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">服务器或单独运行一组</span><span lang="EN-US">Nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">进程。虚拟主机提供了在同一台服务器、同一组</span><span lang="EN-US">Nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">进程上运行多个网站的功能。</span>
</p>

<p class="MsoNormal" style="text-indent: 21.0pt;">
  <span lang="EN-US"> </span>
</p>

### <span id="431"><a name="_Toc496798043"></a><a name="_Toc496466421"></a><!--[if !supportLists]-->

<span lang="EN-US">4.3.1 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">虚拟主机概念</span></span>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">所谓虚拟主机，在</span><span lang="EN-US">Web</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">服务里就是一个独立的网站站点，这个站点对应独立的域名（也可能是</span><span lang="EN-US">ip</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">或端口</span><span lang="EN-US">.</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">具有独立的程序及资源目录，可以独立地对外提供服务供用户访问。</span>
</p>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">这个独立的站点在配置里是由一定格式的标签段标记的，对于</span><span lang="EN-US">Apache</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">软件来说，一个虚拟主机的标签段通常被包含在以的此</span><span lang="EN-US"><VirtualHost></VirtualHost></span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">，而</span><span lang="EN-US">Nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">软件则使用一个</span><span lang="EN-US">server{}</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">标签来标示一个虚拟主机。一个</span><span lang="EN-US">Web</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">服务里可以有多个虚拟主机标签对，即可以同时支持多个虚拟主机站点。</span>
</p>

### <span id="432"><a name="_Toc496798044"></a><a name="_Toc496466422"></a><!--[if !supportLists]-->

<span lang="EN-US">4.3.2 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">虚拟主机类型</span></span>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">常见的虚拟主机类型有如下几种</span>
</p>

<p class="MsoNormal" style="text-indent: 24.0pt; mso-char-indent-count: 2.0;">
  <strong><span lang="EN-US">1</span></strong><strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">）基于域名的虚拟主机</span></strong>
</p>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">所谓基于域名的虚拟主机，意思就是通过不同的域名区分不同的虚拟主机，基于域名的虚拟主机是企业应用最广的虚拟主机类型，几乎所有对外提供服务的网站使用的都是基于域名的虚拟主机，例如</span><span lang="EN-US">: www.znix.top</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">。</span>
</p>

<p class="MsoNormal" style="text-indent: 24.0pt; mso-char-indent-count: 2.0;">
  <strong><span lang="EN-US">2</span></strong><strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">）基于端口的虚拟主机</span><span lang="EN-US">  </span></strong>
</p>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">同理，所谓基于端口的虚拟主机，意思就是通过不同的端口来区分不同的虚拟主机，此类虚拟主机对应的企业应用主要为公司内部网站，例如：一些不希望直接对外提供用户访问的网站后台等，访问基于端口的虚拟主机，地址里要带有端口，例如：</span><span lang="EN-US">http://blog.znix.top:80</span>
</p>

<p class="MsoNormal">
  <strong><span lang="EN-US">    3</span></strong><strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">）基于</span><span lang="EN-US">IP</span></strong><strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">的虚拟主机</span></strong>
</p>

<p class="MsoNormal">
  <span lang="EN-US"> </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">所谓基于</span><span lang="EN-US">IP</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">的虚拟主机，意思是通过不同的</span><span lang="EN-US">IP</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">区分不同的虚拟主机，</span>
</p>

### <span id="433_Nginx"><a name="_Toc496798045"></a><!--[if !supportLists]-->

<span style="mso-fareast-font-family: 'Courier New'; mso-bidi-font-family: 'Courier New'; background: lime; mso-highlight: lime;" lang="EN-US">4.3.3 </span><!--[endif]-->

<span style="background: lime; mso-highlight: lime;" lang="EN-US">Nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; background: lime; mso-highlight: lime;">配置虚拟主机的步骤如下（适合各类虚拟主机类型）</span></span>

<p class="MsoNormal" style="margin-left: 12.0pt; mso-para-margin-left: 1.0gd;">
  <span lang="EN-US">1</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">）增加一个完整的</span><span lang="EN-US">server</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">标签段到结尾处。注意，要放在</span><span lang="EN-US">http</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">的结束大括号前，也就是将</span><span lang="EN-US">server</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">标签段放入</span><span lang="EN-US">http</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">标签。</span>
</p>

<p class="MsoNormal" style="margin-left: 12.0pt; mso-para-margin-left: 1.0gd;">
  <span lang="EN-US">2)</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">更改</span><span lang="EN-US">server_name</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">及对应网页的</span><span lang="EN-US">root</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">根目录，如果需要其他参数，可以增加或修改。</span>
</p>

<p class="MsoNormal" style="margin-left: 12.0pt; mso-para-margin-left: 1.0gd;">
  <span lang="EN-US">3)</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">创建</span><span lang="EN-US">Seever_name</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">域名对应网页的根目录，并且建立测试文件，如果没有</span><span lang="EN-US">index</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">首页，访问会出现</span><span lang="EN-US">403</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">错误。</span>
</p>

> <p class="MsoNormal" style="margin-left: 12.0pt; mso-para-margin-left: 1.0gd;">
>        如果是apache软件，没有首页文件，默认会把站点目录下面的信息显示出来
> </p>
> 
> <p class="MsoNormal" style="margin-left: 12.0pt; mso-para-margin-left: 1.0gd;">
>        nginx出403错误解决方式：http://clsn.blog.51cto.com/2561410/1633952
> </p>
> 
> <p class="MsoNormal" style="margin-left: 12.0pt; mso-para-margin-left: 1.0gd;">
>        autoindex on;#<==当找不到首页文件时，会展示目录结构，这个功能一般不要用除非有需求。
> </p>
> 
> <p class="MsoNormal" style="margin-left: 12.0pt; mso-para-margin-left: 1.0gd;">
>    
> </p>
> 
> <p class="a3">
>    <strong>   PS:显示的目录结构中，有些信息点击就是下载，有的点击就是显示，因为扩展名称不一样</strong>
> </p>
> 
> <p class="MsoNormal" style="margin-left: 12.0pt; mso-para-margin-left: 1.0gd;">
>            根本在于nginx软件是否能够进行解析
> </p>
> 
> <p class="MsoNormal" style="margin-left: 12.0pt; mso-para-margin-left: 1.0gd;">
>            nginx是否解析：
> </p>
> 
> <p class="MsoNormal" style="margin-left: 12.0pt; mso-para-margin-left: 1.0gd;">
>            1.htmljpg认识显示出内容
> </p>
> 
> <p class="MsoNormal" style="margin-left: 12.0pt; mso-para-margin-left: 1.0gd;">
>            2.不认识不解析便直接下载
> </p>

<p class="MsoNormal" style="margin-left: 12.0pt; mso-para-margin-left: 1.0gd;">
  <span lang="EN-US">4)</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">检査</span><span lang="EN-US">Nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">配置文件语法，平滑重启</span><span lang="EN-US">Nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">服务，快速检査启动结果。</span>
</p>

<p class="MsoNormal" style="margin-left: 12.0pt; mso-para-margin-left: 1.0gd;">
  <span lang="EN-US">5)</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">在客户端对</span><span lang="EN-US">server_name</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">处配置的域名做</span><span lang="EN-US">host</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">解析或</span><span lang="EN-US">DNS</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">配置，并检査（</span><span lang="EN-US">ping</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">域名看返回的</span><span lang="EN-US">IP</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">是否正确）。</span>
</p>

<p class="MsoNormal" style="margin-left: 12.0pt; mso-para-margin-left: 1.0gd;">
  <span lang="EN-US">6)</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">在</span><span lang="EN-US">Win32</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">浏览器中输入地址访问，或者在</span><span lang="EN-US">Linux</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">客户端做</span><span lang="EN-US">hosts</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">解析，用</span><span lang="EN-US">wget</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">或</span><span lang="EN-US">curl</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">接地址访问。</span>
</p>

<p class="MsoNormal" style="margin-left: 12.0pt; mso-para-margin-left: 1.0gd;">
  <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">7）在服务重启或关闭之前先进行一次配置文件检查 /application/ngnix/sbin/nginx -t</span></strong>
</p>

<p class="MsoNormal" style="margin-left: 7.1pt;">
  <strong><span lang="EN-US">Nginx</span></strong><strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">虚拟主机的官方帮助网址为：</span></strong><span lang="EN-US">http://Nginx.org/en/docs/http/requestj3rocessing.html</span>
</p>

<h2 style="margin-top: 8.15pt; margin-right: 0cm; margin-bottom: 8.15pt; margin-left: 25.1pt; mso-list: l14 level2 lfo4;">
  <span id="44"><a name="_Toc496798046"></a><!--[if !supportLists]-->
  
  <span lang="EN-US">4.4 </span><!--[endif]-->
  
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; background: yellow; mso-highlight: yellow;">【实践】</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">虚拟主机配置</span></span>
</h2>

### <span id="441"><a name="_Toc496798047"></a><!--[if !supportLists]-->

<span lang="EN-US">4.4.1 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">基于域名的虚拟主机</span></span>

<p class="MsoNormal">
  <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; background: yellow; mso-highlight: yellow;">修改配置文件</span></strong>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 ~]<span style="color: #008000;">#</span><span style="color: #008000;"> cat  /application/nginx/conf/nginx.conf</span>
worker_processes  1<span style="color: #000000;">;
events {
    worker_connections  </span>1024<span style="color: #000000;">;
}
http {
    include       mime.types;
    default_type  application</span>/octet-<span style="color: #000000;">stream;
    sendfile        on;
    keepalive_timeout  </span>65<span style="color: #000000;">;
    server {
        listen       </span>80<span style="color: #000000;">;
        server_name  www.nmtui.com;
        location </span>/<span style="color: #000000;"> {
            root   html</span>/<span style="color: #000000;">www;
            index  index.html index.htm;
        }
        error_page   </span>500 502 503 504  /<span style="color: #000000;">50x.html;
        location </span>= /<span style="color: #000000;">50x.html {
            root   html;
        }
    }
    server {
        listen       </span>80<span style="color: #000000;">;
        server_name  bbs.nmtui.com;
        location </span>/<span style="color: #000000;"> {
            root   html</span>/<span style="color: #000000;">bbs;
            index  index.html index.htm;
        }
        error_page   </span>500 502 503 504  /<span style="color: #000000;">50x.html;
        location </span>= /<span style="color: #000000;">50x.html {
            root   html;
        }
    }
    server {
        listen       </span>80<span style="color: #000000;">;
        server_name  blog.nmtui.com;
        location </span>/<span style="color: #000000;"> {
            root   html</span>/<span style="color: #000000;">blog;
            index  index.html index.htm;
        }
        error_page   </span>500 502 503 504  /<span style="color: #000000;">50x.html;
        location </span>= /<span style="color: #000000;">50x.html {
            root   html;
        }
    }
}</span></pre>
</div>

<p class="MsoNormal">
  <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">检查配置信息是否正确</span></strong>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 conf]<span style="color: #008000;">#</span><span style="color: #008000;"> /application/nginx/sbin/nginx -t</span>
nginx: the configuration file /application/nginx-1.10.2/conf/nginx.conf syntax <span style="color: #0000ff;">is</span><span style="color: #000000;"> ok
nginx: configuration file </span>/application/nginx-1.10.2/conf/nginx.conf test <span style="color: #0000ff;">is</span> successful</pre>
</div>

<p class="MsoNormal">
  <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">重启服务</span></strong>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 conf]<span style="color: #008000;">#</span><span style="color: #008000;"> /application/nginx/sbin/nginx -s reload</span></pre>
</div>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">注意：服务没有启动的时候不能使用平滑重启</span>
</p>

<p class="MsoNormal">
  <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">创建站点目录</span></strong>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 conf]<span style="color: #008000;">#</span><span style="color: #008000;"> for name in www blog bbs ;do  mkdir ../html/$name -p ;done</span></pre>
</div>

<p class="MsoNormal">
  <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">创建主页文件</span></strong>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 conf]<span style="color: #008000;">#</span><span style="color: #008000;"> for name in www blog bbs ;do echo "web01 $name" >../html/$name/index.html  ;done</span></pre>
</div>

<p class="MsoNormal">
  <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">检查主页内容信息</span></strong>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 conf]<span style="color: #008000;">#</span><span style="color: #008000;"> for name in www blog bbs ;do  cat ../html/$name/index.html ;done</span>
<span style="color: #000000;">web01 www
web01 blog
web01 bbs</span></pre>
</div>

<p class="MsoNormal">
  <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">修改主机</span><span lang="EN-US">hosts</span></strong><strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">文件</span></strong>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 ~]<span style="color: #008000;">#</span><span style="color: #008000;"> vim /etc/hosts</span>
172.16.1.8    web01 www.nmtui.com blog.nmtui.com bbs.nmtui.com</pre>
</div>

<p class="MsoNormal">
  <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">测试</span></strong>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 ~]<span style="color: #008000;">#</span><span style="color: #008000;"> curl  www.nmtui.com</span>
<span style="color: #000000;">web01 www
[root@web01 </span>~]<span style="color: #008000;">#</span><span style="color: #008000;"> curl  blog.nmtui.com</span>
<span style="color: #000000;">web01 blog
[root@web01 </span>~]<span style="color: #008000;">#</span><span style="color: #008000;"> curl  bbs.nmtui.com</span>
web01 bbs</pre>
</div>

### <span id="442"><a name="_Toc496798048"></a><!--[if !supportLists]-->

<span lang="EN-US">4.4.2 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">基于端口的虚拟主机</span></span>

<p class="MsoNormal">
  <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">修改配置文件内容</span></strong>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 conf]<span style="color: #008000;">#</span><span style="color: #008000;"> vim nginx.conf</span>
<span style="color: #000000;">    server {
        listen       </span>81<span style="color: #000000;">;
        server_name  bbs.nmtui.com;
        location </span>/<span style="color: #000000;"> {
            root   html</span>/<span style="color: #000000;">bbs;
            index  index.html index.htm;
        }
        error_page   </span>500 502 503 504  /<span style="color: #000000;">50x.html;
        location </span>= /<span style="color: #000000;">50x.html {
            root   html;
</span><span style="color: #800000;">"</span><span style="color: #800000;">nginx.conf</span><span style="color: #800000;">"</span> 46L, 1098C written  </pre>
</div>

<p class="MsoNormal">
  <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">重启服务</span></strong>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 conf]<span style="color: #008000;">#</span><span style="color: #008000;"> /application/nginx/sbin/nginx -t</span>
nginx: the configuration file /application/nginx-1.10.2/conf/nginx.conf syntax <span style="color: #0000ff;">is</span><span style="color: #000000;"> ok
nginx: configuration file </span>/application/nginx-1.10.2/conf/nginx.conf test <span style="color: #0000ff;">is</span><span style="color: #000000;"> successful
[root@web01 conf]</span><span style="color: #008000;">#</span><span style="color: #008000;"> /application/nginx/sbin/nginx -s reload</span></pre>
</div>

<p class="MsoNormal">
  <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">检查端口信息</span></strong>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 conf]<span style="color: #008000;">#</span><span style="color: #008000;"> netstat -lntup |grep ng</span>
tcp        0      0 0.0.0.0:80                  0.0.0.0:*                   LISTEN      40110/<span style="color: #000000;">nginx        
tcp        0      0 </span>0.0.0.0:81                  0.0.0.0:*                   LISTEN      40110/nginx  </pre>
</div>

<p class="MsoNormal">
  <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">测试访问</span></strong>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 ~]<span style="color: #008000;">#</span><span style="color: #008000;"> curl  bbs.nmtui.com:81</span>
web01 bbs</pre>
</div>

### <span id="443_IP"><a name="_Toc496798049"></a><!--[if !supportLists]-->

<span lang="EN-US">4.4.3 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">基于</span><span lang="EN-US">IP</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">的虚拟主机</span></span>

<p class="MsoNormal">
  <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; color: red;">注意：</span></strong>  
</p>

<div style="mso-element: para-border-div; border: solid windowtext 2.0pt; padding: 1.0pt 4.0pt 1.0pt 4.0pt; mso-border-shadow: yes; background: #F2F2F2; mso-shading: windowtext; mso-pattern: gray-5 auto; margin-left: 42.5pt; margin-right: 69.6pt;">
  <p class="a3" style="margin: 1pt 0cm 1pt 42.5pt; text-indent: -42.5pt; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">
    <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">采用基于</span><span lang="EN-US">IP</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">的虚拟主机，配置文件修改后要重启（</span><span lang="EN-US">-s stop</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">）</span>
  </p>
  
  <p class="a3" style="margin: 1pt 0cm 1pt 42.5pt; text-indent: -42.5pt; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">
    <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">配置和</span><span lang="EN-US">IP</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">地址配置相关的都要采用（</span><span lang="EN-US">-s stop</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">）重启，不能够使用软重启的方式</span>
  </p>
</div>

<p class="MsoNormal">
  <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">修改配置文件</span></strong>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 conf]<span style="color: #008000;">#</span><span style="color: #008000;"> cat nginx.conf</span>
worker_processes  1<span style="color: #000000;">;
events {
    worker_connections  </span>1024<span style="color: #000000;">;
}
http {
    include       mime.types;
    default_type  application</span>/octet-<span style="color: #000000;">stream;
    sendfile        on;
    keepalive_timeout  </span>65<span style="color: #000000;">;
    server {
        listen       </span>10.0.0.8:80<span style="color: #000000;">;
        server_name  www.nmtui.com;
        location </span>/<span style="color: #000000;"> {
            root   html</span>/<span style="color: #000000;">www;
            index  index.html index.htm;
        }
        error_page   </span>500 502 503 504  /<span style="color: #000000;">50x.html;
        location </span>= /<span style="color: #000000;">50x.html {
            root   html;
        }
    }
}</span></pre>
</div>

<p class="MsoNormal">
  <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">检查配置文件格式</span></strong>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 conf]<span style="color: #008000;">#</span><span style="color: #008000;"> /application/nginx/sbin/nginx -t</span>
nginx: the configuration file /application/nginx-1.10.2/conf/nginx.conf syntax <span style="color: #0000ff;">is</span><span style="color: #000000;"> ok
nginx: configuration file </span>/application/nginx-1.10.2/conf/nginx.conf test <span style="color: #0000ff;">is</span> successful</pre>
</div>

<p class="MsoNormal">
  <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">重启服务，注意使用的是<span style="color: red;">直接重启</span>的方式</span><span lang="EN-US">  </span></strong>
</p>

<p class="MsoNormal">
  <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; color: red;">只要</span><span style="color: red;" lang="EN-US">nginx</span></strong><strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; color: red;">配置文件中涉及到</span><span style="color: red; background: yellow; mso-highlight: yellow;" lang="EN-US">IP</span></strong><strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; color: red;">地址的更改只能正真的重启才生效</span></strong>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 conf]<span style="color: #008000;">#</span><span style="color: #008000;"> /application/nginx/sbin/nginx -s stop</span>
[root@web01 conf]<span style="color: #008000;">#</span><span style="color: #008000;"> /application/nginx/sbin/nginx</span>
[root@web01 conf]<span style="color: #008000;">#</span><span style="color: #008000;"> netstat -lntup |grep ng</span>
tcp        0      0 10.0.0.8:80                 0.0.0.0:*                   LISTEN      40592/nginx   </pre>
</div>

<p class="MsoNormal">
  <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">访问测试</span></strong>
</p>

<p class="MsoNormal" style="text-align: center;" align="center">
   
</p>

<h2 style="margin-top: 8.15pt; margin-right: 0cm; margin-bottom: 8.15pt; margin-left: 25.1pt; mso-list: l14 level2 lfo4;">
  <span id="45_nginx"><a name="_Toc496798050"></a><!--[if !supportLists]-->
  
  <span lang="EN-US">4.5 </span><!--[endif]-->
  
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; background: yellow; mso-highlight: yellow;">【规范化配置】</span><span lang="EN-US">nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">配置文件企业规范化</span></span>
</h2>

### <span id="451"><a name="_Toc496798051"></a><!--[if !supportLists]-->

<span lang="EN-US">4.5.1 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">第一个里程碑：</span><span lang="EN-US">  </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">创建虚拟主机配置文件存储目录</span></span>

<div class="cnblogs_code">
  <pre>[root@web01 conf]<span style="color: #008000;">#</span><span style="color: #008000;"> pwd</span>
/application/nginx/<span style="color: #000000;">conf
[root@web01 conf]</span><span style="color: #008000;">#</span><span style="color: #008000;"> mkdir extra</span></pre>
</div>

### <span id="452"><a name="_Toc496798052"></a><!--[if !supportLists]-->

<span lang="EN-US">4.5.2 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">第二个里程碑：</span> <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">生产虚拟主机配置文件</span></span>

<div class="cnblogs_code">
  <pre>[root@web01 conf]<span style="color: #008000;">#</span><span style="color: #008000;"> sed -n '10,21p' nginx.conf > extra/www.conf</span>
[root@web01 conf]<span style="color: #008000;">#</span><span style="color: #008000;"> sed -n '22,33p' nginx.conf > extra/bbs.conf</span>
[root@web01 conf]<span style="color: #008000;">#</span><span style="color: #008000;"> sed -n '34,45p' nginx.conf > extra/blog.conf</span></pre>
</div>

### <span id="453_nginx"><a name="_Toc496798053"></a><!--[if !supportLists]-->

<span lang="EN-US">4.5.3 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">第三个里程碑：</span> <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">修改</span><span lang="EN-US">nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">配置文件使之加载识别虚拟主机配置文件</span></span>

<div class="cnblogs_code">
  <pre>[root@web01 conf]<span style="color: #008000;">#</span><span style="color: #008000;"> cat  nginx.conf</span>
worker_processes  1<span style="color: #000000;">;
events {
    worker_connections  </span>1024<span style="color: #000000;">;
}
http {
    include       mime.types;
    default_type  application</span>/octet-<span style="color: #000000;">stream;
    sendfile        on;
    keepalive_timeout  </span>65<span style="color: #000000;">;
    include extra</span>/*<span style="color: #000000;">;
}</span></pre>
</div>

### <span id="454"><a name="_Toc496798054"></a><!--[if !supportLists]-->

<span lang="EN-US">4.5.4 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">重启服务</span></span>

<div class="cnblogs_code">
  <pre>[root@web01 conf]<span style="color: #008000;">#</span><span style="color: #008000;"> /application/nginx/sbin/nginx -t</span>
nginx: the configuration file /application/nginx-1.10.2/conf/nginx.conf syntax <span style="color: #0000ff;">is</span><span style="color: #000000;"> ok
nginx: configuration file </span>/application/nginx-1.10.2/conf/nginx.conf test <span style="color: #0000ff;">is</span> successful</pre>
</div>

### <span id="455"><a name="_Toc496798055"></a><!--[if !supportLists]-->

<span lang="EN-US">4.5.5 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">检查监听端口</span></span>

<div class="cnblogs_code">
  <pre>[root@web01 conf]<span style="color: #008000;">#</span><span style="color: #008000;"> netstat -lntup |grep ng</span>
tcp        0      0 0.0.0.0:80           0.0.0.0:*       LISTEN      40714/nginx       </pre>
</div>

### <span id="456"><a name="_Toc496798056"></a><!--[if !supportLists]-->

<span lang="EN-US">4.5.6 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">查看配置文件的加载顺序</span></span>

<div class="cnblogs_code">
  <pre>[root@web01 logs]<span style="color: #008000;">#</span><span style="color: #008000;"> /application/nginx/sbin/nginx -T</span></pre>
</div>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">参数说明：</span>
</p>

<p class="MsoNormal">
  <span lang="EN-US">-T   : test configuration, dump it and exit</span>
</p>

<p class="MsoNormal">
  <span lang="EN-US">   </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">测试配置文件，并且加载一遍，并显示加载的顺序</span>
</p>

### <span id="457_inculdeconf"><a name="_Toc496798057"></a><!--[if !supportLists]-->

<span lang="EN-US">4.5.7 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; background: darkcyan; mso-highlight: darkcyan;">【优化】</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">调整</span><span lang="EN-US"> inculde</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">的加载顺序，指定第一个加载为</span><span lang="EN-US">conf</span></span>

<div class="cnblogs_code">
  <pre>[root@web01 conf]<span style="color: #008000;">#</span><span style="color: #008000;"> vim nginx.conf</span>
worker_processes  1<span style="color: #000000;">;
events {
    worker_connections  </span>1024<span style="color: #000000;">;
}
http {
    include       mime.types;
    default_type  application</span>/octet-<span style="color: #000000;">stream;
    sendfile        on;
    keepalive_timeout  </span>65<span style="color: #000000;">;
    include extra</span>/<span style="color: #000000;">www.conf;
    include extra</span>/<span style="color: #000000;">bbs.conf;
    include extra</span>/<span style="color: #000000;">blog.conf;
}</span></pre>
</div>

### <span id="458"><a name="_Toc496798058"></a><!--[if !supportLists]-->

<span lang="EN-US">4.5.8 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">重启服务</span></span>

<div class="cnblogs_code">
  <pre>[root@web01 conf]<span style="color: #008000;">#</span><span style="color: #008000;"> /application/nginx/sbin/nginx -t</span>
nginx: the configuration file /application/nginx-1.10.2/conf/nginx.conf syntax <span style="color: #0000ff;">is</span><span style="color: #000000;"> ok
nginx: configuration file </span>/application/nginx-1.10.2/conf/nginx.conf test <span style="color: #0000ff;">is</span><span style="color: #000000;"> successful
[root@web01 conf]</span><span style="color: #008000;">#</span><span style="color: #008000;"> /application/nginx/sbin/nginx -s reload</span></pre>
</div>

### <span id="459"><a name="_Toc496798059"></a><!--[if !supportLists]-->

<span lang="EN-US">4.5.9 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">说明</span><span lang="EN-US">;</span></span>

<p class="MsoNormal" style="margin-left: 42.0pt;">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">这样的配置能够让用户通过</span><span lang="EN-US">IP</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">访问的时候，访问到的网站是</span><span lang="EN-US">www</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">的网站。</span>
</p>

<h2 style="margin-top: 8.15pt; margin-right: 0cm; margin-bottom: 8.15pt; margin-left: 25.1pt; mso-list: l14 level2 lfo4;">
  <span id="46"><a name="_Toc496798060"></a><!--[if !supportLists]-->
  
  <span lang="EN-US">4.6 </span><!--[endif]-->
  
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">别名的配置</span></span>
</h2>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">在配置文件中添加别名</span>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 conf]<span style="color: #008000;">#</span><span style="color: #008000;"> vim extra/www.conf</span>
<span style="color: #000000;">    server {
        listen       </span>80<span style="color: #000000;">;
        server_name  www.nmtui.com nmtui.cn;
        location </span>/<span style="color: #000000;"> {
            root   html</span>/<span style="color: #000000;">www;
            index  index.html index.htm;
        }
        error_page   </span>500 502 503 504  /<span style="color: #000000;">50x.html;
        location </span>= /<span style="color: #000000;">50x.html {
            root   html;
        }
    }
}</span></pre>
</div>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">重启服务</span>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 conf]<span style="color: #008000;">#</span><span style="color: #008000;"> /application/nginx/sbin/nginx -s reload</span></pre>
</div>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">修改</span><span lang="EN-US">hosts </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">进行访问测试</span>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 www]<span style="color: #008000;">#</span><span style="color: #008000;"> curl  nmtui.cn</span>
web01 www</pre>
</div>

<h2 style="margin-top: 8.15pt; margin-right: 0cm; margin-bottom: 8.15pt; margin-left: 25.1pt; mso-list: l14 level2 lfo4;">
  <span id="47_status"><a name="_Toc496798061"></a><!--[if !supportLists]-->
  
  <span style="mso-fareast-font-family: 'Courier New'; mso-bidi-font-family: 'Courier New'; background: lime; mso-highlight: lime;" lang="EN-US">4.7 </span><!--[endif]-->
  
  <span style="background: lime; mso-highlight: lime;" lang="EN-US">status </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; background: lime; mso-highlight: lime;">状态模块</span></span>
</h2>

### <span id="471"><a name="_Toc496798062"></a><!--[if !supportLists]-->

<span lang="EN-US">4.7.1 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">状态模块的配置</span></span>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">修改配置文件，添加三</span><span lang="EN-US">status</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">模块</span>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 conf]<span style="color: #008000;">#</span><span style="color: #008000;"> vim nginx.conf</span>
worker_processes  1<span style="color: #000000;">;
events {
    worker_connections  </span>1024<span style="color: #000000;">;
}
http {
    include       mime.types;
    default_type  application</span>/octet-<span style="color: #000000;">stream;
    sendfile        on;
    keepalive_timeout  </span>65<span style="color: #000000;">;
          server{
          listen  </span>80<span style="color: #000000;">;
          server_name  status.nmtui.com;
          location </span>/<span style="color: #000000;"> {
            stub_status on;
            access_log   off;
          }
        }
    include extra</span>/<span style="color: #000000;">www.conf;
    include extra</span>/<span style="color: #000000;">bbs.conf;
    include extra</span>/<span style="color: #000000;">blog.conf;
}</span></pre>
</div>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">检查配置文件是否正确</span>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 conf]<span style="color: #008000;">#</span><span style="color: #008000;"> /application/nginx/sbin/nginx -t</span>
nginx: the configuration file /application/nginx-1.10.2/conf/nginx.conf syntax <span style="color: #0000ff;">is</span><span style="color: #000000;"> ok
nginx: configuration file </span>/application/nginx-1.10.2/conf/nginx.conf test <span style="color: #0000ff;">is</span> successful</pre>
</div>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">重启服务</span>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 conf]<span style="color: #008000;">#</span><span style="color: #008000;"> /application/nginx/sbin/nginx -s reload</span></pre>
</div>

<p class="MsoNormal">
  <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">访问测试</span></strong> 
</p>

<p class="MsoNormal" style="text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">说明：</span>
</p>

<p class="MsoNormal" style="text-indent: 21.0pt;">
   
</p>

<div class="cnblogs_code">
  <pre><span style="color: #000000;">以上页面内容信息主要会被zabbix监控服务调取，形成图像信息
根据图形信息，从而判断nginx网站服务用户访问量情况</span></pre>
</div>

<p class="MsoNormal" style="text-indent: 21.0pt;">
   
</p>

### <span id="472"><a name="_Toc496798063"></a><!--[if !supportLists]-->

<span lang="EN-US">4.7.2 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">状态模块说明</span></span>

<table class="MsoTable15Grid4Accent5" style="border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
  <tr>
    <td style="width: 169.85pt; border-top-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-top-color: #4bacc6; border-bottom-color: #4bacc6; border-left-color: #4bacc6; border-right: none; background: #4bacc6; padding: 0cm 5.4pt;" valign="top" width="226">
      <p class="MsoNormal" style="text-align: center; mso-yfti-cnfc: 5;" align="center">
        <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; color: white; mso-themecolor: background1;">参数</span></strong>
      </p>
    </td>
    
    <td style="width: 352.95pt; border-top-width: 1pt; border-right-width: 1pt; border-bottom-width: 1pt; border-top-color: #4bacc6; border-right-color: #4bacc6; border-bottom-color: #4bacc6; border-left: none; background: #4bacc6; padding: 0cm 5.4pt;" valign="top" width="471">
      <p class="MsoNormal" style="text-align: center; mso-yfti-cnfc: 1;" align="center">
        <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; color: white; mso-themecolor: background1;">参数说明</span></strong>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 169.85pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: #92cddc; border-bottom-color: #92cddc; border-left-color: #92cddc; border-top: none; background: #daeef3; padding: 0cm 5.4pt;" valign="top" width="226">
      <p class="MsoNormal">
        <strong><span lang="EN-US">Active connections</span></strong>
      </p>
    </td>
    
    <td style="width: 352.95pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: #92cddc; border-right-width: 1pt; border-right-color: #92cddc; background: #daeef3; padding: 0cm 5.4pt;" valign="top" width="471">
      <p class="MsoNormal">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">当前的活动客户端连接数量</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 169.85pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: #92cddc; border-bottom-color: #92cddc; border-left-color: #92cddc; border-top: none; padding: 0cm 5.4pt;" valign="top" width="226">
      <p class="MsoNormal">
        <strong><span lang="EN-US">accepts           </span></strong>
      </p>
    </td>
    
    <td style="width: 352.95pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: #92cddc; border-right-width: 1pt; border-right-color: #92cddc; padding: 0cm 5.4pt;" valign="top" width="471">
      <p class="MsoNormal">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">接受客户端连接的总数</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 169.85pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: #92cddc; border-bottom-color: #92cddc; border-left-color: #92cddc; border-top: none; background: #daeef3; padding: 0cm 5.4pt;" valign="top" width="226">
      <p class="MsoNormal">
        <strong><span lang="EN-US">handled           </span></strong>
      </p>
    </td>
    
    <td style="width: 352.95pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: #92cddc; border-right-width: 1pt; border-right-color: #92cddc; background: #daeef3; padding: 0cm 5.4pt;" valign="top" width="471">
      <p class="MsoNormal">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">处理的连接总数</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 169.85pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: #92cddc; border-bottom-color: #92cddc; border-left-color: #92cddc; border-top: none; padding: 0cm 5.4pt;" valign="top" width="226">
      <p class="MsoNormal">
        <strong><span lang="EN-US">requests          </span></strong>
      </p>
    </td>
    
    <td style="width: 352.95pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: #92cddc; border-right-width: 1pt; border-right-color: #92cddc; padding: 0cm 5.4pt;" valign="top" width="471">
      <p class="MsoNormal">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">客户端请求的总数</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 169.85pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: #92cddc; border-bottom-color: #92cddc; border-left-color: #92cddc; border-top: none; background: #daeef3; padding: 0cm 5.4pt;" valign="top" width="226">
      <p class="MsoNormal">
        <strong><span lang="EN-US">Reading           </span></strong>
      </p>
    </td>
    
    <td style="width: 352.95pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: #92cddc; border-right-width: 1pt; border-right-color: #92cddc; background: #daeef3; padding: 0cm 5.4pt;" valign="top" width="471">
      <p class="MsoNormal">
        <span lang="EN-US">nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">正在读请求头的当前连接数。</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 169.85pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: #92cddc; border-bottom-color: #92cddc; border-left-color: #92cddc; border-top: none; padding: 0cm 5.4pt;" valign="top" width="226">
      <p class="MsoNormal">
        <strong><span lang="EN-US">Writing           </span></strong>
      </p>
    </td>
    
    <td style="width: 352.95pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: #92cddc; border-right-width: 1pt; border-right-color: #92cddc; padding: 0cm 5.4pt;" valign="top" width="471">
      <p class="MsoNormal">
        <span lang="EN-US">nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">正在将响应写回客户端的当前连接数。</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 169.85pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: #92cddc; border-bottom-color: #92cddc; border-left-color: #92cddc; border-top: none; background: #daeef3; padding: 0cm 5.4pt;" valign="top" width="226">
      <p class="MsoNormal">
        <strong><span lang="EN-US">Waiting           </span></strong>
      </p>
    </td>
    
    <td style="width: 352.95pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: #92cddc; border-right-width: 1pt; border-right-color: #92cddc; background: #daeef3; padding: 0cm 5.4pt;" valign="top" width="471">
      <p class="MsoNormal">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">当前空闲客户端连接数等待一个请求。</span>
      </p>
    </td>
  </tr>
</table>

<h2 style="margin-top: 8.15pt; margin-right: 0cm; margin-bottom: 8.15pt; margin-left: 25.1pt; mso-list: l14 level2 lfo4;">
  <span id="48_nginx"><a name="_Toc496798064"></a><!--[if !supportLists]-->
  
  <span lang="EN-US">4.8 </span><!--[endif]-->
  
  <span lang="EN-US">nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">的日志功能</span></span>
</h2>

<p class="MsoNormal">
  <span lang="EN-US">nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">的两种日志种类</span>
</p>

<p class="MsoNormal" style="text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">错误日志：记录</span><span lang="EN-US">nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">运行错误情况信息</span>
</p>

<p class="MsoNormal" style="text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">访问日志：记录用户访问日志信息</span>
</p>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">官方说明： http://nginx.org/en/docs/ngx_core_module.html#error_log</span>
</p>

### <span id="481"><a name="_Toc496798065"></a><!--[if !supportLists]-->

<span lang="EN-US">4.8.1 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">定义错误日志信息</span></span>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">系统默认配置</span>
</p>

<div class="cnblogs_code">
  <pre><span style="color: #008000;">#</span><span style="color: #008000;">error_log  logs/error.log;</span><span style="color: #008000;">
#</span><span style="color: #008000;">error_log  logs/error.log  notice;</span><span style="color: #008000;">
#</span><span style="color: #008000;">error_log  logs/error.log  info;</span></pre>
</div>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">配置错误日志，修改主配置文件</span>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 logs]<span style="color: #008000;">#</span><span style="color: #008000;"> vim ../conf/nginx.conf</span>
worker_processes  1<span style="color: #000000;">;
error_log  logs</span>/<span style="color: #000000;">error.log  error;
events {
    worker_connections  </span>1024<span style="color: #000000;">;
}
http {
    include       mime.types;
    default_type  application</span>/octet-<span style="color: #000000;">stream;
    sendfile        on;
    keepalive_timeout  </span>65<span style="color: #000000;">;
          server{
          listen  </span>80<span style="color: #000000;">;
          server_name  status.nmtui.com;
          location </span>/<span style="color: #000000;"> {
            stub_status on;
            access_log   off;
          }
        }
    include extra</span>/<span style="color: #000000;">www.conf;
    include extra</span>/<span style="color: #000000;">bbs.conf;
    include extra</span>/<span style="color: #000000;">blog.conf;
}</span></pre>
</div>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">重启服务</span>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 logs]<span style="color: #008000;">#</span><span style="color: #008000;"> /application/nginx/sbin/nginx -t</span>
nginx: the configuration file /application/nginx-1.10.2/conf/nginx.conf syntax <span style="color: #0000ff;">is</span><span style="color: #000000;"> ok
nginx: configuration file </span>/application/nginx-1.10.2/conf/nginx.conf test <span style="color: #0000ff;">is</span><span style="color: #000000;"> successful
[root@web01 logs]</span><span style="color: #008000;">#</span><span style="color: #008000;"> /application/nginx/sbin/nginx -s reload</span></pre>
</div>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">查看错误日志信息</span>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 logs]<span style="color: #008000;">#</span><span style="color: #008000;"> tail  error.log</span>
2017/10/25 11:41:55 [error] 40842<span style="color: #008000;">#</span><span style="color: #008000;">0: *7 open() "/application/nginx-1.10.2/html/www/favicon.ico" failed (2: No such file or directory), client: 10.0.0.1, server: www.nmtui.com, request: "GET /favicon.ico HTTP/1.1", host: "www.nmtui.com", referrer: "http://www.nmtui.com/"</span></pre>
</div>

### <span id="482"><a name="_Toc496798066"></a><!--[if !supportLists]-->

<span lang="EN-US">4.8.2 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">访问日志配置</span></span>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">系统默认配置</span>
</p>

<div class="cnblogs_code">
  <pre><span style="color: #008000;">#</span><span style="color: #008000;">log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '</span><span style="color: #008000;">
#</span><span style="color: #008000;">                  '$status $body_bytes_sent "$http_referer" '</span><span style="color: #008000;">
#</span><span style="color: #008000;">                  '"$http_user_agent" "$http_x_forwarded_for"';</span>
 
<span style="color: #008000;">#</span><span style="color: #008000;">access_log  logs/access.log  main;</span></pre>
</div>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">修改访问日志配置</span><span lang="EN-US">--</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">修改主配置文件</span>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 www]<span style="color: #008000;">#</span><span style="color: #008000;"> cat ../../conf/nginx.conf</span>
worker_processes  1<span style="color: #000000;">;
error_log  logs</span>/<span style="color: #000000;">error.log  error;
events {
    worker_connections  </span>1024<span style="color: #000000;">;
}
http {
    include       mime.types;
    default_type  application</span>/octet-<span style="color: #000000;">stream;
    sendfile        on;
    keepalive_timeout  </span>65<span style="color: #000000;">;
    log_format  main  </span><span style="color: #800000;">'</span><span style="color: #800000;">$remote_addr - $remote_user [$time_local] "$request" </span><span style="color: #800000;">'</span>
                  <span style="color: #800000;">'</span><span style="color: #800000;">$status $body_bytes_sent "$http_referer" </span><span style="color: #800000;">'</span>
                  <span style="color: #800000;">'</span><span style="color: #800000;">"$http_user_agent" "$http_x_forwarded_for"</span><span style="color: #800000;">'</span><span style="color: #000000;">;
 
          server{
          listen  </span>80<span style="color: #000000;">;
          server_name  status.nmtui.com;
          location </span>/<span style="color: #000000;"> {
            stub_status on;
            access_log   off;
          }
        }
    include extra</span>/<span style="color: #000000;">www.conf;
    include extra</span>/<span style="color: #000000;">bbs.conf;
    include extra</span>/<span style="color: #000000;">blog.conf;
}</span></pre>
</div>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">修改访问日志配置</span><span lang="EN-US">--</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">修改虚拟主机配置文件</span>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 www]<span style="color: #008000;">#</span><span style="color: #008000;"> cat /application/nginx/conf/extra/www.conf</span>
<span style="color: #000000;">    server {
        listen       </span>80<span style="color: #000000;">;
        server_name  www.nmtui.com nmtui.cn;
        location </span>/<span style="color: #000000;"> {
            root   html</span>/<span style="color: #000000;">www;
            index  index.html index.htm;
        }
　　　　 access_log  logs</span>/<span style="color: #000000;">access_www.log  main;
        error_page   </span>500 502 503 504  /<span style="color: #000000;">50x.html;
        location </span>= /<span style="color: #000000;">50x.html {
            root   html;
        }
    }</span></pre>
</div>

### <span id="483"><a name="_Toc496798067"></a><!--[if !supportLists]-->

<span lang="EN-US">4.8.3 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; color: red;">【重要】</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">访问日志信息说明</span></span>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">日志内容</span>
</p>

<div class="cnblogs_code">
  <pre>10.0.0.1 - - [22/Oct/2017:16:04:54 +0800] <span style="color: #800000;">"</span><span style="color: #800000;">GET / HTTP/1.1</span><span style="color: #800000;">"</span> 304 0 <span style="color: #800000;">"</span><span style="color: #800000;">-</span><span style="color: #800000;">"</span> <span style="color: #800000;">"</span><span style="color: #800000;">Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/61.0.3163.100 Safari/537.36</span><span style="color: #800000;">"</span> <span style="color: #800000;">"</span><span style="color: #800000;">-</span><span style="color: #800000;">"</span></pre>
</div>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">配置文件</span>
</p>

<div class="cnblogs_code">
  <pre><span style="color: #800000;">'</span><span style="color: #800000;">$remote_addr - $remote_user [$time_local] "$request" </span><span style="color: #800000;">'</span>
<span style="color: #800000;">'</span><span style="color: #800000;">$status $body_bytes_sent "$http_referer" </span><span style="color: #800000;">'</span>
<span style="color: #800000;">'</span><span style="color: #800000;">"$http_user_agent" "$http_x_forwarded_for"</span><span style="color: #800000;">'</span>;</pre>
</div>

<p class="MsoNormal">
  <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; background: lime; mso-highlight: lime;">日志信息说明</span></strong>
</p>

<table class="MsoTable15Grid5DarkAccent5" style="border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
  <tr>
    <td style="width: 162.05pt; border-top-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-top-color: white; border-bottom-color: white; border-left-color: white; border-right: none; background: #4bacc6; padding: 0cm 5.4pt;" valign="top" width="216">
      <p class="MsoNormal" style="text-align: center; mso-yfti-cnfc: 5;" align="center">
        <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; color: white; mso-themecolor: background1;">参数</span></strong>
      </p>
    </td>
    
    <td style="width: 226.35pt; border-top-width: 1pt; border-top-color: white; border-left: none; border-bottom-width: 1pt; border-bottom-color: white; border-right: none; background: #4bacc6; padding: 0cm 5.4pt;" valign="top" width="302">
      <p class="MsoNormal" style="text-align: center; mso-yfti-cnfc: 1;" align="center">
        <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; color: white; mso-themecolor: background1;">日志内容</span></strong>
      </p>
    </td>
    
    <td style="width: 134.4pt; border-top-width: 1pt; border-right-width: 1pt; border-bottom-width: 1pt; border-top-color: white; border-right-color: white; border-bottom-color: white; border-left: none; background: #4bacc6; padding: 0cm 5.4pt;" valign="top" width="179">
      <p class="MsoNormal" style="text-align: center; mso-yfti-cnfc: 1;" align="center">
        <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; color: white; mso-themecolor: background1;">含义</span></strong>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 162.05pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: white; border-bottom-color: white; border-left-color: white; border-top: none; background: #00b0f0; padding: 0cm 5.4pt;" width="216">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph; mso-yfti-cnfc: 68;">
        <strong><span lang="EN-US">$remote_addr</span></strong>
      </p>
    </td>
    
    <td style="width: 226.35pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: white; border-right-width: 1pt; border-right-color: white; background: #b6dde8; padding: 0cm 5.4pt;" valign="top" width="302">
      <p class="MsoNormal">
        <span lang="EN-US">10.0.0.1</span>
      </p>
    </td>
    
    <td style="width: 134.4pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: white; border-right-width: 1pt; border-right-color: white; background: #b6dde8; padding: 0cm 5.4pt;" valign="top" width="179">
      <p class="MsoNormal">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">客户端</span><span lang="EN-US">ip</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">地址</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 162.05pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: white; border-bottom-color: white; border-left-color: white; border-top: none; background: #00b0f0; padding: 0cm 5.4pt;" width="216">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph; mso-yfti-cnfc: 4;">
        <strong><span lang="EN-US">-</span></strong>
      </p>
    </td>
    
    <td style="width: 226.35pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: white; border-right-width: 1pt; border-right-color: white; background: #daeef3; padding: 0cm 5.4pt;" valign="top" width="302">
      <p class="MsoNormal">
        <span lang="EN-US">-</span>
      </p>
    </td>
    
    <td style="width: 134.4pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: white; border-right-width: 1pt; border-right-color: white; background: #daeef3; padding: 0cm 5.4pt;" valign="top" width="179">
      <p class="MsoNormal">
        <span lang="EN-US"> </span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 162.05pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: white; border-bottom-color: white; border-left-color: white; border-top: none; background: #00b0f0; padding: 0cm 5.4pt;" width="216">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph; mso-yfti-cnfc: 68;">
        <strong><span lang="EN-US">$remote_user</span></strong>
      </p>
    </td>
    
    <td style="width: 226.35pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: white; border-right-width: 1pt; border-right-color: white; background: #b6dde8; padding: 0cm 5.4pt;" valign="top" width="302">
      <p class="MsoNormal">
        <span lang="EN-US">-</span>
      </p>
    </td>
    
    <td style="width: 134.4pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: white; border-right-width: 1pt; border-right-color: white; background: #b6dde8; padding: 0cm 5.4pt;" valign="top" width="179">
      <p class="MsoNormal">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">显示远程访问者用户信息</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 162.05pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: white; border-bottom-color: white; border-left-color: white; border-top: none; background: #00b0f0; padding: 0cm 5.4pt;" width="216">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph; mso-yfti-cnfc: 4;">
        <strong><span lang="EN-US">[$time_local]</span></strong>
      </p>
    </td>
    
    <td style="width: 226.35pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: white; border-right-width: 1pt; border-right-color: white; background: #daeef3; padding: 0cm 5.4pt;" valign="top" width="302">
      <p class="MsoNormal">
        <span lang="EN-US">[22/Oct/2017:16:04:54 +0800]</span>
      </p>
    </td>
    
    <td style="width: 134.4pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: white; border-right-width: 1pt; border-right-color: white; background: #daeef3; padding: 0cm 5.4pt;" valign="top" width="179">
      <p class="MsoNormal">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">显示访问时间</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 162.05pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: white; border-bottom-color: white; border-left-color: white; border-top: none; background: #00b0f0; padding: 0cm 5.4pt;" width="216">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph; mso-yfti-cnfc: 68;">
        <strong><span lang="EN-US">$request</span></strong>
      </p>
    </td>
    
    <td style="width: 226.35pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: white; border-right-width: 1pt; border-right-color: white; background: #b6dde8; padding: 0cm 5.4pt;" valign="top" width="302">
      <p class="MsoNormal">
        <span lang="EN-US">GET / HTTP/1.1"</span>
      </p>
    </td>
    
    <td style="width: 134.4pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: white; border-right-width: 1pt; border-right-color: white; background: #b6dde8; padding: 0cm 5.4pt;" valign="top" width="179">
      <p class="MsoNormal">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">请求行信息</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 162.05pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: white; border-bottom-color: white; border-left-color: white; border-top: none; background: #00b0f0; padding: 0cm 5.4pt;" width="216">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph; mso-yfti-cnfc: 4;">
        <strong><span lang="EN-US">$status</span></strong>
      </p>
    </td>
    
    <td style="width: 226.35pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: white; border-right-width: 1pt; border-right-color: white; background: #daeef3; padding: 0cm 5.4pt;" valign="top" width="302">
      <p class="MsoNormal">
        <span lang="EN-US">304</span>
      </p>
    </td>
    
    <td style="width: 134.4pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: white; border-right-width: 1pt; border-right-color: white; background: #daeef3; padding: 0cm 5.4pt;" valign="top" width="179">
      <p class="MsoNormal">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">状态码</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 162.05pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: white; border-bottom-color: white; border-left-color: white; border-top: none; background: #00b0f0; padding: 0cm 5.4pt;" width="216">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph; mso-yfti-cnfc: 68;">
        <strong><span lang="EN-US">$body_bytes_sent</span></strong>
      </p>
    </td>
    
    <td style="width: 226.35pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: white; border-right-width: 1pt; border-right-color: white; background: #b6dde8; padding: 0cm 5.4pt;" valign="top" width="302">
      <p class="MsoNormal">
        <span lang="EN-US"></span>
      </p>
    </td>
    
    <td style="width: 134.4pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: white; border-right-width: 1pt; border-right-color: white; background: #b6dde8; padding: 0cm 5.4pt;" valign="top" width="179">
      <p class="MsoNormal">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">响应报文主体内容大小</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 162.05pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: white; border-bottom-color: white; border-left-color: white; border-top: none; background: #00b0f0; padding: 0cm 5.4pt;" width="216">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph; mso-yfti-cnfc: 4;">
        <strong><span lang="EN-US">$http_referer</span></strong>
      </p>
    </td>
    
    <td style="width: 226.35pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: white; border-right-width: 1pt; border-right-color: white; background: #daeef3; padding: 0cm 5.4pt;" valign="top" width="302">
      <p class="MsoNormal">
        <span lang="EN-US">-</span>
      </p>
    </td>
    
    <td style="width: 134.4pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: white; border-right-width: 1pt; border-right-color: white; background: #daeef3; padding: 0cm 5.4pt;" valign="top" width="179">
      <p class="MsoNormal">
        <span lang="EN-US"> </span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 162.05pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: white; border-bottom-color: white; border-left-color: white; border-top: none; background: #00b0f0; padding: 0cm 5.4pt;" width="216">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph; mso-yfti-cnfc: 68;">
        <strong><span lang="EN-US">$http_user_agent</span></strong>
      </p>
    </td>
    
    <td style="width: 226.35pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: white; border-right-width: 1pt; border-right-color: white; background: #b6dde8; padding: 0cm 5.4pt;" valign="top" width="302">
      <p class="MsoNormal">
        <span lang="EN-US">Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/61.0.3163.100 Safari/537.36</span>
      </p>
    </td>
    
    <td style="width: 134.4pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: white; border-right-width: 1pt; border-right-color: white; background: #b6dde8; padding: 0cm 5.4pt;" valign="top" width="179">
      <p class="MsoNormal">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">客户端浏览网页工具信息</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 162.05pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: white; border-bottom-color: white; border-left-color: white; border-top: none; background: #00b0f0; padding: 0cm 5.4pt;" width="216">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph; mso-yfti-cnfc: 4;">
        <strong><span lang="EN-US">$http_x_forwarded_for</span></strong>
      </p>
    </td>
    
    <td style="width: 226.35pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: white; border-right-width: 1pt; border-right-color: white; background: #daeef3; padding: 0cm 5.4pt;" valign="top" width="302">
      <p class="MsoNormal">
        <span lang="EN-US">-</span>
      </p>
    </td>
    
    <td style="width: 134.4pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: white; border-right-width: 1pt; border-right-color: white; background: #daeef3; padding: 0cm 5.4pt;" valign="top" width="179">
      <p class="MsoNormal">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">反向代理转发</span>
      </p>
    </td>
  </tr>
</table>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">详细日志详细说明</span>
</p>

<table class="MsoTableGrid" style="border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
  <tr>
    <td style="width: 162.8pt; border-width: 1pt; border-color: windowtext; background: #a6a6a6; padding: 0cm 5.4pt;" width="217">
      <p class="MsoNormal" style="text-align: center;" align="center">
        <strong><span lang="EN-US">Nginx</span></strong><strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">日志变量</span></strong>
      </p>
    </td>
    
    <td style="width: 360pt; border-top-width: 1pt; border-right-width: 1pt; border-bottom-width: 1pt; border-top-color: windowtext; border-right-color: windowtext; border-bottom-color: windowtext; border-left: none; background: #a6a6a6; padding: 0cm 5.4pt;" width="480">
      <p class="MsoNormal" style="text-align: center;" align="center">
        <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">说明</span></strong>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 162.8pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" width="217">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
        <span lang="EN-US">$remote_addr</span>
      </p>
    </td>
    
    <td style="width: 360pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="480">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">记录访问网站的客户端地址；即源</span><span lang="EN-US">IP</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">地址</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 162.8pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" width="217">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
        <span lang="EN-US">$http_x_forwarded_for</span>
      </p>
    </td>
    
    <td style="width: 360pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="480">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">当前端有代理服务器时，设置</span><span lang="EN-US">web</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">节点记录客户端地址的配置，此参数生效的</span>
      </p>
      
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">前提是代理服务器上也进行了相关的</span><span lang="EN-US">x_forwarded_for</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">设置</span>
      </p>
      
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">可以记录用户真实的</span><span lang="EN-US">IP</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">地址信息</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 162.8pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" width="217">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
        <span lang="EN-US">$remote_user</span>
      </p>
    </td>
    
    <td style="width: 360pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="480">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">远程客户端用户名称</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 162.8pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" width="217">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
        <span lang="EN-US">$time_local</span>
      </p>
    </td>
    
    <td style="width: 360pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="480">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">记录访问时间与时区</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 162.8pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" width="217">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
        <span lang="EN-US">$request</span>
      </p>
    </td>
    
    <td style="width: 360pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="480">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">用户的</span><span lang="EN-US">http</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">请求起始行信息</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 162.8pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" width="217">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
        <span lang="EN-US">$status</span>
      </p>
    </td>
    
    <td style="width: 360pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="480">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
        <span lang="EN-US">http</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">状态码，记录请求返回的状态，例如：</span><span lang="EN-US">200 , 404 , 301</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">等</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 162.8pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" width="217">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
        <span lang="EN-US">$body_bytes_sents</span>
      </p>
    </td>
    
    <td style="width: 360pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="480">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">服务器发送给客户端的响应</span><span lang="EN-US">body</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">字节数</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 162.8pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" width="217">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
        <span lang="EN-US">$http_referer</span>
      </p>
    </td>
    
    <td style="width: 360pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="480">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">记录此次请求是从哪个链接访问过来的，可以根据</span><span lang="EN-US">referer</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">进行防盗链设置</span>
      </p>
      
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">即表示是哪个网站介绍过来的</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 162.8pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" width="217">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
        <span lang="EN-US">$http_user_agent</span>
      </p>
    </td>
    
    <td style="width: 360pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="480">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">记录客户端访问信息，例如：浏览器、手机客户端等</span>
      </p>
    </td>
  </tr>
</table>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">在没有特殊要求的情况下，采用默认的配置即可，更多可以设置的记录日志信息的变量见：http://nginx.org/en/docs/http/ngx_httpJog_module.html1</span>
</p>

### <span id="484"><a name="_Toc496798068"></a><!--[if !supportLists]-->

<span lang="EN-US">4.8.4 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">日志的切割</span></span>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">切割日志方式</span>
</p>

<p class="MsoNormal">
  <span style="background: lime; mso-highlight: lime;" lang="EN-US">01</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; background: lime; mso-highlight: lime;">：利用脚本实现日志切割</span>
</p>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">简单脚本</span>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 logs]<span style="color: #008000;">#</span><span style="color: #008000;"> cat /server/scripts/log_cut.sh</span><span style="color: #008000;">
#</span><span style="color: #008000;">!/bin/bash</span>
<span style="color: #000000;"> 
mv </span>/application/nginx/logs/access_www.log  /application/nginx/logs/access_www_`date +%<span style="color: #000000;">F`.log
</span>/application/nginx/sbin/nginx -s reload</pre>
</div>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">包含判断的脚本</span>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 logs]<span style="color: #008000;">#</span><span style="color: #008000;"> cat /server/script/cut_nginx_log.sh</span><span style="color: #008000;">
#</span><span style="color: #008000;"> ! /bin/sh</span>
Dateformat=<span style="color: #800000;">'</span><span style="color: #800000;">date +%Y%m%d</span><span style="color: #800000;">'</span><span style="color: #000000;">
Basedir</span>= <span style="color: #800000;">"</span><span style="color: #800000;">/application/nginx</span><span style="color: #800000;">"</span><span style="color: #000000;">
Nginxlogdir</span>=<span style="color: #800000;">"</span><span style="color: #800000;">$Basedir/logs</span><span style="color: #800000;">"</span><span style="color: #000000;">
Logname</span>=<span style="color: #800000;">"</span><span style="color: #800000;">access_www</span><span style="color: #800000;">"</span><span style="color: #000000;">
[</span>-d $Nginxlogdir ] && cd $Nginxlogdir || exit 1<span style="color: #000000;">
[</span>-f ${Logname}.log ] || exit 1
/bin/<span style="color: #000000;">mv ${Logname}.log ${Dateformat}_${Logname}.log
$Basedir</span>/sbin/nginx -s reload</pre>
</div>

<p class="MsoNormal">
  <span style="background: lime; mso-highlight: lime;" lang="EN-US">02.</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; background: lime; mso-highlight: lime;">利用系统自带切割软件进行切割</span>
</p>

<div class="cnblogs_code">
  <pre>cat /etc/logrotate.conf</pre>
</div>

<h2 style="margin-top: 8.15pt; margin-right: 0cm; margin-bottom: 8.15pt; margin-left: 25.1pt; mso-list: l14 level2 lfo4;">
  <span id="49_location"><a name="_Toc496798069"></a><!--[if !supportLists]-->
  
  <span lang="EN-US">4.9 </span><!--[endif]-->
  
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">企业需求解决（</span><span lang="EN-US">location</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">应用）</span></span>
</h2>

<p class="MsoNormal">
  <span lang="EN-US">   1</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">、搭建好一台</span><span lang="EN-US">nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">的</span><span lang="EN-US">web</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">服务器，配置好内网网卡地址与外网网卡地址</span>
</p>

<p class="MsoNormal">
  <span lang="EN-US">   2</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">、</span><span lang="EN-US">web</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">服务器的网站域名为</span><span lang="EN-US">www.nmtui.com </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">站点目录为</span><span lang="EN-US"> html/www</span>
</p>

<p class="MsoNormal">
  <span lang="EN-US">   3</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">、要求内网可以访问</span><span lang="EN-US"> www.nmtui.com/AV </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">资源</span>
</p>

<p class="MsoNormal">
  <span lang="EN-US">   4</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">、要求外网不可以访问</span><span lang="EN-US"> www.nmtui.com/AV </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">资源</span>
</p>

### <span id="491_--location"><a name="_Toc496798070"></a><a name="_Toc496466443"></a><!--[if !supportLists]-->

<span lang="EN-US">4.9.1 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">需求处理</span> <span lang="EN-US">--location</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">的应用</span></span>

<p class="MsoNormal" style="margin-left: 7.1pt;">
  <span lang="EN-US">1</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">、定位需要控制的资源</span>
</p>

<p class="MsoNormal" style="margin-left: 7.1pt;">
  <span lang="EN-US">     location == if</span>
</p>

<p class="MsoNormal" style="margin-left: 7.1pt;">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">修改配置文件</span>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 extra]<span style="color: #008000;">#</span><span style="color: #008000;"> cat www.conf</span>
<span style="color: #000000;">    server {
        listen       </span>80<span style="color: #000000;">;
        server_name  www.nmtui.com;
        location </span>/<span style="color: #000000;"> {
            root   html</span>/<span style="color: #000000;">www;
            index  index.html index.htm;
        }
        location </span>/<span style="color: #000000;">AV  {
            root  html</span>/<span style="color: #000000;">www;
            index index.html index.htm;
            allow </span>172.16.1.0/24<span style="color: #000000;">;
            deny  all;
        }
    }</span></pre>
</div>

### <span id="492_location"><a name="_Toc496798071"></a><a name="_Toc496466444"></a><!--[if !supportLists]-->

<span lang="EN-US">4.9.2 </span><!--[endif]-->

<span lang="EN-US">location </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">语法</span></span>

<p class="MsoNormal">
  <span lang="EN-US">location </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">指令的作用是根据用户请求的</span><span lang="EN-US">URI</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">来执行不同的应用。</span>
</p>

<p class="MsoNormal" style="margin-left: 7.1pt;">
  <span lang="EN-US">locationn</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">使用的语法为</span>
</p>

<div class="cnblogs_code">
  <pre>location [=|~|~*|^~<span style="color: #000000;">] uri {
  ....
}</span></pre>
</div>

<p class="MsoNormal">
  <span lang="EN-US">location </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">语法说明表</span>
</p>

<div align="center">
  <table class="MsoTableGrid" style="width: 100%; border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
    <tr style="mso-yfti-irow: 0; mso-yfti-firstrow: yes; height: 27.5pt;">
      <td style="width: 16.62%; border-width: 1pt; border-color: windowtext; background: #a6a6a6; padding: 0cm 5.4pt; height: 27.5pt;" width="16%">
        <p class="MsoNormal" style="text-align: center;" align="center">
          <strong><span lang="EN-US">location</span></strong>
        </p>
      </td>
      
      <td style="width: 21.88%; border-top-width: 1pt; border-right-width: 1pt; border-bottom-width: 1pt; border-top-color: windowtext; border-right-color: windowtext; border-bottom-color: windowtext; border-left: none; background: #a6a6a6; padding: 0cm 5.4pt; height: 27.5pt;" width="21%">
        <p class="MsoNormal" style="text-align: center;" align="center">
          <strong><span lang="EN-US">[=|~|~*|^~]</span></strong>
        </p>
      </td>
      
      <td style="width: 23.02%; border-top-width: 1pt; border-right-width: 1pt; border-bottom-width: 1pt; border-top-color: windowtext; border-right-color: windowtext; border-bottom-color: windowtext; border-left: none; background: #a6a6a6; padding: 0cm 5.4pt; height: 27.5pt;" width="23%">
        <p class="MsoNormal" style="text-align: center;" align="center">
          <strong><span lang="EN-US">uri</span></strong>
        </p>
      </td>
      
      <td style="width: 38.48%; border-top-width: 1pt; border-right-width: 1pt; border-bottom-width: 1pt; border-top-color: windowtext; border-right-color: windowtext; border-bottom-color: windowtext; border-left: none; background: #a6a6a6; padding: 0cm 5.4pt; height: 27.5pt;" width="38%">
        <p class="MsoNormal" style="text-align: center;" align="center">
          <strong><span lang="EN-US">{....}</span></strong>
        </p>
      </td>
    </tr>
    
    <tr>
      <td style="width: 16.62%; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" valign="top" width="16%">
        <p class="MsoNormal" style="text-align: center;" align="center">
          <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">指令</span>
        </p>
      </td>
      
      <td style="width: 21.88%; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" valign="top" width="21%">
        <p class="MsoNormal" style="text-align: center;" align="center">
          <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">匹配标识</span>
        </p>
      </td>
      
      <td style="width: 23.02%; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" valign="top" width="23%">
        <p class="MsoNormal" style="text-align: center;" align="center">
          <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">匹配的网站地址</span>
        </p>
      </td>
      
      <td style="width: 38.48%; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" valign="top" width="38%">
        <p class="MsoNormal" style="text-align: center;" align="center">
          <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">匹配</span><span lang="EN-US">URI</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">后要执行的配置段</span>
        </p>
      </td>
    </tr>
  </table>
</div>

<p class="MsoNormal">
  <span lang="EN-US"> </span>
</p>

<p class="MsoNormal">
  <strong><span lang="EN-US">~ </span></strong><strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">与</span><span lang="EN-US">~* </span></strong><strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">的区别</span></strong>
</p>

<p class="MsoListParagraph" style="margin-left: 42.0pt; text-indent: -21.0pt; mso-list: l17 level1 lfo20;">
  <!--[if !supportLists]-->
  
  <span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;" lang="EN-US">u<span style="font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span><!--[endif]-->
  
  <span lang="EN-US">~  </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">匹配内容区分大小写</span>
</p>

<p class="MsoListParagraph" style="margin-left: 42.0pt; text-indent: -21.0pt; mso-list: l17 level1 lfo20;">
  <!--[if !supportLists]-->
  
  <span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;" lang="EN-US">u<span style="font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span><!--[endif]-->
  
  <span lang="EN-US">~* </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">匹配内容不区分的小写</span>
</p>

<p class="MsoListParagraph" style="margin-left: 42.0pt; text-indent: -21.0pt; mso-list: l17 level1 lfo20;">
  <!--[if !supportLists]-->
  
  <span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;" lang="EN-US">u<span style="font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span><!--[endif]-->
  
  <span lang="EN-US">!~ </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">取反</span>
</p>

<p class="MsoListParagraph" style="margin-left: 42.0pt; text-indent: -21.0pt; mso-list: l17 level1 lfo20;">
  <!--[if !supportLists]-->
  
  <span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;" lang="EN-US">u<span style="font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span><!--[endif]-->
  
  <span lang="EN-US">^~ </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">但多个匹配同时存在，优先匹配</span><span lang="EN-US"> ^~</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">匹配的内容</span><span lang="EN-US">;</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">不做正则表达式的检查</span> <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">（优先处理）</span>
</p>

### <span id="493"><a name="_Toc496798072"></a><a name="_Toc496466445"></a><!--[if !supportLists]-->

<span lang="EN-US">4.9.3 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">官方配置示例</span></span>

<div class="cnblogs_code">
  <pre>location = /<span style="color: #000000;"> {
    [ configuration A ]
}
 
location </span>/<span style="color: #000000;"> {
    [ configuration B ]
}
 
location </span>/documents/<span style="color: #000000;"> {
    [ configuration C ]
}
 
location </span>^~ /images/<span style="color: #000000;"> {
    [ configuration D ]
}
 
location </span>~* \.(gif|jpg|<span style="color: #000000;">jpeg)$ {
    [ configuration E ]
}</span></pre>
</div>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">说明：</span>
</p>

<div style="mso-element: para-border-div; border: solid windowtext 2.0pt; padding: 1.0pt 4.0pt 1.0pt 4.0pt; mso-border-shadow: yes; background: #F2F2F2; mso-shading: windowtext; mso-pattern: gray-5 auto; margin-left: 42.5pt; margin-right: 55.45pt;">
  <p class="a3" style="margin: 1pt 0cm; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">
    <span lang="EN-US">"/"</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">请求将匹配配置</span><span lang="EN-US">A</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">，</span>
  </p>
  
  <p class="a3" style="margin: 1pt 0cm; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">
    <span lang="EN-US">"/index.html"</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">请求将匹配配置</span><span lang="EN-US">B</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">，</span>
  </p>
  
  <p class="a3" style="margin: 1pt 0cm; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">
    <span lang="EN-US">"/documents/document.html"</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">请求将匹配配置</span><span lang="EN-US">C</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">，</span>
  </p>
  
  <p class="a3" style="margin: 1pt 0cm; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">
    <span lang="EN-US">"/images/1.gif"</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">请求将匹配配置</span><span lang="EN-US">D</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">，</span>
  </p>
  
  <p class="a3" style="margin: 1pt 0cm; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">
    <span lang="EN-US">"/documents/1.jpg"</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">请求将匹配配置</span><span lang="EN-US">E.</span>
  </p>
</div>

<p class="MsoNormal">
  <span lang="EN-US"> </span>
</p>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">不同</span><span lang="EN-US">uri</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">及特殊字符组合匹配的顺序说明</span>
</p>

<table class="MsoTableGrid" style="border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
  <tr>
    <td style="width: 35.2pt; border-width: 1pt; border-color: windowtext; background: #a6a6a6; padding: 0cm 5.4pt;" width="47">
      <p class="MsoNormal" style="text-align: center;" align="center">
        <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">顺序</span></strong>
      </p>
    </td>
    
    <td style="width: 241pt; border-top-width: 1pt; border-right-width: 1pt; border-bottom-width: 1pt; border-top-color: windowtext; border-right-color: windowtext; border-bottom-color: windowtext; border-left: none; background: #a6a6a6; padding: 0cm 5.4pt;" width="321">
      <p class="MsoNormal" style="text-align: center;" align="center">
        <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">不用</span><span lang="EN-US">URI</span></strong><strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">及特殊字符组合匹配</span></strong>
      </p>
    </td>
    
    <td style="width: 246.6pt; border-top-width: 1pt; border-right-width: 1pt; border-bottom-width: 1pt; border-top-color: windowtext; border-right-color: windowtext; border-bottom-color: windowtext; border-left: none; background: #a6a6a6; padding: 0cm 5.4pt;" width="329">
      <p class="MsoNormal" style="text-align: center;" align="center">
        <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">匹配说明</span></strong>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 35.2pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" width="47">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
        <span lang="EN-US">1</span>
      </p>
    </td>
    
    <td style="width: 241pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="321">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
        <span lang="EN-US">location = / {}</span>
      </p>
    </td>
    
    <td style="width: 246.6pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="329">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">精确匹配</span><span lang="EN-US"> /</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 35.2pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" width="47">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
        <span lang="EN-US">2</span>
      </p>
    </td>
    
    <td style="width: 241pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="321">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
        <span lang="EN-US">location ^~ /image/{</span>
      </p>
    </td>
    
    <td style="width: 246.6pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="329">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">匹配常规字符串，不做正则表达式匹配检查</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 35.2pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" width="47">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
        <span lang="EN-US">3</span>
      </p>
    </td>
    
    <td style="width: 241pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="321">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
        <span lang="EN-US">location ~* \.(gif|jpg|jpeg)$ {</span>
      </p>
    </td>
    
    <td style="width: 246.6pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="329">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">正则匹配</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 35.2pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" width="47">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
        <span lang="EN-US">4</span>
      </p>
    </td>
    
    <td style="width: 241pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="321">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
        <span lang="EN-US">location /documents/ {</span>
      </p>
    </td>
    
    <td style="width: 246.6pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="329">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">匹配常规字符串，如果有正则，则优先匹配正则</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 35.2pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" width="47">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
        <span lang="EN-US">5</span>
      </p>
    </td>
    
    <td style="width: 241pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="321">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
        <span lang="EN-US">location / {</span>
      </p>
    </td>
    
    <td style="width: 246.6pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="329">
      <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">所有</span><span lang="EN-US">location </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">都不能匹配后的默认匹配</span>
      </p>
    </td>
  </tr>
</table>

### <span id="494_location"><a name="_Toc496798073"></a><!--[if !supportLists]-->

<span lang="EN-US">4.9.4 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">【测试】测试</span><span lang="EN-US">location</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">的访问</span></span>

#### <span id="4941"><!--[if !supportLists]-->

<strong><span lang="EN-US">4.9.4.1<span style="font-variant-numeric: normal; font-weight: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span></strong><!--[endif]-->

<strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">修改配置文件</span></strong></span>

<p class="MsoNormal" style="margin-left: 15.75pt;">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">定义不同的</span><span lang="EN-US">location</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">返回不同的数值</span>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 extra]<span style="color: #008000;">#</span><span style="color: #008000;"> vim www.conf</span>
<span style="color: #000000;">server {
    listen       </span>80<span style="color: #000000;">;
    server_name  www.nmtui.com nmtui.com;
    root   html</span>/<span style="color: #000000;">www;
    location </span>/<span style="color: #000000;"> {
       </span><span style="color: #0000ff;">return</span> 401<span style="color: #000000;">;
    }
    location </span>= /<span style="color: #000000;"> {
        </span><span style="color: #0000ff;">return</span> 402<span style="color: #000000;">;
    }
    location </span>/documents/<span style="color: #000000;"> {
        </span><span style="color: #0000ff;">return</span> 403<span style="color: #000000;">;
    }
    location </span>^~ /images/<span style="color: #000000;"> {
        </span><span style="color: #0000ff;">return</span> 404<span style="color: #000000;">;
    }
    location </span>~* \.（gif|jpg|<span style="color: #000000;">jpeg）$ {
    </span><span style="color: #0000ff;">return</span> 500<span style="color: #000000;">;
    }
    access_log logs</span>/<span style="color: #000000;">access_www.log main;
}</span></pre>
</div>

#### <span id="4942"><!--[if !supportLists]-->

<strong><span lang="EN-US">4.9.4.2<span style="font-variant-numeric: normal; font-weight: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span></strong><!--[endif]-->

<strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">访问测试</span></strong></span>

<p class="MsoNormal" style="margin-left: 15.75pt;">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">根据请求不同</span><span lang="EN-US">uri</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">的返回值验证</span><span lang="EN-US"> location</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">的配置。</span>
</p>

<div class="cnblogs_code">
  <pre>[root@nfs01 ~]<span style="color: #008000;">#</span><span style="color: #008000;"> curl -I -w "%{http_code}\n" -o /dev/null -s  www.nmtui.com/documents</span>
401<span style="color: #000000;">
[root@nfs01 </span>~]<span style="color: #008000;">#</span><span style="color: #008000;"> curl -I -w "%{http_code}\n" -o /dev/null -s  www.nmtui.com</span>
402<span style="color: #000000;">
[root@nfs01 </span>~]<span style="color: #008000;">#</span><span style="color: #008000;"> curl -I -w "%{http_code}\n" -o /dev/null -s  www.nmtui.com/documents/ss.jpg</span>
500<span style="color: #000000;">
[root@nfs01 </span>~]<span style="color: #008000;">#</span><span style="color: #008000;"> curl -I -w "%{http_code}\n" -o /dev/null -s  www.nmtui.com/documents</span>
401<span style="color: #000000;">
[root@nfs01 </span>~]<span style="color: #008000;">#</span><span style="color: #008000;"> curl -I -w "%{http_code}\n" -o /dev/null -s  www.nmtui.com/documents/</span>
403<span style="color: #000000;">
[root@nfs01 </span>~]<span style="color: #008000;">#</span><span style="color: #008000;"> curl -I -w "%{http_code}\n" -o /dev/null -s  www.nmtui.com/images/1.jpg</span>
404</pre>
</div>

<h2 style="margin-top: 8.15pt; margin-right: 0cm; margin-bottom: 8.15pt; margin-left: 25.1pt; mso-list: l14 level2 lfo4;">
  <span id="410_rewrite"><a name="_Toc496798074"></a><!--[if !supportLists]-->
  
  <span lang="EN-US">4.10 </span><!--[endif]-->
  
  <span lang="EN-US">rewrite </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">模块的使用</span><span lang="EN-US">--</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">地址重写</span></span>
</h2>

### <span id="4101_rewrite"><a name="_Toc496798075"></a><!--[if !supportLists]-->

<span lang="EN-US">4.10.1 </span><!--[endif]-->

<span lang="EN-US">rewrite </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">重写模块</span></span>

<p class="MsoNormal" style="margin-left: 7.1pt;">
  <span lang="EN-US">  </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">将地址信息进行重写</span>
</p>

<p class="MsoNormal">
  <span lang="EN-US">rewrite </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">语法格式</span>
</p>

<div class="cnblogs_code">
  <pre>rewrite regex replacement [flag]</pre>
</div>

<p class="MsoNormal">
  <span lang="EN-US">rewrite</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">应用标签：</span><span lang="EN-US">server</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">、</span><span lang="EN-US">location</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">、</span><span lang="EN-US">if</span>
</p>

### <span id="4102_rewrite"><a name="_Toc496798076"></a><!--[if !supportLists]-->

<span lang="EN-US">4.10.2 </span><!--[endif]-->

<span lang="EN-US">rewrite</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">模块两个功能</span></span>

<p class="MsoNormal" style="text-indent: 21.0pt;">
  <span lang="EN-US">1. </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">实现网站地址信息跳转</span>
</p>

<p class="MsoNormal" style="text-indent: 21.0pt;">
  <span lang="EN-US">2. </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">实现伪静态</span>
</p>

### <span id="4103_if"><a name="_Toc496798077"></a><!--[if !supportLists]-->

<span lang="EN-US">4.10.3 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">方法一</span> <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">使用</span><span lang="EN-US">if</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">判断</span></span>

<div class="cnblogs_code">
  <pre>[root@web01 extra]<span style="color: #008000;">#</span><span style="color: #008000;"> cat www.conf</span>
<span style="color: #000000;">    server {
        listen       </span>80<span style="color: #000000;">;
        server_name  www.nmtui.com nmtui.cn;
</span><span style="color: #0000ff;">if</span> ($host ~* <span style="color: #800000;">"</span><span style="color: #800000;">^nmtui.com$</span><span style="color: #800000;">"</span><span style="color: #000000;">) {
rewrite </span>^/(.*) http://www.nmtui.com/$1<span style="color: #000000;"> permanent;
}
        location </span>/<span style="color: #000000;"> {
            root   html</span>/<span style="color: #000000;">www;
            index  index.html index.htm;
        }
        access_log  logs</span>/<span style="color: #000000;">access_www.log  main;
        error_page   </span>500 502 503 504  /<span style="color: #000000;">50x.html;
        location </span>= /<span style="color: #000000;">50x.html {
            root   html;
        }
    }</span></pre>
</div>

<p class="MsoNormal">
  <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">测试</span></strong>
</p>

<div class="cnblogs_code">
  <pre>[root@web01 www]<span style="color: #008000;">#</span><span style="color: #008000;"> curl  nmtui.com -L</span>
web01 www</pre>
</div>

### <span id="4104"><a name="_Toc496798078"></a><!--[if !supportLists]-->

<span lang="EN-US">4.10.4 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">方法二</span><span lang="EN-US">  </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">再添加上一个区块</span></span>

<div class="cnblogs_code">
  <pre><span style="color: #000000;">server {   
        server_name nmtui.com;
        rewrite </span>^/(.*) http://www.nmtui.com/$1<span style="color: #000000;"> permanent;
}  </span></pre>
</div>

### <span id="4105_nginx_rwite"><a name="_Toc496798079"></a><!--[if !supportLists]-->

<span lang="EN-US">4.10.5 </span><!--[endif]-->

<span lang="EN-US">nginx </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">的</span><span lang="EN-US">rwite</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">重写企业应用场景</span></span>

<p class="MsoListParagraph" style="margin-left: 33.0pt; text-indent: -21.0pt; mso-list: l16 level1 lfo22;">
  <span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;" lang="EN-US"><span style="font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span><!--[endif]-->
  
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">可以调整用户浏览的</span><span lang="EN-US">URL</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">，使其看起来更规范，合乎开发及产品人员的需求。</span>
</p>

<p class="MsoListParagraph" style="margin-left: 33.0pt; text-indent: -21.0pt; mso-list: l16 level1 lfo22;">
  <span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;" lang="EN-US"><span style="font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';"> </span></span><!--[endif]-->
  
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">为了让搜索引擎收录网站内容，并让用户体验更好，企业会将动态</span><span lang="EN-US">URL</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">地址伪装成静态地址提供服务。</span>
</p>

<p class="MsoListParagraph" style="margin-left: 33.0pt; text-indent: -21.0pt; mso-list: l16 level1 lfo22;">
  <span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;" lang="EN-US"><span style="font-variant-numeric: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: 'Times New Roman';">  </span></span><!--[endif]-->
  
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">网站换新域名后，让旧域名的访问跳转到新的域名上，例如：让京东的</span><span lang="EN-US">360buy</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">换成了</span><span lang="EN-US">jd.com</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">。</span>
</p>

<p class="MsoListParagraph" style="margin-left: 33.0pt; text-indent: -21.0pt; mso-list: l16 level1 lfo22;">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">根据特殊变量、目录、客户端的信息进行</span><span lang="EN-US">URL</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">跳转等。</span>
</p>

<p class="MsoListParagraph" style="margin-left: 33.0pt; text-indent: -21.0pt; mso-list: l16 level1 lfo22;">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">说明：开源软件类似</span><span lang="EN-US">wordpress</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">的，官方都会对伪静态配置进行说明</span>
</p>

<h2 style="margin-top: 8.15pt; margin-right: 0cm; margin-bottom: 8.15pt; margin-left: 25.1pt; mso-list: l14 level2 lfo4;">
  <span id="411_nginx"><a name="_Toc496798080"></a><!--[if !supportLists]-->
  
  <span lang="EN-US">4.11 </span><!--[endif]-->
  
  <span lang="EN-US">nginx </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">的访问认证</span></span>
</h2>

### <span id="4111_nginx"><a name="_Toc496798081"></a><!--[if !supportLists]-->

<span lang="EN-US">4.11.1 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">修改</span><span lang="EN-US">nginx</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">的相关配置文件</span></span>

<div class="cnblogs_code">
  <pre>vim extra/<span style="color: #000000;">www.conf
location </span>/<span style="color: #000000;"> {
        root   html</span>/<span style="color: #000000;">www;
        index  index.html index.htm;
        auth_basic           </span><span style="color: #800000;">"</span><span style="color: #800000;">clsn training</span><span style="color: #800000;">"</span><span style="color: #000000;">;
        auth_basic_user_file   </span>/application/nginx/conf/<span style="color: #000000;">htpasswd;
 }</span></pre>
</div>

### <span id="4112"><a name="_Toc496798082"></a><!--[if !supportLists]-->

<span lang="EN-US">4.11.2 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">创建密码文件</span></span>

<div style="mso-element: para-border-div; border: solid windowtext 2.0pt; padding: 1.0pt 4.0pt 1.0pt 4.0pt; mso-border-shadow: yes; background: #F2F2F2; mso-shading: windowtext; mso-pattern: gray-5 auto;">
  <p class="a3">
    <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">注：</span> <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">这里使用的</span><span lang="EN-US">htpasswd</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 宋体; mso-hansi-font-family: 宋体;">命令默认是没有的，需要通过</span><span class="ad"><span lang="EN-US">yum install httpd-tools -y </span></span><span class="ad"><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; mso-bidi-font-family: 'Times New Roman';">安装</span></span>
  </p>
</div>

<div class="cnblogs_code">
  <pre>[root@web01 extra]<span style="color: #008000;">#</span><span style="color: #008000;"> htpasswd -c /application/nginx/conf/htpasswd clsn</span>
<span style="color: #000000;">New password:
Re</span>-<span style="color: #000000;">type new password:
Adding password </span><span style="color: #0000ff;">for</span> user clsn</pre>
</div>

<p class="MsoNormal">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">参数说明：</span>
</p>

<p class="MsoNormal">
  <span lang="EN-US">-c  Create a new file.</span>
</p>

<p class="MsoNormal">
  <span lang="EN-US">    </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">创建一个新的密码文</span>
</p>

<p class="MsoNormal">
  <span lang="EN-US">-b  Use the password from the command line rather than prompting for it.</span>
</p>

<p class="MsoNormal" style="text-indent: 24.0pt;">
  <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">采用免交互的方式输入用户的密码信息</span>
</p>

<p class="MsoNormal">
  <a name="_Toc496466456"></a><strong><span style="background: yellow; mso-highlight: yellow;" lang="EN-US">htpasswd</span></strong><strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; background: yellow; mso-highlight: yellow;">参数说明</span></strong>
</p>

<div align="center">
  <table class="MsoTableGrid" style="border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
    <tr>
      <td style="width: 155.7pt; border-width: 1pt; border-color: windowtext; background: #a6a6a6; padding: 0cm 5.4pt;" width="208">
        <p class="MsoNormal" style="text-align: center;" align="center">
          <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">参数</span></strong>
        </p>
      </td>
      
      <td style="width: 367.1pt; border-top-width: 1pt; border-right-width: 1pt; border-bottom-width: 1pt; border-top-color: windowtext; border-right-color: windowtext; border-bottom-color: windowtext; border-left: none; background: #a6a6a6; padding: 0cm 5.4pt;" width="489">
        <p class="MsoNormal" style="text-align: center;" align="center">
          <strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">参数说明</span></strong>
        </p>
      </td>
    </tr>
    
    <tr>
      <td style="width: 155.7pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" width="208">
        <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
          <span lang="EN-US">-c </span>
        </p>
      </td>
      
      <td style="width: 367.1pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="489">
        <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
          <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">创建一个新文件。</span>
        </p>
      </td>
    </tr>
    
    <tr>
      <td style="width: 155.7pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" width="208">
        <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
          <span lang="EN-US">-n </span>
        </p>
      </td>
      
      <td style="width: 367.1pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="489">
        <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
          <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">不更新文件</span><span lang="EN-US">; </span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">显示结果。</span>
        </p>
      </td>
    </tr>
    
    <tr>
      <td style="width: 155.7pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" width="208">
        <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
          <span lang="EN-US">-m </span>
        </p>
      </td>
      
      <td style="width: 367.1pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="489">
        <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
          <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">强制</span><span lang="EN-US">MD5</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">密码加密。</span>
        </p>
      </td>
    </tr>
    
    <tr>
      <td style="width: 155.7pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" width="208">
        <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
          <span lang="EN-US">-d </span>
        </p>
      </td>
      
      <td style="width: 367.1pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="489">
        <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
          <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">强制</span><span lang="EN-US">CRYPT</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">加密密码（默认）。</span>
        </p>
      </td>
    </tr>
    
    <tr>
      <td style="width: 155.7pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" width="208">
        <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
          <span lang="EN-US">-p </span>
        </p>
      </td>
      
      <td style="width: 367.1pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="489">
        <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
          <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">不加密密码（明文）。</span>
        </p>
      </td>
    </tr>
    
    <tr>
      <td style="width: 155.7pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" width="208">
        <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
          <span lang="EN-US">-s </span>
        </p>
      </td>
      
      <td style="width: 367.1pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="489">
        <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
          <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">强制</span><span lang="EN-US">SHA</span><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">加密密码。</span>
        </p>
      </td>
    </tr>
    
    <tr>
      <td style="width: 155.7pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" width="208">
        <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
          <span lang="EN-US">-b </span>
        </p>
      </td>
      
      <td style="width: 367.1pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="489">
        <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
          <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">使用命令行中的密码，而不是提示。（免交互）</span>
        </p>
      </td>
    </tr>
    
    <tr>
      <td style="width: 155.7pt; border-right-width: 1pt; border-bottom-width: 1pt; border-left-width: 1pt; border-right-color: windowtext; border-bottom-color: windowtext; border-left-color: windowtext; border-top: none; padding: 0cm 5.4pt;" width="208">
        <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
          <span lang="EN-US">-D </span>
        </p>
      </td>
      
      <td style="width: 367.1pt; border-top: none; border-left: none; border-bottom-width: 1pt; border-bottom-color: windowtext; border-right-width: 1pt; border-right-color: windowtext; padding: 0cm 5.4pt;" width="489">
        <p class="MsoNormal" style="text-align: justify; text-justify: inter-ideograph;">
          <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">删除指定的用户。</span>
        </p>
      </td>
    </tr>
  </table>
</div>

<p class="MsoNormal" style="text-indent: 24.0pt;">
  <span lang="EN-US"> </span>
</p>

### <span id="4113"><a name="_Toc496798083"></a><!--[if !supportLists]-->

<span lang="EN-US">4.11.3 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">更改密码文件权限</span></span>

<div class="cnblogs_code">
  <pre>[root@web01 extra]<span style="color: #008000;">#</span><span style="color: #008000;">  chmod 400 /application/nginx/conf/htpasswd    </span>
[root@web01 extra]<span style="color: #008000;">#</span><span style="color: #008000;">  chown -R www.www /application/nginx/conf/htpasswd</span>
[root@web01 extra]<span style="color: #008000;">#</span><span style="color: #008000;"> cat /application/nginx/conf/htpasswd</span>
clsn:e3OfMiJThE0Qg</pre>
</div>

### <span id="4114"><a name="_Toc496798084"></a><!--[if !supportLists]-->

<span lang="EN-US">4.11.4 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">重启服务：</span> <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">配置修改后要重启服务</span></span>

<div class="cnblogs_code">
  <pre>[root@web01 extra]<span style="color: #008000;">#</span><span style="color: #008000;"> /application/nginx/sbin/nginx -t</span>
nginx: the configuration file /application/nginx-1.10.2/conf/nginx.conf syntax <span style="color: #0000ff;">is</span><span style="color: #000000;"> ok
nginx: configuration file </span>/application/nginx-1.10.2/conf/nginx.conf test <span style="color: #0000ff;">is</span><span style="color: #000000;"> successful
[root@web01 extra]</span><span style="color: #008000;">#</span><span style="color: #008000;"> /application/nginx/sbin/nginx -s reload</span></pre>
</div>

### <span id="4115"><a name="_Toc496798085"></a><!--[if !supportLists]-->

<span lang="EN-US">4.11.5 </span><!--[endif]-->

<span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">访问测试</span></span>

<div class="cnblogs_code">
  <pre><span style="color: #008000;">#</span><span style="color: #008000;"> 使用交互式输入密码</span>
[root@web01 www]<span style="color: #008000;">#</span><span style="color: #008000;"> curl www.nmtui.com -uclsn</span>
Enter host password <span style="color: #0000ff;">for</span> user <span style="color: #800000;">'</span><span style="color: #800000;">clsn</span><span style="color: #800000;">'</span>:123456<span style="color: #000000;">
web01 www
</span><span style="color: #008000;">#</span><span style="color: #008000;"> 使用免交互输入密码</span>
[root@web01 www]<span style="color: #008000;">#</span><span style="color: #008000;"> curl www.nmtui.com -uclsn:123456</span>
web01 www</pre>
</div>

<p class="MsoNormal" style="text-indent: 15.75pt;">
  <strong><span style="color: red;" lang="EN-US">401</span></strong><strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'; color: red;">错误说明</span></strong><span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">：</span> <span style="font-family: '微软雅黑',sans-serif; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New';">需要认证，但是没有认证</span>
</p>

<

p class="MsoNormal"><span lang="EN-US"> </span>

<div id="toc_container" class="toc_white have_bullets">
  <ul class="toc_list">
    <ul>
      <li>
        <a href="#11">1.1 常用来提供静态服务的软件</a>
      </li>
      <li>
        <a href="#12">1.2 常用来提供动态服务的软件</a>
      </li>
    </ul></li>
    
    <li>
      <a href="#2_nginx">第2章 nginx 软件</a><ul>
        <li>
          <a href="#21">2.1 软件介绍</a>
        </li>
        <li>
          <a href="#22_NGINX">2.2 NGINX 软件特性</a><ul>
            <li>
              <a href="#221_HTTP">2.2.1 HTTP服务器的特色及优点：</a>
            </li>
            <li>
              <a href="#222_nginx">2.2.2 nginx功能特性</a>
            </li>
          </ul>
        </li>
        
        <li>
          <a href="#23_nginx">2.3 nginx软件的企业功能应用</a>
        </li>
        <li>
          <a href="#24_nginx">2.4 nginx软件的动态访问瓶颈</a><ul>
            <li>
              <a href="#241">2.4.1 与其他软件的对比</a>
            </li>
            <li>
              <a href="#242_select_epoll">2.4.2 最主要的区别（select & epoll）</a>
            </li>
            <li>
              <a href="#243_apache_selectnginx_epoll">2.4.3 apache select和nginx epoll技术对比图</a>
            </li>
          </ul>
        </li>
      </ul>
    </li>
    
    <li>
      <a href="#3_nginx">第3章 nginx的安装与使用</a><ul>
        <li>
          <a href="#31_nginx">3.1 nginx软件的编译安装步骤</a><ul>
            <li>
              <a href="#311">3.1.1 检查软件安装的系统环境</a>
            </li>
            <li>
              <a href="#312_nginxpcre-devel_openssl-devel">3.1.2 安装nginx的依赖包（pcre-devel openssl-devel）</a>
            </li>
            <li>
              <a href="#313_nginx">3.1.3 下载nginx软件</a>
            </li>
            <li>
              <a href="#314_www">3.1.4 创建管理用户 www</a>
            </li>
            <li>
              <a href="#315_nginx">3.1.5  nginx软件编译安装过程</a><ul>
                <li>
                  <a href="#3151">3.1.5.1  注意</a>
                </li>
                <li>
                  <a href="#3152">3.1.5.2  编译安装软件</a>
                </li>
              </ul>
            </li>
            
            <li>
              <a href="#316">3.1.6 创建软连接</a>
            </li>
            <li>
              <a href="#317_nginxconf">3.1.7 精简化nginx.conf 主配置文件内容</a>
            </li>
            <li>
              <a href="#318">3.1.8 启动程序</a>
            </li>
          </ul>
        </li>
        
        <li>
          <a href="#31_nginx-2">3.1 nginx 目录结构</a>
        </li>
        <li>
          <a href="#32_nginxconf">3.2 nginx.conf 配置文件说明</a><ul>
            <li>
              <a href="#321">3.2.1 站点目录与首页文件概 </a>
            </li>
            <li>
              <a href="#322">3.2.2 配置文件详解 </a>
            </li>
          </ul>
        </li>
        
        <li>
          <a href="#33_nginx">3.3 【常见错误】nginx软件的编译安装常见错误说明</a><ul>
            <li>
              <a href="#331_nginx">3.3.1 nginx软件安装过程中遇到的问题</a>
            </li>
            <li>
              <a href="#332_nginx">3.3.2 nginx软件启动过程中遇到的问题</a>
            </li>
            <li>
              <a href="#333_Nginx_nginxemerggetpwnamnginxfailed">3.3.3 启动 Nginx 时如下报错"nginx:[emerg]getpwnam(“nginx”〉failed"</a>
            </li>
            <li>
              <a href="#334_pcregccyum">3.3.4 编译安装pcre编译软件时，gcc不全导致报错（本文使用yum安装不存在此问题)。</a>
            </li>
            <li>
              <a href="#335_nginxapplication">3.3.5 nginx软件编译安装后，看不到程序目录（/application）</a>
            </li>
            <li>
              <a href="#336_nginx">3.3.6 nginx软件排查问题三部曲说明</a>
            </li>
            <li>
              <a href="#337_403">3.3.7 【注意】403状态码出现情况原因</a>
            </li>
          </ul>
        </li>
        
        <li>
          <a href="#34_nginx">3.4 nginx软件使用命令参数</a><ul>
            <li>
              <a href="#341_nginx">3.4.1 nginx 启动方法</a>
            </li>
            <li>
              <a href="#342_nginx">3.4.2 nginx 停止方法</a>
            </li>
            <li>
              <a href="#343_nginx">3.4.3 nginx 重启方法 （平滑重启）</a>
            </li>
            <li>
              <a href="#344">3.4.4 检查配置文件语法是否正确</a>
            </li>
            <li>
              <a href="#345_-V_V">3.4.5 显示配置参数  -V （大写V）</a>
            </li>
            <li>
              <a href="#346_nginx">3.4.6 nginx软件使用过程中深入说明</a>
            </li>
          </ul>
        </li>
        
        <li>
          <a href="#35_nginx">3.5 nginx软件静态页面编写过程</a>
        </li>
      </ul>
    </li>
    
    <li>
      <a href="#4_nginx">第4章 nginx进阶 --虚拟主机配置</a><ul>
        <li>
          <a href="#41_nginx">4.1 【企业要求】需要按照以前nginx服务编译安装过程安装</a><ul>
            <li>
              <a href="#411">4.1.1 【语法检查】检查配置文件</a>
            </li>
          </ul>
        </li>
        
        <li>
          <a href="#42_--nginx">4.2 首页文件不存在--利用nginx服务搭建文件共享服务器</a><ul>
            <li>
              <a href="#421_curl403">4.2.1 进行curl时，报403错误，因为没有首页文件信息</a>
            </li>
            <li>
              <a href="#422_autoindex_on">4.2.2 autoindex on参数实践</a>
            </li>
          </ul>
        </li>
        
        <li>
          <a href="#43">4.3 【概念】虚拟主机的概念和类型</a><ul>
            <li>
              <a href="#431">4.3.1 虚拟主机概念</a>
            </li>
            <li>
              <a href="#432">4.3.2 虚拟主机类型</a>
            </li>
            <li>
              <a href="#433_Nginx">4.3.3 Nginx配置虚拟主机的步骤如下（适合各类虚拟主机类型）</a>
            </li>
          </ul>
        </li>
        
        <li>
          <a href="#44">4.4 【实践】虚拟主机配置</a><ul>
            <li>
              <a href="#441">4.4.1 基于域名的虚拟主机</a>
            </li>
            <li>
              <a href="#442">4.4.2 基于端口的虚拟主机</a>
            </li>
            <li>
              <a href="#443_IP">4.4.3 基于IP的虚拟主机</a>
            </li>
          </ul>
        </li>
        
        <li>
          <a href="#45_nginx">4.5 【规范化配置】nginx配置文件企业规范化</a><ul>
            <li>
              <a href="#451">4.5.1 第一个里程碑：  创建虚拟主机配置文件存储目录</a>
            </li>
            <li>
              <a href="#452">4.5.2 第二个里程碑： 生产虚拟主机配置文件</a>
            </li>
            <li>
              <a href="#453_nginx">4.5.3 第三个里程碑： 修改nginx配置文件使之加载识别虚拟主机配置文件</a>
            </li>
            <li>
              <a href="#454">4.5.4 重启服务</a>
            </li>
            <li>
              <a href="#455">4.5.5 检查监听端口</a>
            </li>
            <li>
              <a href="#456">4.5.6 查看配置文件的加载顺序</a>
            </li>
            <li>
              <a href="#457_inculdeconf">4.5.7 【优化】调整 inculde的加载顺序，指定第一个加载为conf</a>
            </li>
            <li>
              <a href="#458">4.5.8 重启服务</a>
            </li>
            <li>
              <a href="#459">4.5.9 说明;</a>
            </li>
          </ul>
        </li>
        
        <li>
          <a href="#46">4.6 别名的配置</a>
        </li>
        <li>
          <a href="#47_status">4.7 status 状态模块</a><ul>
            <li>
              <a href="#471">4.7.1 状态模块的配置</a>
            </li>
            <li>
              <a href="#472">4.7.2 状态模块说明</a>
            </li>
          </ul>
        </li>
        
        <li>
          <a href="#48_nginx">4.8 nginx的日志功能</a><ul>
            <li>
              <a href="#481">4.8.1 定义错误日志信息</a>
            </li>
            <li>
              <a href="#482">4.8.2 访问日志配置</a>
            </li>
            <li>
              <a href="#483">4.8.3 【重要】访问日志信息说明</a>
            </li>
            <li>
              <a href="#484">4.8.4 日志的切割</a>
            </li>
          </ul>
        </li>
        
        <li>
          <a href="#49_location">4.9 企业需求解决（location应用）</a><ul>
            <li>
              <a href="#491_--location">4.9.1 需求处理 --location的应用</a>
            </li>
            <li>
              <a href="#492_location">4.9.2 location 语法</a>
            </li>
            <li>
              <a href="#493">4.9.3 官方配置示例</a>
            </li>
            <li>
              <a href="#494_location">4.9.4 【测试】测试location的访问</a><ul>
                <li>
                  <a href="#4941">4.9.4.1  修改配置文件</a>
                </li>
                <li>
                  <a href="#4942">4.9.4.2  访问测试</a>
                </li>
              </ul>
            </li>
          </ul>
        </li>
        
        <li>
          <a href="#410_rewrite">4.10 rewrite 模块的使用--地址重写</a><ul>
            <li>
              <a href="#4101_rewrite">4.10.1 rewrite 重写模块</a>
            </li>
            <li>
              <a href="#4102_rewrite">4.10.2 rewrite模块两个功能</a>
            </li>
            <li>
              <a href="#4103_if">4.10.3 方法一 使用if判断</a>
            </li>
            <li>
              <a href="#4104">4.10.4 方法二  再添加上一个区块</a>
            </li>
            <li>
              <a href="#4105_nginx_rwite">4.10.5 nginx 的rwite重写企业应用场景</a>
            </li>
          </ul>
        </li>
        
        <li>
          <a href="#411_nginx">4.11 nginx 的访问认证</a><ul>
            <li>
              <a href="#4111_nginx">4.11.1 修改nginx的相关配置文件</a>
            </li>
            <li>
              <a href="#4112">4.11.2 创建密码文件</a>
            </li>
            <li>
              <a href="#4113">4.11.3 更改密码文件权限</a>
            </li>
            <li>
              <a href="#4114">4.11.4 重启服务： 配置修改后要重启服务</a>
            </li>
            <li>
              <a href="#4115">4.11.5 访问测试</a>
            </li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</div>