---
title: 'FTP&samba 服务简单部署'
author: 惨绿少年
type: post
date: 2017-11-22T05:56:00+00:00
url: /clsn/lx755.html
Baidusubmit:
  - 1
views:
  - 116
categories:
  - Linux运维
  - 存储
  - 玩转Linux
  - 运维基本功

---
# <span id="1_FTP">第1章 FTP<span style="font-family: '微软雅黑',sans-serif;">服务部署</span></span>

<p style="margin-left: 7.1pt; text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif;">在</span>Linux<span style="font-family: '微软雅黑',sans-serif;">下，我们应用最广泛的</span>FTP<span style="font-family: '微软雅黑',sans-serif;">服务程序是</span> vsftpd (<strong><span style="color: #0070c0;">Very Secure FTP Daemon</span></strong>),<span style="font-family: '微软雅黑',sans-serif;">从名字我们也可以看出，其提供了非常安全的</span>FTP<span style="font-family: '微软雅黑',sans-serif;">服务。</span>vsftpd <span style="font-family: '微软雅黑',sans-serif;">是一个</span> UNIX <span style="font-family: '微软雅黑',sans-serif;">类操作系统上运行的服务器的名字，它可以运行在诸如</span> Linux, BSD, Solaris, HP-UX <span style="font-family: '微软雅黑',sans-serif;">以及</span> IRIX <span style="font-family: '微软雅黑',sans-serif;">上面。它支持很多其他的</span> FTP <span style="font-family: '微软雅黑',sans-serif;">服务器不支持的特征。例如：</span>
</p>

> <p style="margin-left: 7.1pt; text-indent: 21.0pt;">
>   <span style="font-family: '微软雅黑',sans-serif;">①&nbsp;非常高的安全性需求　　</span>
> </p>
> 
> <p style="margin-left: 7.1pt; text-indent: 21.0pt;">
>   <span style="font-family: '微软雅黑',sans-serif;">②带宽限制　　</span>
> </p>
> 
> <p style="margin-left: 7.1pt; text-indent: 21.0pt;">
>   <span style="font-family: '微软雅黑',sans-serif;">③创建虚拟用户的可能性　　</span>
> </p>
> 
> <p style="margin-left: 7.1pt; text-indent: 21.0pt;">
>   <span style="font-family: '微软雅黑',sans-serif;">④高速　　</span>
> </p>
> 
> <p style="margin-left: 7.1pt; text-indent: 21.0pt;">
>   <span style="font-family: '微软雅黑',sans-serif;">...</span>
> </p>

<p style="text-indent: 21.0pt;">
  <span style="font-family: '微软雅黑',sans-serif;">可以说</span> vsftpd <span style="font-family: '微软雅黑',sans-serif;">给我们提供了一个快速的、稳定的且相当安全的</span>FTP<span style="font-family: '微软雅黑',sans-serif;">服务</span>
</p>

## <span id="11">1.1 <span style="font-family: '微软雅黑',sans-serif;">服务端配置</span></span>

### <span id="111">1.1.1 <span style="font-family: '微软雅黑',sans-serif;">第一个里程碑：</span> <span style="font-family: '微软雅黑',sans-serif;">检查是否有这个软件，（没有则安装软件）</span></span>

<div class="cnblogs_code">
  <pre>[root@test ~]# rpm -qa vsftpd # 在CentOS下默认没有安装&nbsp;vsftpd&nbsp;这个FTP程序</pre>
</div>

<span style="font-family: '微软雅黑',sans-serif;">我们通过</span> yum install vsfptd <span style="font-family: '微软雅黑',sans-serif;">来进行安装</span>

<div class="cnblogs_code">
  <pre>[root@test ~]# <span style="color: #0000ff;">yum</span> <span style="color: #0000ff;">install</span> vsftpd</pre>
</div>

**<span style="font-family: 微软雅黑, sans-serif; color: red; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">说明</span><span style="color: red; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">:</span>**

<span style="font-family: '微软雅黑',sans-serif; courier new"4courier new";background: lime;">服务的启动配置文件</span>

<div class="cnblogs_code">
  <pre>/etc/rc.d/init.d/vsftpd</pre>
</div>

<span style="font-size: 11.5pt; font-family: 微软雅黑, sans-serif; background: lime;">安装完之后在</span><span style="font-size: 11.5pt; font-family: Arial, sans-serif; background: lime;">/etc/vsftpd/</span><span style="font-size: 11.5pt; font-family: 微软雅黑, sans-serif; background: lime;">路径下会存在三个配置文件</span>

&nbsp;

<div class="cnblogs_code">
  <pre>/etc/vsftpd/<span style="color: #000000;">vsftpd.conf   主配置文件
</span>/etc/vsftpd/<span style="color: #000000;">ftpusers       指定哪些用户不能访问FTP服务器,这里的用户包括root在内的用户。
</span>/etc/vsftpd/<span style="color: #000000;">user_list      指定的用户是否可以访问ftp服务器。
通过vsftpd.conf文件中的userlist_deny的配置来决定配置中的用户是否可以访问，
userlist_enable</span>=YES ，userlist_deny=YES ，userlist_file=/etc/vsftpd/<span style="color: #000000;">user_list
这三个配置允许文件中的用户访问FTP。</span></pre>
</div>

&nbsp;

### <span id="112">1.1.2 <span style="font-family: '微软雅黑',sans-serif;">第二个里程碑：</span> <span style="font-family: '微软雅黑',sans-serif;">编写配置文件</span></span>

&nbsp;&nbsp; **<span style="color: red;">ftp</span>****<span style="font-family: '微软雅黑',sans-serif; courier new"4courier new"; color: red;">服务有默认的配置文件</span>**<span style="font-family: '微软雅黑',sans-serif;">，将原配置文件备份，重新编写配置文件</span>

<div class="cnblogs_code">
  <pre>[root@test <span style="color: #0000ff;">ftp</span>]# <span style="color: #0000ff;">mv</span>  /etc/vsftpd/vsftpd.conf  /etc/vsftpd/<span style="color: #000000;">vsftpd.conf.bak

[root@test </span>~]# <span style="color: #0000ff;">cat</span> /etc/vsftpd/<span style="color: #000000;">vsftpd.conf
#</span><span style="color: #800080;">20171014</span><span style="color: #000000;">
#HZS

anonymous_enable</span>=<span style="color: #000000;">NO
local_enable</span>=<span style="color: #000000;">YES
write_enable</span>=<span style="color: #000000;">YES
local_umask</span>=<span style="color: #800080;">022</span><span style="color: #000000;">
dirmessage_enable</span>=<span style="color: #000000;">YES
xferlog_enable</span>=<span style="color: #000000;">YES
connect_from_port_20</span>=<span style="color: #000000;">YES
xferlog_std_format</span>=<span style="color: #000000;">YES
listen</span>=<span style="color: #000000;">YES

pam_service_name</span>=<span style="color: #000000;">vsftpd
userlist_enable</span>=<span style="color: #000000;">YES
tcp_wrappers</span>=YES</pre>
</div>

**<span style="font-family: '微软雅黑',sans-serif; courier new"4courier new";background: lime;">默认配置文件说明：</span>**

<table style="border-collapse: collapse; border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
  <tr>
    <td style="width: 226.55pt; border-width: 1pt; border-style: solid; border-color: windowtext; background: gray; padding: 0cm 5.4pt;" width="302">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <strong><span style="font-family: '微软雅黑',sans-serif;">参数</span></strong>
      </p>
    </td>
    
    <td style="width: 296.25pt; border-top: 1pt solid windowtext; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: none; background: gray; padding: 0cm 5.4pt;" width="395">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <strong><span style="font-family: '微软雅黑',sans-serif;">说明</span></strong>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 226.55pt; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="302">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        anonymous_enable=YES
      </p>
    </td>
    
    <td style="width: 296.25pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="395">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">允许匿名用户</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 226.55pt; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="302">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        local_enable=YES
      </p>
    </td>
    
    <td style="width: 296.25pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="395">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">允许使用本地用户账号登陆</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 226.55pt; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="302">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        write_enable=YES
      </p>
    </td>
    
    <td style="width: 296.25pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="395">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">允许</span>ftp<span style="font-family: '微软雅黑',sans-serif;">用户写数据</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 226.55pt; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="302">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        connect_from_port_20=YES
      </p>
    </td>
    
    <td style="width: 296.25pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="395">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">通过</span>20<span style="font-family: '微软雅黑',sans-serif;">端口传输数据</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 226.55pt; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="302">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <strong>#anon_mkdir_write_enable=YES&nbsp; </strong>
      </p>
    </td>
    
    <td style="width: 296.25pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="395">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <strong><span style="font-family: '微软雅黑',sans-serif;">是否允许匿名账户在</span>FTP</strong><strong><span style="font-family: '微软雅黑',sans-serif;">服务器中创建目录</span></strong>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 226.55pt; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="302">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        xferlog_enable=YES&nbsp;
      </p>
    </td>
    
    <td style="width: 296.25pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="395">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">启用上传和下载日志功能</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 226.55pt; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="302">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        #ascii_download_enable=YES
      </p>
    </td>
    
    <td style="width: 296.25pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="395">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">是否允许使用</span>ASCII<span style="font-family: '微软雅黑',sans-serif;">格式来上传和下载文件</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 226.55pt; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="302">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        pam_service_name=vsftpd
      </p>
    </td>
    
    <td style="width: 296.25pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="395">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        /<span style="font-family: '微软雅黑',sans-serif;">设置</span>PAM<span style="font-family: '微软雅黑',sans-serif;">认证服务的配置文件名称</span>,<span style="font-family: '微软雅黑',sans-serif;">该文件存放在</span>/etc/pam.d/<span style="font-family: '微软雅黑',sans-serif;">目录下</span>.
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 226.55pt; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="302">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        userlist_enable=YES
      </p>
    </td>
    
    <td style="width: 296.25pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="395">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">用户列表中的用户是否允许登录</span>FTP<span style="font-family: '微软雅黑',sans-serif;">服务器</span>,<span style="font-family: '微软雅黑',sans-serif;">默认是不允许</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 226.55pt; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="302">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        tcp_wrappers=YES
      </p>
    </td>
    
    <td style="width: 296.25pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="395">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        /<span style="font-family: '微软雅黑',sans-serif;">使用</span>tcp_wrqppers<span style="font-family: '微软雅黑',sans-serif;">作为主机访问控制方式</span>
      </p>
    </td>
  </tr>
</table>

**<span style="font-family: '微软雅黑',sans-serif; courier new"4courier new";background: yellow;">其他的配置参数说明：</span>**

&nbsp;

<div class="cnblogs_code">
  <pre>ftpd_banner=welcome to <span style="color: #0000ff;">ftp</span><span style="color: #000000;"> service ：设置连接服务器后的欢迎信息
idle_session_timeout</span>=<span style="color: #800080;">60</span><span style="color: #000000;"> ：限制远程的客户机连接后，所建立的控制连接，在多长时间没有做任何的操作就会中断(秒)
data_connection_timeout</span>=<span style="color: #800080;">120</span><span style="color: #000000;"> ：设置客户机在进行数据传输时,设置空闲的数据中断时间
accept_timeout</span>=<span style="color: #800080;">60</span><span style="color: #000000;"> 设置在多长时间后自动建立连接
connect_timeout</span>=<span style="color: #800080;">60</span><span style="color: #000000;"> 设置数据连接的最大激活时间，多长时间断开，为别人所使用;
max_clients</span>=<span style="color: #800080;">200</span><span style="color: #000000;"> 指明服务器总的客户并发连接数为200
max_per_ip</span>=<span style="color: #800080;">3</span><span style="color: #000000;"> 指明每个客户机的最大连接数为3
local_max_rate</span>=<span style="color: #800080;">50000</span>(50kbytes/<span style="color: #000000;">sec)  本地用户最大传输速率限制
anon_max_rate</span>=<span style="color: #000000;">30000匿名用户的最大传输速率限制
pasv_min_port</span>=<span style="color: #000000;">端口
pasv</span>-max-prot=<span style="color: #000000;">端口号 定义最大与最小端口，为0表示任意端口;为客户端连接指明端口;
listen_address</span>=<span style="color: #000000;">IP地址 设置ftp服务来监听的地址，客户端可以用哪个地址来连接;
listen_port</span>=<span style="color: #000000;">端口号 设置FTP工作的端口号，默认的为21
local_root</span>=<span style="color: #000000;">path 无论哪个用户都能登录的用户，定义登录帐号的主目录, 若没有指定，则每一个用户则进入到个人用户主目录;
chroot_local_user</span>=yes/no 是否锁定本地系统帐号用户主目录(所有);锁定后，用户只能访问用户的主目录/home/<span style="color: #000000;">user;
chroot_list_enable</span>=yes/<span style="color: #000000;">no 启用不锁定用户在主目录的名单
chroot_list_file</span>=/etc/vsftpd/<span style="color: #000000;">chroot_list指定列表文件
userlist_enable</span>=YES/<span style="color: #000000;">NO 是否加载用户列表文件;
userlist_deny</span>=<span style="color: #000000;">YES 表示上面所加载的用户允许登录;
userlist_file</span>=/etc/vsftpd/user_list 指定列表文件</pre>
</div>

&nbsp;

**<span style="font-family: '微软雅黑',sans-serif; courier new"4courier new";color: red;">注意：</span>**

**<span style="color: red;">&nbsp;&nbsp; </span>****<span style="font-family: '微软雅黑',sans-serif; courier new"4courier new"; color: red;">在这里要禁止匿名登陆</span>anonymous_enable=NO**

### <span id="113_FTP">1.1.3 <span style="font-family: '微软雅黑',sans-serif;">第三个里程碑：创建用于</span>FTP<span style="font-family: '微软雅黑',sans-serif;">连接用户，设置密码</span></span>

<div class="cnblogs_code">
  <pre>[root@test ~]# useradd ftpuser -s /sbin/nologin  -<span style="color: #000000;">M
[root@test </span>~]# <span style="color: #0000ff;">echo</span> <span style="color: #800000;">"</span><span style="color: #800000;">ftpuser</span><span style="color: #800000;">"</span> |<span style="color: #0000ff;">passwd</span> --<span style="color: #000000;">stdin ftpuser
Changing password </span><span style="color: #0000ff;">for</span><span style="color: #000000;"> user ftpuser.
</span><span style="color: #0000ff;">passwd</span>: all authentication tokens updated successfully</pre>
</div>

### <span id="114_ftpftpuser_ftpuser">1.1.4 <span style="font-family: '微软雅黑',sans-serif;">第四个里程碑：</span> <span style="font-family: '微软雅黑',sans-serif;">创建</span>ftp<span style="font-family: '微软雅黑',sans-serif;">共享目录，将目录所有者属于</span>ftpuser<span style="font-family: '微软雅黑',sans-serif;">，将</span> ftpuser<span style="font-family: '微软雅黑',sans-serif;">用户家目录修改为共享目录。</span></span>

<div class="cnblogs_code">
  <pre>[root@test ~]# <span style="color: #0000ff;">mkdir</span> /<span style="color: #000000;">ftpshare
[root@test </span>~]# <span style="color: #0000ff;">chown</span> ftpuser.ftpuser /<span style="color: #000000;">ftpshare
[root@test </span>~]# usermod ftpuser -d /ftpshare</pre>
</div>

**<span style="font-family: '微软雅黑',sans-serif;">检查配置是否正确：</span>**

<div class="cnblogs_code">
  <pre>[root@test ~]# ll /ftpshare/ -<span style="color: #000000;">d
drwxr</span>-xr-x <span style="color: #800080;">2</span> ftpuser ftpuser <span style="color: #800080;">4096</span> Oct <span style="color: #800080;">14</span> <span style="color: #800080;">10</span>:<span style="color: #800080;">48</span> /ftpshare/<span style="color: #000000;">

[root@test </span>~]# <span style="color: #0000ff;">tail</span> -<span style="color: #800080;">1</span> /etc/<span style="color: #0000ff;">passwd</span><span style="color: #000000;">
ftpuser:x:</span><span style="color: #800080;">501</span>:<span style="color: #800080;">501</span>::/ftpshare:/sbin/nologin</pre>
</div>

### <span id="115_vsftpd">1.1.5 <span style="font-family: '微软雅黑',sans-serif;">第五个里程碑：</span> <span style="font-family: '微软雅黑',sans-serif;">启动</span>vsftpd <span style="font-family: '微软雅黑',sans-serif;">服务，并设置开机自启动</span></span>

<div class="cnblogs_code">
  <pre>[root@test ~]# /etc/init.d/<span style="color: #000000;">vsftpd start
Starting vsftpd </span><span style="color: #0000ff;">for</span><span style="color: #000000;"> vsftpd:                                [  OK  ]

[root@test bin]# chkconfig  vsftpd on
[root@test bin]# chkconfig </span>|<span style="color: #0000ff;">grep</span><span style="color: #000000;"> vsftpd
vsftpd         </span><span style="color: #800080;"></span>:off  <span style="color: #800080;">1</span>:off  <span style="color: #800080;">2</span>:on   <span style="color: #800080;">3</span>:on   <span style="color: #800080;">4</span>:on   <span style="color: #800080;">5</span>:on   <span style="color: #800080;">6</span>:off</pre>
</div>

## <span id="12">1.2 <span style="font-family: '微软雅黑',sans-serif;">客户端链接测试</span></span>

<span style="font-family: '微软雅黑',sans-serif;">第一步：打开</span>windows<span style="font-family: '微软雅黑',sans-serif;">上资源管理器</span>

<span style="font-family: '微软雅黑',sans-serif;">在地址栏中是输入服务器地址，注意</span>ftp<span style="font-family: '微软雅黑',sans-serif;">格式</span>

<div class="cnblogs_code">
  <pre><span style="color: #0000ff;">ftp</span>:<span style="color: #008000;">//</span><span style="color: #008000;">10.0.0.250</span></pre>
</div>

<span style="font-family: '微软雅黑',sans-serif;">确定，输入用户名，和密码进行登陆。</span>

<p style="text-align: center;">
  <span style="font-family: '微软雅黑',sans-serif;"><img src="https://images2017.cnblogs.com/blog/1190037/201711/1190037-20171122214841758-485348051.png" alt="FTP&samba 服务简单部署" alt="" />&nbsp;<img data-original="https://images2017.cnblogs.com/blog/1190037/201711/1190037-20171122214851727-108817146.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="FTP&samba 服务简单部署" alt="" /></span>
</p>

### <span id="121">1.2.1 <span style="font-family: '微软雅黑',sans-serif;">下载文件测试</span></span>

<p style="text-align: center;" align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171122214908274-1929026701.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="FTP&samba 服务简单部署" alt="" />&nbsp;
</p>

### <span id="122">1.2.2 <span style="font-family: '微软雅黑',sans-serif;">上传文件测试</span></span>

<p style="text-align: center;" align="center">
  &nbsp;<img data-original="https://images2017.cnblogs.com/blog/1190037/201711/1190037-20171122214923899-676077979.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="FTP&samba 服务简单部署" alt="" />
</p>

### <span id="123">1.2.3 <span style="font-family: '微软雅黑',sans-serif;">服务端检查</span></span>

<div class="cnblogs_code">
  <pre><span style="color: #000000;">[root@test ftpshare]# ll
total </span><span style="color: #800080;">7072</span>
-rw-r--r-- <span style="color: #800080;">1</span> ftpuser ftpuser <span style="color: #800080;">7234678</span> Oct <span style="color: #800080;">14</span> <span style="color: #800080;">11</span>:<span style="color: #800080;">13</span> cwRsync.<span style="color: #0000ff;">zip</span>
-rw-r--r-- <span style="color: #800080;">1</span> root    root         <span style="color: #800080;">60</span> Oct <span style="color: #800080;">14</span> <span style="color: #800080;">11</span>:<span style="color: #800080;">05</span> 访问正常.txt</pre>
</div>

## <span id="13_linuxftp">1.3 linux<span style="font-family: '微软雅黑',sans-serif;">系统挂载</span>ftp<span style="font-family: '微软雅黑',sans-serif;">测试</span></span>

<div class="cnblogs_code">
  <pre>[root@test ~]# <span style="color: #0000ff;">mount</span> -t nfs -o rw <span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.250</span>:/ftpshare/ /opt/<span style="color: #000000;">
[root@test </span>~]# <span style="color: #0000ff;">df</span> -<span style="color: #000000;">h
Filesystem            Size  Used Avail Use</span>%<span style="color: #000000;"> Mounted on
</span>/dev/sda3              19G  <span style="color: #800080;">1</span>.7G   17G  <span style="color: #800080;">10</span>% /<span style="color: #000000;">
tmpfs                 238M     </span><span style="color: #800080;"></span>  238M   <span style="color: #800080;"></span>% /dev/<span style="color: #000000;">shm
</span>/dev/sda1             190M   40M  141M  <span style="color: #800080;">22</span>% /<span style="color: #000000;">boot
</span><span style="color: #800080;">10.0</span>.<span style="color: #800080;">0.250</span>:/ftpshare/ 19G  <span style="color: #800080;">1</span>.7G   17G  <span style="color: #800080;">10</span>% /opt</pre>
</div>

# <span id="2_samba">第2章 samba<span style="font-family: '微软雅黑',sans-serif;">服务配置</span></span>

## <span id="21_samba">2.1 samba<span style="font-family: '微软雅黑',sans-serif;">服务简介</span></span>

<span style="font-family: '微软雅黑',sans-serif;">　　</span>Samba<span style="font-family: '微软雅黑',sans-serif;">是一个能让</span>Linux<span style="font-family: '微软雅黑',sans-serif;">系统应用</span>Microsoft<span style="font-family: '微软雅黑',sans-serif;">网络通讯协议的软件，而</span>SMB<span style="font-family: '微软雅黑',sans-serif;">是</span>S**<span style="color: #00b0f0;">erver Message Block</span>**<span style="font-family: '微软雅黑',sans-serif;">的缩写，即为<strong><span style="color: #00b0f0;">服务器消息块</span></strong></span><span style="font-family: '微软雅黑',sans-serif;">，</span>SMB<span style="font-family: '微软雅黑',sans-serif;">主要是作为</span>Microsoft<span style="font-family: '微软雅黑',sans-serif;">的网络通讯协议，后来</span>Samba<span style="font-family: '微软雅黑',sans-serif;">将</span>SMB<span style="font-family: '微软雅黑',sans-serif;">通信协议应用到了</span>Linux<span style="font-family: '微软雅黑',sans-serif;">系统上，就形成了现在的</span>Samba<span style="font-family: '微软雅黑',sans-serif;">软件。后来微软又把</span> SMB <span style="font-family: '微软雅黑',sans-serif;">改名为</span> CIFS<span style="font-family: '微软雅黑',sans-serif;">（</span>Common Internet File System<span style="font-family: '微软雅黑',sans-serif;">），即公共</span> Internet <span style="font-family: '微软雅黑',sans-serif;">文件系统，并且加入了许多新的功能，这样一来，使得</span>Samba<span style="font-family: '微软雅黑',sans-serif;">具有了更强大的功能。</span>

<span style="font-family: '微软雅黑',sans-serif;">　　</span>Samba<span style="font-family: '微软雅黑',sans-serif;">最大的功能就是<span style="background: lime;">可以用于</span></span><span style="background: lime;">Linux</span><span style="font-family: '微软雅黑',sans-serif; courier new"4courier new"; background: lime;">与</span><span style="background: lime;">windows</span><span style="font-family: '微软雅黑',sans-serif; courier new"4courier new"; background: lime;">系统直接的文件共享和打印共享</span><span style="font-family: '微软雅黑',sans-serif;">，</span>Samba<span style="font-family: '微软雅黑',sans-serif;">既可以用于</span>windows<span style="font-family: '微软雅黑',sans-serif;">与</span>Linux<span style="font-family: '微软雅黑',sans-serif;">之间的文件共享，也可以用于</span>Linux<span style="font-family: '微软雅黑',sans-serif;">与</span>Linux<span style="font-family: '微软雅黑',sans-serif;">之间的资源共享，由于</span>NFS(<span style="font-family: '微软雅黑',sans-serif;">网络文件系统）可以很好的完成</span>Linux<span style="font-family: '微软雅黑',sans-serif;">与</span>Linux<span style="font-family: '微软雅黑',sans-serif;">之间的数据共享，因而</span> Samba<span style="font-family: '微软雅黑',sans-serif;">较多的用在了</span>Linux<span style="font-family: '微软雅黑',sans-serif;">与</span>windows<span style="font-family: '微软雅黑',sans-serif;">之间的数据共享上面。</span>

<span style="font-family: '微软雅黑',sans-serif;">　　</span>SMB<span style="font-family: '微软雅黑',sans-serif;">是<span style="background: yellow;">基于客户机</span></span><span style="background: yellow;">/</span><span style="font-family: '微软雅黑',sans-serif; courier new"4courier new"; background: yellow;">服务器型的协议</span><span style="font-family: '微软雅黑',sans-serif;">，因而一台</span>Samba<span style="font-family: '微软雅黑',sans-serif;">服务器既可以充当文件共享服务器，也可以充当一个</span>Samba<span style="font-family: '微软雅黑',sans-serif;">的客户端，例如，一台在</span>Linux <span style="font-family: '微软雅黑',sans-serif;">下已经架设好的</span>Samba<span style="font-family: '微软雅黑',sans-serif;">服务器，</span>windows<span style="font-family: '微软雅黑',sans-serif;">客户端就可以通过</span>SMB<span style="font-family: '微软雅黑',sans-serif;">协议共享</span>Samba<span style="font-family: '微软雅黑',sans-serif;">服务器上的资源文件，同时，</span>Samba<span style="font-family: '微软雅黑',sans-serif;">服务器也可以访问网络中</span> <span style="font-family: '微软雅黑',sans-serif;">其它</span>windows<span style="font-family: '微软雅黑',sans-serif;">系统或者</span>Linux<span style="font-family: '微软雅黑',sans-serif;">系统共享出来的文件。</span>

<p style="text-indent: 21.0pt;">
  Samba<span style="font-family: '微软雅黑',sans-serif;">在</span>windows<span style="font-family: '微软雅黑',sans-serif;">下使用的是</span>NetBIOS<span style="font-family: '微软雅黑',sans-serif;">协议，如果你要使用</span>Linux<span style="font-family: '微软雅黑',sans-serif;">下共享出来的文件，<span style="color: red;">请确认你的</span></span><span style="color: red;">windows</span><span style="font-family: '微软雅黑',sans-serif; courier new"4courier new"; color: red;">系统下是否安装了</span><span style="color: red;">NetBIOS</span><span style="font-family: '微软雅黑',sans-serif; courier new"4courier new";color: red;">协议</span><span style="font-family: '微软雅黑',sans-serif;">。</span>
</p>

<span style="font-family: '微软雅黑',sans-serif;">　　<span style="background: lime;">组成</span></span><span style="background: lime;">Samba</span><span style="font-family: '微软雅黑',sans-serif; courier new"4courier new"; background: lime;">运行的有两个服务，一个是</span><span style="background: lime;">SMB</span><span style="font-family: '微软雅黑',sans-serif; courier new"4courier new";background: lime;">，另一个是</span><span style="background: lime;">NMB</span><span style="font-family: '微软雅黑',sans-serif;">；</span><span style="background: aqua;">SMB</span><span style="font-family: '微软雅黑',sans-serif; courier new"4courier new";background: aqua;">是</span><span style="background: aqua;">Samba </span><span style="font-family: '微软雅黑',sans-serif; courier new"4courier new";background: aqua;">的核心启动服务，</span><span style="font-family: '微软雅黑',sans-serif;">主要负责建立</span> Linux Samba<span style="font-family: '微软雅黑',sans-serif;">服务器与</span>Samba<span style="font-family: '微软雅黑',sans-serif;">客户机之间的对话，</span> <span style="font-family: '微软雅黑',sans-serif;">验证用户身份并提供对文件和打印系统的访问，只有</span>SMB<span style="font-family: '微软雅黑',sans-serif;">服务启动，才能实现文件的共享，监听</span>**<span style="color: red;">139</span>** <span style="color: red;">TCP</span><span style="font-family: '微软雅黑',sans-serif; courier new"4courier new"; color: red;">端口</span><span style="font-family: '微软雅黑',sans-serif;">；而</span><span style="background: aqua;">NMB</span><span style="font-family: '微软雅黑',sans-serif; courier new"4courier new";background: aqua;">服务是负责解析用的</span><span style="font-family: '微软雅黑',sans-serif;">，类似与</span>DNS<span style="font-family: '微软雅黑',sans-serif;">实现的功能，</span>NMB<span style="font-family: '微软雅黑',sans-serif;">可以把</span>Linux<span style="font-family: '微软雅黑',sans-serif;">系统共享的工作组名称与其</span>IP<span style="font-family: '微软雅黑',sans-serif;">对应起来，如果</span>NMB<span style="font-family: '微软雅黑',sans-serif;">服务没有启动，就只能通过</span>IP<span style="font-family: '微软雅黑',sans-serif;">来访问共享文件，监听</span>137<span style="font-family: '微软雅黑',sans-serif;">和</span>138 UDP<span style="font-family: '微软雅黑',sans-serif;">端口。</span>

<span style="font-family: '微软雅黑',sans-serif;">　　例如，某台</span>Samba<span style="font-family: '微软雅黑',sans-serif;">服务器的</span>IP<span style="font-family: '微软雅黑',sans-serif;">地址为</span>10.0.0.163<span style="font-family: '微软雅黑',sans-serif;">，对应的工作组名称为</span>davidsamba<span style="font-family: '微软雅黑',sans-serif;">，那么在</span>Windows<span style="font-family: '微软雅黑',sans-serif;">的</span>IE<span style="font-family: '微软雅黑',sans-serif;">浏览器输入下面两条指令都可以访问共享文件。其实这就是</span>Windows<span style="font-family: '微软雅黑',sans-serif;">下查看</span>Linux Samba<span style="font-family: '微软雅黑',sans-serif;">服务器共享文件的方法。</span>

> &nbsp;
> 
> 　　\\10.0.0.163\共享目录名称
> 
> &nbsp;
> 
> 　　\\davidsamba\共享目录名称
> 
> &nbsp;

<span style="font-family: '微软雅黑',sans-serif;">　　</span>Samba<span style="font-family: '微软雅黑',sans-serif;">服务器可实现如下功能：</span>WINS<span style="font-family: '微软雅黑',sans-serif;">和</span>DNS<span style="font-family: '微软雅黑',sans-serif;">服务；</span> <span style="font-family: '微软雅黑',sans-serif;">网络浏览服务；</span> Linux<span style="font-family: '微软雅黑',sans-serif;">和</span>Windows<span style="font-family: '微软雅黑',sans-serif;">域之间的认证和授权；</span> UNICODE<span style="font-family: '微软雅黑',sans-serif;">字符集和域名映射；满足</span>CIFS<span style="font-family: '微软雅黑',sans-serif;">协议的</span>UNIX<span style="font-family: '微软雅黑',sans-serif;">共享等。</span>

## <span id="22_samba">2.2 samba<span style="font-family: '微软雅黑',sans-serif;">服务端部署</span></span>

### <span id="221_samba">2.2.1 <span style="font-family: '微软雅黑',sans-serif;">第一个里程碑：</span> <span style="font-family: '微软雅黑',sans-serif;">检查软件是否安装（安装</span>samba<span style="font-family: '微软雅黑',sans-serif;">软件）</span></span>

<div class="cnblogs_code">
  <pre>[root@test ~]# rpm -qa samba</pre>
</div>

<span style="font-family: '微软雅黑',sans-serif;">安装</span>samba<span style="font-family: '微软雅黑',sans-serif;">服务</span>

<div class="cnblogs_code">
  <pre>[root@test ~]# <span style="color: #0000ff;">yum</span> <span style="color: #0000ff;">install</span>  samba -<span style="color: #000000;">y
Dependency Installed:
  libtalloc.x86_64 </span><span style="color: #800080;"></span>:<span style="color: #800080;">2.1</span>.<span style="color: #800080;">5</span>-<span style="color: #800080;">1</span><span style="color: #000000;">.el6_7                                               
  libtdb.x86_64 </span><span style="color: #800080;"></span>:<span style="color: #800080;">1.3</span>.<span style="color: #800080;">8</span>-<span style="color: #800080;">3</span>.el6_8.<span style="color: #800080;">2</span><span style="color: #000000;">                                                
  libtevent.x86_64 </span><span style="color: #800080;"></span>:<span style="color: #800080;">0.9</span>.<span style="color: #800080;">26</span>-<span style="color: #800080;">2</span><span style="color: #000000;">.el6_7                                              
  samba</span>-common.x86_64 <span style="color: #800080;"></span>:<span style="color: #800080;">3.6</span>.<span style="color: #800080;">23</span>-<span style="color: #800080;">45</span><span style="color: #000000;">.el6_9                                          
  samba</span>-winbind.x86_64 <span style="color: #800080;"></span>:<span style="color: #800080;">3.6</span>.<span style="color: #800080;">23</span>-<span style="color: #800080;">45</span><span style="color: #000000;">.el6_9                                         
  samba</span>-winbind-clients.x86_64 <span style="color: #800080;"></span>:<span style="color: #800080;">3.6</span>.<span style="color: #800080;">23</span>-<span style="color: #800080;">45</span>.el6_9      </pre>
</div>

### <span id="222">2.2.2 <span style="font-family: '微软雅黑',sans-serif;">第二个里程碑：</span> <span style="font-family: '微软雅黑',sans-serif;">编写配置文件</span></span>

<p style="margin-left: 7.1pt;">
  samba<span style="font-family: '微软雅黑',sans-serif;">服务默认配置文件位置为</span><strong><span style="color: red;">/etc/samba/smb.conf </span></strong><span style="font-family: '微软雅黑',sans-serif;">备份该文件，重新写配置文件</span>
</p>

<div class="cnblogs_code">
  <pre>[root@test ~]# <span style="color: #0000ff;">mv</span>  /etc/samba/smb.conf /etc/samba/smb.conf.bak</pre>
</div>

**<span style="font-family: '微软雅黑',sans-serif; courier new"4courier new";background: lime;">配置文件内容：</span>**

<div class="cnblogs_code">
  <pre>[root@test ~]# vim /etc/samba/<span style="color: #000000;">smb.conf

[global]
workgroup </span>=<span style="color: #000000;"> WORKGROUP
netbios name </span>=<span style="color: #000000;"> Test_samba
server </span><span style="color: #0000ff;">string</span> =<span style="color: #000000;"> Linux Samba Server TestServer
security </span>=<span style="color: #000000;"> share

[test]
path </span>= /<span style="color: #000000;">share_samba
writeable </span>=<span style="color: #000000;"> yes
browseable </span>=<span style="color: #000000;"> yes
guest ok </span>=<span style="color: #000000;"> yes
</span>~                                                                                
<span style="color: #800000;">"</span><span style="color: #800000;">/etc/samba/smb.conf</span><span style="color: #800000;">"</span> <span style="color: #800080;">11L</span>, 189C written</pre>
</div>

**<span style="font-family: '微软雅黑',sans-serif; courier new"4courier new";background: lime;">配置文件参数说明：</span>**

<table style="border-collapse: collapse; border-width: initial; border-style: none; border-color: initial;" border="1" cellspacing="0" cellpadding="0">
  <tr>
    <td style="width: 148.6pt; border-width: 1pt; border-style: solid; border-color: windowtext; background: gray; padding: 0cm 5.4pt;" width="198">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <strong><span style="font-family: '微软雅黑',sans-serif;">参数</span></strong>
      </p>
    </td>
    
    <td style="width: 374.2pt; border-top: 1pt solid windowtext; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: none; background: gray; padding: 0cm 5.4pt;" width="499">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <strong><span style="font-family: '微软雅黑',sans-serif;">说明</span></strong>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 148.6pt; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="198">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        [global]
      </p>
    </td>
    
    <td style="width: 374.2pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="499">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">这段是全局配置，是必段写的。</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 148.6pt; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="198">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        workgroup
      </p>
    </td>
    
    <td style="width: 374.2pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="499">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">就是</span>Windows<span style="font-family: '微软雅黑',sans-serif;">中显示的工作组</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 148.6pt; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="198">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        netbios name
      </p>
    </td>
    
    <td style="width: 374.2pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="499">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">就是在</span>Windows<span style="font-family: '微软雅黑',sans-serif;">中显示出来的计算机名</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 148.6pt; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="198">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        server string
      </p>
    </td>
    
    <td style="width: 374.2pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="499">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">就是</span>Samba<span style="font-family: '微软雅黑',sans-serif;">服务器说明，可以自己来定义；这个不是什么重要的</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 148.6pt; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="198">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        security
      </p>
    </td>
    
    <td style="width: 374.2pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="499">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">这是验证和登录方式，这里我们用了</span>share
      </p>
      
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">用</span>share<span style="font-family: '微软雅黑',sans-serif;">，就是不用设置用户和密码了</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 148.6pt; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="198">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        [test]
      </p>
    </td>
    
    <td style="width: 374.2pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="499">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">这个在</span>Windows<span style="font-family: '微软雅黑',sans-serif;">中显示出来是共享的目录</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 148.6pt; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="198">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        path
      </p>
    </td>
    
    <td style="width: 374.2pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="499">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">可以设置要共享的目录放在哪里</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 148.6pt; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="198">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        writeable
      </p>
    </td>
    
    <td style="width: 374.2pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="499">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">是否可写，这里我设置为可写</span>
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 148.6pt; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="198">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        browseable
      </p>
    </td>
    
    <td style="width: 374.2pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="499">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">是否可以浏览，可以；可以浏览意味着，我们在工作组下能看到共享文件夹。如果您不想显示出来，那就设置为</span> browseable=no
      </p>
    </td>
  </tr>
  
  <tr>
    <td style="width: 148.6pt; border-right: 1pt solid windowtext; border-bottom: 1pt solid windowtext; border-left: 1pt solid windowtext; border-top: none; padding: 0cm 5.4pt;" width="198">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        guest ok
      </p>
    </td>
    
    <td style="width: 374.2pt; border-top: none; border-left: none; border-bottom: solid windowtext 1.0pt; border-right: solid windowtext 1.0pt; padding: 0cm 5.4pt 0cm 5.4pt;" width="499">
      <p style="text-align: justify; text-justify: inter-ideograph;">
        <span style="font-family: '微软雅黑',sans-serif;">匿名用户以</span>guest<span style="font-family: '微软雅黑',sans-serif;">身份是登录</span>
      </p>
    </td>
  </tr>
</table>

### <span id="223">2.2.3 <span style="font-family: '微软雅黑',sans-serif;">第三个里程碑：</span> <span style="font-family: '微软雅黑',sans-serif;">创建共享目录，修改权限</span></span>

<div class="cnblogs_code">
  <pre>[root@test ~]# <span style="color: #0000ff;">mkdir</span> -p /<span style="color: #000000;">share_samba
[root@test </span>~]# <span style="color: #0000ff;">id</span><span style="color: #000000;"> nobody
uid</span>=<span style="color: #800080;">99</span>(nobody) gid=<span style="color: #800080;">99</span>(nobody) <span style="color: #0000ff;">groups</span>=<span style="color: #800080;">99</span><span style="color: #000000;">(nobody)

[root@test </span>~]# <span style="color: #0000ff;">chown</span> nobody.nobody /share_samba -R</pre>
</div>

**<span style="font-family: '微软雅黑',sans-serif; courier new"4courier new";background: yellow;">说明：</span>**

&nbsp;&nbsp; <span style="font-family: '微软雅黑',sans-serif;">关于授权</span>nobody<span style="font-family: '微软雅黑',sans-serif;">，我们先用</span>id<span style="font-family: '微软雅黑',sans-serif;">命令查看了</span>nobody<span style="font-family: '微软雅黑',sans-serif;">用户的信息，发现他的用户组也是</span>nobody<span style="font-family: '微软雅黑',sans-serif;">，我们要以这个为准。有些系统</span>nobody<span style="font-family: '微软雅黑',sans-serif;">用户组并非是</span>nobody <span style="font-family: '微软雅黑',sans-serif;">。</span>

### <span id="224_smbnmb">2.2.4 <span style="font-family: '微软雅黑',sans-serif;">第四个里程碑：</span> <span style="font-family: '微软雅黑',sans-serif;">启动</span>smb<span style="font-family: '微软雅黑',sans-serif;">和</span>nmb<span style="font-family: '微软雅黑',sans-serif;">服务，加入开机启动</span></span>

<div class="cnblogs_code">
  <pre>[root@test ~]# /etc/init.d/<span style="color: #000000;">smb start
Starting SMB services:                                     [  OK  ]

[root@test </span>~<span style="color: #000000;">]# chkconfig smb on
[root@test </span>~]# chkconfig |<span style="color: #0000ff;">grep</span><span style="color: #000000;"> smb
smb            </span><span style="color: #800080;"></span>:off  <span style="color: #800080;">1</span>:off  <span style="color: #800080;">2</span>:on   <span style="color: #800080;">3</span>:on   <span style="color: #800080;">4</span>:on   <span style="color: #800080;">5</span>:on   <span style="color: #800080;">6</span>:off</pre>
</div>

<div style="border: solid windowtext 2.0pt; padding: 1.0pt 4.0pt 1.0pt 4.0pt; background: #F2F2F2;">
  <p>
    <strong><span style="font-family: '微软雅黑',sans-serif;">说明：</span></strong>
  </p>
  
  <p>
    &nbsp;&nbsp;&nbsp; <span style="font-family: '微软雅黑',sans-serif;">由于未涉及域名解析，所以不启动</span>nmb<span style="font-family: '微软雅黑',sans-serif;">服务也可以访问</span>
  </p>
</div>

## <span id="23_windows">2.3 windows<span style="font-family: '微软雅黑',sans-serif;">客户端测试</span></span>

### <span id="231_windowssamba">2.3.1 windows<span style="font-family: '微软雅黑',sans-serif;">上添加网络位置（</span>samba<span style="font-family: '微软雅黑',sans-serif;">共享的文件夹）</span></span>

<div style="border: solid windowtext 2.0pt; padding: 1.0pt 4.0pt 1.0pt 4.0pt; background: #F2F2F2;">
  <p>
    &nbsp;&nbsp;&nbsp; <span style="font-family: '微软雅黑',sans-serif;">打开资源管理器，右键单击，选择&ldquo;添加网络位置&rdquo;</span>
  </p>
</div>

<p style="text-align: center;" align="center">
  <img data-original="https://images2017.cnblogs.com/blog/1190037/201711/1190037-20171122215214618-487143535.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="FTP&samba 服务简单部署" alt="" />
</p>

<div style="border: solid windowtext 2.0pt; padding: 1.0pt 4.0pt 1.0pt 4.0pt; background: #F2F2F2;">
  <p>
    <span style="font-family: '微软雅黑',sans-serif;">输入</span> samba<span style="font-family: '微软雅黑',sans-serif;">服务器的地址</span>
  </p>
  
  <p>
    <span style="font-family: '微软雅黑',sans-serif;">格式：</span> \\<em>samba</em><em><span style="font-family: '微软雅黑',sans-serif;">服务器地址</span></em>\<em><span style="font-family: '微软雅黑',sans-serif;">共享目录名称</span></em>
  </p>
  
  <p>
    <strong><span style="font-family: '微软雅黑',sans-serif; color: red;">说明</span><span style="color: red;">:</span></strong><em><span style="font-family: '微软雅黑',sans-serif;">共享目录名称</span> </em><span style="font-family: '微软雅黑',sans-serif;">为设置的局部变量名，我设置的为</span>[test]<span style="font-family: '微软雅黑',sans-serif;">。</span>
  </p>
</div>

<p style="text-align: center;" align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171122215230696-675263253.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="FTP&samba 服务简单部署" alt="" />&nbsp;
</p>

<div style="border: solid windowtext 2.0pt; padding: 1.0pt 4.0pt 1.0pt 4.0pt; background: #F2F2F2;">
  <p>
    &nbsp;&nbsp;&nbsp; <span style="font-family: '微软雅黑',sans-serif;">点击下一步，设置显示的名称【可以选择默认】</span>
  </p>
</div>

<p style="text-align: center;" align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171122215301711-1449562885.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="FTP&samba 服务简单部署" alt="" />&nbsp;
</p>

<div style="border: solid windowtext 2.0pt; padding: 1.0pt 4.0pt 1.0pt 4.0pt; background: #F2F2F2;">
  <p>
    &nbsp;&nbsp;&nbsp; <span style="font-family: '微软雅黑',sans-serif;">至此</span>samba<span style="font-family: '微软雅黑',sans-serif;">共享的文件夹在</span>winndows<span style="font-family: '微软雅黑',sans-serif;">上添加上了</span> <span style="font-family: '微软雅黑',sans-serif;">。</span>
  </p>
</div>

<p style="text-align: center;" align="center">
  &nbsp;<img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171122215312883-1274433294.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="FTP&samba 服务简单部署" alt="" />
</p>

### <span id="232">2.3.2 <span style="font-family: '微软雅黑',sans-serif;">对共享文件夹进行测试</span></span>

<div style="border: solid windowtext 2.0pt; padding: 1.0pt 4.0pt 1.0pt 4.0pt; background: #F2F2F2;">
  <p>
    <span style="font-family: '微软雅黑',sans-serif;">上传测试</span>
  </p>
</div>

<p style="text-align: center;">
  &nbsp;<img data-original="https://images2017.cnblogs.com/blog/1190037/201711/1190037-20171122215325290-75123493.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="FTP&samba 服务简单部署" alt="" />
</p>

<div class="cnblogs_code">
  <pre>[root@test share_samba]# <span style="color: #0000ff;">pwd</span>
/<span style="color: #000000;">share_samba
[root@test share_samba]# tree
├── test.</span><span style="color: #0000ff;">zip</span><span style="color: #000000;">
└── samba sever.txt</span></pre>
</div>

<div style="border: solid windowtext 2.0pt; padding: 1.0pt 4.0pt 1.0pt 4.0pt; background: #F2F2F2;">
  <p>
    <strong><span style="font-family: '微软雅黑',sans-serif;">下载文件测试</span></strong>
  </p>
</div>

<p style="text-align: center;" align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171122215402711-584078708.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="FTP&samba 服务简单部署" alt="" />&nbsp;
</p>

## <span id="24_cento_69samba">2.4 <span style="font-family: '微软雅黑',sans-serif;">在</span>cento 6.9<span style="font-family: '微软雅黑',sans-serif;">上测试说明</span>samba<span style="font-family: '微软雅黑',sans-serif;">共享</span></span>

<span style="font-family: '微软雅黑',sans-serif;">安装</span>samba<span style="font-family: '微软雅黑',sans-serif;">客户端</span>

&nbsp;

<div class="cnblogs_code">
  <pre>[root@test <span style="color: #0000ff;">ftp</span>]# <span style="color: #0000ff;">yum</span> <span style="color: #0000ff;">install</span> samba-client</pre>
</div>

<div class="cnblogs_code">
  <pre>[root@test ~]# smbclient <span style="color: #008000;">//</span><span style="color: #008000;">172.16.1.250/test</span>
WARNING: The security=<span style="color: #000000;">share option is deprecated
Enter root</span><span style="color: #800000;">'</span><span style="color: #800000;">s password:</span>
Domain=[WORKGROUP] OS=[Unix] Server=[Samba <span style="color: #800080;">3.6</span>.<span style="color: #800080;">23</span>-<span style="color: #800080;">45</span><span style="color: #000000;">.el6_9]
Server not using user level security and no password supplied.
smb: \</span>> <span style="color: #0000ff;">ls</span><span style="color: #000000;">
  .                                   D        </span><span style="color: #800080;"></span>  Sat Oct <span style="color: #800080;">14</span> <span style="color: #800080;">14</span>:<span style="color: #800080;">38</span>:<span style="color: #800080;">47</span> <span style="color: #800080;">2017</span><span style="color: #000000;">
  ..                                 DR        </span><span style="color: #800080;"></span>  Sat Oct <span style="color: #800080;">14</span> <span style="color: #800080;">13</span>:<span style="color: #800080;">49</span>:<span style="color: #800080;">02</span> <span style="color: #800080;">2017</span><span style="color: #000000;">
  samba sever.txt                     A       </span><span style="color: #800080;">60</span>  Sat Oct <span style="color: #800080;">14</span> <span style="color: #800080;">03</span>:<span style="color: #800080;">05</span>:<span style="color: #800080;">00</span> <span style="color: #800080;">2017</span><span style="color: #000000;">
  redhat</span>-release                              <span style="color: #800080;">27</span>  Sat Oct <span style="color: #800080;">14</span> <span style="color: #800080;">14</span>:<span style="color: #800080;">49</span>:<span style="color: #800080;">16</span> <span style="color: #800080;">2017</span><span style="color: #000000;">
  test.</span><span style="color: #0000ff;">zip</span>                            A  <span style="color: #800080;">7234678</span>  Sat Oct <span style="color: #800080;">14</span> <span style="color: #800080;">11</span>:<span style="color: #800080;">08</span>:<span style="color: #800080;">50</span> <span style="color: #800080;">2017</span>
 
    <span style="color: #800080;">38152</span> blocks of size <span style="color: #800080;">524288</span>. <span style="color: #800080;">32854</span> blocks available</pre>
</div>

<span style="font-family: '微软雅黑',sans-serif;">挂载方式</span>

<div class="cnblogs_code">
  <pre>[root@test ~]# <span style="color: #0000ff;">mount</span>.tmpfs <span style="color: #008000;">//</span><span style="color: #008000;">10.0.0.250/test/ /mnt/</span>
[root@test ~]# <span style="color: #0000ff;">df</span> -<span style="color: #000000;">h
Filesystem          Size  Used Avail Use</span>%<span style="color: #000000;"> Mounted on
</span>/dev/sda3            19G  <span style="color: #800080;">1</span>.7G   17G  <span style="color: #800080;">10</span>% /<span style="color: #000000;">
tmpfs               238M     </span><span style="color: #800080;"></span>  238M   <span style="color: #800080;"></span>% /dev/<span style="color: #000000;">shm
</span>/dev/sda1           190M   40M  141M  <span style="color: #800080;">22</span>% /<span style="color: #000000;">boot
</span><span style="color: #008000;">//</span><span style="color: #008000;">10.0.0.250/test/  238M     0  238M   0% /mnt</span></pre>
</div>

<span style="color: #ff0000; background-color: #ffff00;"><strong><span style="font-family: '微软雅黑',sans-serif;">至此</span>samba<span style="font-family: '微软雅黑',sans-serif;">服务配置完成。</span></strong></span>

&nbsp;

<div id="toc_container" class="toc_white have_bullets">
  <ul class="toc_list">
    <li>
      <a href="#1_FTP">第1章 FTP服务部署</a><ul>
        <li>
          <a href="#11">1.1 服务端配置</a><ul>
            <li>
              <a href="#111">1.1.1 第一个里程碑： 检查是否有这个软件，（没有则安装软件）</a>
            </li>
            <li>
              <a href="#112">1.1.2 第二个里程碑： 编写配置文件</a>
            </li>
            <li>
              <a href="#113_FTP">1.1.3 第三个里程碑：创建用于FTP连接用户，设置密码</a>
            </li>
            <li>
              <a href="#114_ftpftpuser_ftpuser">1.1.4 第四个里程碑： 创建ftp共享目录，将目录所有者属于ftpuser，将 ftpuser用户家目录修改为共享目录。</a>
            </li>
            <li>
              <a href="#115_vsftpd">1.1.5 第五个里程碑： 启动vsftpd 服务，并设置开机自启动</a>
            </li>
          </ul>
        </li>
        
        <li>
          <a href="#12">1.2 客户端链接测试</a><ul>
            <li>
              <a href="#121">1.2.1 下载文件测试</a>
            </li>
            <li>
              <a href="#122">1.2.2 上传文件测试</a>
            </li>
            <li>
              <a href="#123">1.2.3 服务端检查</a>
            </li>
          </ul>
        </li>
        
        <li>
          <a href="#13_linuxftp">1.3 linux系统挂载ftp测试</a>
        </li>
      </ul>
    </li>
    
    <li>
      <a href="#2_samba">第2章 samba服务配置</a><ul>
        <li>
          <a href="#21_samba">2.1 samba服务简介</a>
        </li>
        <li>
          <a href="#22_samba">2.2 samba服务端部署</a><ul>
            <li>
              <a href="#221_samba">2.2.1 第一个里程碑： 检查软件是否安装（安装samba软件）</a>
            </li>
            <li>
              <a href="#222">2.2.2 第二个里程碑： 编写配置文件</a>
            </li>
            <li>
              <a href="#223">2.2.3 第三个里程碑： 创建共享目录，修改权限</a>
            </li>
            <li>
              <a href="#224_smbnmb">2.2.4 第四个里程碑： 启动smb和nmb服务，加入开机启动</a>
            </li>
          </ul>
        </li>
        
        <li>
          <a href="#23_windows">2.3 windows客户端测试</a><ul>
            <li>
              <a href="#231_windowssamba">2.3.1 windows上添加网络位置（samba共享的文件夹）</a>
            </li>
            <li>
              <a href="#232">2.3.2 对共享文件夹进行测试</a>
            </li>
          </ul>
        </li>
        
        <li>
          <a href="#24_cento_69samba">2.4 在cento 6.9上测试说明samba共享</a>
        </li>
      </ul>
    </li>
  </ul>
</div>