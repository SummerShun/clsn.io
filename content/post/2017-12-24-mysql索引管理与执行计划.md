---
title: MySQL 索引管理与执行计划
author: 惨绿少年
type: post
date: 2017-12-23T17:22:00+00:00
url: /clsn/lx399.html
Baidusubmit:
  - 1
views:
  - 225
categories:
  - Linux运维
  - MySQL
  - 数据库
  - 运维基本功

---
## <span id="11">1.1 索引的介绍</span>

　　索引是对数据库表中一列或多列的值进行排序的一种结构，使用索引可快速访问数据库表中的特定信息。如果想按特定职员的姓来查找他或她，则与在表中搜索所有的行相比，索引有助于更快地获取信息。

　　索引的一个主要目的就是加快检索表中数据的方法，亦即能协助信息搜索者尽快的找到符合限制条件的记录ID的辅助数据结构。

<p align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171222194530881-1683712218.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="MySQL 索引管理与执行计划" alt="" />
</p>

### <span id="111">1.1.1 唯一索引</span>

　　唯一索引是不允许其中任何两行具有相同索引值的索引。当现有数据中存在重复的键值时，大多数数据库不允许将新创建的唯一索引与表一起保存。数据库还可能防止添加将在表中创建重复键值的新数据。

　　例如，如果在employee表中职员的姓(lname)上创建了唯一索引，则任何两个员工都不能同姓。

### <span id="112">1.1.2 主键索引</span>

　　数据库表经常有一列或多列组合，其值唯一标识表中的每一行。该列称为表的主键。在数据库关系图中为表定义主键将自动创建主键索引，主键索引是唯一索引的特定类型。

　　该索引要求主键中的每个值都唯一。当在查询中使用主键索引时，它还允许对数据的快速访问。

### <span id="113">1.1.3 聚集索引</span>

　　在聚集索引中，表中行的物理顺序与键值的逻辑（索引）顺序相同。一个表只能包含一个聚集索引。如果某索引不是聚集索引，则表中行的物理顺序与键值的逻辑顺序不匹配。与非聚集索引相比，聚集索引通常提供更快的数据访问速度。

　　聚集索引和非聚集索引的区别，如字典默认按字母顺序排序，读者如知道某个字的读音可根据字母顺序快速定位。因此聚集索引和表的内容是在一起的。如读者需查询某个生僻字，则需按字典前面的索引，举例按偏旁进行定位，找到该字对应的页数，再打开对应页数找到该字。

　　这种通过两个地方而查询到某个字的方式就如非聚集索引。

### <span id="114">1.1.4 索引列</span>

　　可以基于数据库表中的单列或多列创建索引。多列索引可以区分其中一列可能有相同值的行。如果经常同时搜索两列或多列或按两列或多列排序时，索引也很有帮助。

　　例如，如果经常在同一查询中为姓和名两列设置判据，那么在这两列上创建多列索引将很有意义。

　　检查查询的WHERE和JOIN子句。在任一子句中包括的每一列都是索引可以选择的对象。对新索引进行试验以检查它对运行查询性能的影响。考虑已在表上创建的索引数量。最好避免在单个表上有很多索引。

　　检查已在表上创建的索引的定义。最好避免包含共享列的重叠索引。

检查某列中唯一数据值的数量，并将该数量与表中的行数进行比较。比较的结果就是该列的可选择性，这有助于确定该列是否适合建立索引，如果适合，确定索引的类型。

### <span id="115_B">1.1.5 B树算法</span>

<p align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171222194619443-1309320406.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="MySQL 索引管理与执行计划" alt="" />
</p>

　　B树的搜索，从根结点开始，如果查询的关键字与结点的关键字相等，那么就命中；否则，如果查询关键字比结点关键字小，就进入左边；如果比结点关键字大，就进入右边；如果左边或右边的指针为空，则报告找不到相应的关键。

如果B树的所有非叶子结点的左右子树的结点数目均保持差不多（平衡），那么B树的搜索性能逼近二分查找；但它比连续内存空间的二分查找的优点是，改变B树结构（插入与删除结点）不需要移动大段的内存数据，甚至通常是常数开销。

### <span id="116_B">1.1.6 B+树算法</span>

&nbsp;&nbsp; &nbsp;B+树是B-树的变体，也是一种多路搜索树：

<div>
  <div class="cnblogs_code">
    <pre>       <span style="color: #800000; font-weight: bold;">1</span>.其定义基本与B<span style="color: #808080;">-</span><span style="color: #000000;">树同，除了：
       </span><span style="color: #800000; font-weight: bold;">2</span><span style="color: #000000;">.非叶子结点的子树指针与关键字个数相同；
       </span><span style="color: #800000; font-weight: bold;">3</span>.非叶子结点的子树指针P<span style="color: #ff0000;">[</span><span style="color: #ff0000;">i</span><span style="color: #ff0000;">]</span>，指向关键字值属于<span style="color: #ff0000;">[</span><span style="color: #ff0000;">K[i</span><span style="color: #ff0000;">]</span>, K<span style="color: #ff0000;">[</span><span style="color: #ff0000;">i+1</span><span style="color: #ff0000;">]</span>)的子树（B<span style="color: #808080;">-</span><span style="color: #000000;">树是开区间）；
       </span><span style="color: #800000; font-weight: bold;">5</span><span style="color: #000000;">.为所有叶子结点增加一个链指针；
       </span><span style="color: #800000; font-weight: bold;">6</span><span style="color: #000000;">.所有关键字都在叶子结点出现；
       如：（M</span><span style="color: #808080;">=</span><span style="color: #800000; font-weight: bold;">3</span>）</pre>
  </div>
</div>

<p align="center">
  <img data-original="https://clsn.io/wp-content/uploads/2018/03/1190037-20171222194700896-434081371.png" src="/wp-content/themes/clsn-003/img/blank.gif" alt="MySQL 索引管理与执行计划" alt="" />&nbsp;
</p>

　　&nbsp;B+的搜索与B-树也基本相同，区别是B+树只有达到叶子结点才命中（B-树可以在非叶子结点命中），其性能也等价于在关键字全集做一次二分查找；

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; B+的特性：

<div>
  <div class="cnblogs_code">
    <pre>       <span style="color: #800000; font-weight: bold;">1</span><span style="color: #000000;">.所有关键字都出现在叶子结点的链表中（稠密索引），且链表中的关键字恰好是有序的；
       </span><span style="color: #800000; font-weight: bold;">2</span><span style="color: #000000;">.不可能在非叶子结点命中；
       </span><span style="color: #800000; font-weight: bold;">3</span><span style="color: #000000;">.非叶子结点相当于是叶子结点的索引（稀疏索引），叶子结点相当于是存储（关键字）数据的数据层；
       </span><span style="color: #800000; font-weight: bold;">4</span>.更适合文件索引系统；</pre>
  </div>
</div>

### <span id="117_HASHHASH">1.1.7 HASH：HASH算法</span>

　　哈希索引只有Memory, NDB两种引擎支持，Memory引擎默认支持哈希索引，如果多个hash值相同，出现哈希碰撞，那么索引以链表方式存储。

　　但是，Memory引擎表只对能够适合机器的内存切实有限的数据集。

　　要使InnoDB或MyISAM支持哈希索引，可以通过伪哈希索引来实现，叫自适应哈希索引。

　　主要通过增加一个字段，存储hash值，将hash值建立索引，在插入和更新的时候，建立触发器，自动添加计算后的hash到表里。

### <span id="118">1.1.8 其他的索引</span>

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #000000;">FULLTEXT：全文索引
RTREE：R树索引</span></pre>
  </div>
</div>

## <span id="12_MySQL">1.2 MySQL索引管理</span>

　　索引建立在表的列上(字段)的。

　　在where后面的列建立索引才会加快查询速度。

　　pages<\---索引（属性）<\----查数据。

添加索引的方法：

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #0000ff;">alter</span> <span style="color: #0000ff;">table</span> test <span style="color: #0000ff;">add</span> <span style="color: #0000ff;">index</span><span style="color: #000000;"> index_name(name);
</span><span style="color: #0000ff;">create</span> <span style="color: #0000ff;">index</span> index_name <span style="color: #0000ff;">on</span> test(name);</pre>
  </div>
</div>

语法格式:

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #0000ff;">alter</span> <span style="color: #0000ff;">table</span> 表 <span style="color: #0000ff;">add</span> <span style="color: #0000ff;">index</span> 索引名称(name);</pre>
  </div>
</div>

### <span id="121">1.2.1 创建普通索引</span>

创建普通索引方法一：

<div>
  <div class="cnblogs_code">
    <pre>mysql<span style="color: #808080;">></span> <span style="color: #0000ff;">ALTER</span> <span style="color: #0000ff;">TABLE</span> PLAYERS <span style="color: #0000ff;">ADD</span> <span style="color: #0000ff;">INDEX</span><span style="color: #000000;">   name_idx(NAME);
mysql</span><span style="color: #808080;">></span> <span style="color: #0000ff;">desc</span><span style="color: #000000;"> PLAYERS;
</span><span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">----------+-------------+------+-----+---------+-------+</span>
<span style="color: #808080;">|</span> Field      <span style="color: #808080;">|</span> Type        <span style="color: #808080;">|</span> <span style="color: #0000ff;">Null</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">Key</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">Default</span> <span style="color: #808080;">|</span> Extra <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">----------+-------------+------+-----+---------+-------+</span>
<span style="color: #808080;">|</span> NAME       <span style="color: #808080;">|</span> <span style="color: #0000ff;">char</span>(<span style="color: #800000; font-weight: bold;">15</span>)    <span style="color: #808080;">|</span> NO   <span style="color: #808080;">|</span> MUL <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>    <span style="color: #808080;">|</span>       <span style="color: #808080;">|</span></pre>
  </div>
</div>

创建普通索引方法二：

<div>
  <div class="cnblogs_code">
    <pre>mysql<span style="color: #808080;">></span> <span style="color: #0000ff;">ALTER</span> <span style="color: #0000ff;">TABLE</span> PLAYERS <span style="color: #0000ff;">ADD</span> <span style="color: #0000ff;">INDEX</span><span style="color: #000000;">   name_idx(NAME);
mysql</span><span style="color: #808080;">></span> <span style="color: #0000ff;">desc</span><span style="color: #000000;"> PLAYERS;
</span><span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">----------+-------------+------+-----+---------+-------+</span>
<span style="color: #808080;">|</span> Field      <span style="color: #808080;">|</span> Type        <span style="color: #808080;">|</span> <span style="color: #0000ff;">Null</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">Key</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">Default</span> <span style="color: #808080;">|</span> Extra <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">----------+-------------+------+-----+---------+-------+</span>
<span style="color: #808080;">|</span> NAME       <span style="color: #808080;">|</span> <span style="color: #0000ff;">char</span>(<span style="color: #800000; font-weight: bold;">15</span>)    <span style="color: #808080;">|</span> NO   <span style="color: #808080;">|</span> MUL <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>    <span style="color: #808080;">|</span>       <span style="color: #808080;">|</span></pre>
  </div>
</div>

### <span id="122">1.2.2 删除索引</span>

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #0000ff;">alter</span> <span style="color: #0000ff;">table</span> PLAYERS <span style="color: #0000ff;">delete</span> <span style="color: #0000ff;">INDEX</span>  name_idx;</pre>
  </div>
</div>

<div>
  <div class="cnblogs_code">
    <pre>mysql<span style="color: #808080;">></span> show <span style="color: #0000ff;">index</span> <span style="color: #0000ff;">from</span><span style="color: #000000;">  PLAYERS\G
</span><span style="color: #808080;">***************************</span> <span style="color: #800000; font-weight: bold;">1</span>. row <span style="color: #808080;">***************************</span>
        <span style="color: #0000ff;">Table</span><span style="color: #000000;">: PLAYERS
   Non_unique: </span><span style="color: #800000; font-weight: bold;"></span><span style="color: #000000;">
     Key_name: </span><span style="color: #0000ff;">PRIMARY</span><span style="color: #000000;">
 Seq_in_index: </span><span style="color: #800000; font-weight: bold;">1</span><span style="color: #000000;">
  Column_name: PLAYERNO
    Collation: A
  Cardinality: </span><span style="color: #800000; font-weight: bold;">14</span><span style="color: #000000;">
     Sub_part: </span><span style="color: #0000ff;">NULL</span><span style="color: #000000;">
       Packed: </span><span style="color: #0000ff;">NULL</span>
         <span style="color: #0000ff;">Null</span><span style="color: #000000;">: 
   Index_type: BTREE
      Comment: 
Index_comment:</span></pre>
  </div>
</div>

## <span id="13_MySQL">1.3 MySQL中的约束索引</span>

<span style="background-color: #ffff00;"><strong>主键索引</strong></span>

　　只能有一个主键。

　　主键索引:列的内容是唯一值,例如学号.

　　表创建的时候至少要有一个主键索引，最好和业务无关。

<span style="background-color: #ffff00;"><strong>普通索引</strong></span>

　　加快查询速度，工作中优化数据库的关键。

　　在合适的列上建立索引，让数据查询更高效。

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #0000ff;">create</span> <span style="color: #0000ff;">index</span> index_name <span style="color: #0000ff;">on</span><span style="color: #000000;"> test(name);
</span><span style="color: #0000ff;">alter</span> <span style="color: #0000ff;">table</span> test <span style="color: #0000ff;">add</span> <span style="color: #0000ff;">index</span> index_name(name);</pre>
  </div>
</div>

<span style="background-color: #ffff00;">用了索引，查一堆内容。</span>

　　在where条件关键字后面的列建立索引才会加快查询速度.

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #0000ff;">select</span> id,name <span style="color: #0000ff;">from</span> test <span style="color: #0000ff;">where</span> state<span style="color: #808080;">=</span><span style="color: #800000; font-weight: bold;">1</span> <span style="color: #0000ff;">order</span> <span style="color: #0000ff;">by</span> id <span style="color: #0000ff;">group</span> <span style="color: #0000ff;">by</span> name;</pre>
  </div>
</div>

<span style="background-color: #ffff00;"><strong>唯一索引</strong></span>

　　内容唯一，但不是主键。

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #0000ff;">create</span> <span style="color: #0000ff;">unique</span> <span style="color: #0000ff;">index</span> index_name <span style="color: #0000ff;">on</span> test(name);</pre>
  </div>
</div>

### <span id="131">1.3.1 创建主键索引</span>

　　建立表时

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #0000ff;">CREATE</span> <span style="color: #0000ff;">TABLE</span><span style="color: #000000;"> `test` (
`id` </span><span style="color: #0000ff;">int</span>(<span style="color: #800000; font-weight: bold;">4</span>) <span style="color: #808080;">NOT</span> <span style="color: #0000ff;">NULL</span><span style="color: #000000;"> AUTO_INCREMENT,
`name` </span><span style="color: #0000ff;">char</span>(<span style="color: #800000; font-weight: bold;">20</span>) <span style="color: #808080;">NOT</span> <span style="color: #0000ff;">NULL</span><span style="color: #000000;">,
</span><span style="color: #0000ff;">PRIMARY</span> <span style="color: #0000ff;">KEY</span><span style="color: #000000;"> (`id`)
) ENGINE</span><span style="color: #808080;">=</span>InnoDB <span style="color: #0000ff;">DEFAULT</span> CHARSET<span style="color: #808080;">=</span>UTF8;</pre>
  </div>
</div>

　　建立表后增加

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #0000ff;">CREATE</span> <span style="color: #0000ff;">TABLE</span><span style="color: #000000;"> `test` (
`id` </span><span style="color: #0000ff;">int</span>(<span style="color: #800000; font-weight: bold;">4</span>) <span style="color: #808080;">NOT</span> <span style="color: #0000ff;">NULL</span><span style="color: #000000;">,
`name` </span><span style="color: #0000ff;">char</span>(<span style="color: #800000; font-weight: bold;">20</span>) <span style="color: #808080;">NOT</span> <span style="color: #0000ff;">NULL</span><span style="color: #000000;">
) ENGINE</span><span style="color: #808080;">=</span>InnoDB <span style="color: #0000ff;">DEFAULT</span> CHARSET<span style="color: #808080;">=</span>UTF8;</pre>
  </div>
</div>

**增加自增主键**

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #0000ff;">alter</span> <span style="color: #0000ff;">table</span> test change id id <span style="color: #0000ff;">int</span>(<span style="color: #800000; font-weight: bold;">4</span>) <span style="color: #0000ff;">primary</span> <span style="color: #0000ff;">key</span> 
<span style="color: #808080;">not</span> <span style="color: #0000ff;">null</span> auto_increment;</pre>
  </div>
</div>

### <span id="132">1.3.2 使用字段前缀创建索引及联合索引</span>

前缀索引：根据字段的前N个字符建立索引

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #0000ff;">create</span> <span style="color: #0000ff;">index</span> index_name <span style="color: #0000ff;">on</span> test(name(<span style="color: #800000; font-weight: bold;">8</span>));</pre>
  </div>
</div>

联合索引：多个字段建立一个索引。

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #0000ff;">where</span> a女生 <span style="color: #808080;">and</span> b身高165 <span style="color: #808080;">and</span><span style="color: #000000;"> c身材好
</span><span style="color: #0000ff;">index</span>(a,b,c)</pre>
  </div>
  
  <p>
    　　特点：前缀生效特性。
  </p>
</div>

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #000000;">a,ab,abc 可以走索引。
b ac bc c 不走索引(</span><span style="color: #800000; font-weight: bold;">5</span>.6之后 ac 可以走主键索引)。</pre>
  </div>
  
  <p>
    　　原则：把最常用来作为条件查询的列放在前面。
  </p>
</div>

**_<span style="text-decoration: underline;">示例:</span>_**

<span style="background-color: #ffff00;">创建表</span>

<div>
  <div class="cnblogs_code">
    <pre> <span style="color: #0000ff;">create</span> <span style="color: #0000ff;">table</span> people (id <span style="color: #0000ff;">int</span> <span style="color: #808080;">not</span> <span style="color: #0000ff;">null</span> auto_increment ,name <span style="color: #0000ff;">char</span>(<span style="color: #800000; font-weight: bold;">20</span>),sr(<span style="color: #800000; font-weight: bold;">20</span>),sex <span style="color: #0000ff;">int</span> ,age <span style="color: #0000ff;">int</span>, <span style="color: #0000ff;">primary</span> <span style="color: #0000ff;">key</span> (id));</pre>
  </div>
</div>

<span style="background-color: #ffff00;">创建联合索引</span>

<div>
  <div class="cnblogs_code">
    <pre>mysql<span style="color: #808080;">></span> <span style="color: #0000ff;">alter</span> <span style="color: #0000ff;">table</span> people  <span style="color: #0000ff;">add</span> <span style="color: #0000ff;">key</span><span style="color: #000000;"> name_sex_idx(name,sex)
    </span><span style="color: #808080;">-></span><span style="color: #000000;"> ;
Query OK, </span><span style="color: #800000; font-weight: bold;"></span> rows affected (<span style="color: #800000; font-weight: bold;">0.02</span><span style="color: #000000;"> sec)
Records: </span><span style="color: #800000; font-weight: bold;"></span>  Duplicates: <span style="color: #800000; font-weight: bold;"></span>  Warnings: <span style="color: #800000; font-weight: bold;"></span></pre>
  </div>
</div>

&nbsp;&nbsp; 查看索引的类型

<div>
  <div class="cnblogs_code">
    <pre>mysql<span style="color: #808080;">></span> <span style="color: #0000ff;">desc</span><span style="color: #000000;"> people;
</span><span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">-----+----------+------+-----+---------+----------------+</span>
<span style="color: #808080;">|</span> Field <span style="color: #808080;">|</span> Type     <span style="color: #808080;">|</span> <span style="color: #0000ff;">Null</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">Key</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">Default</span> <span style="color: #808080;">|</span> Extra          <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">-----+----------+------+-----+---------+----------------+</span>
<span style="color: #808080;">|</span> id    <span style="color: #808080;">|</span> <span style="color: #0000ff;">int</span>(<span style="color: #800000; font-weight: bold;">11</span>)  <span style="color: #808080;">|</span> NO   <span style="color: #808080;">|</span> PRI <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>    <span style="color: #808080;">|</span> auto_increment <span style="color: #808080;">|</span>
<span style="color: #808080;">|</span> name  <span style="color: #808080;">|</span> <span style="color: #0000ff;">char</span>(<span style="color: #800000; font-weight: bold;">20</span>) <span style="color: #808080;">|</span> YES  <span style="color: #808080;">|</span> MUL <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>    <span style="color: #808080;">|</span>                <span style="color: #808080;">|</span>
<span style="color: #808080;">|</span> sex   <span style="color: #808080;">|</span> <span style="color: #0000ff;">int</span>(<span style="color: #800000; font-weight: bold;">11</span>)  <span style="color: #808080;">|</span> YES  <span style="color: #808080;">|</span>     <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>    <span style="color: #808080;">|</span>                <span style="color: #808080;">|</span>
<span style="color: #808080;">|</span> age   <span style="color: #808080;">|</span> <span style="color: #0000ff;">int</span>(<span style="color: #800000; font-weight: bold;">11</span>)  <span style="color: #808080;">|</span> YES  <span style="color: #808080;">|</span>     <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>    <span style="color: #808080;">|</span>                <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">-----+----------+------+-----+---------+----------------+</span></pre>
  </div>
</div>

**<span style="text-decoration: underline;">建立唯一键索引</span>**

<div>
  <div class="cnblogs_code">
    <pre>mysql<span style="color: #808080;">></span> <span style="color: #0000ff;">alter</span> <span style="color: #0000ff;">table</span> people <span style="color: #0000ff;">add</span> <span style="color: #0000ff;">unique</span> <span style="color: #0000ff;">key</span><span style="color: #000000;"> age_uidx(age);
Query OK, </span><span style="color: #800000; font-weight: bold;"></span> rows affected (<span style="color: #800000; font-weight: bold;">0.01</span><span style="color: #000000;"> sec)
Records: </span><span style="color: #800000; font-weight: bold;"></span>  Duplicates: <span style="color: #800000; font-weight: bold;"></span>  Warnings: <span style="color: #800000; font-weight: bold;"></span></pre>
  </div>
</div>

&nbsp;&nbsp; 查看数据表

<div>
  <div class="cnblogs_code">
    <pre>mysql<span style="color: #808080;">></span> <span style="color: #0000ff;">desc</span><span style="color: #000000;"> people;
</span><span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">-----+----------+------+-----+---------+----------------+</span>
<span style="color: #808080;">|</span> Field <span style="color: #808080;">|</span> Type     <span style="color: #808080;">|</span> <span style="color: #0000ff;">Null</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">Key</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">Default</span> <span style="color: #808080;">|</span> Extra          <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">-----+----------+------+-----+---------+----------------+</span>
<span style="color: #808080;">|</span> id    <span style="color: #808080;">|</span> <span style="color: #0000ff;">int</span>(<span style="color: #800000; font-weight: bold;">11</span>)  <span style="color: #808080;">|</span> NO   <span style="color: #808080;">|</span> PRI <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>    <span style="color: #808080;">|</span> auto_increment <span style="color: #808080;">|</span>
<span style="color: #808080;">|</span> name  <span style="color: #808080;">|</span> <span style="color: #0000ff;">char</span>(<span style="color: #800000; font-weight: bold;">20</span>) <span style="color: #808080;">|</span> YES  <span style="color: #808080;">|</span> MUL <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>    <span style="color: #808080;">|</span>                <span style="color: #808080;">|</span>
<span style="color: #808080;">|</span> sex   <span style="color: #808080;">|</span> <span style="color: #0000ff;">int</span>(<span style="color: #800000; font-weight: bold;">11</span>)  <span style="color: #808080;">|</span> YES  <span style="color: #808080;">|</span>     <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>    <span style="color: #808080;">|</span>                <span style="color: #808080;">|</span>
<span style="color: #808080;">|</span> age   <span style="color: #808080;">|</span> <span style="color: #0000ff;">int</span>(<span style="color: #800000; font-weight: bold;">11</span>)  <span style="color: #808080;">|</span> YES  <span style="color: #808080;">|</span> UNI <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>    <span style="color: #808080;">|</span>                <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">-----+----------+------+-----+---------+----------------+</span>
<span style="color: #800000; font-weight: bold;">4</span> rows <span style="color: #808080;">in</span> <span style="color: #0000ff;">set</span> (<span style="color: #800000; font-weight: bold;">0.00</span> sec)</pre>
  </div>
</div>

　　<span style="background-color: #00ff00;">联合主键是联合索引的特殊形式</span>

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #0000ff;">PRIMARY</span> <span style="color: #0000ff;">KEY</span> (`Host`,`<span style="color: #ff00ff;">User</span><span style="color: #000000;">`)
</span><span style="color: #0000ff;">alter</span> <span style="color: #0000ff;">table</span> test <span style="color: #0000ff;">add</span> sex <span style="color: #0000ff;">char</span>(<span style="color: #800000; font-weight: bold;">4</span>) <span style="color: #808080;">not</span> <span style="color: #0000ff;">null</span><span style="color: #000000;">;
</span><span style="color: #0000ff;">create</span> <span style="color: #0000ff;">index</span> ind_name_sex <span style="color: #0000ff;">on</span> test(name,sex);</pre>
  </div>
</div>

前缀加联合索引

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #0000ff;">create</span> <span style="color: #0000ff;">index</span> index_name <span style="color: #0000ff;">on</span> test(name(<span style="color: #800000; font-weight: bold;">8</span>),sex(<span style="color: #800000; font-weight: bold;">2</span>));</pre>
  </div>
</div>

## <span id="14_SQL">1.4 SQL语句优化</span>

### <span id="141_SQL">1.4.1 企业SQL优化思路</span>

　　1、把一个大的不使用索引的SQL语句按照功能进行拆分

　　2、长的SQL语句无法使用索引，能不能变成2条短的SQL语句让它分别使用上索引。

　　3、对SQL语句功能的拆分和修改

　　4、减少&ldquo;烂&rdquo;SQL由运维（DBA）和开发交流（确认），共同确定如何改，最终由DBA执行

　　5、制定开发流程

### <span id="142">1.4.2 不适合走索引的场景</span>

　　1、唯一值少的列上不适合建立索引或者建立索引效率低。例如：性别列

　　2、小表可以不建立索引，100条记录。

　　3、对于数据仓库，大量全表扫描的情况，建索引反而会慢

### <span id="143">1.4.3 查看表的唯一值数量</span>

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #0000ff;">select</span> <span style="color: #ff00ff;">count</span>(<span style="color: #0000ff;">distinct</span> <span style="color: #ff00ff;">user</span>) <span style="color: #0000ff;">from</span> mysql.<span style="color: #ff00ff;">user</span><span style="color: #000000;">;
</span><span style="color: #0000ff;">select</span> <span style="color: #ff00ff;">count</span>(<span style="color: #0000ff;">distinct</span> <span style="color: #ff00ff;">user</span>,host) <span style="color: #0000ff;">from</span> mysql.<span style="color: #ff00ff;">user</span>;</pre>
  </div>
</div>

### <span id="144">1.4.4 建立索引流程</span>

　　1、找到慢SQL。

<div>
  <div class="cnblogs_code">
    <pre>show processlist;</pre>
  </div>
</div>

　　　　记录慢查询日志。

　　2、explain select句,条件列多。

　　3、查看表的唯一值数量：

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #0000ff;">select</span> <span style="color: #ff00ff;">count</span>(<span style="color: #0000ff;">distinct</span> <span style="color: #ff00ff;">user</span>) <span style="color: #0000ff;">from</span> mysql.<span style="color: #ff00ff;">user</span><span style="color: #000000;">;
</span><span style="color: #0000ff;">select</span> <span style="color: #ff00ff;">count</span>(<span style="color: #0000ff;">distinct</span> <span style="color: #ff00ff;">user</span>,host) <span style="color: #0000ff;">from</span> mysql.<span style="color: #ff00ff;">user</span>;</pre>
  </div>
  
  <p>
    　　　　条件列多。可以考虑建立联合索引。
  </p>
</div>

　　4、建立索引(流量低谷)

<div>
  <div class="cnblogs_code">
    <pre>force <span style="color: #0000ff;">index</span></pre>
  </div>
  
  <p>
    　　5、拆开语句（和开发）。
  </p>
</div>

　　6、like '%%'不用mysql

　　7、进行判断重复的行数

_<span style="text-decoration: underline;">查看行数:</span>_

<div>
  <div class="cnblogs_code">
    <pre>mysql<span style="color: #808080;">></span> <span style="color: #0000ff;">select</span> <span style="color: #ff00ff;">count</span>(<span style="color: #808080;">*</span>) <span style="color: #0000ff;">from</span><span style="color: #000000;"> city;
</span><span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--------+</span>
<span style="color: #808080;">|</span> <span style="color: #ff00ff;">count</span>(<span style="color: #808080;">*</span>) <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--------+</span>
<span style="color: #808080;">|</span>     <span style="color: #800000; font-weight: bold;">4079</span> <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--------+</span>
<span style="color: #800000; font-weight: bold;">1</span> row <span style="color: #808080;">in</span> <span style="color: #0000ff;">set</span> (<span style="color: #800000; font-weight: bold;">0.00</span> sec)</pre>
  </div>
</div>

_<span style="text-decoration: underline;">查看去重后的行数：</span>_

<div>
  <div class="cnblogs_code">
    <pre>mysql<span style="color: #808080;">></span> <span style="color: #0000ff;">select</span> <span style="color: #ff00ff;">count</span>(<span style="color: #0000ff;">distinct</span> countrycode) <span style="color: #0000ff;">from</span><span style="color: #000000;"> city;
</span><span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">---------------------------+</span>
<span style="color: #808080;">|</span> <span style="color: #ff00ff;">count</span>(<span style="color: #0000ff;">distinct</span> countrycode) <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">---------------------------+</span>
<span style="color: #808080;">|</span>                         <span style="color: #800000; font-weight: bold;">232</span> <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">---------------------------+</span>
<span style="color: #800000; font-weight: bold;">1</span> row <span style="color: #808080;">in</span> <span style="color: #0000ff;">set</span> (<span style="color: #800000; font-weight: bold;">0.00</span> sec)</pre>
  </div>
</div>

## <span id="15_explainSQL">1.5 用explain查看SQL的执行计划</span>

　　在工作中，我们用于捕捉性能问题最常用的就是打开慢查询，定位执行效率差的SQL，那么当我们定位到一个SQL以后还不算完事，我们还需要知道该SQL的执行计划，比如是全表扫描，还是索引扫描，这些都需要通过EXPLAIN去完成。

　　EXPLAIN命令是查看优化器如何决定执行查询的主要方法。可以帮助我们深入了解MySQL的基于开销的优化器，还可以获得很多可能被优化器考虑到的访问策略的细节，以及当运行SQL语句时哪种策略预计会被优化器采用。

　　需要注意的是，生成的QEP并不确定，它可能会根据很多因素发生改变。MySQL不会将一个QEP和某个给定查询绑定，QEP将由SQL语句每次执行时的实际情况确定，即便使用存储过程也是如此。尽管在存储过程中SQL语句都是预先解析过的，但QEP仍然会在每次调用存储过程的时候才被确定。

### <span id="151_select">1.5.1 查看 select 语句的执行过程</span>

<div>
  <div class="cnblogs_code">
    <pre>mysql<span style="color: #808080;">></span> explain <span style="color: #0000ff;">select</span> id,name <span style="color: #0000ff;">from</span> test <span style="color: #0000ff;">where</span> name<span style="color: #808080;">=</span><span style="color: #ff0000;">'</span><span style="color: #ff0000;">clsn</span><span style="color: #ff0000;">'</span><span style="color: #000000;">;
</span><span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+------+---------------+----------+---------+-------+------+-------------+</span>
<span style="color: #808080;">|</span> id <span style="color: #808080;">|</span> select_type <span style="color: #808080;">|</span> <span style="color: #0000ff;">table</span> <span style="color: #808080;">|</span> type <span style="color: #808080;">|</span> possible_keys <span style="color: #808080;">|</span> <span style="color: #0000ff;">key</span>      <span style="color: #808080;">|</span> key_len <span style="color: #808080;">|</span> ref   <span style="color: #808080;">|</span> rows <span style="color: #808080;">|</span> Extra       <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+------+---------------+----------+---------+-------+------+-------------+</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> SIMPLE      <span style="color: #808080;">|</span> test  <span style="color: #808080;">|</span> ref  <span style="color: #808080;">|</span> name_idx      <span style="color: #808080;">|</span> name_idx <span style="color: #808080;">|</span> <span style="color: #800000; font-weight: bold;">24</span>      <span style="color: #808080;">|</span> const <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> Using <span style="color: #0000ff;">where</span> <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+------+---------------+----------+---------+-------+------+-------------+</span>
<span style="color: #800000; font-weight: bold;">1</span> row <span style="color: #808080;">in</span> <span style="color: #0000ff;">set</span> (<span style="color: #800000; font-weight: bold;">0.00</span> sec)</pre>
  </div>
  
  <p>
    　　SQL_NO_CACHE的作用是禁止缓存查询结果。
  </p>
</div>

**使用where****条件查找**

<div>
  <div class="cnblogs_code">
    <pre>mysql<span style="color: #808080;">></span> explain <span style="color: #0000ff;">select</span> <span style="color: #ff00ff;">user</span>,host <span style="color: #0000ff;">from</span> mysql.<span style="color: #ff00ff;">user</span> <span style="color: #0000ff;">where</span> <span style="color: #ff00ff;">user</span><span style="color: #808080;">=</span><span style="color: #ff0000;">'</span><span style="color: #ff0000;">root</span><span style="color: #ff0000;">'</span> <span style="color: #808080;">and</span> host<span style="color: #808080;">=</span><span style="color: #ff0000;">'</span><span style="color: #ff0000;">127.0.0.1</span><span style="color: #ff0000;">'</span><span style="color: #000000;">;
</span><span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+---------+---------+-------------+------+-------------+</span>
<span style="color: #808080;">|</span> id <span style="color: #808080;">|</span> select_type <span style="color: #808080;">|</span> <span style="color: #0000ff;">table</span> <span style="color: #808080;">|</span> type  <span style="color: #808080;">|</span> possible_keys <span style="color: #808080;">|</span> <span style="color: #0000ff;">key</span>     <span style="color: #808080;">|</span> key_len <span style="color: #808080;">|</span> ref         <span style="color: #808080;">|</span> rows <span style="color: #808080;">|</span> Extra       <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+---------+---------+-------------+------+-------------+</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> SIMPLE      <span style="color: #808080;">|</span> <span style="color: #ff00ff;">user</span>  <span style="color: #808080;">|</span> const <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span>       <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span> <span style="color: #808080;">|</span> <span style="color: #800000; font-weight: bold;">228</span>     <span style="color: #808080;">|</span> const,const <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> Using <span style="color: #0000ff;">index</span> <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+---------+---------+-------------+------+-------------+</span>
<span style="color: #800000; font-weight: bold;">1</span> row <span style="color: #808080;">in</span> <span style="color: #0000ff;">set</span> (<span style="color: #800000; font-weight: bold;">0.00</span> sec)</pre>
  </div>
</div>

### <span id="152">1.5.2 通过执行计划可以知道什么？</span>

<div>
  <div class="cnblogs_code">
    <pre>mysql<span style="color: #808080;">></span> explain <span style="color: #0000ff;">select</span> d1.age, t2.id <span style="color: #0000ff;">from</span> (<span style="color: #0000ff;">select</span> age,name <span style="color: #0000ff;">from</span> t1 <span style="color: #0000ff;">where</span> id <span style="color: #808080;">in</span> (<span style="color: #800000; font-weight: bold;">1</span>,<span style="color: #800000; font-weight: bold;">2</span>))d1, t2 <span style="color: #0000ff;">where</span> d1.age<span style="color: #808080;">=</span>t2.age <span style="color: #0000ff;">group</span> <span style="color: #0000ff;">by</span> d1.age, t2.id <span style="color: #0000ff;">order</span> <span style="color: #0000ff;">by</span><span style="color: #000000;"> t2.id;
</span><span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+------------+-------+---------------+---------+---------+--------+------+---------------------------------+</span>
<span style="color: #808080;">|</span> id <span style="color: #808080;">|</span> select_type <span style="color: #808080;">|</span> <span style="color: #0000ff;">table</span>      <span style="color: #808080;">|</span> type  <span style="color: #808080;">|</span> possible_keys <span style="color: #808080;">|</span> <span style="color: #0000ff;">key</span>     <span style="color: #808080;">|</span> key_len <span style="color: #808080;">|</span> ref    <span style="color: #808080;">|</span> rows <span style="color: #808080;">|</span> Extra                           <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+------------+-------+---------------+---------+---------+--------+------+---------------------------------+</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span>     <span style="color: #808080;">|</span> <span style="color: #808080;">&lt;</span>derived2<span style="color: #808080;">></span> <span style="color: #808080;">|</span> <span style="color: #808080;">ALL</span>   <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>          <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>    <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>    <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>   <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;">2</span> <span style="color: #808080;">|</span> Using <span style="color: #0000ff;">temporary</span>; Using filesort <span style="color: #808080;">|</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span>     <span style="color: #808080;">|</span> t2         <span style="color: #808080;">|</span> ref   <span style="color: #808080;">|</span> age           <span style="color: #808080;">|</span> age     <span style="color: #808080;">|</span> <span style="color: #800000; font-weight: bold;">5</span>       <span style="color: #808080;">|</span> d1.age <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> Using <span style="color: #0000ff;">where</span>; Using <span style="color: #0000ff;">index</span>        <span style="color: #808080;">|</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">2</span> <span style="color: #808080;">|</span> DERIVED     <span style="color: #808080;">|</span> t1         <span style="color: #808080;">|</span> range <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span>       <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span> <span style="color: #808080;">|</span> <span style="color: #800000; font-weight: bold;">4</span>       <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>   <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;">2</span> <span style="color: #808080;">|</span> Using <span style="color: #0000ff;">where</span>                     <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+------------+-------+---------------+---------+---------+--------+------+---------------------------------+</span>
<span style="color: #800000; font-weight: bold;">3</span> rows <span style="color: #808080;">in</span> <span style="color: #0000ff;">set</span> (<span style="color: #800000; font-weight: bold;">0.00</span> sec)</pre>
  </div>
</div>

### <span id="153_MySQL">1.5.3 MySQL执行计划调用方式</span>

<div class="cnblogs_code">
  <pre><span style="color: #800000; font-weight: bold;">1</span>.EXPLAIN <span style="color: #0000ff;">SELECT</span><span style="color: #000000;"> &hellip;&hellip;
</span><span style="color: #800000; font-weight: bold;">2</span>.EXPLAIN EXTENDED <span style="color: #0000ff;">SELECT</span><span style="color: #000000;"> &hellip;&hellip;
　　将执行计划"反编译"成SELECT语句，运行SHOW WARNINGS 可得到被MySQL优化器优化后的查询语句
</span><span style="color: #800000; font-weight: bold;">3</span>.EXPLAIN PARTITIONS <span style="color: #0000ff;">SELECT</span><span style="color: #000000;"> &hellip;&hellip;
　　用于分区表的EXPLAIN生成QEP的信息</span></pre>
</div>

### <span id="154">1.5.4 执行计划包含的信息</span>

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+---------+---------+------+------+-------------+</span>
<span style="color: #808080;">|</span> id <span style="color: #808080;">|</span> select_type <span style="color: #808080;">|</span> <span style="color: #0000ff;">table</span> <span style="color: #808080;">|</span> type  <span style="color: #808080;">|</span> possible_keys <span style="color: #808080;">|</span> <span style="color: #0000ff;">key</span>     <span style="color: #808080;">|</span> key_len <span style="color: #808080;">|</span> ref  <span style="color: #808080;">|</span> rows <span style="color: #808080;">|</span> Extra       <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+---------+---------+------+------+-------------+</span></pre>
  </div>
</div>

### <span id="155_id"><span style="background-color: #ffff00;">1.5.5 id</span></span>

　　包含一组数字，表示查询中执行select子句或操作表的顺序

【示例一】id相同，执行顺序由上至下

<div>
  <div class="cnblogs_code">
    <pre>mysql<span style="color: #808080;">></span> explain <span style="color: #0000ff;">select</span> t2.<span style="color: #808080;">*</span> <span style="color: #0000ff;">from</span> t1, t2, t3 <span style="color: #0000ff;">where</span> t1.id<span style="color: #808080;">=</span>t2.id <span style="color: #808080;">and</span> t1.id<span style="color: #808080;">=</span>t3.id <span style="color: #808080;">and</span> t1.name<span style="color: #808080;">=</span><span style="color: #ff0000;">''</span><span style="color: #000000;">;
</span><span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+--------+---------------+---------+---------+------------+------+--------------------------+</span>
<span style="color: #808080;">|</span> id <span style="color: #808080;">|</span> select_type <span style="color: #808080;">|</span> <span style="color: #0000ff;">table</span> <span style="color: #808080;">|</span> type   <span style="color: #808080;">|</span> possible_keys <span style="color: #808080;">|</span> <span style="color: #0000ff;">key</span>     <span style="color: #808080;">|</span> key_len <span style="color: #808080;">|</span> ref        <span style="color: #808080;">|</span> rows <span style="color: #808080;">|</span> Extra                    <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+--------+---------------+---------+---------+------------+------+--------------------------+</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> SIMPLE      <span style="color: #808080;">|</span> t1    <span style="color: #808080;">|</span> ref    <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span>,name  <span style="color: #808080;">|</span> name    <span style="color: #808080;">|</span> <span style="color: #800000; font-weight: bold;">63</span>      <span style="color: #808080;">|</span> const      <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> Using <span style="color: #0000ff;">where</span>; Using <span style="color: #0000ff;">index</span> <span style="color: #808080;">|</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> SIMPLE      <span style="color: #808080;">|</span> t2    <span style="color: #808080;">|</span> eq_ref <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span>       <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span> <span style="color: #808080;">|</span> <span style="color: #800000; font-weight: bold;">4</span>       <span style="color: #808080;">|</span> test.t1.id <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span>                          <span style="color: #808080;">|</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> SIMPLE      <span style="color: #808080;">|</span> t3    <span style="color: #808080;">|</span> eq_ref <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span>       <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span> <span style="color: #808080;">|</span> <span style="color: #800000; font-weight: bold;">4</span>       <span style="color: #808080;">|</span> test.t1.id <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> Using <span style="color: #0000ff;">index</span>              <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+--------+---------------+---------+---------+------------+------+--------------------------+</span>
<span style="color: #800000; font-weight: bold;">3</span> rows <span style="color: #808080;">in</span> <span style="color: #0000ff;">set</span> (<span style="color: #800000; font-weight: bold;">0.00</span> sec)</pre>
  </div>
</div>

【示例二】如果是子查询，id的序号会递增，id值越大优先级越高，越先被执行

<div>
  <div class="cnblogs_code">
    <pre>mysql<span style="color: #808080;">></span> explain <span style="color: #0000ff;">select</span> t2.<span style="color: #808080;">*</span> <span style="color: #0000ff;">from</span> t2 <span style="color: #0000ff;">where</span> id <span style="color: #808080;">=</span> (<span style="color: #0000ff;">select</span> id <span style="color: #0000ff;">from</span> t1 <span style="color: #0000ff;">where</span> id <span style="color: #808080;">=</span> (<span style="color: #0000ff;">select</span> t3.id <span style="color: #0000ff;">from</span> t3 <span style="color: #0000ff;">where</span> t3.name<span style="color: #808080;">=</span><span style="color: #ff0000;">''</span><span style="color: #000000;">));
</span><span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+------+---------------+------+---------+------+------+-----------------------------------------------------+</span>
<span style="color: #808080;">|</span> id <span style="color: #808080;">|</span> select_type <span style="color: #808080;">|</span> <span style="color: #0000ff;">table</span> <span style="color: #808080;">|</span> type <span style="color: #808080;">|</span> possible_keys <span style="color: #808080;">|</span> <span style="color: #0000ff;">key</span>  <span style="color: #808080;">|</span> key_len <span style="color: #808080;">|</span> ref  <span style="color: #808080;">|</span> rows <span style="color: #808080;">|</span> Extra                                               <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+------+---------------+------+---------+------+------+-----------------------------------------------------+</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span>     <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>  <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>          <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>    <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span> Impossible <span style="color: #0000ff;">WHERE</span> noticed after reading const tables <span style="color: #808080;">|</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">2</span> <span style="color: #808080;">|</span> SUBQUERY    <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>  <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>          <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>    <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span> no matching row <span style="color: #808080;">in</span> const <span style="color: #0000ff;">table</span>                      <span style="color: #808080;">|</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">3</span> <span style="color: #808080;">|</span> SUBQUERY    <span style="color: #808080;">|</span> t3    <span style="color: #808080;">|</span> ref  <span style="color: #808080;">|</span> name          <span style="color: #808080;">|</span> name <span style="color: #808080;">|</span> <span style="color: #800000; font-weight: bold;">63</span>      <span style="color: #808080;">|</span>      <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> Using <span style="color: #0000ff;">where</span>; Using <span style="color: #0000ff;">index</span>                            <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+------+---------------+------+---------+------+------+-----------------------------------------------------+</span>
<span style="color: #800000; font-weight: bold;">3</span> rows <span style="color: #808080;">in</span> <span style="color: #0000ff;">set</span> (<span style="color: #800000; font-weight: bold;">0.00</span> sec)</pre>
  </div>
</div>

【示例三】id如果相同，可以认为是一组，从上往下顺序执行；在所有组中，id值越大，优先级越高，越先执行

<div>
  <div class="cnblogs_code">
    <pre>mysql<span style="color: #808080;">></span> explain <span style="color: #0000ff;">select</span> t2.<span style="color: #808080;">*</span> <span style="color: #0000ff;">from</span> (<span style="color: #0000ff;">select</span> t3.id <span style="color: #0000ff;">from</span> t3 <span style="color: #0000ff;">where</span> t3.name<span style="color: #808080;">=</span><span style="color: #ff0000;">''</span>)s1, t2 <span style="color: #0000ff;">where</span> s1.id<span style="color: #808080;">=</span><span style="color: #000000;">t2.id;
</span><span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+------------+--------+---------------+---------+---------+-------+------+--------------------------+</span>
<span style="color: #808080;">|</span> id <span style="color: #808080;">|</span> select_type <span style="color: #808080;">|</span> <span style="color: #0000ff;">table</span>      <span style="color: #808080;">|</span> type   <span style="color: #808080;">|</span> possible_keys <span style="color: #808080;">|</span> <span style="color: #0000ff;">key</span>     <span style="color: #808080;">|</span> key_len <span style="color: #808080;">|</span> ref   <span style="color: #808080;">|</span> rows <span style="color: #808080;">|</span> Extra                    <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+------------+--------+---------------+---------+---------+-------+------+--------------------------+</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span>     <span style="color: #808080;">|</span> <span style="color: #808080;">&lt;</span>derived2<span style="color: #808080;">></span> <span style="color: #808080;">|</span> system <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>          <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>    <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>    <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>  <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span>                          <span style="color: #808080;">|</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span>     <span style="color: #808080;">|</span> t2         <span style="color: #808080;">|</span> const  <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span>       <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span> <span style="color: #808080;">|</span> <span style="color: #800000; font-weight: bold;">4</span>       <span style="color: #808080;">|</span> const <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span>                          <span style="color: #808080;">|</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">2</span> <span style="color: #808080;">|</span> DERIVED     <span style="color: #808080;">|</span> t3         <span style="color: #808080;">|</span> ref    <span style="color: #808080;">|</span> name          <span style="color: #808080;">|</span> name    <span style="color: #808080;">|</span> <span style="color: #800000; font-weight: bold;">63</span>      <span style="color: #808080;">|</span>       <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> Using <span style="color: #0000ff;">where</span>; Using <span style="color: #0000ff;">index</span> <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+------------+--------+---------------+---------+---------+-------+------+--------------------------+</span>
<span style="color: #800000; font-weight: bold;">3</span> rows <span style="color: #808080;">in</span> <span style="color: #0000ff;">set</span> (<span style="color: #800000; font-weight: bold;">0.00</span> sec)</pre>
  </div>
</div>

### <span id="156_select_type"><span style="background-color: #ffff00;">1.5.6 select_type</span></span>

<div class="cnblogs_code">
  <pre><span style="color: #000000;">示查询中每个select子句的类型（简单OR复杂）
    a. SIMPLE：查询中不包含子查询或者UNION
    b. 查询中若包含任何复杂的子部分，最外层查询则被标记为：</span><span style="color: #0000ff;">PRIMARY</span><span style="color: #000000;">
    c. 在SELECT或WHERE列表中包含了子查询，该子查询被标记为：SUBQUERY
    d. 在FROM列表中包含的子查询被标记为：DERIVED（衍生）用来表示包含在from子句中的子查询的select，mysql会递归执行并将结果放到一个临时表中。服务器内部称为"派生表"，因为该临时表是从子查询中派生出来的
    e. 若第二个SELECT出现在UNION之后，则被标记为UNION；若UNION包含在FROM子句的子查询中，外层SELECT将被标记为：DERIVED
    f. 从UNION表获取结果的SELECT被标记为：</span><span style="color: #0000ff;">UNION</span> RESULT</pre>
</div>

说明：

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #000000;">SUBQUERY和UNION还可以被标记为DEPENDENT和UNCACHEABLE。
DEPENDENT意味着select依赖于外层查询中发现的数据。
UNCACHEABLE意味着select中的某些 特性阻止结果被缓存于一个item_cache中。</span></pre>
  </div>
</div>

【示例】

<div>
  <div class="cnblogs_code">
    <pre>mysql<span style="color: #808080;">></span> explain <span style="color: #0000ff;">select</span> d1.name, ( <span style="color: #0000ff;">select</span> id <span style="color: #0000ff;">from</span> t3) d2 <span style="color: #0000ff;">from</span> (<span style="color: #0000ff;">select</span> id,name <span style="color: #0000ff;">from</span> t1 <span style="color: #0000ff;">where</span> name<span style="color: #808080;">=</span><span style="color: #ff0000;">''</span>)d1 <span style="color: #0000ff;">union</span> (<span style="color: #0000ff;">select</span> name,id <span style="color: #0000ff;">from</span><span style="color: #000000;"> t2);
</span><span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+--------------+------------+--------+---------------+------+---------+------+------+--------------------------+</span>
<span style="color: #808080;">|</span> id <span style="color: #808080;">|</span> select_type  <span style="color: #808080;">|</span> <span style="color: #0000ff;">table</span>      <span style="color: #808080;">|</span> type   <span style="color: #808080;">|</span> possible_keys <span style="color: #808080;">|</span> <span style="color: #0000ff;">key</span>  <span style="color: #808080;">|</span> key_len <span style="color: #808080;">|</span> ref  <span style="color: #808080;">|</span> rows <span style="color: #808080;">|</span> Extra                    <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+--------------+------------+--------+---------------+------+---------+------+------+--------------------------+</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span>      <span style="color: #808080;">|</span> <span style="color: #808080;">&lt;</span>derived3<span style="color: #808080;">></span> <span style="color: #808080;">|</span> system <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>          <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>    <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;"></span> <span style="color: #808080;">|</span> const row <span style="color: #808080;">not</span> found      <span style="color: #808080;">|</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">3</span> <span style="color: #808080;">|</span> DERIVED      <span style="color: #808080;">|</span> t1         <span style="color: #808080;">|</span> ref    <span style="color: #808080;">|</span> name          <span style="color: #808080;">|</span> name <span style="color: #808080;">|</span> <span style="color: #800000; font-weight: bold;">63</span>      <span style="color: #808080;">|</span>      <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> Using <span style="color: #0000ff;">where</span>; Using <span style="color: #0000ff;">index</span> <span style="color: #808080;">|</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">2</span> <span style="color: #808080;">|</span> SUBQUERY     <span style="color: #808080;">|</span> t3         <span style="color: #808080;">|</span> <span style="color: #0000ff;">index</span>  <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>          <span style="color: #808080;">|</span> age  <span style="color: #808080;">|</span> <span style="color: #800000; font-weight: bold;">5</span>       <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;">6</span> <span style="color: #808080;">|</span> Using <span style="color: #0000ff;">index</span>              <span style="color: #808080;">|</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">4</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">UNION</span>        <span style="color: #808080;">|</span> t2         <span style="color: #808080;">|</span> <span style="color: #0000ff;">index</span>  <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>          <span style="color: #808080;">|</span> name <span style="color: #808080;">|</span> <span style="color: #800000; font-weight: bold;">63</span>      <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;">4</span> <span style="color: #808080;">|</span> Using <span style="color: #0000ff;">index</span>              <span style="color: #808080;">|</span>
<span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">UNION</span> RESULT <span style="color: #808080;">|</span> <span style="color: #808080;">&lt;</span>union1,<span style="color: #800000; font-weight: bold;">4</span><span style="color: #808080;">></span> <span style="color: #808080;">|</span> <span style="color: #808080;">ALL</span>    <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>          <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>    <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span>                          <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+--------------+------------+--------+---------------+------+---------+------+------+--------------------------+</span>
<span style="color: #800000; font-weight: bold;">5</span> rows <span style="color: #808080;">in</span> <span style="color: #0000ff;">set</span> (<span style="color: #800000; font-weight: bold;">0.00</span> sec)</pre>
  </div>
</div>

<span style="text-decoration: underline;"><em><strong><span style="background-color: #ffff00;">内容说明：</span></strong></em></span>

<div>
  <div class="cnblogs_code">
    <pre>第一行：id列为1，表示第一个select，select_type列的primary表 示该查询为外层查询，table列被标记为<span style="color: #808080;">&lt;</span>derived3<span style="color: #808080;">></span><span style="color: #000000;">，表示查询结果来自一个衍生表，其中3代表该查询衍生自第三个select查询，即id为3的select。
第二行：id为3，表示该查询的执行次序为2（ </span><span style="color: #800000; font-weight: bold;">4</span> <span style="color: #808080;">=></span> <span style="color: #800000; font-weight: bold;">3</span><span style="color: #000000;">），是整个查询中第三个select的一部分。因查询包含在from中，所以为derived。
第三行：select列表中的子查询，select_type为subquery，为整个查询中的第二个select。
第四行：select_type为union，说明第四个select是union里的第二个select，最先执行。
第五行：代表从union的临时表中读取行的阶段，table列的</span><span style="color: #808080;">&lt;</span>union1,<span style="color: #800000; font-weight: bold;">4</span><span style="color: #808080;">></span>表示用第一个和第四个select的结果进行union操作。</pre>
  </div>
</div>

### <span id="157_type">1.5.7 type</span>

　　表示MySQL在表中找到所需行的方式，又称&ldquo;访问类型&rdquo;，常见类型如下:

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #808080;">ALL</span>, <span style="color: #0000ff;">index</span>,  range, ref, eq_ref, const, system, <span style="color: #0000ff;">NULL</span></pre>
  </div>
</div>

　　从左到右，性能从最差到最好

【示例一】ALL：Full Table Scan， MySQL将遍历全表以找到匹配的行

<div>
  <div class="cnblogs_code">
    <pre>mysql<span style="color: #808080;">></span> explain <span style="color: #0000ff;">select</span> <span style="color: #808080;">*</span> <span style="color: #0000ff;">from</span> t1 <span style="color: #0000ff;">where</span> email<span style="color: #808080;">=</span><span style="color: #ff0000;">''</span><span style="color: #000000;">;
</span><span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+------+---------------+------+---------+------+------+-------------+</span>
<span style="color: #808080;">|</span> id <span style="color: #808080;">|</span> select_type <span style="color: #808080;">|</span> <span style="color: #0000ff;">table</span> <span style="color: #808080;">|</span> type <span style="color: #808080;">|</span> possible_keys <span style="color: #808080;">|</span> <span style="color: #0000ff;">key</span>  <span style="color: #808080;">|</span> key_len <span style="color: #808080;">|</span> ref  <span style="color: #808080;">|</span> rows <span style="color: #808080;">|</span> Extra       <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+------+---------------+------+---------+------+------+-------------+</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> SIMPLE      <span style="color: #808080;">|</span> t1    <span style="color: #808080;">|</span> <span style="color: #808080;">ALL</span>  <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>          <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>    <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;">4</span> <span style="color: #808080;">|</span> Using <span style="color: #0000ff;">where</span> <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+------+---------------+------+---------+------+------+-------------+</span>
<span style="color: #800000; font-weight: bold;">1</span> row <span style="color: #808080;">in</span> <span style="color: #0000ff;">set</span> (<span style="color: #800000; font-weight: bold;">0.00</span> sec)</pre>
  </div>
</div>

【示例二】index：Full Index Scan，index与ALL区别为index类型只遍历索引树

<div>
  <div class="cnblogs_code">
    <pre>mysql<span style="color: #808080;">></span> explain <span style="color: #0000ff;">select</span> id <span style="color: #0000ff;">from</span><span style="color: #000000;"> t1;
</span><span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+------+---------+------+------+-------------+</span>
<span style="color: #808080;">|</span> id <span style="color: #808080;">|</span> select_type <span style="color: #808080;">|</span> <span style="color: #0000ff;">table</span> <span style="color: #808080;">|</span> type  <span style="color: #808080;">|</span> possible_keys <span style="color: #808080;">|</span> <span style="color: #0000ff;">key</span>  <span style="color: #808080;">|</span> key_len <span style="color: #808080;">|</span> ref  <span style="color: #808080;">|</span> rows <span style="color: #808080;">|</span> Extra       <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+------+---------+------+------+-------------+</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> SIMPLE      <span style="color: #808080;">|</span> t1    <span style="color: #808080;">|</span> <span style="color: #0000ff;">index</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>          <span style="color: #808080;">|</span> age  <span style="color: #808080;">|</span> <span style="color: #800000; font-weight: bold;">5</span>       <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;">4</span> <span style="color: #808080;">|</span> Using <span style="color: #0000ff;">index</span> <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+------+---------+------+------+-------------+</span>
<span style="color: #800000; font-weight: bold;">1</span> row <span style="color: #808080;">in</span> <span style="color: #0000ff;">set</span> (<span style="color: #800000; font-weight: bold;">0.00</span> sec)</pre>
  </div>
</div>

【示例三】range:索引范围扫描，对索引的扫描开始于某一点，返回匹配值域的行。

显而易见的索引范围扫描是带有between或者where子句里带有<, >查询。当mysql使用索引去查找一系列值时，例如IN()和OR列表，也会显示range（范围扫描）,当然性能上面是有差异的。

<div>
  <div class="cnblogs_code">
    <pre>mysql<span style="color: #808080;">></span> explain <span style="color: #0000ff;">select</span> <span style="color: #808080;">*</span> <span style="color: #0000ff;">from</span> t1 <span style="color: #0000ff;">where</span> id <span style="color: #808080;">in</span> (<span style="color: #800000; font-weight: bold;">1</span>,<span style="color: #800000; font-weight: bold;">4</span><span style="color: #000000;">);
</span><span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+---------+---------+------+------+-------------+</span>
<span style="color: #808080;">|</span> id <span style="color: #808080;">|</span> select_type <span style="color: #808080;">|</span> <span style="color: #0000ff;">table</span> <span style="color: #808080;">|</span> type  <span style="color: #808080;">|</span> possible_keys <span style="color: #808080;">|</span> <span style="color: #0000ff;">key</span>     <span style="color: #808080;">|</span> key_len <span style="color: #808080;">|</span> ref  <span style="color: #808080;">|</span> rows <span style="color: #808080;">|</span> Extra       <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+---------+---------+------+------+-------------+</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> SIMPLE      <span style="color: #808080;">|</span> t1    <span style="color: #808080;">|</span> range <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span>       <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span> <span style="color: #808080;">|</span> <span style="color: #800000; font-weight: bold;">4</span>       <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;">2</span> <span style="color: #808080;">|</span> Using <span style="color: #0000ff;">where</span> <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+---------+---------+------+------+-------------+</span>
<span style="color: #800000; font-weight: bold;">1</span> row <span style="color: #808080;">in</span> <span style="color: #0000ff;">set</span> (<span style="color: #800000; font-weight: bold;">0.00</span> sec)</pre>
  </div>
</div>

<div class="cnblogs_code">
  <pre>mysql<span style="color: #808080;">></span> explain <span style="color: #0000ff;">select</span> <span style="color: #808080;">*</span> <span style="color: #0000ff;">from</span> t1 <span style="color: #0000ff;">where</span> id <span style="color: #808080;">between</span> <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">and</span> <span style="color: #800000; font-weight: bold;">4</span><span style="color: #000000;">;
</span><span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+---------+---------+------+------+-------------+</span>
<span style="color: #808080;">|</span> id <span style="color: #808080;">|</span> select_type <span style="color: #808080;">|</span> <span style="color: #0000ff;">table</span> <span style="color: #808080;">|</span> type  <span style="color: #808080;">|</span> possible_keys <span style="color: #808080;">|</span> <span style="color: #0000ff;">key</span>     <span style="color: #808080;">|</span> key_len <span style="color: #808080;">|</span> ref  <span style="color: #808080;">|</span> rows <span style="color: #808080;">|</span> Extra       <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+---------+---------+------+------+-------------+</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> SIMPLE      <span style="color: #808080;">|</span> t1    <span style="color: #808080;">|</span> range <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span>       <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span> <span style="color: #808080;">|</span> <span style="color: #800000; font-weight: bold;">4</span>       <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;">3</span> <span style="color: #808080;">|</span> Using <span style="color: #0000ff;">where</span> <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+---------+---------+------+------+-------------+</span>
<span style="color: #800000; font-weight: bold;">1</span> row <span style="color: #808080;">in</span> <span style="color: #0000ff;">set</span> (<span style="color: #800000; font-weight: bold;">0.00</span> sec)</pre>
</div>

<div class="cnblogs_code">
  <pre>mysql<span style="color: #808080;">></span> explain <span style="color: #0000ff;">select</span> <span style="color: #808080;">*</span> <span style="color: #0000ff;">from</span> t1 <span style="color: #0000ff;">where</span> id<span style="color: #808080;">=</span><span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">or</span> id<span style="color: #808080;">=</span><span style="color: #800000; font-weight: bold;">4</span><span style="color: #000000;">;       
</span><span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+---------+---------+------+------+-------------+</span>
<span style="color: #808080;">|</span> id <span style="color: #808080;">|</span> select_type <span style="color: #808080;">|</span> <span style="color: #0000ff;">table</span> <span style="color: #808080;">|</span> type  <span style="color: #808080;">|</span> possible_keys <span style="color: #808080;">|</span> <span style="color: #0000ff;">key</span>     <span style="color: #808080;">|</span> key_len <span style="color: #808080;">|</span> ref  <span style="color: #808080;">|</span> rows <span style="color: #808080;">|</span> Extra       <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+---------+---------+------+------+-------------+</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> SIMPLE      <span style="color: #808080;">|</span> t1    <span style="color: #808080;">|</span> range <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span>       <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span> <span style="color: #808080;">|</span> <span style="color: #800000; font-weight: bold;">4</span>       <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;">2</span> <span style="color: #808080;">|</span> Using <span style="color: #0000ff;">where</span> <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+---------+---------+------+------+-------------+</span>
<span style="color: #800000; font-weight: bold;">1</span> row <span style="color: #808080;">in</span> <span style="color: #0000ff;">set</span> (<span style="color: #800000; font-weight: bold;">0.01</span> sec)</pre>
</div>

<div class="cnblogs_code">
  <pre>mysql<span style="color: #808080;">></span> explain <span style="color: #0000ff;">select</span> <span style="color: #808080;">*</span> <span style="color: #0000ff;">from</span> t1 <span style="color: #0000ff;">where</span> id <span style="color: #808080;">></span> <span style="color: #800000; font-weight: bold;">1</span><span style="color: #000000;">;      
</span><span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+---------+---------+------+------+-------------+</span>
<span style="color: #808080;">|</span> id <span style="color: #808080;">|</span> select_type <span style="color: #808080;">|</span> <span style="color: #0000ff;">table</span> <span style="color: #808080;">|</span> type  <span style="color: #808080;">|</span> possible_keys <span style="color: #808080;">|</span> <span style="color: #0000ff;">key</span>     <span style="color: #808080;">|</span> key_len <span style="color: #808080;">|</span> ref  <span style="color: #808080;">|</span> rows <span style="color: #808080;">|</span> Extra       <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+---------+---------+------+------+-------------+</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> SIMPLE      <span style="color: #808080;">|</span> t1    <span style="color: #808080;">|</span> range <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span>       <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span> <span style="color: #808080;">|</span> <span style="color: #800000; font-weight: bold;">4</span>       <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;">3</span> <span style="color: #808080;">|</span> Using <span style="color: #0000ff;">where</span> <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+---------+---------+------+------+-------------+</span>
<span style="color: #800000; font-weight: bold;">1</span> row <span style="color: #808080;">in</span> <span style="color: #0000ff;">set</span> (<span style="color: #800000; font-weight: bold;">0.00</span> sec)</pre>
</div>

【示例四】ref：使用非唯一索引扫描或者唯一索引的前缀扫描，返回匹配某个单独值的记录行

<div>
  <div class="cnblogs_code">
    <pre>mysql<span style="color: #808080;">></span> explain <span style="color: #0000ff;">select</span> <span style="color: #808080;">*</span> <span style="color: #0000ff;">from</span> t1 <span style="color: #0000ff;">where</span> name<span style="color: #808080;">=</span><span style="color: #ff0000;">'</span><span style="color: #ff0000;">guo</span><span style="color: #ff0000;">'</span><span style="color: #000000;">;
</span><span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+------+---------------+------+---------+-------+------+-------------+</span>
<span style="color: #808080;">|</span> id <span style="color: #808080;">|</span> select_type <span style="color: #808080;">|</span> <span style="color: #0000ff;">table</span> <span style="color: #808080;">|</span> type <span style="color: #808080;">|</span> possible_keys <span style="color: #808080;">|</span> <span style="color: #0000ff;">key</span>  <span style="color: #808080;">|</span> key_len <span style="color: #808080;">|</span> ref   <span style="color: #808080;">|</span> rows <span style="color: #808080;">|</span> Extra       <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+------+---------------+------+---------+-------+------+-------------+</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> SIMPLE      <span style="color: #808080;">|</span> t1    <span style="color: #808080;">|</span> ref  <span style="color: #808080;">|</span> name          <span style="color: #808080;">|</span> name <span style="color: #808080;">|</span> <span style="color: #800000; font-weight: bold;">63</span>      <span style="color: #808080;">|</span> const <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> Using <span style="color: #0000ff;">where</span> <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+------+---------------+------+---------+-------+------+-------------+</span>
<span style="color: #800000; font-weight: bold;">1</span> row <span style="color: #808080;">in</span> <span style="color: #0000ff;">set</span> (<span style="color: #800000; font-weight: bold;">0.00</span> sec)</pre>
  </div>
</div>

【示例五】eq_ref：类似ref，区别就在使用的索引是唯一索引，对于每个索引键值，表中只有一条记录匹配，简单来说，就是多表连接中使用primary key或者 unique key作为关联条件。

<div>
  <div class="cnblogs_code">
    <pre>mysql<span style="color: #808080;">></span> explain <span style="color: #0000ff;">select</span> t1.name <span style="color: #0000ff;">from</span> t1, t2 <span style="color: #0000ff;">where</span> t1.id<span style="color: #808080;">=</span><span style="color: #000000;">t2.id;
</span><span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+--------+---------------+---------+---------+------------+------+-------------+</span>
<span style="color: #808080;">|</span> id <span style="color: #808080;">|</span> select_type <span style="color: #808080;">|</span> <span style="color: #0000ff;">table</span> <span style="color: #808080;">|</span> type   <span style="color: #808080;">|</span> possible_keys <span style="color: #808080;">|</span> <span style="color: #0000ff;">key</span>     <span style="color: #808080;">|</span> key_len <span style="color: #808080;">|</span> ref        <span style="color: #808080;">|</span> rows <span style="color: #808080;">|</span> Extra       <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+--------+---------------+---------+---------+------------+------+-------------+</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> SIMPLE      <span style="color: #808080;">|</span> t1    <span style="color: #808080;">|</span> <span style="color: #0000ff;">index</span>  <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span>       <span style="color: #808080;">|</span> name    <span style="color: #808080;">|</span> <span style="color: #800000; font-weight: bold;">63</span>      <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>       <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;">4</span> <span style="color: #808080;">|</span> Using <span style="color: #0000ff;">index</span> <span style="color: #808080;">|</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> SIMPLE      <span style="color: #808080;">|</span> t2    <span style="color: #808080;">|</span> eq_ref <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span>       <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span> <span style="color: #808080;">|</span> <span style="color: #800000; font-weight: bold;">4</span>       <span style="color: #808080;">|</span> test.t1.id <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> Using <span style="color: #0000ff;">index</span> <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+--------+---------------+---------+---------+------------+------+-------------+</span>
<span style="color: #800000; font-weight: bold;">2</span> rows <span style="color: #808080;">in</span> <span style="color: #0000ff;">set</span> (<span style="color: #800000; font-weight: bold;">0.00</span> sec)</pre>
  </div>
</div>

【示例六】const、system：当MySQL对查询某部分进行优化，并转换为一个常量时，使用这些类型访问。

　　如将主键置于where列表中，MySQL就能将该查询转换为一个常量

<div>
  <div class="cnblogs_code">
    <pre>mysql<span style="color: #808080;">></span> explain <span style="color: #0000ff;">select</span> <span style="color: #808080;">*</span> <span style="color: #0000ff;">from</span> ( <span style="color: #0000ff;">select</span> <span style="color: #808080;">*</span> <span style="color: #0000ff;">from</span> t1 <span style="color: #0000ff;">where</span> id<span style="color: #808080;">=</span><span style="color: #800000; font-weight: bold;">1</span><span style="color: #000000;">)b1;
</span><span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+------------+--------+---------------+---------+---------+------+------+-------+</span>
<span style="color: #808080;">|</span> id <span style="color: #808080;">|</span> select_type <span style="color: #808080;">|</span> <span style="color: #0000ff;">table</span>      <span style="color: #808080;">|</span> type   <span style="color: #808080;">|</span> possible_keys <span style="color: #808080;">|</span> <span style="color: #0000ff;">key</span>     <span style="color: #808080;">|</span> key_len <span style="color: #808080;">|</span> ref  <span style="color: #808080;">|</span> rows <span style="color: #808080;">|</span> Extra <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+------------+--------+---------------+---------+---------+------+------+-------+</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span>     <span style="color: #808080;">|</span> <span style="color: #808080;">&lt;</span>derived2<span style="color: #808080;">></span> <span style="color: #808080;">|</span> system <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>          <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>    <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>    <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span>       <span style="color: #808080;">|</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">2</span> <span style="color: #808080;">|</span> DERIVED     <span style="color: #808080;">|</span> t1         <span style="color: #808080;">|</span> const  <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span>       <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span> <span style="color: #808080;">|</span> <span style="color: #800000; font-weight: bold;">4</span>       <span style="color: #808080;">|</span>      <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span>       <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+------------+--------+---------------+---------+---------+------+------+-------+</span>
<span style="color: #800000; font-weight: bold;">2</span> rows <span style="color: #808080;">in</span> <span style="color: #0000ff;">set</span> (<span style="color: #800000; font-weight: bold;">0.00</span> sec)</pre>
  </div>
  
  <p>
    　　<strong><em><span style="text-decoration: underline;">注：</span></em></strong>system是const类型的特例，当查询的表只有一行的情况下，使用system
  </p>
</div>

【示例七】NULL：MySQL在优化过程中分解语句，执行时甚至不用访问表或索引，&nbsp;&nbsp; 例如从一个索引列里选取最小值可以通过单独索引查找完成。

<div>
  <div class="cnblogs_code">
    <pre>mysql<span style="color: #808080;">></span> explain <span style="color: #0000ff;">select</span> <span style="color: #808080;">*</span> <span style="color: #0000ff;">from</span> t1 <span style="color: #0000ff;">where</span> id <span style="color: #808080;">=</span> (<span style="color: #0000ff;">select</span> <span style="color: #ff00ff;">min</span>(id) <span style="color: #0000ff;">from</span><span style="color: #000000;"> t2);
</span><span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+---------+---------+-------+------+------------------------------+</span>
<span style="color: #808080;">|</span> id <span style="color: #808080;">|</span> select_type <span style="color: #808080;">|</span> <span style="color: #0000ff;">table</span> <span style="color: #808080;">|</span> type  <span style="color: #808080;">|</span> possible_keys <span style="color: #808080;">|</span> <span style="color: #0000ff;">key</span>     <span style="color: #808080;">|</span> key_len <span style="color: #808080;">|</span> ref   <span style="color: #808080;">|</span> rows <span style="color: #808080;">|</span> Extra                        <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+---------+---------+-------+------+------------------------------+</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span>     <span style="color: #808080;">|</span> t1    <span style="color: #808080;">|</span> const <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span>       <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span> <span style="color: #808080;">|</span> <span style="color: #800000; font-weight: bold;">4</span>       <span style="color: #808080;">|</span> const <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span>                              <span style="color: #808080;">|</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">2</span> <span style="color: #808080;">|</span> SUBQUERY    <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>  <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>  <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>          <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>    <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>    <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>  <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">Select</span> tables optimized away <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+---------+---------+-------+------+------------------------------+</span>
<span style="color: #800000; font-weight: bold;">2</span> rows <span style="color: #808080;">in</span> <span style="color: #0000ff;">set</span> (<span style="color: #800000; font-weight: bold;">0.00</span> sec)</pre>
  </div>
</div>

### <span id="158_possible_keys"><span style="background-color: #ffff00;">1.5.8 possible_keys</span></span>

　　指出MySQL能使用哪个索引在表中找到记录，查询涉及到的字段上若存在索引，则该索引将被列出，但不一定被查询使用

### <span id="159_key"><span style="background-color: #ffff00;">1.5.9 key</span></span>

　　显示MySQL在查询中实际使用的索引，若没有使用索引，显示为NULL

【示例】

<div>
  <div class="cnblogs_code">
    <pre>mysql<span style="color: #808080;">></span> explain <span style="color: #0000ff;">select</span> id,age <span style="color: #0000ff;">from</span><span style="color: #000000;"> t1;
</span><span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+------+---------+------+------+-------------+</span>
<span style="color: #808080;">|</span> id <span style="color: #808080;">|</span> select_type <span style="color: #808080;">|</span> <span style="color: #0000ff;">table</span> <span style="color: #808080;">|</span> type  <span style="color: #808080;">|</span> possible_keys <span style="color: #808080;">|</span> <span style="color: #0000ff;">key</span>  <span style="color: #808080;">|</span> key_len <span style="color: #808080;">|</span> ref  <span style="color: #808080;">|</span> rows <span style="color: #808080;">|</span> Extra       <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+------+---------+------+------+-------------+</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> SIMPLE      <span style="color: #808080;">|</span> t1    <span style="color: #808080;">|</span> <span style="color: #0000ff;">index</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>          <span style="color: #808080;">|</span> age  <span style="color: #808080;">|</span> <span style="color: #800000; font-weight: bold;">5</span>       <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;">4</span> <span style="color: #808080;">|</span> Using <span style="color: #0000ff;">index</span> <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+------+---------+------+------+-------------+</span>
<span style="color: #800000; font-weight: bold;">1</span> row <span style="color: #808080;">in</span> <span style="color: #0000ff;">set</span> (<span style="color: #800000; font-weight: bold;">0.00</span> sec)</pre>
  </div>
</div>

### <span id="1510_key_len"><span style="background-color: #ffff00;">1.5.10 key_len</span></span>

　　表示索引中使用的字节数，可通过该列计算查询中使用的索引的长度（key\_len显示的值为索引字段的最大可能长度，并非实际使用长度，即key\_len是根据表定义计算而得，不是通过表内检索出的）。

### <span id="1511_ref"><span style="background-color: #ffff00;">1.5.11 ref</span></span>

　　表示上述表的连接匹配条件，即哪些列或常量被用于查找索引列上的值。

### <span id="1512_rows"><span style="background-color: #ffff00;">1.5.12 rows</span></span>

　　表示MySQL根据表统计信息及索引选用情况，估算的找到所需的记录所需要读取的行数。

【示例】

<div>
  <div class="cnblogs_code">
    <pre>mysql<span style="color: #808080;">></span> explain <span style="color: #0000ff;">select</span> <span style="color: #808080;">*</span> <span style="color: #0000ff;">from</span> t1 , t2 <span style="color: #0000ff;">where</span> t1.id<span style="color: #808080;">=</span>t2.id <span style="color: #808080;">and</span> t2.name<span style="color: #808080;">=</span><span style="color: #ff0000;">'</span><span style="color: #ff0000;">atlas</span><span style="color: #ff0000;">'</span><span style="color: #000000;">;
</span><span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+--------+---------------+---------+---------+------------+------+-------------+</span>
<span style="color: #808080;">|</span> id <span style="color: #808080;">|</span> select_type <span style="color: #808080;">|</span> <span style="color: #0000ff;">table</span> <span style="color: #808080;">|</span> type   <span style="color: #808080;">|</span> possible_keys <span style="color: #808080;">|</span> <span style="color: #0000ff;">key</span>     <span style="color: #808080;">|</span> key_len <span style="color: #808080;">|</span> ref        <span style="color: #808080;">|</span> rows <span style="color: #808080;">|</span> Extra       <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+--------+---------------+---------+---------+------------+------+-------------+</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> SIMPLE      <span style="color: #808080;">|</span> t2    <span style="color: #808080;">|</span> ref    <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span>,name  <span style="color: #808080;">|</span> name    <span style="color: #808080;">|</span> <span style="color: #800000; font-weight: bold;">63</span>      <span style="color: #808080;">|</span> const      <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> Using <span style="color: #0000ff;">where</span> <span style="color: #808080;">|</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> SIMPLE      <span style="color: #808080;">|</span> t1    <span style="color: #808080;">|</span> eq_ref <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span>       <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span> <span style="color: #808080;">|</span> <span style="color: #800000; font-weight: bold;">4</span>       <span style="color: #808080;">|</span> test.t2.id <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span>             <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+--------+---------------+---------+---------+------------+------+-------------+</span>
<span style="color: #800000; font-weight: bold;">2</span> rows <span style="color: #808080;">in</span> <span style="color: #0000ff;">set</span> (<span style="color: #800000; font-weight: bold;">0.00</span> sec)</pre>
  </div>
</div>

### <span id="1513_Extra">1.5.13 Extra</span>

　　包含不适合在其他列中显示但十分重要的额外信息

【示例一】Using index

该值表示相应的select操作中使用了覆盖索引（Covering Index）

<div>
  <div class="cnblogs_code">
    <pre>mysql<span style="color: #808080;">></span> explain <span style="color: #0000ff;">select</span> id <span style="color: #0000ff;">from</span><span style="color: #000000;"> t1;
</span><span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+------+---------+------+------+-------------+</span>
<span style="color: #808080;">|</span> id <span style="color: #808080;">|</span> select_type <span style="color: #808080;">|</span> <span style="color: #0000ff;">table</span> <span style="color: #808080;">|</span> type  <span style="color: #808080;">|</span> possible_keys <span style="color: #808080;">|</span> <span style="color: #0000ff;">key</span>  <span style="color: #808080;">|</span> key_len <span style="color: #808080;">|</span> ref  <span style="color: #808080;">|</span> rows <span style="color: #808080;">|</span> Extra       <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+------+---------+------+------+-------------+</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> SIMPLE      <span style="color: #808080;">|</span> t1    <span style="color: #808080;">|</span> <span style="color: #0000ff;">index</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>          <span style="color: #808080;">|</span> age  <span style="color: #808080;">|</span> <span style="color: #800000; font-weight: bold;">5</span>       <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;">4</span> <span style="color: #808080;">|</span> Using <span style="color: #0000ff;">index</span> <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+------+---------+------+------+-------------+</span>
<span style="color: #800000; font-weight: bold;">1</span> row <span style="color: #808080;">in</span> <span style="color: #0000ff;">set</span> (<span style="color: #800000; font-weight: bold;">0.00</span> sec)</pre>
  </div>
</div>

　　　　覆盖索引（Covering Index）

　　　　MySQL可以利用索引返回select列表中的字段，而不必根据索引再次读取数据文件

　　　　包含所有满足查询需要的数据的索引称为覆盖索引（Covering Index）

**　　　　<span style="color: #ff0000;">注意：</span>**如果要使用覆盖索引，一定要注意select列表中只取出需要的列，不可select *，因为如果将所有字段一起做索引会导致索引文件过大，查询性能下降

【示例二】Using where

　　表示mysql服务器将在存储引擎检索行后再进行过滤。许多where条件里涉及索引中的列，当（并且如果）它读取索引时，就能被存储引擎检验，因此不是所有带where字句的查询都会显示"Using where"。

　　有时"Using where"的出现就是一个暗示：查询可受益与不同的索引。

<div>
  <div class="cnblogs_code">
    <pre>mysql<span style="color: #808080;">></span> explain <span style="color: #0000ff;">select</span> id,name <span style="color: #0000ff;">from</span> t1 <span style="color: #0000ff;">where</span> id<span style="color: #808080;">&lt;</span><span style="color: #800000; font-weight: bold;">4</span><span style="color: #000000;">;
</span><span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+------+---------+------+------+--------------------------+</span>
<span style="color: #808080;">|</span> id <span style="color: #808080;">|</span> select_type <span style="color: #808080;">|</span> <span style="color: #0000ff;">table</span> <span style="color: #808080;">|</span> type  <span style="color: #808080;">|</span> possible_keys <span style="color: #808080;">|</span> <span style="color: #0000ff;">key</span>  <span style="color: #808080;">|</span> key_len <span style="color: #808080;">|</span> ref  <span style="color: #808080;">|</span> rows <span style="color: #808080;">|</span> Extra                    <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+------+---------+------+------+--------------------------+</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> SIMPLE      <span style="color: #808080;">|</span> t1    <span style="color: #808080;">|</span> <span style="color: #0000ff;">index</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span>       <span style="color: #808080;">|</span> name <span style="color: #808080;">|</span> <span style="color: #800000; font-weight: bold;">63</span>      <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;">4</span> <span style="color: #808080;">|</span> Using <span style="color: #0000ff;">where</span>; Using <span style="color: #0000ff;">index</span> <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+------+---------+------+------+--------------------------+</span>
<span style="color: #800000; font-weight: bold;">1</span> row <span style="color: #808080;">in</span> <span style="color: #0000ff;">set</span> (<span style="color: #800000; font-weight: bold;">0.00</span> sec)</pre>
  </div>
</div>

【示例三】Using temporary

　　表示MySQL需要使用临时表来存储结果集，常见于排序和分组查询

　　这个值表示使用了内部临时(基于内存的)表。一个查询可能用到多个临时表。有很多原因都会导致MySQL在执行查询期间创建临时表。两个常见的原因是在来自不同表的上使用了DISTINCT,或者使用了不同的ORDER BY和GROUP BY列。可以强制指定一个临时表使用基于磁盘的MyISAM存储引擎。这样做的原因主要有两个：

　　　　1)内部临时表占用的空间超过min(tmp\_table\_size，max\_heap\_table_size)系统变量的限制

　　　　2)使用了TEXT/BLOB 列

<div>
  <div class="cnblogs_code">
    <pre>mysql<span style="color: #808080;">></span> explain <span style="color: #0000ff;">select</span> id <span style="color: #0000ff;">from</span> t1 <span style="color: #0000ff;">where</span> id <span style="color: #808080;">in</span> (<span style="color: #800000; font-weight: bold;">1</span>,<span style="color: #800000; font-weight: bold;">2</span>) <span style="color: #0000ff;">group</span> <span style="color: #0000ff;">by</span><span style="color: #000000;"> age,name;
</span><span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+---------+---------+------+------+----------------------------------------------+</span>
<span style="color: #808080;">|</span> id <span style="color: #808080;">|</span> select_type <span style="color: #808080;">|</span> <span style="color: #0000ff;">table</span> <span style="color: #808080;">|</span> type  <span style="color: #808080;">|</span> possible_keys <span style="color: #808080;">|</span> <span style="color: #0000ff;">key</span>     <span style="color: #808080;">|</span> key_len <span style="color: #808080;">|</span> ref  <span style="color: #808080;">|</span> rows <span style="color: #808080;">|</span> Extra                                        <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+---------+---------+------+------+----------------------------------------------+</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> SIMPLE      <span style="color: #808080;">|</span> t1    <span style="color: #808080;">|</span> range <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span>       <span style="color: #808080;">|</span> <span style="color: #0000ff;">PRIMARY</span> <span style="color: #808080;">|</span> <span style="color: #800000; font-weight: bold;">4</span>       <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;">2</span> <span style="color: #808080;">|</span> Using <span style="color: #0000ff;">where</span>; Using <span style="color: #0000ff;">temporary</span>; Using filesort <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+---------+---------+------+------+----------------------------------------------+</span>
<span style="color: #800000; font-weight: bold;">1</span> row <span style="color: #808080;">in</span> <span style="color: #0000ff;">set</span> (<span style="color: #800000; font-weight: bold;">0.00</span> sec)</pre>
  </div>
</div>

【示例四】Using filesort

　　MySQL中无法利用索引完成的排序操作称为&ldquo;文件排序&rdquo;

<div>
  <div class="cnblogs_code">
    <pre>mysql<span style="color: #808080;">></span> explain <span style="color: #0000ff;">select</span> id,age <span style="color: #0000ff;">from</span> t1 <span style="color: #0000ff;">order</span> <span style="color: #0000ff;">by</span><span style="color: #000000;"> name; 
</span><span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+------+---------------+------+---------+------+------+----------------+</span>
<span style="color: #808080;">|</span> id <span style="color: #808080;">|</span> select_type <span style="color: #808080;">|</span> <span style="color: #0000ff;">table</span> <span style="color: #808080;">|</span> type <span style="color: #808080;">|</span> possible_keys <span style="color: #808080;">|</span> <span style="color: #0000ff;">key</span>  <span style="color: #808080;">|</span> key_len <span style="color: #808080;">|</span> ref  <span style="color: #808080;">|</span> rows <span style="color: #808080;">|</span> Extra          <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+------+---------------+------+---------+------+------+----------------+</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> SIMPLE      <span style="color: #808080;">|</span> t1    <span style="color: #808080;">|</span> <span style="color: #808080;">ALL</span>  <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>          <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>    <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;">4</span> <span style="color: #808080;">|</span> Using filesort <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+------+---------------+------+---------+------+------+----------------+</span>
<span style="color: #800000; font-weight: bold;">1</span> row <span style="color: #808080;">in</span> <span style="color: #0000ff;">set</span> (<span style="color: #800000; font-weight: bold;">0.00</span> sec)</pre>
  </div>
</div>

<div>
  <div class="cnblogs_code">
    <pre>mysql<span style="color: #808080;">></span> explain <span style="color: #0000ff;">select</span> id,age <span style="color: #0000ff;">from</span> t1 <span style="color: #0000ff;">order</span> <span style="color: #0000ff;">by</span><span style="color: #000000;"> age; 
</span><span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+------+---------+------+------+-------------+</span>
<span style="color: #808080;">|</span> id <span style="color: #808080;">|</span> select_type <span style="color: #808080;">|</span> <span style="color: #0000ff;">table</span> <span style="color: #808080;">|</span> type  <span style="color: #808080;">|</span> possible_keys <span style="color: #808080;">|</span> <span style="color: #0000ff;">key</span>  <span style="color: #808080;">|</span> key_len <span style="color: #808080;">|</span> ref  <span style="color: #808080;">|</span> rows <span style="color: #808080;">|</span> Extra       <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+------+---------+------+------+-------------+</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> SIMPLE      <span style="color: #808080;">|</span> t1    <span style="color: #808080;">|</span> <span style="color: #0000ff;">index</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>          <span style="color: #808080;">|</span> age  <span style="color: #808080;">|</span> <span style="color: #800000; font-weight: bold;">5</span>       <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;">4</span> <span style="color: #808080;">|</span> Using <span style="color: #0000ff;">index</span> <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+------+---------+------+------+-------------+</span>
<span style="color: #800000; font-weight: bold;">1</span> row <span style="color: #808080;">in</span> <span style="color: #0000ff;">set</span> (<span style="color: #800000; font-weight: bold;">0.00</span> sec)</pre>
  </div>
  
  <p>
    【示例五】Using join buffer
  </p>
</div>

　　该值强调了在获取连接条件时没有使用索引，并且需要连接缓冲区来存储中间结果。

　　如果出现了这个值，那应该注意，根据查询的具体情况可能需要添加索引来改进能。

<div>
  <div class="cnblogs_code">
    <pre>mysql<span style="color: #808080;">></span> explain <span style="color: #0000ff;">select</span> t1.name <span style="color: #0000ff;">from</span> t1 <span style="color: #0000ff;">inner</span> <span style="color: #808080;">join</span> t2 <span style="color: #0000ff;">on</span> t1.name<span style="color: #808080;">=</span><span style="color: #000000;">t2.name;
</span><span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+------+---------+--------------+------+--------------------------+</span>
<span style="color: #808080;">|</span> id <span style="color: #808080;">|</span> select_type <span style="color: #808080;">|</span> <span style="color: #0000ff;">table</span> <span style="color: #808080;">|</span> type  <span style="color: #808080;">|</span> possible_keys <span style="color: #808080;">|</span> <span style="color: #0000ff;">key</span>  <span style="color: #808080;">|</span> key_len <span style="color: #808080;">|</span> ref          <span style="color: #808080;">|</span> rows <span style="color: #808080;">|</span> Extra                    <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+------+---------+--------------+------+--------------------------+</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> SIMPLE      <span style="color: #808080;">|</span> t1    <span style="color: #808080;">|</span> <span style="color: #0000ff;">index</span> <span style="color: #808080;">|</span> name          <span style="color: #808080;">|</span> name <span style="color: #808080;">|</span> <span style="color: #800000; font-weight: bold;">63</span>      <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>         <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;">4</span> <span style="color: #808080;">|</span> Using <span style="color: #0000ff;">index</span>              <span style="color: #808080;">|</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> SIMPLE      <span style="color: #808080;">|</span> t2    <span style="color: #808080;">|</span> ref   <span style="color: #808080;">|</span> name          <span style="color: #808080;">|</span> name <span style="color: #808080;">|</span> <span style="color: #800000; font-weight: bold;">63</span>      <span style="color: #808080;">|</span> test.t1.name <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;">2</span> <span style="color: #808080;">|</span> Using <span style="color: #0000ff;">where</span>; Using <span style="color: #0000ff;">index</span> <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+-------+---------------+------+---------+--------------+------+--------------------------+</span>
<span style="color: #800000; font-weight: bold;">2</span> rows <span style="color: #808080;">in</span> <span style="color: #0000ff;">set</span> (<span style="color: #800000; font-weight: bold;">0.00</span> sec)</pre>
  </div>
</div>

删除t1索引

<div>
  <div class="cnblogs_code">
    <pre>mysql<span style="color: #808080;">></span> <span style="color: #0000ff;">alter</span> <span style="color: #0000ff;">table</span> t1 <span style="color: #0000ff;">drop</span> <span style="color: #0000ff;">key</span><span style="color: #000000;"> name;                                   
Query OK, </span><span style="color: #800000; font-weight: bold;"></span> rows affected (<span style="color: #800000; font-weight: bold;">0.02</span><span style="color: #000000;"> sec)
Records: </span><span style="color: #800000; font-weight: bold;"></span>  Duplicates: <span style="color: #800000; font-weight: bold;"></span>  Warnings: <span style="color: #800000; font-weight: bold;"></span></pre>
  </div>
</div>

删除t2索引

<div>
  <div class="cnblogs_code">
    <pre>mysql<span style="color: #808080;">></span> <span style="color: #0000ff;">alter</span> <span style="color: #0000ff;">table</span> t2 <span style="color: #0000ff;">drop</span> <span style="color: #0000ff;">key</span><span style="color: #000000;"> name; 
Query OK, </span><span style="color: #800000; font-weight: bold;"></span> rows affected (<span style="color: #800000; font-weight: bold;">0.02</span><span style="color: #000000;"> sec)
Records: </span><span style="color: #800000; font-weight: bold;"></span>  Duplicates: <span style="color: #800000; font-weight: bold;"></span>  Warnings: <span style="color: #800000; font-weight: bold;"></span></pre>
  </div>
</div>

经常查找

<div>
  <div class="cnblogs_code">
    <pre>mysql<span style="color: #808080;">></span> explain <span style="color: #0000ff;">select</span> t1.name <span style="color: #0000ff;">from</span> t1 <span style="color: #0000ff;">inner</span> <span style="color: #808080;">join</span> t2 <span style="color: #0000ff;">on</span> t1.name<span style="color: #808080;">=</span><span style="color: #000000;">t2.name;
</span><span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+------+---------------+------+---------+------+------+--------------------------------+</span>
<span style="color: #808080;">|</span> id <span style="color: #808080;">|</span> select_type <span style="color: #808080;">|</span> <span style="color: #0000ff;">table</span> <span style="color: #808080;">|</span> type <span style="color: #808080;">|</span> possible_keys <span style="color: #808080;">|</span> <span style="color: #0000ff;">key</span>  <span style="color: #808080;">|</span> key_len <span style="color: #808080;">|</span> ref  <span style="color: #808080;">|</span> rows <span style="color: #808080;">|</span> Extra                          <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+------+---------------+------+---------+------+------+--------------------------------+</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> SIMPLE      <span style="color: #808080;">|</span> t1    <span style="color: #808080;">|</span> <span style="color: #808080;">ALL</span>  <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>          <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>    <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;">4</span> <span style="color: #808080;">|</span>                                <span style="color: #808080;">|</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> SIMPLE      <span style="color: #808080;">|</span> t2    <span style="color: #808080;">|</span> <span style="color: #808080;">ALL</span>  <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>          <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>    <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span>    <span style="color: #800000; font-weight: bold;">4</span> <span style="color: #808080;">|</span> Using <span style="color: #0000ff;">where</span>; Using <span style="color: #808080;">join</span> buffer <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+------+---------------+------+---------+------+------+--------------------------------+</span>
<span style="color: #800000; font-weight: bold;">2</span> rows <span style="color: #808080;">in</span> <span style="color: #0000ff;">set</span> (<span style="color: #800000; font-weight: bold;">0.00</span> sec)</pre>
  </div>
</div>

【示例六】Impossible where

　　这个值强调了where语句会导致没有符合条件的行。

<div>
  <div class="cnblogs_code">
    <pre>mysql<span style="color: #808080;">></span> EXPLAIN <span style="color: #0000ff;">SELECT</span> <span style="color: #808080;">*</span> <span style="color: #0000ff;">FROM</span> t1 <span style="color: #0000ff;">WHERE</span> <span style="color: #800000; font-weight: bold;">1</span><span style="color: #808080;">=</span><span style="color: #800000; font-weight: bold;">2</span><span style="color: #000000;">;
</span><span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+------+---------------+------+---------+------+------+------------------+</span>
<span style="color: #808080;">|</span> id <span style="color: #808080;">|</span> select_type <span style="color: #808080;">|</span> <span style="color: #0000ff;">table</span> <span style="color: #808080;">|</span> type <span style="color: #808080;">|</span> possible_keys <span style="color: #808080;">|</span> <span style="color: #0000ff;">key</span>  <span style="color: #808080;">|</span> key_len <span style="color: #808080;">|</span> ref  <span style="color: #808080;">|</span> rows <span style="color: #808080;">|</span> Extra            <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+------+---------------+------+---------+------+------+------------------+</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> SIMPLE      <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>  <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>          <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>    <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span> Impossible <span style="color: #0000ff;">WHERE</span> <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+------+---------------+------+---------+------+------+------------------+</span>
<span style="color: #800000; font-weight: bold;">1</span> row <span style="color: #808080;">in</span> <span style="color: #0000ff;">set</span> (<span style="color: #800000; font-weight: bold;">0.00</span> sec)</pre>
  </div>
</div>

【示例七】Select tables optimized away

　　这个值意味着仅通过使用索引，优化器可能仅从聚合函数结果中返回一行.

<div>
  <div class="cnblogs_code">
    <pre>mysql<span style="color: #808080;">></span> explain <span style="color: #0000ff;">select</span> <span style="color: #ff00ff;">max</span>(id) <span style="color: #0000ff;">from</span><span style="color: #000000;"> t1;
</span><span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+------+---------------+------+---------+------+------+------------------------------+</span>
<span style="color: #808080;">|</span> id <span style="color: #808080;">|</span> select_type <span style="color: #808080;">|</span> <span style="color: #0000ff;">table</span> <span style="color: #808080;">|</span> type <span style="color: #808080;">|</span> possible_keys <span style="color: #808080;">|</span> <span style="color: #0000ff;">key</span>  <span style="color: #808080;">|</span> key_len <span style="color: #808080;">|</span> ref  <span style="color: #808080;">|</span> rows <span style="color: #808080;">|</span> Extra                        <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+------+---------------+------+---------+------+------+------------------------------+</span>
<span style="color: #808080;">|</span>  <span style="color: #800000; font-weight: bold;">1</span> <span style="color: #808080;">|</span> SIMPLE      <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>  <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>          <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span>    <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">NULL</span> <span style="color: #808080;">|</span> <span style="color: #0000ff;">Select</span> tables optimized away <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">--+-------------+-------+------+---------------+------+---------+------+------+------------------------------+</span>
<span style="color: #800000; font-weight: bold;">1</span> row <span style="color: #808080;">in</span> <span style="color: #0000ff;">set</span> (<span style="color: #800000; font-weight: bold;">0.00</span> sec)</pre>
  </div>
</div>

【示例八】Index merges

　　当MySQL 决定要在一个给定的表上使用超过一个索引的时候，就会出现以下格式中的一个，详细说明使用的索引以及合并的类型。

<div>
  <div class="cnblogs_code">
    <pre><span style="color: #000000;">Using sort_union(...)
Using </span><span style="color: #0000ff;">union</span><span style="color: #000000;">(...)
Using </span><span style="color: #0000ff;">intersect</span>(...)</pre>
  </div>
</div>

### <span id="1514">1.5.14 小结</span>

　　EXPLAIN不会告诉你关于触发器、存储过程的信息或用户自定义函数对查询的影响情况。

　　EXPLAIN不考虑各种Cache。

　　EXPLAIN不能显示MySQL在执行查询时所作的优化工作。

　　部分统计信息是估算的，并非精确值。

　　EXPALIN只能解释SELECT操作，其他操作要重写为SELECT后查看执行计划。

## <span id="16_mysql">1.6 mysql不走索引的原因</span>

### <span id="161">1.6.1 一些常见的原因</span>

　　1) 没有查询条件，或者查询条件没有建立索引

　　2) 在查询条件上没有使用引导列

　　3) 查询的数量是大表的大部分，应该是30％以上。

　　4) 索引本身失效

　　5) 查询条件使用函数在索引列上，或者对索引列进行运算，运算包括(+，-，*，/，! 等)

<div>
  <p class="a1">
    　　　　错误的例子：select * from test where id-1=9; 正确的例子：select * from test where id=10;
  </p>
</div>

　　6) 对小表查询

　　7) 提示不使用索引

　　8) 统计数据不真实

　　9) CBO计算走索引花费过大的情况。其实也包含了上面的情况，这里指的是表占有的block要比索引小。

　　10)隐式转换导致索引失效.这一点应当引起重视.也是开发中经常会犯的错误.

<div>
  <p class="a1">
    　　　　由于表的字段tel_num定义为varchar2(20),但在查询时把该字段作为number类型以where条件传给数据库,这样会导致索引失效.
  </p>
  
  <p class="a1">
    　　　　　　错误的例子：select * from test where tel_nume=13333333333;
  </p>
  
  <p class="a1">
    　　　　　　正确的例子：select * from test where tel_nume='13333333333';
  </p>
</div>

　　11) 注意使用的特殊符号

<div>
  <p class="a1">
    &nbsp;&nbsp;&nbsp; 　　　　1,<>&nbsp; ,!=
  </p>
  
  <p class="a1">
    &nbsp;&nbsp;　　　　&nbsp; 2,单独的>,<,(有时会用到，有时不会)
  </p>
</div>

　　12)like "%_" 百分号在前.

<div>
  <p class="a1">
    　　　　　　select * from t1&nbsp; where name like 'linux培训%';
  </p>
</div>

　　13) not in ,not exist.

　　14)&nbsp; in&nbsp; 尽量改成 union 。

　　15)当变量采用的是times变量，而表的字段采用的是date变量时.或相反情况。

　　16)B-tree索引is null不会走,is not null会走,位图索引 is null,is not null 都会走 。

　　17)联合索引 is not null 只要在建立的索引列（不分先后）都会走,

　　in null时 必须要和建立索引第一列一起使用,当建立索引第一位置条件是is null 时,其他建立索引的列可以是is null（但必须在所有列 都满足is null的时候）,或者=一个值；

　　当建立索引的第一位置是=一个值时,其他索引列可以是任何情况（包括is null =一个值）,以上两种情况索引都会走。其他情况不会走。

### <span id="162">1.6.2 需要注意的一些</span>

<div class="cnblogs_code">
  <pre><span style="color: #800000; font-weight: bold;">1</span><span style="color: #000000;">)    MyISAM 存储引擎索引键长度总和不能超过1000 字节；
</span><span style="color: #800000; font-weight: bold;">2</span><span style="color: #000000;">)    BLOB 和TEXT 类型的列只能创建前缀索引；
</span><span style="color: #800000; font-weight: bold;">3</span><span style="color: #000000;">)    MySQL 目前不支持函数索引；
</span><span style="color: #800000; font-weight: bold;">4</span>)    使用不等于（<span style="color: #808080;">!=</span> 或者<span style="color: #808080;">&lt;></span><span style="color: #000000;">）的时候MySQL 无法使用索引；
</span><span style="color: #800000; font-weight: bold;">5</span>)    过滤字段使用了函数运算后（如abs(<span style="color: #0000ff;">column</span><span style="color: #000000;">)），MySQL 无法使用索引；
</span><span style="color: #800000; font-weight: bold;">6</span>)    <span style="color: #808080;">Join</span><span style="color: #000000;"> 语句中Join 条件字段类型不一致的时候MySQL 无法使用索引；
</span><span style="color: #800000; font-weight: bold;">7</span>)    使用LIKE 操作的时候如果条件以通配符开始（ <span style="color: #ff0000;">'</span><span style="color: #ff0000;">%abc...</span><span style="color: #ff0000;">'</span><span style="color: #000000;">）MySQL 无法使用索引；
</span><span style="color: #800000; font-weight: bold;">8</span><span style="color: #000000;">)    使用非等值查询的时候MySQL 无法使用Hash 索引；
</span><span style="color: #800000; font-weight: bold;">9</span>)    在我们使用索引的时候，需要注意上面的这些限制，尤其是要注意无法使用索引的情况，因为这很容易让我们因为疏忽而造成极大的性能隐患。</pre>
</div>

## <span id="17">1.7 数据库索引的设计原则</span>

　　为了使索引的使用效率更高，在创建索引时，必须考虑在哪些字段上创建索引和创建什么类型的索引。

### <span id="171">1.7.1 那么索引设计原则又是怎样的</span>

<span style="background-color: #00ff00;">1．选择唯一性索引</span>

　　唯一性索引的值是唯一的，可以更快速的通过该索引来确定某条记录。

　　例如，学生表中学号是具有唯一性的字段。为该字段建立唯一性索引可以很快的确定某个学生的信息。如果使用姓名的话，可能存在同名现象，从而降低查询速度。

<span style="background-color: #00ff00;">2．为经常需要排序、分组和联合操作的字段建立索引</span>

　　经常需要ORDER BY、GROUP BY、DISTINCT和UNION等操作的字段，排序操作会浪费很多时间。

如果为其建立索引，可以有效地避免排序操作。

<span style="background-color: #00ff00;">3．为常作为查询条件的字段建立索引</span>

　　如果某个字段经常用来做查询条件，那么该字段的查询速度会影响整个表的查询速度。因此，

　　为这样的字段建立索引，可以提高整个表的查询速度。

<span style="background-color: #00ff00;">4．限制索引的数目</span>

　　索引的数目不是越多越好。每个索引都需要占用磁盘空间，索引越多，需要的磁盘空间就越大。修改表时，对索引的重构和更新很麻烦。越多的索引，会使更新表变得很浪费时间。

<span style="background-color: #00ff00;">5．尽量使用数据量少的索引</span>

　　如果索引的值很长，那么查询的速度会受到影响。例如，对一个CHAR（100）类型的字段进行全文检索需要的时间肯定要比对CHAR（10）类型的字段需要的时间要多。

<span style="background-color: #00ff00;">6．尽量使用前缀来索引</span>

　　如果索引字段的值很长，最好使用值的前缀来索引。例如，TEXT和BLOG类型的字段，进行全文检索会很浪费时间。如果只检索字段的前面的若干个字符，这样可以提高检索速度。

<span style="background-color: #00ff00;">7．删除不再使用或者很少使用的索引</span>

　　表中的数据被大量更新，或者数据的使用方式被改变后，原有的一些索引可能不再需要。数据库管理员应当定期找出这些索引，将它们删除，从而减少索引对更新操作的影响。

<span style="background-color: #00ff00;">8.小表不应建立索引</span>

　　包含大量的列并且不需要搜索非空值的时候可以考虑不建索引

## <span id="18">1.8 参考文献</span>

<div>
  <div class="cnblogs_code">
    <pre>https:<span style="color: #808080;">//</span>baike.baidu.com<span style="color: #808080;">/</span>item<span style="color: #808080;">/</span>数据库索引<span style="color: #808080;">/</span><span style="color: #800000; font-weight: bold;">8751686</span>?fr<span style="color: #808080;">=</span><span style="color: #000000;">aladdin
https:</span><span style="color: #808080;">//</span>www.cnblogs.com<span style="color: #808080;">/</span>oldhorse<span style="color: #808080;">/</span>archive<span style="color: #808080;">/</span><span style="color: #800000; font-weight: bold;">2009</span><span style="color: #808080;">/</span><span style="color: #800000; font-weight: bold;">11</span><span style="color: #808080;">/</span><span style="color: #800000; font-weight: bold;">16</span><span style="color: #808080;">/</span><span style="color: #800000; font-weight: bold;">1604009</span><span style="color: #000000;">.html
http:</span><span style="color: #808080;">//</span>blog.csdn.net<span style="color: #808080;">/</span>manesking<span style="color: #808080;">/</span>archive<span style="color: #808080;">/</span><span style="color: #800000; font-weight: bold;">2007</span><span style="color: #808080;">/</span><span style="color: #800000; font-weight: bold;">02</span><span style="color: #808080;">/</span><span style="color: #800000; font-weight: bold;">09</span><span style="color: #808080;">/</span><span style="color: #800000; font-weight: bold;">1505979</span><span style="color: #000000;">.aspx
http:</span><span style="color: #808080;">//</span>blog.csdn.net<span style="color: #808080;">/</span>woshiqjs<span style="color: #808080;">/</span>article<span style="color: #808080;">/</span>details<span style="color: #808080;">/</span><span style="color: #800000; font-weight: bold;">24135495</span></pre>
  </div>
  
  <p>
    &nbsp;
  </p>
</div>

&nbsp;

<div id="toc_container" class="toc_white have_bullets">
  <ul class="toc_list">
    <li>
      <a href="#11">1.1 索引的介绍</a><ul>
        <li>
          <a href="#111">1.1.1 唯一索引</a>
        </li>
        <li>
          <a href="#112">1.1.2 主键索引</a>
        </li>
        <li>
          <a href="#113">1.1.3 聚集索引</a>
        </li>
        <li>
          <a href="#114">1.1.4 索引列</a>
        </li>
        <li>
          <a href="#115_B">1.1.5 B树算法</a>
        </li>
        <li>
          <a href="#116_B">1.1.6 B+树算法</a>
        </li>
        <li>
          <a href="#117_HASHHASH">1.1.7 HASH：HASH算法</a>
        </li>
        <li>
          <a href="#118">1.1.8 其他的索引</a>
        </li>
      </ul>
    </li>
    
    <li>
      <a href="#12_MySQL">1.2 MySQL索引管理</a><ul>
        <li>
          <a href="#121">1.2.1 创建普通索引</a>
        </li>
        <li>
          <a href="#122">1.2.2 删除索引</a>
        </li>
      </ul>
    </li>
    
    <li>
      <a href="#13_MySQL">1.3 MySQL中的约束索引</a><ul>
        <li>
          <a href="#131">1.3.1 创建主键索引</a>
        </li>
        <li>
          <a href="#132">1.3.2 使用字段前缀创建索引及联合索引</a>
        </li>
      </ul>
    </li>
    
    <li>
      <a href="#14_SQL">1.4 SQL语句优化</a><ul>
        <li>
          <a href="#141_SQL">1.4.1 企业SQL优化思路</a>
        </li>
        <li>
          <a href="#142">1.4.2 不适合走索引的场景</a>
        </li>
        <li>
          <a href="#143">1.4.3 查看表的唯一值数量</a>
        </li>
        <li>
          <a href="#144">1.4.4 建立索引流程</a>
        </li>
      </ul>
    </li>
    
    <li>
      <a href="#15_explainSQL">1.5 用explain查看SQL的执行计划</a><ul>
        <li>
          <a href="#151_select">1.5.1 查看 select 语句的执行过程</a>
        </li>
        <li>
          <a href="#152">1.5.2 通过执行计划可以知道什么？</a>
        </li>
        <li>
          <a href="#153_MySQL">1.5.3 MySQL执行计划调用方式</a>
        </li>
        <li>
          <a href="#154">1.5.4 执行计划包含的信息</a>
        </li>
        <li>
          <a href="#155_id">1.5.5 id</a>
        </li>
        <li>
          <a href="#156_select_type">1.5.6 select_type</a>
        </li>
        <li>
          <a href="#157_type">1.5.7 type</a>
        </li>
        <li>
          <a href="#158_possible_keys">1.5.8 possible_keys</a>
        </li>
        <li>
          <a href="#159_key">1.5.9 key</a>
        </li>
        <li>
          <a href="#1510_key_len">1.5.10 key_len</a>
        </li>
        <li>
          <a href="#1511_ref">1.5.11 ref</a>
        </li>
        <li>
          <a href="#1512_rows">1.5.12 rows</a>
        </li>
        <li>
          <a href="#1513_Extra">1.5.13 Extra</a>
        </li>
        <li>
          <a href="#1514">1.5.14 小结</a>
        </li>
      </ul>
    </li>
    
    <li>
      <a href="#16_mysql">1.6 mysql不走索引的原因</a><ul>
        <li>
          <a href="#161">1.6.1 一些常见的原因</a>
        </li>
        <li>
          <a href="#162">1.6.2 需要注意的一些</a>
        </li>
      </ul>
    </li>
    
    <li>
      <a href="#17">1.7 数据库索引的设计原则</a><ul>
        <li>
          <a href="#171">1.7.1 那么索引设计原则又是怎样的</a>
        </li>
      </ul>
    </li>
    
    <li>
      <a href="#18">1.8 参考文献</a>
    </li>
  </ul>
</div>